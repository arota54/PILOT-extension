//  Complex file   TODO 
//  Sometimes, the grpprl does not contain data at every offset. I have no idea why this happens. 
/* @todo handle table sprms from complex files */
//  FIXME (byte array properties not yet implemented): dsi.setDocparts(P_DOCPARTS); 
//  FIXME (byte array properties not yet implemented): assertNull(dsi.getDocparts());   FIXME (byte array properties not yet implemented): assertNull(dsi.getHeadingPair()); 
//  TODO clone some more properties ?  
/*  TODO: handle rect path  */
// TODO -- implement these as needed  BrtFileVersion(128), //file version 
// TODO: depending on the formatId getDateTimeText() should return formatted date  assertEquals("08/12/08", notesHdd.getDateTimeText()); 
/*  * Test Freeform object. * The Freeform shape is constructed from java.awt.GeneralPath. * Check that the get/set path accessors are consistent. * (TODO: verification of Bezier curves is more difficult due to rounding error.  Figure out a test approach for that) * * @author Yegor Kozlov  */
//  TODO: Can these ever have formatting on them? 
//  "A .. B" not valid syntax for "A:B"   and there's no other valid expression that fits this grammar 
//  PDXNAN(0x006F,0x0C65,"PDXnan"), // invalid combo 
//  Copy merged regions that are fully contained on the row   FIXME: is this something that rowShifter could be doing? 
/* @todo handle large PAPX from data stream */
/*  TODO update body element, update xwpf element, verify that         * incoming paragraph belongs to this document or if not, XML was         * copied properly (namespace-abbreviations, etc.)          */
/*  *	Test to see if Range.insertBefore() works even if the Range contains a *	CharacterRun that uses Unicode characters. * * TODO - re-enable me when unicode paragraph stuff is fixed!  */
//  Some files seem to lie about their unicode status, which      is very very pesky. Try to work around these, but this 
//  TODO - check the formula once tables and    arrays are properly supported 
//  TODO: handle LCID codes 
//  TODO: use new properties 
//  TODO Update this to expose first and last sheet indexes 
//  We get an error when we parse [Content_Types].xml   because it's not a valid URI. 
//  TODO Work out how to report this, given we can't change the method signature... 
/*  * TODO: document me *  * @author Sergey Vladimirov (vlsergey {at} gmail {dot} com)  */
//  FIXME: is this something that rowShifter could be doing? 
// TODO: default "autobreaks" is different in HSSF and XSSF 
//  We need a new CTXf for the main styles   TODO decide on a style ctxf 
// TODO: implement more dashing styles 
/*          * HACK: Detect compressed images. In reality there should be some way         * to determine this from the first 32 bytes, but I can't see any         * similarity between all the samples I have obtained, nor any         * similarity in the data block contents.          */
//  TODO: handle palette colors and alpha(?) value 
//  TODO: check size   TODO: check size   TODO: check size 
//       assertRefPtgA1('V', getPtgs(cell), 6); // FIXME! 
//  Excel's # with value 0 will output empty where Java will output 0. This hack removes the # from the format. 
//  Todo - check text too, once bug fixed 
//  TODO: check if we can break here, i.e. if a page can have more than 1 break on the same id 
/*      * Apply a custom filter     *     * <p>     * A custom AutoFilter specifies an operator and a value.     * There can be at most two customFilters specified, and in that case the parent element     * specifies whether the two conditions are joined by 'and' or 'or'. For any cells whose     * values do not meet the specified criteria, the corresponding rows shall be hidden from     * view when the filter is applied.     * </p>     *     * <p>     * Example:     * <blockquote><pre>     *  AutoFilter filter = sheet.setAutoFilter(CellRangeAddress.valueOf("A1:F200"));     *  filter.applyFilter(0, FilterOperator.GreaterThanOrEqual", "0.2");     *  filter.applyFilter(1, FilterOperator.LessThanOrEqual"", "0.5");     * </pre></blockquote>     * </p>     *     * @param columnIndex 0-based column index     * @param operator the operator to apply     * @param criteria top or bottom value used in the filter criteria.     *     * TODO YK: think how to combine AutoFilter with with DataValidationConstraint, they are really close relatives     * void applyFilter(int columnIndex, FilterOperator operator, String criteria);      */
//  TODO - this data seems to require two extra bytes padding. not sure where original file is.   it's not bug 38607 attachment 17639 
//  FIXME: this function is a self-fulfilling prophecy: this test will always pass as long 
// FIXME: XSSFCell and HSSFCell expose different interfaces. getErrorCellString would be helpful here 
/*         * Exponent sign handling is complex.        *        * In DecimalFormat, you never put the sign in the format, and the sign only        * comes out of the format if it is negative.        *        * In Excel, you always say whether to always show the sign ("e+") or only        * show negative signs ("e-").        *        * Also in Excel, where you put the sign in the format is NOT where it comes        * out in the result.  In the format, the sign goes with the "e"; in the        * output it goes with the exponent value.  That is, if you say "#e-|#" you        * get "1e|-5", not "1e-|5". This makes sense I suppose, but it complicates        * things.        *        * Finally, everything else in this formatting code assumes that the base of        * the result is the original format, and that starting from that situation,        * the indexes of the original special characters can be used to place the new        * characters.  As just described, this is not true for the exponent's sign.        * <p>        * So here is how we handle it:        *        * (1) When parsing the format, remove the sign from after the 'e' and put it        * before the first digit of the exponent (where it will be shown).        *        * (2) Determine the result's sign.        *        * (3) If it's missing, put the sign into the output to keep the result        * lined up with the output. (In the result, "after the 'e'" and "before the        * first digit" are the same because the result has no extra chars to be in        * the way.)        *        * (4) In the output, remove the sign if it should not be shown ("e-" was used        * and the sign is negative) or set it to the correct value.         */
//  FIXME: forgot to reassign!  cols = sheet1.getCTWorksheet().getColsArray(0); 
//  ExpPtg is used for array formulas and shared formulas.   it is currently unsupported, and may not even get implemented here 
/*      * To avoid accident changes to the template, you should be able     *  to create a SXSSFWorkbook from a read-only XSSF one, then     *  change + save that (only). See bug #60010     * TODO Fix this to work!      */
//  It's a special formula condition.   TODO: Check whether the condition cell contains a formula and return #VALUE! if it doesn't. 
//  TODO - would be nice to remove this 
//  This override is used only in order to test failing for HSSF. Please remove method after code is fixed on hssf,    so that original method from BaseTestSheetShiftColumns can be executed.  
//  int, not short ... :( 
//  TODO - add getFormat() to interface PictureData and genericise wb.getAllPictures() 
//  TODO - remove 've == null' condition once AreaEval is fixed 
//  TODO - remove this method 
//  POI uses UnknownPtg when the encoded Ptg array seems to be corrupted.   This seems to occur in very rare cases (e.g. unused name formulas in bug 44774, attachment 21790)   In any case, formulas are re-parsed before execution, so UnknownPtg should not get here 
//  Hack the FAT so that it goes 0->1->2->0 
//  TODO - shouldn't BlankEval.INSTANCE be used always instead of null?   null seems to occur when the blank cell is part of an area ref (but not reliably) 
//  TODO Is CommonCrawl 265 = 0x109 the one above or below? 
// TODO, read byte to figure out the type of error 
//  TODO: handle PaintStyle 
//  this already failed! Hex2Dec did not correctly handle RefEval 
// TODO column styles are not yet supported by XSSF 
//  TODO Add support for removing these kinds of nested runs,    which aren't on the CTP -> R array, but CTP -> XXX -> R array 
//  Oh dear, something has gone wrong... 
//  not implemented ... also not in the specs 
//  fix header size, sometimes this is invalid 
//  TODO How best to warn of a short read? 
/*  * This class is a friendly wrapper on top of the more scary HSLFSlideShow. * * TODO: - figure out how to match notes to their correct sheet (will involve * understanding DocSlideList and DocNotesList) - handle Slide creation cleaner  */
//  TODO - no idea if this is right 
//  TODO: convert the data to the cell format 
//  TODO - when does this occur? 
/*     * To ensure we can create a file >2gb in size, as well as to    *  extend existing files past the 2gb boundary.    *    * Note that to run this test, you will require 2.5+gb of free    *  space on your TMP/TEMP partition/disk    *    * Note that to run this test, you need to be able to mmap 2.5+gb    *  files, which may need bigger kernel.shmmax and vm.max_map_count    *  settings on Linux.    *    * TODO Fix this to work...     */
//  This bug is currently open. This test will fail with "expected error not thrown" when the bug has been fixed.   When this happens, change this from @Test(expected=...) to @Test 
// FIXME: change to protected if/when SXSSFHyperlink class is created 
/*  *	Test to see if Range.replaceText() works even if the Range contains a *	CharacterRun that uses Unicode characters. * * TODO - re-enable me when unicode paragraph stuff is fixed!  */
/*  * Represents autofiltering for the specified worksheet. * * <p> * Filtering data is a quick and easy way to find and work with a subset of data in a range of cells or table. * For example, you can filter to see only the values that you specify, filter to see the top or bottom values, * or filter to quickly see duplicate values. * </p> * * TODO YK: For now (Aug 2010) POI only supports setting a basic autofilter on a range of cells. * In future, when we support more auto-filter functions like custom criteria, sort, etc. we will add * corresponding methods to this interface.  */
//  FIXME: remove try, catch, and testPassesNow, skipTest when test passes 
/*  FIXME copied from {@link org.apache.poi.ss.TestWorkbookFactory}  */
//  TODO - check contents 
/*  * This handles reading and writing a stream within a *  {@link POIFSFileSystem}. It can supply an iterator *  to read blocks, and way to write out to existing and *  new blocks. * Most users will want a higher level version of this,  *  which deals with properties to track which stream *  this is. * This only works on big block streams, it doesn't *  handle small block ones. * This uses the new NIO code *  * TODO Implement a streaming write method, and append  */
//  FIXME: Move these constants into an enum 
// FIXME: should be false, no need to create rows where src is only to copy them to dest 
//  TODO add support for TargetMode.EXTERNAL relations. 
//  TODO - DOLLAR() function impl is NQR   result should be StringEval, with leading '$' and thousands separators 
/* 	 * Sets the URL of the link	 * TODO: Figure out if we should always set both	  */
//  FIXME: this class implements a lot of path joining and splitting logic that   is already implemented in java.nio.file.Path.   This class should heavily leverage Java library code to reduce the number of lines of code that POI has to maintain and test 
//  The directory lacks a name! 
// don't really need this. spec is confusing regarding this  sprm 
//  TODO - Current examples(3) from junits only have zero length username.  
//  TODO: handle relative coordinates 
//  TODO .xls version available too, add HSSF support then check  
//  TODO calculation of tint might be incorrect 
//  Dummy implementation - not used! 
//  not sure why this is only 2 bytes, but it is... go figure 
//  TODO Implement the rest of this, see bug #57184 
//  TODO - what about NameX ? 
// TODO: implement this 
//  TODO - make writing possible 
//  FIXME: Array Formula set with Sheet.setArrayFormula() instead of cell.setFormula() 
//  TODO: check for XXE 
//  TODO Add support for Even/Odd headings and footers 
//  FIXME: _sheetName may be null, depending on the entry point.   Perhaps it would be better to declare _sheetName is never null, using an empty string to represent a 2D reference. 
//  TODO - no Random - tests should be completely deterministic 
//  FIXME: may want to defer to the TempFile with a persistent file creation strategy to the test output dir 
//  TODO Figure out if we're in 1900 or 1904   EXCEL functions round up nearly a half second (probably to prevent floating point 
/*         // FIXME: Array Formula set with Sheet.setArrayFormula() instead of cell.setFormula()        assertEquals("[Array Formula] N10 cell type", CellType.FORMULA, cell.getCellType());        assertEquals("[Array Formula] N10 cell formula", "{SUM(H10:J10*{1,2,3})}", cell.getCellFormula());        cell = CellUtil.getCell(destRow2, col);        // FIXME: Array Formula set with Sheet.setArrayFormula() instead of cell.setFormula()        assertEquals("[Array Formula] N11 cell type", CellType.FORMULA, cell.getCellType());        assertEquals("[Array Formula] N11 cell formula", "{SUM(H11:J11*{1,2,3})}", cell.getCellFormula());      */
//  TODO repeat above code for missing charts: Bubble, Doughnut, OfPie and Stock 
//  TODO Decode this properly 
//  0x8??? ones are outlook specific, and not standard MAPI   TODO See http://msdn.microsoft.com/en-us/library/ee157150%28v=exchg.80%29   for some   info on how we might decode them properly in the future 
//  Formula based strings   TODO Find some then test 
/*  * Implementation of the DMin function: * Finds the minimum value of a column in an area with given conditions. *  * TODO: * - wildcards ? and * in string conditions * - functions as conditions  */
//  workaround for too wide pens ... just arbitrary reduce high values ... 
//  TOOD: implement Non-Cmap-Lookup correctly 
//  Comes from Iterators etc.   TODO Decide if we can handle these better whilst    still sticking to the iterator contract 
//  TODO: very non-optimal 
//  TODO: add trailing \u0000?  
//  FIXME: What happens if level is in between two levels (an even number)? 
/*      * Get the raw value flags. TODO Also provide getters for the flag meanings      */
//  FIXME: test failing case 
/*     * Note - this test runs several times, to ensure that things    *  don't get broken as we write out and read back in again    * TODO - Make this work with 3+ runs     */
//  TODO - support charts properly in usermodel 
//  Workaround for XMLBEANS-512 - ensure that when we parse    the file, we start with a fresh XML Parser each time,    and avoid the risk of getting a SaxHandler that's in error 
//  TODO: ok to ignore? 
//  TODO ... read from graphics context??? 
//  TODO Re-check sheet contents   TODO Re-check formula evaluation 
//  TODO Fix the exception this incorrectly triggers  assertEquals(" $   - ",  cfUS.apply(Double.valueOf(0)).text);   TODO Fix these to not have an incorrect bonus 0 on the end   assertEquals(" "+pound+"   -  ", cfUK.apply(Double.valueOf(0)).text);  assertEquals(" -    "+euro+"  ", cfFR.apply(Double.valueOf(0)).text); 
/*  * TODO Bring more of the logic over from XWPFParagraph  */
//  TODO: assertEquals("Minimum row number is 0.", e.getMessage()); 
//  FIXME (byte array properties not yet implemented): si.setThumbnail(P_THUMBNAIL); 
/*      * Builds a Picture object for a Picture stored as     *  Escher.     * TODO We need to pass in the PICF data too somehow!      */
//  Index the Parent Group chunks for easy lookup   TODO Is this the right way? 
//  TODO Support IconSet + Other CFs with 2 rules          assertEquals(2, cf.getNumberOfRules());          cr = cf.getRule(0);          assertIconSetPercentages(cr, IconSet.GYR_3_TRAFFIC_LIGHTS_BOX, 0d, 33d, 67d);          cr = cf.getRule(1);          assertEquals(ConditionType.FORMULA, cr.getConditionType());          assertEquals(ComparisonOperator.NO_COMPARISON, cr.getComparisonOperation());          // TODO Why aren't these two the same between formats? 
//  TODO Look up more of these in the latest [MS-XLS] doc and move to getBiffName 
//  TODO: better exception class 
//  TODO: check why we always clear this ... 
//  TODO - enable XSSF test 
//  TODO: to be validated ...   like anisotropic, but use x-axis as reference 
//  Tricky, not stored directly in poifs   TODO 
// TODO add other shape types which can not contain text 
/*  find a better solution  */
//  TODO Decode the value into an offset   TODO Look up the chunk based on that 
/*      * Test of getPath method, of class DConRefRecord.     * @todo different types of paths.      */
//             // TODO - trivial differences in ContinueRecord break locations              // Sample data should be checked against what most recent Excel version produces.              // maybe tweaks are required in ContinuableRecordOutput              assertArrayEquals(origData, ser_output);          } 
/*  @todo handle cell shading */
//  TODO: good to ignore? 
//  TODO: is "velvetSweatshop" the default password? 
//  FIXME (byte array properties not yet implemented): assertEquals(P_, dsi.getHeadingPair()); 
/*                  * too bad, this start field mark doesn't have corresponding end                 * field mark or separator field mark in fields table                  */
//  TODO Load element with XMLBeans or dynamic table   TODO Check every element/namespace for compliance 
//  something went wrong. just print the whole stack trace 
//  To do: Excel places restrictions on the available operations within a list formula.   Some things like union and intersection are not allowed. 
//  TODO: actually evaluate the formula / NPE checks 
// Given that we basically iterate through the rows in order,  For a performance improvement, it would be better to return an instance of  an iterator and use that instance throughout, rather than recreating one and  having to move it to the right position. 
//  TODO - do we need "Workbook.records.remove(...);" similar to that in Workbook.removeName(int namenum) {}? 
//  Tricky:   fourth arg supplied but evaluates to blank   this does not get the default value 
//  bad because zero is not a valid row number   this should get parsed as "B1" 
//  TODO - Handle CRC checking on the output side 
//  WARNING - this is wrong!   The file name should be showing, but bug #45970 is fixed 
//  not available here, unless it exists and is unimplemented in cfRuleRecord 
//  TODO: support inline table style 
//  TODO Shouldn't it become [2] like the others? 
//  TODO Detect if it is multi-valued, since if it is   then even fixed-length strings store their multiple   values in another chunk (much as variable length ones) 
//  TODO avoid StringIndexOutOfBounds 
//  TODO Some files, such as TestVisioWithCodepage.vsd, are currently   triggering this for values that don't look like codepages   See Bug #52258 for details 
//  TODO - are these ~Field used / necessary 
/*      * TODO - parse conditional format formulas properly i.e. produce tRefN and tAreaN instead of tRef and tArea     * this call will produce the wrong results if the formula contains any cell references     * One approach might be to apply the inverse of SharedFormulaRecord.convertSharedFormulas(Stack, int, int)     * Note - two extra parameters (rowIx &amp; colIx) will be required. They probably come from one of the Region objects.     *     * @param formula  The formula to parse, excluding the leading equals sign.     * @param sheet  The sheet that the formula is on.     * @return <code>null</code> if <tt>formula</tt> was null.      */
//  can this clumsy generic syntax be improved? 
//  TODO: check if issuerName is different on getTBSCertificate   issuerName = PrincipalUtil.getIssuerX509Principal(certificate).getName().replace(",", ", "); 
/*      * @param fcStart The start of the text for this property, in characters.     * @param fcEnd   The end of the text for this property, in characters.     * @param buf     FIXME: Old documentation is: "grpprl The property description in compressed form."      */
//  TODO: calculate integrity hmac while reading the stream   for a post-validation of the data 
//  workaround for not having the vmlDrawing filled 
//  not implemented ... only for OLE objects in the specs 
//  see 2.3.4.9 Password Verification (Standard Encryption)   ... The number of bytes used by the encrypted Verifier hash MUST be 32 ...   TODO: check and trim/pad the hashes to 32 
//  TODO Shouldn't we use XWPFNumbering or similar here?   TODO Make it easier to change 
/*      * Chooses a new boolean value for the cell when its type is changing.<p>     *     * Usually the caller is calling setCellType() with the intention of calling     * setCellValue(boolean) straight afterwards.  This method only exists to give     * the cell a somewhat reasonable value until the setCellValue() call (if at all).     * TODO - perhaps a method like setCellTypeAndValue(CellType, Object) should be introduced to avoid this      */
//  TODO: update this test for meaningful functional behavior 
/*  @todo handle word defined table styles */
/*      * Determines if there is a page break at the indicated row     * @param row FIXME: Document this!     * @return FIXME: Document this!      */
//  TODO Identify if we're doing 1900 or 1904 date windowing 
//  TODO - not a real Ptg   0x01   0x02   0x03   0x04   0x05   0x06   0x07   0x08   0x09   0x0a   0x0b   0x0c   0x0d   0x0e   0x0f   0x10   0x11   0x12   0x13   0x14   0x15   0x16 
// HACK: do a "cheat" clone, see Record.java for more information 
/*              * it is not very good, but what can do without breaking current             * API? --sergey              */
//  as the integrity hmac needs to contain the StreamSize,   it's not possible to calculate it on-the-fly while buffering   TODO: add stream size parameter to getDataStream() 
//  TODO - c2 unused but changing next line ('c'->'c2') causes test to fail 
//  TODO: what is the reaction for readOnly=false and styles.isEmpty()? 
/* 	 * Formats the given numeric of date cells contents as a String, in as	 * close as we can to the way that Excel would do so. Uses the various	 * format records to manage this.	 *	 * TODO - move this to a central class in such a way that hssf.usermodel can	 * make use of it too	 * 	 * @param cell the cell	 * 	 * @return the given numeric of date cells contents as a String	  */
//  XOR-Obfuscation   TODO: XOR-Obfuscation is currently flawed - although the de-/obfuscation initially works,   it suddenly differs from the result of encrypted files via Office ...   and only very small files can be opened without file validation errors 
//  Workaround   sheet.addIgnoredErrors(new CellReference(cell.getRowIndex(), cell.getColumnIndex(), false, false),          IgnoredErrorType.NUMBER_STORED_AS_TEXT); 
/*      * Normalize a URI/part name     * TODO: find a better way ...      */
//  TODO: The colors don't match 100% the results of Powerpoint, maybe because we still   operate in sRGB and not scRGB ... work in progress ... 
//  Work out what to add the picture to, then add both the    picture and the relationship for it   TODO Should we have an interface for this sort of thing? 
//  XXX: shall we support fill? 
//  TODO: case-sensitive? 
//  TODO: find out how we can find the mastersheet base on the slide layout type, i.e.   getSlideRecord().getSlideAtom().getSSlideLayoutAtom().getGeometryType() 
//  TODO: close() re-writes the sample-file?! Resort to revert() for now to close file handle... 
//  TODO Fix this to convert line to equivalent value, or deprecate this in 
//  TODO: implement support for denormalized XMLs (see   OpenOffice part 4: chapter 3.5.1.7) 
/*      * Check if cell range A contains cell range B (B <= A)     *      * TODO: move this into {@link CellRangeAddressBase}     *      * @param crA cell range A     * @param crB cell range B     * @return true if cell range A contains cell range B      */
//  Check for bits that only apply when attached to a core document   TODO Make this nicer by tracking the XWPFFootnotes directly 
/*      * TODO - would not be required if calling code used RecordStream or similar      */
//  TODO: handle srcUnit 
//  TODO: What is this? 
//  TODO - simplify logic using a generalised record ordering 
//  FIXME: (performance optimization) this should be moved outside the for-loop so that comments only needs to be iterated over once. 
//  FIXME: serves same purpose as org.apache.poi.xssf.usermodel.XSSFEvaluationSheet$CellKey 
//  FIXME: can these be merged with {@link CellType}?   are the numbers specific to the HSSF formula record format or just a poor-man's enum? 
/*      * FIXME:     * bug 58779: Closing an XMLSlideShow that was created with {@link SlideShowFactory#create(File)} modifies the file     *     * @param filename the sample filename or full path of the slideshow to check before and after closing     * @param ss the slideshow to close or revert      */
//  XXX: temporary workaround for old Word95 document 
//  TODO - check the contents 
//  tricky: indexing outside of A10:A12 
//  This is not a very useful test as written. It is not worth the execution time for a unit test 
//  TODO: implement! 
//  TODO This should be 2, but we don't support CFEX formattings yet, see #58149 
//  TODO: Check for NaN 
//  TODO: fix me 
//  TODO: support rich text fragments 
//  TODO: dead fields? 
//  TODO: some documents fail currently...  XSSFFormulaEvaluator evaluator = new XSSFFormulaEvaluator(wb);  evaluator.evaluateAll(); 
//  TODO Are these right? 
//  TODO: any properties??? 
//  FIXME (byte array properties not yet implemented): assertEquals(P_, dsi.getDocparts()); 
// this is a complete hack.  The challenge is that there  can be many 0 length or junk streams that are uncompressed  look in the first 20 characters for "Attribute" 
// TODO: it is possible to have an SDT that contains a cell in within a row  need to modify this code so that it pulls out SDT wrappers around cells, too. 
//  TODO: implement setting bullet color to null 
// TODO: Convert this to generate an AreaReference 
//  TODO: fails XMLExportTest, is this ok? 
//  FIXME (byte array properties not yet implemented): dsi.setHeadingPair(P_HEADING_PAIR); 
/*      * tests that the create record function returns a properly      * constructed record in the case of a continued record.     * TODO - need a real world example to put in a unit test      */
//  casting here is wrong, but there's no other way of getting the value,   as it doesn't seem to be exposed by complex types (even though this   is a mixed type) 
//  TODO - prune this method out of the hierarchy 
//  wrong size 
//  TODO: check why original bitmaps scale/behave differently to vector based images 
//  TODO Could we do the read-only case with MapMode.PRIVATE instead?   See https://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.MapMode.html#PRIVATE   Or should we have 3 modes instead of the current boolean -     read-write, read-only, read-to-write-elsewhere?  
//  TODO: find out character style for empty, but bulleted/numbered lines 
/*      * Retrieves the region at the row/column indicated     * @param main FIXME: Document this!     * @return The Break or null if no break exists at the row/col specified.      */
//  this is not implemented yet 
//  TODO - refactor cell reference parsing logic to one place.   Current known incarnations:     FormulaParser.GetName()     CellReference.parseSheetName() (here)     AreaReference.separateAreaRefs()     SheetNameFormatter.format() (inverse) 
//  FIXME (byte array properties not yet implemented): assertEquals(P_THUMBNAIL, si.getThumbnail()); 
//  TODO: fix line width calculation 
//  NOTE: This is currently based on current behavior of POI, somehow   what POI returns in the calls to collapsed/hidden is not fully matching    the examples in the spec or I did not fully understand how POI stores the data internally... 
//  I do not really like it!! 
//  TODO - replace no-arg constructor with this logic 
/*      * Determines if there is a page break at the indicated column     * @param column FIXME: Document this!     * @return FIXME: Document this!      */
//  hack because I can't figure out how to get XMLBeans to parse a sub-element in a standalone manner 
/*                      * TODO: make sense of the remaining bytes                     * According to the spec they consist of:                     * 1. 16-byte  GUID: This field MUST equal                     *    {0xF4815879, 0x1D3B, 0x487F, 0xAF, 0x2C, 0x82, 0x5D, 0xC4, 0x85, 0x27, 0x63}                     * 2. Serial version, this field MUST equal 0 if present.                     * 3. URI Flags                      */
//  TODO: implement second operation based on playback device context 
/* 	 * TODO - use simple JDK methods on {@link File} instead:<br>	 * {@link File#getParentFile()} instead of {@link FileHelper#getDirectory(File)	 * {@link File#getName()} instead of {@link FileHelper#getFilename(File)	  */
//  TODO implement or throw exception if not supported 
//  TODO - RowRecord column boundaries need to be updated for cell comments too 
// The token_1_columns and token_2_rows do not follow the documentation.  The number of physical rows and columns is actually +1 of these values.  Which is not explicitly documented. 
//  TODO - do we need "this.records.remove(...);" similar to that in this.removeName(int namenum) {}? 
//  FIXME: this may be faster if it looped over array formulas directly rather than looping over each cell in   the region and searching if that cell belongs to an array formula 
//  TODO: is immutable ??? 
// passing HSSFRichTextString is incorrect 
//  workaround for IBM JDK assigning the classname to the lowercase instance provided by Definer!?!   I could not find out why that happens, the wrong assignment seems to be done somewhere deep inside Ant itself   or even in IBM JDK as Oracle JDK does not have this problem. 
//  Check the CF colours   TODO 
//  FIXME: should be protected   FindBugs, category MALICIOUS_CODE, FI_PUBLIC_SHOULD_BE_PROTECTED   A class's finalize() method should have protected access, not public 
//                     // TODO - would like to keep the chart aggregate packed, but one unit test needs attention                      records.add(chartAgg); 
/*      * A protected sheet with comments, when written out by     * POI, ends up upsetting excel.     * TODO Identify the cause and add extra asserts for     * the bit excel cares about      */
/*      * TODO - while this is internally consistent, I'm not     *  completely clear in all cases what it's supposed to     *  be doing... Someone who understands the goals a little     *  better should really review this!      */
/*  * A variable length {@link PropertyValue} that is backed by a {@link Chunk} * TODO Provide a way to link these up with the chunks  */
/*         //TODO: figure out why this isn't working        data[0] = (byte)0xF9;        data[1] = (byte)0xD8;        assertCharEquals('\u88CF', data);      */
//  TODO: implement TextCFException10 structure 
//  TODO - update OOO document to include this value 
/*              * YK: reading the ClipboardData packet (VT_CF) is not quite             * correct. The size of the data is determined by the first four             * bytes of the packet while the current implementation calculates             * it in the Section constructor. Test files in Bugzilla 42726 and             * 45583 clearly show that this approach does not always work. The             * workaround below attempts to gracefully handle such cases instead             * of throwing exceptions.             *             * August 20, 2009              */
//  TODO - this code probably never executes 
/*      *      * @return the blur radius of the shadow     * TODO: figure out how to make sense of this property when rendering shadows       */
//  TODO - problems with OBJ sub-records stream   MS spec says first sub-record is always CommonObjectDataSubRecord,   and last is always EndSubRecord. OOO spec does not mention ObjRecord(0x005D).   Existing POI test data seems to violate that rule. Some test data   seems to contain garbage, and a crash is only averted by stopping at   what looks like the 'EndSubRecord' 
//  @deprecated 3.15 beta 2. getVerticalAlignment will only work on VerticalAlignment enums instead of codes in the future. 
/* 	 * TODO - these are all formulas which currently (Apr-2008) break on ooxml 	  */
//  FIXME (byte array properties not yet implemented): static final byte[] P_THUMBNAIL = new byte[123]; 
//  TODO - if we are confident that this sanity check is not required, we can remove 'value' from plain value cache entry 
// TODO: simplify this to get ibody elements in order 
//  TODO: replace it, by applyTransform???? 
//  This one defines it   TODO Save it somewhere 
/*  * This enumeration value indicates the type of vertical alignment for a cell, i.e., * whether it is aligned top, bottom, vertically centered, justified or distributed. *  * <!-- FIXME: Identical to {@link org.apache.poi.ss.usermodel.VerticalAlignment}. Should merge these to * {@link org.apache.poi.common.usermodel}.VerticalAlignment in the future. -->  */
//  TODO - bug elsewhere in POI - something wrong with encoding of NOT() function 
//  FIXME: remove type casting when copyCellFrom(Cell, CellCopyPolicy) is added to Cell interface 
/*  This is case-sensitive. Is that correct?  */
//  can you believe it? excel returns nper as a fraction!?? 
//  Some files from Crystal Reports lack the is16BitUnicode byte    the remaining fields, which is naughty 
//  TODO this needs to be migrated out into section code 
//  TODO should we have this stuff in the FormulaEvaluator? 
// Had to add this and TIME_ZONE_PAT to handle tz with colons.  When we move to Java 7, we should be able to add another  date format to DATE_FORMATS that uses XXX and get rid of this  and TIME_ZONE_PAT   TODO Fix this after the Java 7 upgrade 
/*      * Make sure the DN is encoded using the same order as present     * within the certificate. This is an Office2010 work-around.     * Should be reverted back.     *     * XXX: not correct according to RFC 4514.     *     * @return when true, the issuer DN is used instead of the issuer X500 principal      */
//  TODO: check if approximation via rotating only the bounds (instead of the shape) is sufficient 
//  This includes text booleans "TRUE" and "FALSE".  They are not valid. 
/*  * This class performs a D* calculation. It takes an {@link IDStarAlgorithm} object and * uses it for calculating the result value. Iterating a database and checking the * entries against the set of conditions is done here. * * TODO: * - wildcards ? and * in string conditions * - functions as conditions  */
//  TODO Fix up for Word 6/95 
// TODO: What is this? 
/*      * Convert a string to {@link java.net.URI}     *     * If  part name is not a valid URI, it is resolved as follows:     * <p>     * 1. Percent-encode each open bracket ([) and close bracket (]).</li>     * 2. Percent-encode each percent (%) character that is not followed by a hexadecimal notation of an octet value.</li>     * 3. Un-percent-encode each percent-encoded unreserved character.     * 4. Un-percent-encode each forward slash (/) and back slash (\).     * 5. Convert all back slashes to forward slashes.     * 6. If present in a segment containing non-dot (?.?) characters, remove trailing dot (?.?) characters from each segment.     * 7. Replace each occurrence of multiple consecutive forward slashes (/) with a single forward slash.     * 8. If a single trailing forward slash (/) is present, remove that trailing forward slash.     * 9. Remove complete segments that consist of three or more dots.     * 10. Resolve the relative reference against the base URI of the part holding the Unicode string, as it is defined     * in ?5.2 of RFC 3986. The path component of the resulting absolute URI is the part name.     *</p>     *     * @param   value   the string to be parsed into a URI     * @return  the resolved part name that should be OK to construct a URI     *     * TODO YK: for now this method does only (5). Finish the rest.      */
/*      * Determines if there is a page break at the indicated column     *     * @param column FIXME: Document this!     * @return FIXME: Document this!      */
// TODO: move test file to framework and fix this 
/* 	 * The example file attached to bugzilla 45046 is a clear example of Name records being present	 * without an External Book (SupBook) record.  Excel has no trouble reading this file.<br>	 * TODO get OOO documentation updated to reflect this (that EXTERNALBOOK is optional).	 *	 * It's not clear what exact steps need to be taken in Excel to create such a workbook	  */
//  TODO Fix this, we are randomly adding a 0 at the end that shouldn't be there  assertEquals(" $    -   ", dfUS.formatRawCellContents( 0.0, -1, "_-$* #,##0.00_-;-$* #,##0.00_-;_-$* \"-\"??_-;_-@_-")); 
//  TODO Add methods to allow adding a HyperlinkRun or a FieldRun 
//  then iterate through the scratchpad renderers     this could be nicely implemented via a j.u.ServiceLoader, but OSGi makes things complicated ...   https://blog.osgi.org/2013/02/javautilserviceloader-in-osgi.html 
//  TODO Discover if these older documents can ever hold Unicode Strings?    (We think not, because they seem to lack a Piece table)      What we have here is a wretched hack.  We need to figure out    how to get the correct charset for the doc. 
/* 	 * Number rendering examples as observed from Excel.	 * TODO - some are currently disabled because POI does not pass these cases yet	  */
//  copy attributes, as they might be removed by merging with the new column   TODO: check if this fix is really necessary or if the sweeping algorithm   in addCleanColIntoCols needs to be adapted ... 
// TODO: figure out why these two aren't passing  assertContains(txt, "\u2019\u0078 block2");//make sure smart quote is extracted correctly 
//  disabled test from superclass   TODO - support shifting of page breaks 
//  TODO: check for recursive loops, when color getter also reference   a different color type 
/*  * Types of ignored workbook and worksheet error. *  * TODO Implement these for HSSF too, using FeatFormulaErr2, *  see bugzilla bug #46136 for details  */
//  TOOD: get a real example file ... to actual test the FBSE entry   not sure where the foDelay block is 
//  TOOD:   - set width according unit type   - provide logic for different start and end cap   - provide standard caps like diamondd   - support custom caps 
/*  * Format a value according to the standard Excel behavior.  This "standard" is * not explicitly documented by Microsoft, so the behavior is determined by * experimentation; see the tests. * <p> * An Excel format has up to four parts, separated by semicolons.  Each part * specifies what to do with particular kinds of values, depending on the number * of parts given: * <dl> * <dt>One part (example: <tt>[Green]#.##</tt>)</dt> * <dd>If the value is a number, display according to this one part (example: green text, * with up to two decimal points). If the value is text, display it as is.</dd> *  * <dt>Two parts (example: <tt>[Green]#.##;[Red]#.##</tt>)</dt> * <dd>If the value is a positive number or zero, display according to the first part (example: green * text, with up to two decimal points); if it is a negative number, display * according to the second part (example: red text, with up to two decimal * points). If the value is text, display it as is.</dd> *  * <dt>Three parts (example: <tt>[Green]#.##;[Black]#.##;[Red]#.##</tt>)</dt> * <dd>If the value is a positive * number, display according to the first part (example: green text, with up to * two decimal points); if it is zero, display according to the second part * (example: black text, with up to two decimal points); if it is a negative * number, display according to the third part (example: red text, with up to * two decimal points). If the value is text, display it as is.</dd> *  * <dt>Four parts (example: <tt>[Green]#.##;[Black]#.##;[Red]#.##;[@]</tt>)</dt> * <dd>If the value is a positive number, display according to the first part (example: green text, * with up to two decimal points); if it is zero, display according to the * second part (example: black text, with up to two decimal points); if it is a * negative number, display according to the third part (example: red text, with * up to two decimal points). If the value is text, display according to the * fourth part (example: text in the cell's usual color, with the text value * surround by brackets).</dd> * </dl> * <p> * A given format part may specify a given Locale, by including something *  like <tt>[$$-409]</tt> or <tt>[$&pound;-809]</tt> or <tt>[$-40C]</tt>. These *  are (currently) largely ignored. You can use {@link DateFormatConverter} *  to look these up into Java Locales if desired. * <p> * In addition to these, there is a general format that is used when no format * is specified. *  * TODO Merge this with {@link DataFormatter} so we only have one set of *  code for formatting numbers. * TODO Re-use parts of this logic with {@link ConditionalFormatting} / *  {@link ConditionalFormattingRule} for reporting stylings which do/don't apply * TODO Support the full set of modifiers, including alternate calendars and *  native character numbers, as documented at https://help.libreoffice.org/Common/Number_Format_Codes  */
/*      * TODO - (May-2008) fix subclasses of AreaPtg 'AreaN~' which are used in shared formulas.     * see similar comment in ReferencePtg      */
//  TODO: write text? 
//  TODO Identify what excel doesn't like, and check for that 
/*  * Helper class to handle the Visio compatible *  streaming LZW compression. * Need our own class to handle keeping track of the *  code buffer, pending bytes to write out etc. *   * TODO Fix this, as it starts to go wrong on *  large streams   */
//  Excel supports 2+ part conditional data formats, eg positive/negative/zero,    or (>1000),(>0),(0),(negative). As Java doesn't handle these kinds    of different formats for different ranges, just +ve/-ve, we need to     handle these ourselves in a special way.   For now, if we detect 2+ parts, we call out to CellFormat to handle it   TODO Going forward, we should really merge the logic between the two classes 
/*      * TODO: Additionally, the lbPlyPos (position_of_BOF) field of the BoundSheet8 record MUST NOT be encrypted.     *     * @return <code>true</code> if record type specified by <tt>sid</tt> is never encrypted      */
//  TODO Refactor this to fetch dir then do the rest 
//  TODO - use a stronger typed exception for this condition   expected during successful test 
//  TODO: check for SVG copying 
// this is pure hackery for specifying the font  this happens to work on this test file, but you need to 
//  why?  Why ask why?  But don't drink bud dry as its a really   crappy beer, try the czech "Budvar" beer (which is the real   budweiser though its ironically good...its sold in the USs   as czechvar  --- odd that they had the name first but can't   use it)... 
//  FIXME: replace with org.apache.commons.collections.map.CaseInsensitiveMap 
//  TODO Fix this, we are randomly adding a 0 at the end that shouldn't be there  assertEquals("     -   ", dfUS.formatRawCellContents(0.0, -1, "_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"??_-;_-@_-")); 
//  TODO: check if paragraph/chars can be handled the same ... 
//  TODO sometimes last byte is non-zero 
//  TODO Should the colours be slightly different between formats? Would CFEX support help for HSSF? 
//  TODO - adjust data validations 
//  TODO: check if this is Java 9 compatible ... 
//  TODO Return a more specialised form of this, see bug #56752   Should include the cached values, for in case that book isn't available 
//  Get more text   TODO 
/* 		 * ex47747-sharedFormula.xls is a heavily cut-down version of the spreadsheet from		 * the attachment (id=24176) in Bugzilla 47747.  This was done to make the sample		 * file smaller, which hopefully allows the special data encoding condition to be		 * seen more easily.  Care must be taken when modifying this file since the		 * special conditions are easily destroyed (which would make this test useless).		 * It seems that removing the worksheet protection has made this more so - if the		 * current file is re-saved in Excel(2007) the bug condition disappears.		 *		 *		 * Using BiffViewer, one can see that there are two shared formula groups representing		 * the essentially same formula over ~20 cells.  The shared group ranges overlap and		 * are A12:Q20 and A20:Q27.  The locator cell ('first cell') for the second group is		 * Q20 which is not the top left cell of the enclosing range.  It is this specific		 * condition which caused the bug to occur		  */
//  TODO to move a table from one sheet to another   CTWorksheet.getTableParts needs to be updated on both sheets 
/*  * Implementation for the Excel function IF * <p> * Note that Excel is a bit picky about the arguments to this function, *  when serialised into {@link Ptg}s in a HSSF file. While most cases are *  pretty chilled about the R vs V state of {@link RefPtg} arguments, *  for IF special care is needed to avoid Excel showing #VALUE. * See bug numbers #55324 and #55747 for the full details on this. * TODO Fix this...  */
// force all children to commit their changes into the underlying OOXML Package   TODO Shouldn't they be committing to the new one instead? 
//  Trigger the onDocumentRead for all the child parts   Otherwise we'll hit issues on Styles, Settings etc on save   TODO: Refactor this to not need to access protected method   from other package! Remove the static helper method once fixed!!! 
//  TODO - probably shouldn't initialize area ref when text is really a cell ref   Need to fix some named range stuff to get rid of this 
//  TODO: find out, how to set this value 
//  @Ignore("TODO Work out why the Thu 21st vs Monday 25th problem is occurring and fix") 
/*  * Collection of convenience chunks for standard parts of the MSG file. *  * Not all of these will be present in any given file. *  * A partial list is available at: * http://msdn.microsoft.com/en-us/library/ms526356%28v=exchg.10%29.aspx *  * TODO Deprecate the public Chunks in favour of Property Lookups  */
//  TODO Streaming write support   TODO  then convert fixed sized write to use streaming internally   TODO Append write support (probably streaming) 
//  TODO - what about values between (10<sup>14</sup>-0.5) and (10<sup>14</sup>-0.05) ? 
/*      * TODO Fix these so that they work      */
//  workaround for office 2007 pretty-printed .rels files 
// TODO use the correct SpreadsheetVersion 
//  XXX: sprm code 0x6428 is sprmPBrcBetween80, but accessed property linked to sprmPBrcBar80 (0x6629) 
//  TODO Provide a way to get the one with the filename 
/*      * Should be able to write then read formulas with references     *  to cells in other files, eg '[refs/airport.xls]Sheet1'!$A$2     *  or 'http://192.168.1.2/[blank.xls]Sheet1'!$A$1 .     * Additionally, if a reference to that file is provided, it should     *  be possible to evaluate them too     * TODO Fix this to evaluate for XSSF     * TODO Fix this to work at all for HSSF      */
//  not sure why we allow this, COUNTIFS() is only available   in OOXML, it was introduced with Office 2007 
//  column F: formula   TODO formulas are not yet supported  in SXSSF  cell.setCellFormula("SUM(A" + (rowIndex+1) + ":E" + (rowIndex+1)+ ")"); 
/*  * Simple interface describing both {@link XWPFParagraph} * and {@link XWPFSDT} * <p> * TODO Should this be based on / extend {@link Paragraph}?  */
//  This lacks the 8 byte header size 
//  TODO: support headers 
// YK: TODO document each alignment option 
//  Need to extend the stream   TODO Replace this with proper append support   For now, do the extending by hand... 
//  @deprecated 3.15 beta 2. getHorizontalAlignment will only work on HorizontalAlignment enums instead of codes in the future. 
/*      * Does this HSSFPatriarch contain a chart?     * (Technically a reference to a chart, since they     * get stored in a different block of records)     * FIXME - detect chart in all cases (only seems     * to work on some charts so far)      */
//  TODO Is this right? 
/* 	 * debug only	 * TODO - encapsulate	  */
//  TODO: should this be supported?   shape.setShapeType(-1);   assertEquals(-1, shape.getShapeType());   shape.setShapeType(-1);   assertEquals(-1, shape.getShapeType()); 
/*       * TODO - make HSSFComment more consistent when created vs read from file.      * Currently HSSFComment has two main forms (corresponding to the two constructors).   There      * are certain operations that only work on comment objects in one of the forms (e.g. deleting      * comments).      * POI is also deficient in its management of RowRecord fields firstCol and lastCol.  Those      * fields are supposed to take comments into account, but POI does not do this yet (feb 2009).      * It seems like HSSFRow should manage a collection of local HSSFComments       */
//  TODO - what does '-1' mean here?  error check, bail out gracefully! 
//  TODO: handle vflip/hflip 
//  TODO - render full row and full column refs properly 
//  FIXME (byte array properties not yet implemented): static final byte[]  P_HEADING_PAIR = new byte[123]; 
//  TODO: init classId directly in the constructor when old statics have been removed from ClassID 
//  TODO - this test probably isn't testing much anymore 
//  TODO: anything else, we don't handle yet, such as top 10 
//  index seems like what index the cellstyle is in the list of styles for a workbook.   not good to compare on! 
//  FIXME: if cell belongs to a merged region, some of the merged region may have fallen outside of the random access window   In this case, getting the column width may result in an error. Need to gracefully handle this. 
//  TODO - instantiable superclass  arbitrarily selected; may need to increase 
/*  * Notes: * Duplicate x values don't work most of the time because of the way the * math library handles multiple regression. * The math library currently fails when the number of x variables is >= * the sample size (see https://github.com/Hipparchus-Math/hipparchus/issues/13).  */
//  TODO - find a way to choose the correct date format 
//  TODO This isn't right, but it's what we currently generate.... 
//  currently not implemented 
//  TODO: charset conversion (see ecma spec)  
//  {   /*   * Page 31:   *   * main document must be found by examining the piece table entries   * from the 0th piece table entry from the piece table entry that   * describes cp=fib.ccpText.   */   // TODO: review   return new Range( _cpSplit.getMainDocumentStart(),   _cpSplit.getMainDocumentEnd(), this );   }     /*   * Page 31:   *   * "In a non-complex file, this means text of the: main document   begins   * at fib.fcMin in the file and continues through   * fib.fcMin+fib.ccpText."   */   int bytesStart = getFileInformationBlock().getFcMin();     int charsStart = getTextTable().getCharIndex( bytesStart );   int charsEnd = charsStart   + getFileInformationBlock().getSubdocumentTextStreamLength(   SubdocumentType.MAIN ); 
//  FIXME: Most cells are not merged, so calling getCellWidth twice re-computes the same value twice.   Need to rewrite this to avoid unnecessary computation if this proves to be a performance bottleneck. 
//  FIXME: replace with wb.close() when bug 58779 is resolved 
//  FIXME (byte array properties not yet implemented): static final byte[]  P_DOCPARTS = new byte[123]; 
//  it doesn't work to use just a color with transparency ... 
/*  * Utilities to read hex from files. * TODO - move to test packages  */
//  TODO Test for tick not bullet 
//  TODO: check font group defaulting to Symbol 
//  todo validate formula here, before changing the cell? 
//  TODO: handle tile settings, currently the pattern is always streched 100% in height/width 
// 	undocumented 
//  TODO These values are suspected to be wrong... 
/*      * A factory method allowing to create a conditional formatting rule     * with a cell comparison operator<p>     * TODO - formulas containing cell references are currently not parsed properly     *     * @param comparisonOperation - a constant value from     *		 <tt>{@link org.apache.poi.hssf.record.CFRuleBase.ComparisonOperator}</tt>: <p>     * <ul>     *		 <li>BETWEEN</li>     *		 <li>NOT_BETWEEN</li>     *		 <li>EQUAL</li>     *		 <li>NOT_EQUAL</li>     *		 <li>GT</li>     *		 <li>LT</li>     *		 <li>GE</li>     *		 <li>LE</li>     * </ul>     * </p>     * @param formula1 - formula for the valued, compared with the cell     * @param formula2 - second formula (only used with     * {@link org.apache.poi.hssf.record.CFRuleBase.ComparisonOperator#BETWEEN}) and     * {@link org.apache.poi.hssf.record.CFRuleBase.ComparisonOperator#NOT_BETWEEN} operations)      */
//  Note: Removal doesn't currently reset the first column.  It probably should but it doesn't. 
// It hurts, hurts, hurts to create a new byte array for every record.  However, on a large Excel spreadsheet, this parser was 1/3 faster than  the ooxml sax parser (5 seconds for xssfb and 7.5 seconds for xssf.  The code is far cleaner to have the parser read all  of the data rather than having every component promise that it will read 
//  Manually check to make sure file isn't corrupted   TODO: develop a process for occasionally manually reviewing workbooks   to verify workbooks are not corrupted 
//  TODO How does XSSF encode this? 
//  TODO: HorribleProxy can't convert array input params yet 
//  TODO - full column references not rendering properly, absolute markers not present either 
//  FIXME: Java 7+: use java.nio.Files#createTempDirectory 
//  TODO - keep looping? Do we expect multiple matches? 
/*      * TODO: data tables are stored at the workbook level in XSSF, but are bound to a single sheet.     *       The current code structure has them hanging off XSSFSheet, but formulas reference them     *       only by name (names are global, and case insensitive).     *       This map stores names as lower case for case-insensitive lookups.     *     * FIXME: Caching tables by name here for fast formula lookup means the map is out of date if     *       a table is renamed or added/removed to a sheet after the map is created.     *     *       Perhaps tables can be managed similar to PivotTable references above?      */
//  TODO Fix this to not have an extra 0 at the end  assertEquals(pound+"   -  ", formatter.formatCellValue(zero)); 
//  ignore... not implemented 
//  TODO - check the formula once tables and 
/*      * TODO: fix and enable      */
//  @Ignore("TODO Work out why the Fri 22nd vs Monday 25th problem is occurring and fix") 
//  XXX: It should be possible to derive this without concatenating the array, too. 
/*      * This is the default Watermark paragraph; the only variable is the text message     * TODO: manage all the other variables      */
// TODO defaults are different in HSSF and XSSF  assertTrue(sheet.getRowSumsBelow());  assertTrue(sheet.getRowSumsRight()); 
//  FIXME: whitespace wasn't stripped 
//  todo: test a manipulation on a package part, which is not signed   ... maybe in combination with #56164  
//  TODO - is this right? 
//  FIXME this should be changed to private and the class marked final once HSSFDateUtil can be removed 
// TODO: default "guts" is different in HSSF and XSSF 
//  work around issues with dates like 1989, which appear as "89" here 
/*  TODO:             * The object specified by this record MUST be deleted from the EMF Object Table.             * If the deleted object is currently selected in the playback device context,             * the default object for that graphics property MUST be restored.              */
//  TODO run more than once 
//  TODO: if decimalPoint is null (-> index == -1), return the whole list? 
//  TODO Add in the rest of the types 
// YK: TODO: this is only a prototype 
//  TODO: support formulas 
//  TODO - add similar sanity check to ensure that Sheet.serializeIndexRecord() does not write mis-aligned offsets either 
//  TODO: we've already scanned the records, why should this work any better now? 
// TODO: remove old one 
//  TODO: add other axis types 
//  TODO - convert this to a RecordAggregate 
// TODO: range checking  TODO: fill this out 
//  TODO Make sense of the raw offset value 
//  TODO Create according XWPFComment class, extending POIXMLDocumentPart 
//  TODO: we need to find the two points for gradient - the problem is, which point at the outline   do you take? My solution would be to apply the gradient rotation to the shape in reverse   and then scan the shape for the largest possible horizontal distance 
//  TODO move parseBoolean to OperandResolver 
//  TODO: handle reset auto number indexes 
//  TODO: Do these have a good home like o.a.p.openxml4j.opc.PackageNamespaces and PackageRelationshipTypes?   These constants should be common to all of POI and easy to use by other applications such as Tika 
//  TODO Correct this, so that the filename is shown too, see bug #56742   This is what Excel itself shows  assertEquals("'56737.xls'!NR_Global_B2", cRefWName.getCellFormula()); 
//  TODO verify the constructors 
//  FIXME: breaks if address contains a sheet name or dollar signs from an absolute CellReference 
//  TODO: check if that list can be replaced by idx = Math.max(idx,themeIdx) 
//  ugly typecast - TODO - make spreadsheet version more easily accessible 
//  FIXME: (performance optimization) this should be moved outside the for-loop so that hyperlinks only needs to be iterated over once. 
//  workaround for IBMs cipher not resetting on doFinal 
// TODO combine testRepeatingRowsAndColums() for HSSF and XSSF 
//  TODO: there may be a better way to delegate this 
//  TODO: check if this is atomic ... as transform() is probably called synchronized, it doesn't matter anyway 
//  TODO: check for duplicate 
//  TODO: this is not implemented ... please provide a sample, if it   ever happens to you, to come here ... 
//  FIXME: This could be moved into LookupFunctionsTestCaseData.xls, which is tested by TestLookupFunctionsFromSpreadsheet.java 
//  workaround for a call by XSLFSheet.importContent:   if we have already the same amount of child shapes 
//  TODO - move these constants to test class (the only consumer) 
//  column E: boolean   TODO booleans are shown as 1/0 instead of TRUE/FALSE 
//  Get the hyperlinks   TODO: make me optional/separated in private function 
//  TODO  support other types of objects 
//  FIXME: we grew a column? 
//  FIXME: These might affect the time zone due to daylight savings:  assertCalendarEquals(JAPAN_CALENDAR, LocaleUtil.getLocaleCalendar(2016, 00, 01));  assertCalendarEquals(JAPAN_CALENDAR, LocaleUtil.getLocaleCalendar(2016, 00, 01, 00, 00, 00)); 
//  TODO: it seems HSSFSheet does not correctly remove comments from rows that are overwritten 
//  FIXME: use org.apache.commons.collections.map.CaseInsensitiveMap 
//  FIXME: if srcRows contains gaps or null values, clear out those rows that will be overwritten   how will this work with merging (copy just values, leave cell styles in place?) 
//  some Records do not implement clone ?!    equals instead of instanceof is on purpose here to only skip exactly this class and not any derived ones 
//  TODO: fix gradient types, this mismatches with the MS-ODRAW definition ...   need to handle (not only) the type (radial,rectangular,linear),   the direction, e.g. top right, and bounds (e.g. for rectangular boxes) 
//  FIXME: is special behavior needed if srcRows and destRows belong to the same sheets and the regions overlap? 
/*      * A factory method allowing to create a conditional formatting rule     * with a cell comparison operator<p>     * TODO - formulas containing cell references are currently not parsed properly     *     * @param comparisonOperation - a constant value from     *		 <tt>{@link org.apache.poi.hssf.record.CFRuleBase.ComparisonOperator}</tt>: <p>     * <ul>     *		 <li>BETWEEN</li>     *		 <li>NOT_BETWEEN</li>     *		 <li>EQUAL</li>     *		 <li>NOT_EQUAL</li>     *		 <li>GT</li>     *		 <li>LT</li>     *		 <li>GE</li>     *		 <li>LE</li>     * </ul>     * </p>     * @param formula1 - formula for the valued, compared with the cell     * @param formula2 - second formula (only used with     * {@link org.apache.poi.ss.usermodel.ComparisonOperator#BETWEEN}) and     * {@link org.apache.poi.ss.usermodel.ComparisonOperator#NOT_BETWEEN} operations)      */
//  TODO Do properly 
//  This one uses a shared formula   TODO Retrieve the shared formula and tweak it to     match the current cell 
//  FIXME: return Collections.unmodifiableList? 
/*      * TODO: figure out why it fails with "RecordFormatException: 0 bytes written but getRecordSize() reports 80"      */
/*  * Counts the number of cells that contain numeric data within *  the list of arguments. * * Excel Syntax * COUNT(value1,value2,...) * Value1, value2, ...   are 1 to 30 arguments representing the values or ranges to be counted. * * TODO: Check this properly matches excel on edge cases *  like formula cells, error cells etc  */
// TODO apply the dataformat for this cell 
/* @todo verify the constructors */
//  partB contains SHEET_NAME_DELIMITER   TODO - are references like "Sheet1!A1:Sheet1:B2" ever valid?     FormulaParser has code to handle that. 
// TODO analyze textCfException when have some test data 
/*      * Resolves a cell or area reference dynamically.     * @param workbookName the name of the workbook containing the reference.  If <code>null</code>     * the current workbook is assumed.  Note - to evaluate formulas which use multiple workbooks,     * a {@link CollaboratingWorkbooksEnvironment} must be set up.     * @param sheetName the name of the sheet containing the reference.  May be <code>null</code>     * (when <tt>workbookName</tt> is also null) in which case the current workbook and sheet is     * assumed.     * @param refStrPart1 the single cell reference or first part of the area reference.  Must not     * be <code>null</code>.     * @param refStrPart2 the second part of the area reference. For single cell references this     * parameter must be <code>null</code>     * @param isA1Style specifies the format for <tt>refStrPart1</tt> and <tt>refStrPart2</tt>.     * Pass <code>true</code> for 'A1' style and <code>false</code> for 'R1C1' style.     * TODO - currently POI only supports 'A1' reference style     * @return a {@link RefEval} or {@link AreaEval}      */
//  Ensure we get the right colours for these themes   TODO fix   assertEquals("FFEEECE1", wb.getTheme().getThemeColor(2).getARGBHex());   assertEquals("FF1F497D", wb.getTheme().getThemeColor(3).getARGBHex()); 
//  TODO - "-1" is a special value being temporarily used for whole row and whole column area references.   so these checks are currently N.Q.R. 
/*  FIXME (3): Ensure that at most "length" bytes are read.  */
//  FIXME: CellReference is inconsistent 
//  this is a bit of a hack, but it works 
// TODO make the two variable below private! 
//  TODO - junit to prove last arg must be srcColumnIndex and not srcRowIndex 
/*      * Test disabled pending a fix in the formula evaluator     * TODO - create MissingArgEval and modify the formula evaluator to handle this      */
//  TODO: check how to clone 
//  TODO Delocalize specialized marshallers 
//  TODO: This seems far more complex than it needs to be 
//  TODO - this is messy   Not the most efficient way but the other way was causing too many bugs 
//  create a new container   TODO: ... is this case really happening? 
//  This bug is currently open. When this bug is fixed, it should not throw an AssertionError 
//  TODO: determine master shape 
// TODO: figure out how to convert SEG_QUADTO into SEG_CUBICTO 
//  TODO Support OOXML-Strict, see bug #57699   xlsxStrict 
/*  @todo handle paragraph postioning */
//  TODO: this could/should be delegated to the Enum type, but that's in the usermodel package,   we may not want evaluation code there.  Of course, maybe the enum should go here in formula,   and not be returned by the SS model, but then we need the XSSF rule to expose the raw OOXML   type value, which isn't ideal either. 
//  not implemented 
//  Out flag is the wrong way round!   Length wise, we're 3 longer than we say, so the max len is 19   Endian wise, we're little endian, so 0x1234 is pos 0x312 
//  TODO: eventually use caching here 
/*      * Shifts rows between startRow and endRow n number of rows.     * If you use a negative number, it will shift rows up.     * Code ensures that rows don't wrap around<p>     *      * Additionally shifts merged regions that are completely defined in these     * rows (ie. merged 2 cells on a row to be shifted).<p>     *      * TODO Might want to add bounds checking here     *     * @param startRow               the row to start shifting     * @param endRow                 the row to end shifting     * @param n                      the number of rows to shift     * @param copyRowHeight          whether to copy the row height during the shift     * @param resetOriginalRowHeight whether to set the original row's height to the default     * @param moveComments           whether to move comments at the same time as the cells they are attached to      */
//  FIXME: this looks very similar to getCellWithMerges below. Consider consolidating.   We should only be checking merged regions if useMergedCells is true. Why are we doing this for-loop? 
//  Finally check the colours on the styles   TODO fix   assertEquals("FFEEECE1", cA4_EEECE1.getCellStyle().getFillForegroundXSSFColor().getARGBHex());   assertEquals("FF1F497D", cA5_1F497D.getCellStyle().getFillForegroundXSSFColor().getARGBHex()); 
//  TODO: find a real charset mapping solution instead of hard coding for Wingdings 
//  TOOD: check for correct placeholder handling - see org.apache.poi.hslf.model.Placeholder 
//  TODO: inspect the CompObj record for more details, i.e. the content type 
//  FIXME: A better exception class (IOException?) and message should be raised   indicating that the document could not be written because the output stream is closed.   see {@link org.apache.poi.openxml4j.opc.ZipPackage#saveImpl(java.io.OutputStream)} 
//  TODO - 2 seems wrong (Jun 2008).  Maybe this method is not relevant 
// FIXME: currently fails 
/*              * TODO DO not use a coded constant, find the constant in the OOXML             * classes instead, as the child of type CT_Paragraph is defined in the             * OOXML schema as 'p'              */
//  this is confusing: the rule is not connected to the sheet, changes are not applied 
//  TODO: handle new HS_* enumeration values 
//  TODO - fix case of negative subpattern differing from the    positive one by more than just the prefix+suffix, which    is all DecimalFormat supports...          assertEquals("(12.3)", dfUS.formatRawCellContents(-12.343, -1, p2dp_n1dp));          assertEquals("(12.3)", dfUS.formatRawCellContents(-12.343, -1, p2dp_n1dp_z0)); 
//  TODO: Add DocumentProperties#equals ??? 
/*  * Default Paragraph style, from which other styles will override * TODO Share logic with {@link XWPFParagraph} which also uses CTPPr  */
//  @deprecated 3.15 beta 2. getFillPattern will only work on FillPatternType enums instead of codes in the future. 
//  FIXME: inconsistent case-sensitivity 
/*      * Why doesnt JUnit have a method like this for doubles?      * The current impl (3.8.1) of Junit has a retar*** method     * for comparing doubles. DO NOT use that.     * TODO: This class should really be in an abstract super class     * to avoid code duplication across this project.     * @param message     * @param baseval     * @param checkval      */
//  TODO: instead of returning a BufferedImage, we might return a pair of raw data + image renderer   instead, so metafiles aren't pixelated, but directly written to the output graphics context 
//  TODO Need to fetch / use format strings 
//  sheet BOFs for sure   TODO - find out about chart BOFs 
//  TOOO: tell the batik guys to use secure parsing feature 
//  TODO: some documents fail currently...   Note - as of Bugzilla 48036 (svn r828244, r828247) POI is capable of evaluating   IntersectionPtg.  However it is still not capable of parsing it.   So FormulaEvalTestData.xls now contains a few formulas that produce errors here.  HSSFFormulaEvaluator evaluator = new HSSFFormulaEvaluator(wb);  evaluator.evaluateAll(); 
//  TODO: find out where this -1 value comes from at #57820 (link to ms docs?) 
//  TODO: calculate bounding rectangle on anchor and set off/ext correctly 
//  TODO - what about MemNoMemPtg? 
//  It is not wise to have such a wide catch clause - Exception is very   close to being at the top of the inheritance hierarchy - though it   will suffice for this example as it is really not possible to recover   easilly from an exceptional set of circumstances at this point in the   program. It should however, ideally be replaced with one or more 
//  TODO: There's probably a better way to do this 
//  TODO: Verify that the version syntax is valid by parsing with a version-aware parser like   org.apache.maven.artifact.versioning.DefaultArtifactVersion 
//  TODO: placement id only "SHOULD" be unique ... check other placeholders on sheet for unique id 
//  FIXME: add more tests to compare calendars, ignoring whether the set dates are equal 
//  And sometimes they write out garbage :( 
//  FIXME: use junit4 parametrization 
//  TODO: check if a hyperlink already exists 
//  FIXME: Verify that the footnote reference is w:endnoteReference, not w:footnoteReference 
//  TODO: fix font height calculation    the height is given as font size + ascent + descent   as an approximation we reduce the height by a static factor  
//  TODO - the last 2 bytes of formula data (8,0) seem weird.  They encode to ConcatPtg, UnknownPtg   UnknownPtg is otherwise not created by any other test cases 
//  hack to pass boolean by ref into inner class 
//  RGB Color   RGB Color   TODO: Add Pattern constants to record 
//  FIXME: replace with SXSSFHyperlink if it ever gets created 
/*      * Call this whenever cell values change in the workbook, so condional formats are re-evaluated      * for all cells.     * <p>     * TODO: eventually this should work like {@link EvaluationCache#notifyUpdateCell(int, int, EvaluationCell)}     * and only clear values that need recalculation based on the formula dependency tree.      */
//       assertRefPtgA1('V', getPtgs(cell), 4); // FIXME! 
/* 	 * From [MS-ODRAW].pdf sec 2.2.1<p>	 * TODO - make EscherRecordHeader {@link LittleEndianInput} aware and refactor with this	  */
//  FIXME dsi.getHeadingPair(); 
// TODO: figure out what this should be? 
//  FIXME: add more tests to compare calendars, ignoring whether the dates are equal 
/*      * A factory method allowing to create a conditional formatting rule with a formula.<br>     *     * The formatting rules are applied by Excel when the value of the formula not equal to 0.<p>     * TODO - formulas containing cell references are currently not parsed properly     * @param formula - formula for the valued, compared with the cell      */
//  TODO: the link of the XLSF classes to the xml beans objects will   be broken, when the elements are parsed a second time.   Unfortunately, the xml schema type can't be set of the alternate   content element 
//  the hyperlink extends over this text run, increase its length   TODO: the text run might be longer than the hyperlink 
/*      * If a formula references cells or named ranges in another workbook,     *  but that isn't available at evaluation time, the cached values     *  should be used instead     * TODO Add the support then add a unit test     * See bug #56752      */
//  TODO Are these getters correct? 
/*  * Common interface for things that can occur * where a run (text with common stylings) can, * eg {@link XWPFRun} or {@link XWPFSDT}. * TODO More methods to follow shortly! * <p> * TODO Make this based on {@link CharacterRun}  */
/*  @todo revisit this  */
//  TODO Why isn't this seen as 10? 
// TODO: needs test 
// FIXME: how many tables are there in this spreadsheet?  FIXME: what is the table name?  FIXME: what is the table name? 
// but is it really? shouldn't autosizing column E use "" from E1 and SHORT from E2? 
//  TODO: documentation and behavior do not match here! 
//  TODO Is this completely correct? 
//  TODO - refactor cell reference parsing logic to one place.   Current known incarnations:      FormulaParser.GetName()     CellReference.separateRefParts()      AreaReference.separateAreaRefs() (here)     SheetNameFormatter.format() (inverse) 
//  TODO: this only works for non-rotated tables 
//  TODO - what does this line do? 
//  TODO: reading cell comments via Sheet does not work currently as it tries    to access the underlying sheet for this, but comments are stored as   properties on Cells... 
// remove nodes which are empty in order to keep the output xml valid   FIXME: what should be done if currentNode.getTextContent() is null? 
//  TODO: implement 
//  Mixed icons - Column U   TODO Support EXT formattings 
//  TODO Provide a wrapper round STHighlightColor, then expose getter/setter    for the highlight colour. Ideally also then add to CharacterRun interface 
//  FIXME: what should be done if complexTypeName is null? 
//  TODO: are these readable by some of the formats? 
/* 	 * Changes the chart's title, but only if there	 *  was one already.	 * TODO - add in the records if not	  */
/*  * Implementation of the DSum function: * Finds the total value of matching values in a column in an area with given conditions. *  * TODO: * - wildcards ? and * in string conditions * - functions as conditions  */
//  TODO: log error 
/*  bug 59775: XSSFHyperlink has wrong type if it contains a location (CTHyperlink#getLocation)     * URLs with a hash mark (#) are still URL hyperlinks, not document links      */
/*      * Problem with evaluation formulas due to     * NameXPtgs.     * Blows up on:     * IF(B6= (ROUNDUP(B6,0) + ROUNDDOWN(B6,0))/2, MROUND(B6,2),ROUND(B6,0))     * <p>     * TODO: delete this test case when MROUND and VAR are implemented      */
//  TODO Do this better 
//  TODO: fix those cases, but ignore them for now ... 
//  don't rely on wmf dimensions, use dimension of anchor   TODO: check pixels vs. points for image dimension 
//  TODO: depending on fill focus, rotation with shape and other escher properties   there are still a lot of cases where we get the gradients wrong 
//  TODO: check for merged cols 
//  TODO - make all these fields private 
//  TODO: Not sure how to format this. -- DN 
//  TODO - is this the best way to represent 'EMPTY'? 
/*      * Sets a page break at the indicated row     * @param row FIXME: Document this!      */
//  TODO: check min/max orientation 
//  TODO - maybe same logic required for other/all built-in name records          workbook.cloneDrawings(clonedSheet.getSheet()); 
/*      * bug 58779: Closing an XSSFWorkbook that was created with WorkbookFactory modifies the file     * FIXME: replace this method with wb.close() when bug 58779 is resolved.     *     * @param wb the workbook to close or revert      */
/*      * Check that we can correctly decode the whole file     * TODO Fix what looks like a padding issue      */
//  TODO fix calculation of tint  assertEquals(new Color(137, 137, 137), r2.getFontColor()); 
//  TODO: to be validated ... 
//  TODO: does this make sense? 
//  TODO: add further members for other properties like:   - ATTACH_ADDITIONAL_INFO   - ATTACH_CONTENT_BASE   - ATTACH_CONTENT_LOCATION   - ATTACH_DISPOSITION   - ATTACH_ENCODING   - ATTACH_FLAGS   - ATTACH_LONG_PATHNAME   - ATTACH_SIZE 
//  TODO: what does extended mean? 
//  FIXME dsi.getDocparts(); 
//  FIXME: Merge with org.apache.poi.ss.usermodel.ComparisonOperator and rewrite as an enum 
// TODO: check shapeId in the cloned sheet 
//  FIXME: this method would be more useful if it could convert any Color to an HSSFColor   Currently the only benefit of this method is to throw an IllegalArgumentException   instead of a ClassCastException. 
//  TODO Discover if the timezone is stored somewhere else or not 
//  TODO: find out, how to determine this value 
//  TODO: apply scaling of drawing context to offset 
//  FIXME: is this correct? Should it be starting out with 0 or 1 text paragraphs? 
//  TODO Fix this 
//  TODO Nicer column fetching 
/*     * Gets 160 bytes through then starts going wrong...    * TODO Fix this     */
//  TODO YK: Formulas in rows 16 and 17 operate with ArrayPtg which isn't yet supported   FormulaEvaluator as of r1041407 throws "Unexpected ptg class (org.apache.poi.ss.formula.ptg.ArrayPtg)" 
//  TODO should be moved to a sub-class 
//  TODO - put unknown OBJ sub-records in a different class   unknown sids in the range 0x0004-0x0013 are probably 'sub-records' of ObjectRecord   those sids are in a different number space. 
/*  @todo verify the constructors  */
/*  * Streaming version of Drawing. * Delegates most tasks to the non-streaming XSSF code. * TODO: Potentially, Comment and Chart need a similar streaming wrapper like Picture.  */
// FIXME: This cast can be avoided. 
//  TODO: investigate if this is just an EMF-hack or if other formats are also embedded in EMF 
//  TODO: remove padding bytes between placeable WMF header and body? 
/*  * <p> * 9 Jan 2010 * </p> * <p> * // TODO insert Javadoc here! * </p> * * @author epp  */
//  TODO Check we get a helpful error about the max size 
/*  * Implementation of the DMax function: * Finds the maximum value of a column in an area with given conditions. *  * TODO: * - wildcards ? and * in string conditions * - functions as conditions  */
//  TODO - POI crashes if the formula is added before this sheet   RuntimeException("Zero length string is an invalid sheet name")   Excel doesn't crash but the formula doesn't work until it is   re-entered 
//  21.17 cm / 2.54 cm/inch * 72dpi * 20 = 12000   15.88 cm / 2.54 cm/inch * 72dpi * 20 = 9000   TODO YK: The Picture is cropped but HWPF reads the crop parameters all zeros 
// FIXME: Need to confirm if this is not a formula.   empirical testing shows Excel saves explicit lists surrounded by double quotes,  
/*              * Make sure the DN is encoded using the same order as present             * within the certificate. This is an Office2010 work-around.             * Should be reverted back.             *              * XXX: not correct according to RFC 4514.              */
//  TODO Check sheet contents   TODO Check formula evaluation 
//  TODO: this is actually never executed ... 
/*                      * too bad, this separator field mark doesn't have                     * corresponding end field mark in fields table                      */
//  TODO - consider deleting this class and letting CellEvaluationFrame take care of itself 
//  This is where excel really gets it wrong   Special numbers like Infinity and NaN are interpreted according to   the standard rules below. 
// TODO: figure out how to map runs/text pieces to fonts  for now, if there's a non standard codepage in one of the fonts 
//  TODO is any token transformation required under the various ref operators? 
//  draw borders (three 3x3 grids) 
// TODO: move to LittleEndian? 
//  there is a special case of this record that has only 14 bytes...undocumented! 
/*  * Supports reading and writing of variant data.<p> * * <strong>FIXME (3):</strong> Reading and writing should be made more * uniform than it is now. The following items should be resolved: * * <ul> * * <li>Reading requires a length parameter that is 4 byte greater than the * actual data, because the variant type field is included. * * <li>Reading reads from a byte array while writing writes to an byte array * output stream. * * </ul>  */
//  0x17 - 0x24 reserved for international and undocumented   TODO - one junit relies on these values which seems incorrect 
/*  something is wrong, ignoring this mark along with start mark  */
//  TODO Correct this! 
//  workaround if a path has been started and no MoveTo command   has been specified before the first lineTo/splineTo 
// hack. internal variable EscherClientAnchorRecord.shortRecord can be  initialized only in fillFields(). We need to set shortRecord=false; 
/* 		 * Changes the series' title, but only if there		 *  was one already.		 * TODO - add in the records if not		  */
//                 ValueEval ve = OperandResolver.getSingleValue(args[3], srcRowIndex, srcColumnIndex);                  // TODO R1C1 style is not yet supported 
//  formulaSize + f2unknown_int 
//  end of palette options 
//  already on the next header, quit searching 
//  From Excel help: 
//  the bug reproduces, if this call fails with NullPointerException 
//  scaling 
//  3 circles div 4: 3 x 360 / 4 = 270 
//  get comment, or create if it does not exist   NOTE - only occurs if getCellComment is called first 
//  calling createCell on an existing cell should return the existing cell and modify the cell value and style. 
/*  test the lower and upper limits of the chunk ids  */
//  and then iterate through them. 
//     public CellStyle setColumnStyle(int column, CellStyle style); 
//  Check that they contain the same data 
//  This line caused the error. 
//  NOTE: XWPFDocument.createEndnote() delegates directly         to XWPFEndnotes.createEndnote() so this tests         both creation of new XWPFEndnotes in document         and XWPFEndnotes.createEndnote(); 
//  not expected normally, id of a custom format should be greater   than BuiltinFormats.FIRST_USER_DEFINED_FORMAT_INDEX 
//  can be null 
// apply custom font to the text in the comment 
//  confirm that HSSFPatriarch.getChildren() returns two picture shapes  
//  represented by the B cell. 
//  Now set up a grid for the table, cells will fit into the grid 
//  Fetch the SlideListWithTexts in the most up-to-date Document Record     As far as we understand it:   * The first SlideListWithText will contain a SlideAtomsSet   for each of the master slides   * The second SlideListWithText will contain a SlideAtomsSet   for each of the slides, in their current order   These SlideAtomsSets will normally contain text   * The third SlideListWithText (if present), will contain a   SlideAtomsSet for each Notes   These SlideAtomsSets will not normally contain text     Having indentified the masters, slides and notes + their orders,   we have to go and find their matching records   We always use the latest versions of these records, and use the   SlideAtom/NotesAtom to match them with the StyleAtomSet 
//  ranges have a horizontal border in common   make sure columns are identical: 
//  Theme cells come first 
//  false, true 
// setting a duplicate name should throw IllegalArgumentException 
//  It's the 7 date fields. We think it's in UTC... 
//  sprmPBrcLeft80   
//  (pivot table) View Item   (pivot table) Row/Column Field IDs   (pivot table) Line Item Array 
/* String cellRef = */
//  The BS_NULL style SHOULD be used to specify a brush that has no effect 
// set up a transformer 
//  Now, add the picture to the workbook. Note that unlike the similar   method in the HSSF Examples section, the image type is checked. First,   the image files location is identified by interrogating the URL passed   to the method, the images type is identified before it is added to the 
//  add dummy entry for object ind ex 0, as emf is 1-based 
//  Link at 20 
//  Custom properties are part of the document info stream 
//  from bug 59686 
//  A 32-bit unsigned integer that specifies the 32-bit-aligned number of bytes of data   in the record-specific data that follows. This number does not include the size of 
// lv3 
//  2% in the MSFT example 
//  The Powerpoint 97 version, major and minor numbers   byte[] ppt97FileVer = new byte[] { 8, 00, -13, 03, 03, 00 }; 
//  this line is intended to compute how "July" would look like in the current locale 
//   3 * len = ascii + unicode 
// conversion relative to [0,0] should return the original formula 
//  create three DocumentProperty instances and add them to the 
//  1980 is our pivot year (so this is an expected "failure") 
//  field_5_indention_options 
//   it need outputting itself? 
//             "sample_pptx_grouping_issues.pptx",              "54542_cropped_bitmap.pptx",              "54541_cropped_bitmap.ppt", 
//  Formula referencing an area in a different sheet 
//  Check it'll fit into the space in the record 
//  Insert a row in the middle of both merged regions. 
/*  (non-Javadoc)     * leave the map alone, if it needs resetting, reusing this class is probably a bad idea.     * @see org.apache.poi.ss.formula.EvaluationSheet#clearAllCachedResultValues()     *      * @since POI 3.15 beta 3      */
//  XAdES-X-L 
//  For example, 400 is normal and 700 is bold. If this value is zero, a default weight can be used. 
//  _VBA_PROJECT, it seems, will always come last 
//  create new workbook 
/*          * In text there can be fields, bookmarks, may be other structures (code         * below allows extension). Those structures can overlaps, so either we         * should process char-by-char (slow) or find a correct way to         * reconstruct the structure of range -- sergey          */
//  It's not much data, so ask POIFSDocument to do it for us 
//  at this point FormulaRecordAggregate#isPartOfArrayFormula() should return false 
// Keep the first marker character! 
//  If we have this, it really has the email 
//  column A: default number format 
//  Add a directory with filtered contents, not the same 
//  rotation 
//  ******************************************************************************   for manual mass parsing and rendering tests of .wmfs use HemfPictureTest.paint() !   ****************************************************************************** 
//  we potentially need to adjust the column/row information in the shape   the same way as we do in setRow()/setColumn() 
/*  Read the POI filesystem's property set streams:  */
//  normalized ppt 
//  on sheet1   on sheet2  
//  the array 
//  first draw a solid background line (depending on bkmode) 
//  Negative rows not allowed 
//  also mark row style as being used 
//  All the text to be found in the file 
//  Reading directly from XLS file 
//  text rotation 
//  Handle negative days of the week, that pull us across 
//  init client data 
/*  Section count  */
//  scan for characters greater than 255 ... if any are   present, we have to use 16-bit encoding. Otherwise, we   can use 8-bit encoding 
//   visio cheats on re-using a block 
//  Check the records are the same 
//  need to add +1 to the last run of the last paragraph 
//  Jumps   Next stream 
//  Now add a formula that refers to our new workbook 
/*  This exception will be thrown if the directory already                 * exists. However, since we have full control about directory                 * creation we can ensure that this will never happen.  */
//  TODO: Find object to match nrec.getShapeId() 
//  Check via the iterator 
//  A 32-bit unsigned integer that specifies the format version number.   If the Signature field specifies encapsulated PostScript (EPS), this value MUST be 0x00000001; 
//  abort: close the file input stream 
//  number format in CellStyles should be restored to default number format 
//  create a table with 5 rows and 7 columns 
//  variable length header   page 24, point 2.4.2.2 
//  ODF / ODS - Stream 
//  --------------- Internal helpers on rich text properties ------- 
/* import org.junit.BeforeClass;import java.util.Date;import java.math.BigInteger;import java.security.KeyPairGenerator;import java.security.SecureRandom;import java.security.cert.Certificate;import sun.security.x509.AlgorithmId;import sun.security.x509.CertificateAlgorithmId;import sun.security.x509.CertificateIssuerName;import sun.security.x509.CertificateSerialNumber;import sun.security.x509.CertificateSubjectName;import sun.security.x509.CertificateValidity;import sun.security.x509.CertificateVersion;import sun.security.x509.CertificateX509Key;import sun.security.x509.X500Name;import sun.security.x509.X509CertImpl;import sun.security.x509.X509CertInfo; */
//  check removing repeating rows and columns        
// setting border to none removes the <right> element 
//  just some sample data.  These values vary a lot 
//  Previous attachment or a new one? 
// System.err.println("drawing west"); 
//  formatted as '10.0000' 
//  Colors should match 
//  If we get here, we're not dealing with a formula,    so handle things as a normal rich text cell 
//  use values close to, but within the limits 
//  borders 
//   and the length is usually the last 4 bits) 
//  compressed token 
// Strings are equal, but one or the other has formatting runs 
//  undocumented 
// !! This assumes there is a numerator and a denominator, but these are actually optional 
// the check for duplicates is case-insensitive 
//  set inside horizontal border 
//  you can leave out parameters, they are simply ignored 
//  Grab the document size, 0x1c -> 0x1f 
//  Check for the normal Office core document 
//  check that the overall workbook serializes with its correct size 
// Loop through and add all values from array list   use a fixed seed to always produce the same file which makes comparing stuff easier 
//  otherwise this line will only set the formula cached result; 
//  remove all sheet relations 
// Relative path notation - for EXCEL lib folder - fallback 
/*              * A 32-bit unsigned integer that specifies either the index of a LogPalette object             * in the EMF Object Table or the value DEFAULT_PALETTE, which is the index             * of a stock object palette from the StockObject enumeration              */
//  application/x-tika-old-excel 
//  first pass: read in data, compute xbar and ybar 
//  Properties 
//  verify results 
//  Check it now has two slides 
//  Check via the message date 
// Test 2D and 3D Area Ptgs (Pxg for OOXML Workbooks) 
//  previously was used by cellLoc, but not anymore 
//  determine the FileInformationBLock size 
//   Office sometimes produces, but is strict on generation 
//  Compare expected values with values return by the package 
//  in this case, excel ignores the row move 
//  This should go at the end 
// these are all used only during parsing, and they are mutable! 
//  Grab the length, and the first option byte 
//  Check one bit in detail   Check that we get back foreground=0 for the theme colours, 
//  width div 6 
//  Ready for Formula use! 
//  Try built-in JVM one first, standalone if not 
//  current value matches next value, skip both 
//  fallback to empty image 
// ftp://ftp.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/bestfit950.txt 
//  other sheet 
/*          * Page 35:         *          * "Associated with each interval is a BTE. A BTE holds a four-byte PN         * (page number) which identifies the FKP page in the file which         * contains the formatting information for that interval. A CHPX FKP         * further partitions an interval into runs of exception text."          */
//  Create for each XML-part in the Package a PartClass 
//  See if it's a multi-sheet range, eg Sheet1:Sheet3!A1 
//  end options bitfields 
//  And another bit 
//  Move the comment 
// append space...this assumes that rPh always comes after regular <t> 
//  get the hotspot diagnostic MBean from the platform MBean server 
//    Moving to an earlier point in the array   
//  It's a text starts-with condition. 
//  Re-test 
//  step = -1 is illegal 
//  also remove any comments associated with this row 
// Sheet#getRowBreaks() returns an empty array if no row breaks are defined 
//  These request space-padding, based on the cell width   There should always be one space after, variable (non-zero) amount before   Because the Cell Width isn't available, this gets emulated with    4 leading spaces, or a minus then 3 leading spaces 
//  Check the types on everything 
//  Is it an absolute file reference? 
//  width div 8 
// columns D-F have custom width 
//  bug 60029 
//  removing the only selected sheet 
//  do this second, as tables are sheet-specific, but named ranges are not, and may not have a sheet name given. 
//  Just the Source File/Folder and Destination Folder were   passed to the main method. 
//  +1 for 1-based, +1 for next row 
//  POI's behavior should match this behavior 
/*  * Row-level policies   */
//  use the combined handler for HSSF/XSSF 
// ////////////////////////////// From File ///////////////////////////// 
//  add or remove columns on the right side of the table 
// TODO: default "fit-to-page" is different in HSSF and XSSF 
// assertFalse(sheet.getFitToPage()); 
//  width div 3 
//  formula size   unknownInt  tRef(T2)   ?? 
//  Create next zip entry 
//  ANSI_VAR_FONT - A variable-width font   Charset: ANSI_CHARSET   PitchAndFamily: FF_DONTCARE + VARIABLE_PITCH 
//  'Worksheet Protection Block' (after 'Page Settings Block' and before DEFCOLWIDTH) 
//       .fontheight      = c8        .attributes      = 0             .italic     = false             .strikout   = false             .macoutlined= false             .macshadowed= false        .colorpalette    = 7fff        .boldweight      = 190        .supersubscript  = 0        .underline       = 0        .family          = 0        .charset         = 0        .namelength      = 5        .fontname        = Arial 
//  parse the value 
//  ByteArrayOutputStream is very unlikely throwing a IO exception (maybe because of OOM ...) 
//  nothing happens with empty row-area 
//  double percent OK 
//  Look for a new font we have 
//  width div 2 
//  4 byte release version 
//  in some cases this seems to be garbage (non spaces) 
//  removing a sheet that is not active, and not the only selected sheet 
//  Can't find it 
//  Blip stored in delay stream, which in a word doc, is   the main stream 
// Check that the cells are not somehow linked 
//  remaining case: moved sheet was higher than active before and is lower now => active is one more 
//  Do we have a comments relationship? (Only ever one if so) 
//  An array of 32-bit unsigned integers that specifies the point count for each polygon. 
//  the first one because it's the patriach). 
//  paragraph is 54 long 
//  sheet.setArrayFormula creates rows and cells for the designated range 
//  Set another, is fine 
//  ooxml file isn't 
//  Change the positions of the first groups, 
//  width div 5 
//  Then time based ones too 
//  55	39	39	57.5 
//  At present (Oct-2008), most unit test samples have (subRecordData.length % 2 == 0) 
//  TODO ChartFormatRecord.class, 
//  boundary of the brush. 
//  == null)   return 0;     final EscherContainerRecord shape = _picfAndOfficeArtData.getShape();   EscherOptRecord optRecord = shape.getChildById( (short) 0xF00B ); 
//  Int - 2 
//  If there's a gap in the cells, then fire 
//  VLookup on a name in another file 
//  width div 4 
//  attrs = 0   colour palette = x7fff 
//  of the cell. 
//  Complex data for Array #325 
//  TSP signer cert path building 
//  Excel's min positive value is several orders of magnitude larger than Java's (Java 8: 4.9e-324, Excel 2016 on Windows 10: 2.2259157957E-308) 
//  no denominator follows the slash, drop the fraction idea 
//  fall-through to pick up height 
//  minor increment   cross over 
/* 		 * Clear this streams buffer, in case flush() is called a second time		 * Fix bug 1921637 - provided by Rainer Schwarze		  */
//  first operand is actually the function name 
//  First up, no policy given, uses default 
//  else assume number 
//  Complex data for Array #326 
// From the spec: An optional unsigned integer that MUST be 3 if present   but some files has 4 
//   putting it past the leap year, adjust 
//  verify behavior of isDocumentEntry 
//  cover some deprecated methods and other smaller stuff... 
//  Whatever happens, write out that record tree 
//  autoSize will fail if required fonts are not installed, skip this test then 
// don't care about this 
//  InputStream fis = new ByteArrayInputStream(pfxFileBytes); 
// now test against a workbook containing cell comments 
// adding one here because 0 indicates a global named region; doesnt make sense for print areas 
//  Microsoft Admin Template? 
//  Font*2 
//  See spec at 2.5.198.63 PtgFuncVar 
//  rounding caused carry 
//  can't set the font to wingdings so use the   default bullet character 
//  clean up the re-saved file 
// only set to default if there is no extended format index already set 
/*  new part is now ready to rumble  */
//  Check all pictures 
//  wrong type error 
//  Open the temp file 
//  280: EXPONDIST   281: FDIST   282: FINV   283: FISHER 
//  Should now hold them 
//  Save the content 
//  dependent.  In BIFF12, "IW123" is not a valid named range name, but in BIFF8 it is. 
//  test if inserted EscherMetafileBlip will be read again 
//  Prefer the comment record if it has text in it 
//  http://stackoverflow.com/questions/9128737/fastest-way-to-set-all-values-of-an-array 
//  (3) If it's missing, put the sign into the output to keep the result 
//  Done 
//  Write out the Workbook stream 
//  Now set the flags 
// Relative path notation - down 
//  Create cell 
//  Check the SBAT (Small Blocks FAT) was properly processed 
//  used to specify that date is invalid 
//  fib.setCcpEdn(fib.getCcpEdn() + adjustment);   } 
// valid time formats - all should have 11:23 in output 
//  use POI's evaluator as an extra sanity check 
//  Not defined, oh well 
//  line end width 
//  if oldIndex > newIndex then this sheet moved left and sheets between newIndex and oldIndex moved right 
//     boolean alignToBaseline = false; 
//  Look up the new positions of our preceding UserEditAtomOffset 
//  Must be an integer 
//  Check the same but with saving to a file 
//  expected for some files 
//  size defined below 
//  327: QUARTILE 
//  Check it has content types for rels and xml 
//  The latest spec doc says this is always zero! 
// sp record 
//  C2   D2 
//  Next up, SEARCH on its own 
//  default text in master placeholders is not visible 
//  expected on the second time that _testDataProvider.writeOutAndReadBack(SXSSFWorkbook) is called   if the test makes it this far, then we know that XSSFName sheet indices are updated when sheet   order is changed, which is the purpose of this test. Therefore, consider this a passing test. 
//  Don't trust colIx boundaries as read by other apps 
//  Having sorted out the masters, that leaves the notes and slides 
//  If we got something to print out, do so 
//  312: PEARSON   313: RSQ 
// Absolute path notation - same device 
//  A 32-bit unsigned integer that specifies the size of region data, in bytes. 
//  Special case for reset to the start 
//  If we're on cells, and this cell isn't in the same    row as the last one, then fire the 
//  look for the stripe containing c, accounting for the style element stripe size   could do fancy math, but tables can't be that wide, a simple loop is fine   if not in this type of stripe, return null 
//  row is moved down by the shifting 
//  for testing invalid invocations 
//  Also handles HPSF bits 
//  merge records are removed from within the MergedCellsTable, 
//  the next three paragraphs form an auto-numbered list 
//  Now, we do the character ones 
// can send the builtin name directly in 
//  How long a code sequence is, and where in the 
//  pred '<>' matches empty string but not blank cell 
//  reading 4 byte data from a 5 byte buffer 
//  used when cell close element is seen. 
//  Ensure now have first style 
//  rotated text occupies at least five times less horizontal space than normal text 
//  low order 16 bits of picture size - can be ignored 
// removes leading equals sign if present 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#setExplicitListValues(java.lang.String[])	  */
/*      * The following definitions are for property IDs in the first     * (and only) section of the Summary Information property set.      */
//  Next is a file 
//  page reference 
//  uses evaluateFormulaCell() 
//  now add css for each used style 
//  Row 3-19 
//  Remark : Originally the latest parameter was :   contentType.toLowerCase(). Change due to a request ID 1996748. 
//  Copy over all the other nodes to our new poifs 
//  Check it has the icon, and the right number of thresholds 
//  old excel formats are not supported here 
//  test the second file. 
//  Option B (preferred for new code): 
//  normally posInChunk is 0, i.e. on the next chunk (-> index-1)   but if called on close(), posInChunk is somewhere within the chunk data 
//  eeAtom.setSubType(ExOleObjAtom.SUBTYPE_EXCEL); 
//  adding included fields 
/* OutputStream out = new FileOutputStream("C:\\temp\\58084.xlsx");        target.write(out);        out.close(); */
//  Check now as expected 
//  Slide.SlideAtom.notesId references the corresponding notes slide. 
//  file handler ignored this file 
//  excel NaN bits: 0xFFFF0420003C0000L   java NaN bits :0x7ff8000000000000L 
//  If requested, add in the hyperlinks   Ideally, we'd do these inline, but the hyperlink    positions are relative to the text area the    hyperlink is in, and we have yet to figure out 
//  And the 3rd 
//  I decided to be consistent in this way. 
//  506 == 0x01FA; 510 == 0x01FE 
//  Props back in 1 block 
// according to the spec, REFERENCE_CONTROL_B(0x33) should have the  same structure as REFERENCE_CONTROL_A(0x2F).  However, it seems to have the int(length) record structure that most others do. 
//  Biff 2 / Excel 2, pre-OLE2   Biff 3 / Excel 3, pre-OLE2   Biff 4 / Excel 4, pre-OLE2   Biff 5 / Excel 5   Biff 5 / Excel 5   Biff 5 / Excel 95 
/*      * bug 59208     * Purpose: test all valid boolean-like values     * exercise isCTOnOff(CTOnOff) through all valid permutations      */
//  decrypt the protected file - in this case it was encrypted with the default password 
//  parse the document with cursor and add   the XmlObject to its lists 
//  error values and string values not counted 
//  System.err.println(cVal.getProperty() + " = " + cVal + " -> "   + HexDump.toHex(cVal.data)); 
//  area is moved up => overwritten area is [startColumn + n, startColumn + n + movedColumns] 
//  write header texts and determine footer text 
//  Optimise 
//   10 (Unknown) and an 18 
//  No data so nothing to copy 
//  Check reading from File and Stream 
/*      * According to ECMA-376 default position is RIGHT.      */
//  Otherwise Excel gets unhappy   check all remaining flag bits (some are not well understood yet) 
//  If this attribute is omitted, then a value of 0.05 inches is   implied 
//  cleaning states of nested levels to reset numbering 
//  blue 
//  Reference to a single cell in a different workbook 
//  Check that, for B1, D1, F1 and G1, the references to A1 
//  top 
//  falling back to BitmapImageRenderer, at least it gracefully handles invalid images 
/*  (non-Javadoc)	 * @see java.io.OutputStream#write(int)	  */
//  standard prefix, defined in the spec 
//  if fc is null, use transparent color to get color of background 
// unset solid and pattern fills if they are set 
//  even though we don't have an assertion for it 
//  For tracking what we've written out, used if we're    going to be preserving nodes 
//  Make sure we got what we expected, should be of  
/*  Create the POI file system the property set is to be written to.  */
//  Should still have two SLTWs 
//  Compute the low-order word of the new key: 
//  DKGRAY_BRUSH - A dark gray, solid color brush   BrushStyle: BS_SOLID   Color: 0x00404040 
//  save a detached  copy to avoid XmlValueDisconnectedException, 
//  single-cell array formulas behave just like normal cells -   changing cell type removes the array formula and associated cached result 
//  character set identifier 
//  Increase the position by the on disk size 
// unused doesn't exist as stFile[1] != 2 
//  -> one dimensional shapes only 
//  Simple numbers 
//  one or both formulas are in error, not evaluating to a number, so the validation is false per Excel's behavior. 
//  verify that excess bits are stripped off 
//  The messes things up on everything but a Mac, so translate them to \n 
//  ensure that this works for vlookup as well 
//  "PK\003\004"   version required: 4.5   flags: 8 = data descriptor used   compression method: 8 = deflate   file modification time & date   CRC-32   compressed file size   uncompressed file size   filename length   extra flags size 
//  first check that it is in one of the regions defined for this format 
//  distance to start of false parameter/tFuncVar. +4 for tAttrSkip after true 
//  Shift rows 3 and 4 up and write to temp file 
//  not yet failed 
//  1 Jan 1901 is 366 days after 31 Dec 1899 
//  If the input stream is null then we try to get it from the   package. 
// Create cell  Cell cell = row.createCell(0); 
//  set this cell to the first cell style we defined 
//  Check if number format already exists 
//             confirm(feA, c, "INDIRECT(\"Sheet1!IW1\")", ErrorEval.REF_INVALID); // bad column              confirm(feA, c, "INDIRECT(\"Sheet1!A65537\")", ErrorEval.REF_INVALID); // bad row          } 
//  Check the rules / values in detail 
//  Clear out cached details 
// Caching of previously calculated factorial for speed 
//  Due to bug 46479 we should call setCellValue() before setCellType(),   but bug 61148 showed a case where it would be better the other   way around, so for now we call setCellValue() a second time to 
//  SlideHeadersFootersContainer 
//  Check it's all there 
//  Zero height or width raises #REF! error 
//  multi-column, multi-row area 
/*  these are for pivot tables only  */
//  same state it's left in if fed a package which has no SST part. 
//  these two are not implemented in r 
//  fully equal - exit here 
// TestStylesTable.class, //converted to junit4 
//  Should be able to create two tempfiles with same prefix and suffix 
//  confirm that the pictures are in the Sheet's drawing 
//  Fill it 
//  NumberOfObjects (2 bytes):  A 16-bit unsigned integer that specifies the number   of graphics objects that are defined in the entire metafile. These objects include 
//  A style of null means resetting back to the default style 
// //////////////// Others 
//  Handle it ourselves 
//  Find our top level children   Note - we don't handle children of children yet, as 
// lv2 
//  Try to get an existing definition of this 
//  Retrieve the properly backed block 
//  At this point we have the username as us ascii 
//  Copied for now from DataValidationEvaluator.ValidationEnum.FORMULA#isValidValue() 
//  Set the reference for the named range for worksheet 'sheet2' 
// BOF  INTERFACEEND with extra two bytes   EOF 
//  bug 51891 
// header row 
//  A 32-bit unsigned integer that specifies the index of the palette object in the EMF Object Table 
//  -2 means that the scope of this name is Workbook and the reference applies to the entire workbook. 
// at this point the master formula is gone, but we are still able to evaluate dependent cells 
//  Decide what to attach it to, based on the levels and IDs 
//  Grab the rgb values 
//  Display the record 
//  Now check the XSSFColor 
// create a new workbook 
//  now change a cell value that's an input for the rules 
//  We've spare ones from 181 to 255 
//  Check we format the English one correctly 
//  This simplifies a few combinations, so we actually always try to copy len bytes   regardless if encryptionOffset is greater than 0 
//  round back and forth - points -> master -> points 
//  pictures keyed by file name 
//  This is actually a spreadsheet! 
//  fake SID   first rec len 15 
//  #1 pass - determine row heights, the height values might be too low or 0 ... 
//  Note use of the cell border width constant. Testing with an image   declared to fit exactly into one column demonstrated that it's   width was greater than the width of the column the POI returned.   Further, this difference was a constant value that I am assuming   related to the cell's borders. Either way, that difference needs   to be allowed for in this calculation. 
/*  char 2   */
//  If you create a header/footer, then remove it again, word    will leave \r\r. Turn these back into an empty string, 
//  ... to be continued 
//  The target column is at either end of the multi-column ColumnInfo   ci   we'll just divide the info and create a new one 
//  Copy merged regions that are contained within the copy region 
//  Finally, update the cells to point at their new extended format records 
//  destination rows are completely outside ref 
//  Make sure hyperlink in overwritten row is deleted 
//  Page 55 of public specification begins 
//  Filter each entry. 
//  from OPCPackage 
//  The new SlideListWithText should go in    just before the EndDocumentRecord 
//  Link at 10 
// take the first match 
//  line breaks 
/*          * since we updated all references in FIB and etc, using new arrays to         * access data          */
//  SlideShowDumper calls IOUtils.toByteArray(is), which would fail if a different size is defined 
//  3rd is normal, so lacks a CharFlagsTextProp 
//  there aren't cells for this, just a single row 
//  First try via the proper chunk 
//  ignore some file types, images, other formats, ... 
//  sprmCCv -- 0x6870 
//  blipId is rId2 of both pictures 
//  if this directory is empty, we can delete it 
//  Handle extra 1 paragraph styles at the end 
//  We should have the same style-objects for these two columns and rows 
// simple test that adds a load of regions
//  exit if can't break any more 
//  line properties are not set by default 
//  verify that it can be accessed now 
//  sprmCFBiDi 
//  Check the updated times     2007-06-20T20:57:00+13:00 
//  Format 
//  the 5th slide has a picture and a texture fill 
//  This data came from attachment 23347 of bug 46693 at offset 0xAA43 
//  Check the header has the right points in it 
// _txtrun.setRunType(TextHeaderAtom.HALF_BODY_TYPE);  _txtrun.getRichTextRuns()[0].setFlag(false, 0, false); 
//  These are other entities that may be used in the 
//  overlap which could theoretically be merged, but isn't because the implementation was buggy and therefore was removed 
// everything except spRecord.shapeId must be the same 
//  although xmlsec has an option to ignore line breaks, currently this   only affects .rels files, so we only modify these   http://stackoverflow.com/questions/4728300 
//  Open as a proper zip stream 
//  *** RegionDataHeader ***   A 32-bit unsigned integer that specifies the size of this object in bytes. This MUST be 0x00000020. 
//  logic from Integer.compare() 
// //////////////// 
//  The flag byte is treated as its 8 individual    bits, which tell us if the following 8 codes 
//  We've now called getDrawingPatriarch() so    everything will be all screwy 
//  display tabs at the bottom 
//  Get a list of all of the Excel spreadsheet files (workbooks) in   the source folder/directory 
//  simple case - expand area by shifting bottom downward 
//  now try adding 2 properties 
//  A 32-bit unsigned integer that specifies the number of entries in the palette after resizing. 
//  ensure that any lingering writer is closed 
//  A 16-bit field that MUST be ignored. 
//  poi-ooxml: org.apache.poi.openxml4j.opc.PackageProperties#NAMESPACE_DC 
//  Create some cells, some numeric, some not 
//  Create a new BATBlock 
/*          * Special Default/Normal/Automatic color.<p>         * <i>Note:</i> This class is NOT in the default Map returned by HSSFColor.         * The index is a special case which is interpreted in the various setXXXColor calls.          */
/* 	 * Open Packaging Convention (Annex F : Standard Namespaces and Content	 * Types)	  */
//  clearer. 
//  use min() to gracefully handle cases where the length-property and the array-length do not match   we saw some such files in circulation 
//  Add the relationship between the package and the thumbnail part 
//  97 -> 98 -> end 
//  Save the contents of the atom, until we're asked to go and 
//  Now find the chunks within it 
//   ascii, and again as unicode laster on 
//  Acquire a resource that is needed to read the next level of openZipEntrySourceStream 
//  All done, return our last code 
// test new workbook 
//  add tests for direct setting - add row 4 to deepest group 
//  #1 pass - determine cols and rows 
//  just output field value 
//  Create the font and save it. Themes Table supplied later 
//  height 
//  Check if the part name URI starts with a forward slash [M1.4] 
/* FontRecord font = */
//  any value is valid if the list contains a blank value per Excel help 
//  Excel seems to have 'normal' comparison behaviour around zero (no rounding)   even -0.0 < +0.0 (which is not quite the initial conclusion of bug 47198) 
//  Confirm first few bytes of ContinueRecord 
//  X=balance, Y=ok 
//  lighter 80% 
//  test with more than we have 
// saveWorkbook(wb, fileName); 
// uncomment below line if only primary axis required and comment above line   the line chart on primary axis 
//  different paragraph mask, because of sanitizing 
//  .... 
// existing cells are invalidated 
//  with funny sheet name 
//  verify some border-case combinations of startDate and month-increase 
//  flags. Define the type of the hyperlink: 
//  legend entry has no (indirect) paragraph properties 
//  prepare embedded data 
// private short             field_4_name_length;  private short             field_5_comment_length; 
//  MissingArg -> BlankEval -> zero (as formula result) 
//  Keep this code in sync with {@link ColumnShifter#shiftMergedRegions} 
//  Grab all the chunks 
//  check read OK 
//  Split into header and contents 
//  Setup links for the sheets 
//  Create the comment and set the text+author 
//  left 
// test file derives from Common Crawl 
// cached formula result 
//  X=shift, Y=shift 
//  Add the thumbnail part to this package. 
//  Starts empty 
//  Create a content 
//  shift due to crop 
//  BinaryTagData seems to contain records, but it 
//  An EmfPlusARGB object that specifies the center color of the path gradient brush, which is the color   that appears at the center point of the brush. The color of the brush changes gradually from the 
//  check that we really are located on a user edit atom 
/*  If there is already an entry with the same name, remove it.  */
//  Print the cell reference 
//  ignore password protected files if password is unknown 
//  First four bytes are the number 
//  line style of cat axis 
//  Don't copy all relations blindly, but only the ones we know about 
//  removing the entry would mess up the sheet index in Formula of NameRecord 
//  plain area refs should be ok too 
//  A1, B1, D1 
//  example for debugging individual functions/operators:   processFunctionGroup(data, SS.START_OPERATORS_ROW_INDEX, "ConcatEval");   processFunctionGroup(data, SS.START_FUNCTIONS_ROW_INDEX, "Text"); 
//  font.color only   blue 
//  Clean up 
//  avoid running on files leftover from previous failed runs 
//  Create a map from the STVerticalJc.Enum values to the XWPF-level enums 
//  condition's string 
//  Per Excel help, "duplicate" means matching value AND format   https://support.office.com/en-us/article/Filter-for-unique-values-or-remove-duplicate-values-ccf664b0-81d6-449b-bbe1-8daaec1e83c2 
//  Find the new size of the escher children; 
//  Level one, id 36867, type 6 
//  Condition 1: Formula Is   =$B2>75   (Blue Fill) 
//  HSSFWorkbooks require a name to be added to Workbook defined names table 
//  chart records 
//  strict OOXML likely not fully supported, see #57699   this code is similar to POIXMLDocumentPart.getPartFromOPCPackage(), but I could not combine it   easily due to different return values 
//  no duplicate found => use this one 
//  encoded length   IntPtg(1) 
//  SummaryInformation 
//  extract encrypted ooxml file and write to custom encrypted zip file  
//  no fields to initialise 
//  Process all the (used) FATs from this XFAT 
//  Do we need to position within it? 
/* import org.apache.poi.ss.util.CellReference;import org.apache.poi.xssf.usermodel.XSSFCreationHelper;import org.apache.poi.xssf.usermodel.XSSFHyperlink;import org.apache.poi.xssf.usermodel.XSSFWorkbook; */
//  exceed the requested size. 
// Excel 2013 path where the file was stored in wbpart 
//  ....and that the footer object captured above contains two 
//  Note - 64 is a special "auto" one with no rgb equiv 
// absolute references 
//  SizeLow (2 bytes):  A 16-bit unsigned integer that defines the low-order word   of the number of 16-bit words in the entire metafile.   SizeHigh (2 bytes):  A 16-bit unsigned integer that defines the high-order word 
//  Extend it 
//  as we processed the full stream already, we can close the filesystem here   otherwise file handles are leaked 
//  Use a category axis for the bottom axis. 
//  Extend it past the 2gb mark 
//  delegate the query to the sheet evaluator which has access to internal ptgs 
//  Ensure trailing \n's are NOT stripped, it is legal to set a text with a trailing '\r' 
//  was formula cell before - no change of type 
//  Check it still works 
//  but if it ever did, care must be taken:   tAttrSpace comes *before* the operand it applies to, which may be consistent   with how the formula text appears but is against the RPN ordering assumed here 
//  inherit the font size from the master style 
//  Has a separator but no trailer 
//  Check "!", "$", "&", "'", "(", ")", "*", "+", ",", ";", "=" 
//  otherwise the format seems to depend on OS settings (default date format) 
//  the cell comments in sheetComments.getCellComments() do not have the client anchors set 
//  millimetres and in EMUs 
//  Now strip them out -- we only need their interpretation, not their presence 
//   rather than in random filesystem order 
//  scale knots to [0, 1] based on first/last knots 
//  Set up references to the other file 
//  Found <sheetData/> 
//  A 32-bit signed integer that specifies the logical width of the source rectangle. 
//  Mark us as being a formula if not already 
/*          * contains coordinates of comments we iterate over          */
//  See https://issues.apache.org/jira/browse/IO-203 for why we use read() rather than delegating to skip() 
//  CellAddress=C4, will be overwritten (deleted) 
//  this will never happen, we have already evaluated the formula 
//  anchor.setDx1(0); 
//  2 initial shorts 
//  315652.8287 
//  writing is not yet implemented... handlePOIDocument(diagram); 
//  that refers to formula with a unicode (non-ASCII) sheet name formula 
//  remove all rows which will be overwritten 
//  check for data bar 
//  Raw data is not compressed. 
// throw new POIXMLException("Unexpected page relation: " + part); 
//  Grab the data from the part stream 
//  bitfields for fill palette options 
//  start of image = BMP header length + dib header length + color tables length 
//  POI does the same for consistency, but this is not critical 
//  we need to re-populate this CTCell 
/*          * Add ds:References that come from signing client local files.          */
//  For each possible entry, see if we match the mask   If we do, decode that, save it, and shuffle on 
/*  Open the file with the buffer  */
/* CTCell[] cArray = ((XSSFRow)row).getCTRow().getCArray();            assertEquals(0, cArray.length); */
//          Excel uses the stored text representation from the XML apparently, in tests done so far 
// @Ignore("Bug 59733 - shiftRows() causes org.apache.xmlbeans.impl.values.XmlValueDisconnectedException") 
//  disable all output for now...          Sheet sheet = wb.getSheetAt(0);           
//  Constructor arguments specify   the line widths for the strokes 
//  Create a value and check it 
//  add alpha channel 
//  How close the sizing should be, given that not all    systems will have quite the same fonts on them 
/*  Execute the get... methods.  */
// noinspection unchecked 
//  now try adding 1 property 
//  First in a nested message 
//  Copy over, and pop the child in at the end 
//  B is zero, so A is definitely greater than B 
//  POI currently doesn't render spaces in formulas 
//  "List" Data Validation type 
//  fields of subsequent META_ESCAPE_ENHANDED_METAFILE escape records. 
//  "registered" symbol 
//  Allowable column range for EXCEL2007 is (0..16383) or ('A'..'XDF') 
//  A string of 32 Unicode characters that defines the character set of the font.   If the length of this string is less than 32 characters, a terminating NULL MUST be present, 
//  Check our cached values were correctly evaluated 
//  the offset, i.e. starting address, of the byte where the bitmap data can be found 
//  this may happen when the master cell of a shared formula is changed 
//  The number of special quantifiers 
//  Ensure they match 
//  Good, we don't have 5 from 7 onwards 
//  Note - Excel does not seem to represent this condition with an error code 
//  Add every cell to its row 
//  calculate border fit 
//  AUTOMATIC is not add to list 
/*  Create a subordinate directory. The first step is to                     * ensure that the parent directory exists:  */
// persist reference 
//  True values: "true", "1", "on" 
//  A 32-bit signed integer that specifies the height in pixels of the area occupied by the bitmap. 
//  = 2007-06-21T09:59:00.123Z 
// assertEquals(0x030018D9, uea.getPPTVersion() ); 
/*  Start mark seems to be missing  */
//  Generate a unique new filename  
// BUG-61295 -- avoid OOM on corrupt file.  Build list instead  of allocating array of length "length".  If the length is corrupted and crazily big but < Integer.MAX_VALUE,  this will trigger a RuntimeException "Buffer overrun" in lei.checkPosition 
//  If it has a location, it's internal 
//  forecolor index   backcolor index 
//  4. Try to re-use patriarch later 
//  skip the first 512 bytes - they are MAC specific crap 
//  get the best-fit width of rows currently in the random access window 
//  otherwise temporarily write all subsequent data to a buffer 
//  if the row contains cells included in a multi-cell array formula 
//  Update our SlideAtomsSets with this 
//  column is unchanged if merged regions are ignored (Excel like behavior) 
//  There is a very odd xmlbeans bug when changing the row    arrays which can lead to corrupt pointer   This call seems to fix them again... See bug #50795  noinspection ResultOfMethodCallIgnored 
//  indentLevel is only valid for paragraph collection 
//  Now with one that triggers on NoteRecord 
//  Check core too 
//  Write something that uses a main stream 
// percentile has to be between 0 and 1 - here we test less than zero 
// else - just a plain string with no interpretation. 
// update formulas on the parent sheet 
// 		records.add(createEndRecord()); 
//  case CellType.STRING 
// Getting NAmed Range 
//  From a real file (embedded SWF control)   <ExOleObjStg info="16" type="4113" size="347" offset="4322" header="10 00 11 10 5B 01 00 00 ">.... 
//  Excel would probably have put tMissArg here 
//  Just slides, no notes 
//  so result does not have a minus sign 
//  Modified at has a -13 timezone but no milliseconds     2007-06-20T07:59:00-13:00 
// save extended and custom properties 
//  don't indent xml documents, the indent will cause errors in calculating the xml signature   because of different handling of linebreaks in Windows/Unix 
//  If it starts with [$-...], then could be a date, but 
//  Check it's really visio 
//  Test 
//  not a shared/array/table formula 
//  sprmCDispFldRMark -- 0xCA62 
//  is this row in the target-window where the moved rows will land? 
//  formula value cell 
// 211: LENB 
//  index number format record   11 bytes length 
//  no circ-ref-error because A1 result is cached 
//  Check that asking for the same font    multiple times gives you the same thing. 
//  don't parse the document parts, if its class can't be determined   or if it's a package relation of another embedded resource 
// Sanity checks 
//  Mark the fact that we've now loaded up the properties 
//  horizontal   vertical 
//      be converted to Unicode hex string representation 
// BUG-60343 
//  some cases require this close here 
//  clear whatever was there 
// sortTopLeftToBottomRight swapped firstRow and lastRow because firstRow is absolute 
//  end public class ShortField 
//  get our plex of PieceDescriptors 
//  Holds metadata on where things are in our document 
// ----------------   Note - From now on the demonstrated POI behaviour is not optimal  ---------------- 
//  span in order to be presented at the required size. 
//  check sheet-index with index out of bounds => throws exception 
//  Rich test file with Chinese + English text in it 
//  writing 8 byte values to a 9 byte buffer 
//         this.cell2 = calcCell(sheet, cell1, size.getCx(), size.getCy()); 
/*  Retrieve the section the property set already contains.  */
//  The x-coordinate of the ending vertex on an arc. 
//  store everything from end of last match to end of string 
//  Look at the low level xml elements 
//  This is an array of PhRuns (see page 881) 
//  check other borders 
// cells A3 and A4 don't contain hyperlinks anymore 
//  _lfoMac is the size of the array 
//  Insert a numbered multi-level list into cell A7. Note that the   same ArrayList as constructed for the plain multi-level list 
//  Write a very small new document, will populate the ministore for us 
//  There is no 4! 
//  SHOULD be set to the default (NULL) clip region. 
//  Relying on the fact that by default the cellType is set to 0 which   is different to {@link CellType#BLANK} hence the following method call correctly   creates a new blank cell. 
//  The delete was somewhere in the middle of us 
//  test variable length property 
//  deleting shared formula cell 
//  now treat same data as 3 columns, 4 rows 
//  The newline is lost for shared formulas 
/*  After adding a custom property the size must be 1 and it must be         * possible to extract the custom property from the map.  */
//  Find the cell at 0,0 
//  Check by index as well for sanity 
//  use this stream as a buffer for the levels since their size varies. 
//  End of row/cell records for the current sheet   Note - It is important that this code does not inadvertently add any sheet   records from a subsequent sheet.  For example, if SharedFormulaRecords   are taken from the wrong sheet, this could cause bug 44449. 
// reading sample xls 
//  create a corrupted zip file by truncating a valid zip file to the first 100 bytes 
//  A 32-bit unsigned integer that specifies the number of elements in the CompoundLineData field. 
// everything worked out.  Great! 
//  If we've run out of data, output anything that's 
//  rotate in the value range 1 to 7 
//  set up format records 
// 10 characters wide 
/*  A document summary information set stream by default does have custom properties.  */
//  A 32-bit unsigned integer that specifies the size of the DIB bits. 
//  Confirm this example really does have SharedFormulas. 
//  columns are ANDed   Whether the condition column matches a database column, if not it's a   special column that accepts formulas. 
//  read as many bytes as possible, up to the required number of bytes 
/*  Check whether a property with this name is in the map already.  */
//  and associated point types that are defined by this object. 
/*  Compare the sections:  */
//  DefaultRowHeightRecord.sid is next 
//  add overhead of broken strings 
//  secondly try the thread local default 
//  The external FunctionPtg is the last Ptg added to the stack   During formula evaluation, this Ptg pops off the the appropriate number of   arguments (getNumberOfOperands()) and pushes the result on the stack 
//         thickness++; 
//  Grab text from SlideListWithTexts entries 
//  remove summary, if previously available 
//  between each character's baseline and the x-axis of the device. 
//  Row 6 is blank / string formula / number / number / string formula 
//  should be assertSame, but a new HSSFCellStyle is returned for each getCellStyle() call.    HSSFCellStyle wraps an underlying style record, and the underlying 
//  e.g. src/examples/src/org/apache/poi/ss/examples/formula/mortgage-calculation.xls Sheet1!B4 
//  feb 
//  = 0; 
//  ftCmo.setObjectId(oleShape.getShapeId()); ... will be set by onCreate(...) 
//  operate: postSign 
//  324: ZTEST 
/*              * Transform the text using a scale so that it's height is increased by a multiple of the leading,             * and then rotate the text before computing the bounds. The scale results in some whitespace around             * the unrotated top and bottom of the text that normally wouldn't be present if unscaled, but             * is added by the standard Excel autosize.              */
//  Page 53 of public specification begins 
//  Check its children 
//  length   option   string 
//  level3, level2, level1 
//  look at all cell-ranges 
//  OOO calls this 'nFmlaLen' 
//  Should the column's width simply be expanded? 
//  verify TSP signer signature 
//  And the base file too 
//       {          TableCellDescriptor[] rgtc = newTAP.getRgtc();   
//  Second is 28 long, centre aligned and normal spacing 
//  skip the first child record, it is group descriptor 
//  Now begin processing the contents 
//  Is the name a valid R1C1 cell reference? 
//  else rules for adjusting area may also depend on the destination of the moved rows 
//  One row, most things are 0, physical is 1 
//  References to a .xlsx file 
/*  Check rule M1.7  */
//  No theme, has colours 
//  Iterations specifies the number of times the hashing function shall be iteratively run (using each 
//  Record the match between slide id and these notes 
//   say about possible slide IDs 
//  However the range A1:B4 also includes the current cell A4.  If the other parameters   were 4 and 1, this would represent a circular reference.  Prior to v3.2 POI would   'fully' evaluate ref arguments before invoking operators, which raised the possibility of   cycles / StackOverflowErrors. 
// we cannot remove rows with cells included in a multi-cell array formula 
//  Update the text length for its Paragraph and Character stylings   * reset the length, to the new string's length   * add on +1 if the last block 
// split to 3 records 
//  identical picture was already added to the SlideShow 
//  else source columns include none of the columns of the area ref   check for clashes with destination 
//  WINDOW2 should always be present, so shouldn't have got this far 
//         OutputStream out = new FileOutputStream("/tmp/testZoom.docx");          doc.write(out);          out.close(); 
//  actually continue a number record anyhow. 
//  Do we have a comment for this cell? 
//  ref is outside source columns   check for clashes with destination 
//  Ask for another block 
//  The image size must be 0 or greater   (0 is allowed, but odd, since we do wind on by the header each 
//   all the ptgs give back the right things 
// do nothing 
/*          * BoundingBox (8 bytes):  The destination rectangle, measured in logical units, for displaying         * the metafile. The size of a logical unit is specified by the Inch field.          */
//   in any of the BATs, so we need another BAT 
//  Add a slide 
//  Check direct 
//  Loop over all the cells in the file, and identify any user defined 
//  Try to add comments to Sheet 1 
//  property has no children 
//  A is 2006-01-24 (2nd day of week) 10:26:15.205 
//  Now write out to a byte array 
//  A 32-bit unsigned integer that specifies the first scan line in the array. 
//  XSSFWorkbooks store formula names as strings. 
//  Now make it a single cell 
//  read <sheet name="Sheet6" sheetId="4" r:id="rId6"/>   and add XSSFSheetRef(id="rId6", name="Sheet6") to sheetRefs 
//  variables for use in other methods. 
//  00 00 
//  This formula SHOULD also be used to calculate the size of aData when DIBHeaderInfo is a   BitmapInfoHeader Object, using values from that object, but only if its Compression value is   BI_RGB, BI_BITFIELDS, or BI_CMYK.   Otherwise, the size of aData MUST be the BitmapInfoHeader Object value ImageSize. 
//  The value for this should be 4 
//  get the best fit width of rows already flushed to disk 
//  note - can't exit loops upon finding null because of potential previous deletes 
//  Plain Text - Stream 
//  Write and read it 
// 			Range range = daDoc.getRange();  			Section section = range.getSection(0);  			Paragraph para = section.getParagraph(2);  			String text = para.getCharacterRun(0).text() + para.getCharacterRun(1).text() +  			para.getCharacterRun(2).text();   
//  this is a three byte int so it has to be handled special 
//  Size is 20+user len + revision len(4) 
//  Acquire the final level resource. If this is acquired successfully, the zip package was read successfully from the input stream 
//  Pass-through methods 
//  Something's up with turning the text pieces into paragraphs   Fall back to ripping out the text pieces 
//  Check each in turn 
//  Grab where the data lives 
//  Get each font record, so we can do deletes 
//  NOTE: Creating the footnote does not automatically         create a first paragraph. 
//  check for unsupported characters and add a fallback font for these 
//  If no more 13s and 14s, just zap 
//  Doesn't have any slides 
//  Find the entry, and get an input stream for it 
//  each 4th century is a leap year 
// file_opts  address length 
//  display horizontal scrollbar 
//  usually we deal with length units and only very few degree units: 
//  Values (1 byte):  An 8-bit unsigned integer that defines how the palette entry is to be used.   The Values field MUST be 0x00 or one of the values in the PaletteEntryFlag Enumeration table. 
// MATH-996/POI-55419 
//  Vertical aligned special case 
//  (GREEN + RED + BLUE + CORAL) + YELLOW(2*2) 
//  takes a long time... 
//  A4 is string and not counted   A5 is blank and not counted 
//  call our own read 
//   (Unknown/Custom) 32955 -> Wed Dec 15 2010 @ 14:46:31 UTC 
//  remove existing background 
//  set a higher max allocation limit as some test-files require more 
//  set the values for one row 
//  can ignore, rest of tokens for this expression are in OK RPN order 
//  Formats 
//  conditional formatting 
// left 
//  change the password on the first sheet 
//  typically goes after the Country record 
//  for old word files we should still support extracting text 
//  write once more 
//         assertEquals(IndexedColors.LIGHT_CORNFLOWER_BLUE.index, fmt4.getFillBackgroundColor()); 
//  also adjust order of Records, calculate the position of the Boundsheets via getBspos()... 
//  side of the rectangle to attach the connector: left=1, bottom=2,right=3, top=4 
//  check with string operand 
//  Open the file up 
// everything except id and DgRecord.lastMSOSPID and DgRecord.Instance must be the same 
// continue the for-loop 
//  And grab the 4 byte values 
//  pred '' matches both blank cell but not empty string 
/* RANDOM */
//  Excel 2013 behavior: ??? 
/*          * lfoMac (4 bytes): An unsigned integer that specifies the count of         * elements in both the rgLfo and rgLfoData arrays. -- Page 424 of 621.         * [MS-DOC] -- v20110315 Word (.doc) Binary File Format          */
//  Now get the index by the sheet, not the name 
//  Save content in the specified output stream 
//  Get a reference to a sheet and check to see if it contains   any rows. 
//  bug 57840 
//  Saving relationship part 
//  Ask again, will still get 181 as not written to 
//  Make sure both hyperlinks were added to the sheet 
//  throw more useful exceptions for known wrong file-extensions 
//  remove all runs 
//  Check that it is seen correctly 
//  These are slides 1+2 -> 256+257 
//  test illegal offsets and lengths 
/*  WriteProtectRecord wprotect = */
//  Next is an internal doc link 
/*          * plcffndRef (footnote reference position table) Written immediately         * after the stsh if the document contains footnotes         *          * plcffndTxt (footnote text position table) Written immediately after         * the plcffndRef if the document contains footnotes         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 24 of 210          */
//  Performance optimization: explicit boxing is slightly faster than auto-unboxing, though may use more memory   NOSONAR   NOSONAR 
//  key not found. 
//  skip it 
//  TransformMatrix field. 
//  rounding propagation 
//  Check it isn't already taken 
//  application/vnd.ms-tnef 
//  NumberOfEntries (2 bytes):  A 16-bit unsigned integer that defines the number of objects in   aPaletteEntries. 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#getValidationType()	  */
//  Construct an HSSFCellStyle and set it's data formt to use the 
// newCell.getCellStyle().cloneStyleFrom(cellStyle); 
//             assertEquals("MOD(ROW($T2),2)=1", cr.getFormula1());          }          assertEquals(null, cr.getFormula2()); 
//  Check OPC compliance rule M4.1 
// create summary sheet 
/*          * The PlfLfo structure contains the list format override data for the         * document. -- Page 424 of 621. [MS-DOC] -- v20110315 Word (.doc)         * Binary File Format          */
//  private final IBody part;   private final XWPFDocument document;   private List<XWPFParagraph> paragraphs = new ArrayList<>();   private List<XWPFTable> tables = new ArrayList<>();   private List<XWPFRun> runs = new ArrayList<>();   private List<XWPFSDT> contentControls = new ArrayList<>(); 
//  Row 17 has a single string in D17 
//  first try with our default image renderer 
//  Check it's one of ours 
//  X=shift, Y=balance 
//  Make sure unaffected rows are not shifted 
//  page 11, point 2.1.2 
//  Have this Java date turned back into an Excel one 
//  can this particular case be verified? 
//  Grab our 4x pre-data 
//  test STOP 
//  use x-scaling for both, reposition y accordingly 
//  avoid infinite iteration 
//  Ensure it really is a slide record 
// average 2 args per function 
//  level one, id 36871, type 6 
//  We ran out of places to put digits before we ran out of digits; put this aside so we can add it later   pos was decremented at the end of the loop above when the iterator was at its end 
//  do nothing for Sheet base class. This will be overridden for SXSSFSheets. 
/*  No, the current document is not a property set stream. We                     * copy it unmodified to the destination POIFS.  */
//  Now, build up TextRuns from pairs of TextHeaderAtom and   one of TextBytesAtom or TextCharsAtom, found inside   EscherTextboxWrapper's in the PPDrawing 
//  remove first 22 bytes if file starts with magic bytes D7-CD-C6-9A   see also http://de.wikipedia.org/wiki/Windows_Metafile#Hinweise_zur_WMF-Spezifikation 
//  Should be the 1st one 
//  first check if Unsafe has the right method, otherwise we can 
//  ObjRecord.sid, size=70   ftCmo 
// check number of cols 
//  skip reserved1/2 fields 
/*          * Property to disable text rebuilding. In this mode changing the text         * will lead to unpredictable behavior          */
//     fail("Best fit width time per cell exceeded 50000 ns: " + bestFitWidthTimePerCell_ns + " ns");  } 
//  Walk on down for the case of container records 
//  else: ignore the character 
//  line spacing 80 
//  destination rows are completely outside area ref 
//  Should only have a master SLWT 
//  object data needs to be initialized 
//  Append new child to the end 
/* int usKeyValue =  */
//  check 1900 and 1904 date windowing conversions 
//  Document - late version 
//  Check cached values 
//  Generic filename in all cases 
//  Zap the target file, in case of an earlier run 
//  in the unit-test just try to write out the file more than once and see if we can still parse it 
//  Nothing in rawCode before, so this byte    isn't in the buffer dictionary   Output it un-compressed 
//   MAPI property, grab the details of it 
/*  check/create default entries - for bug54803  */
//  Given the width of the image, what should be it's co-ordinate? 
//  bug 60246: validate name does not allow DOT in named ranges 
//  simple shape 
//  options   record id   remaining bytes   options   record id   remaining bytes 
// if this byte here == 7, it _may_ signify existence of  an altername font name 
//  Add a default set of thresholds 
//  just outside 'subnormal' range 
//  this listener wasn't already listening for this   document -- add the listener to the set of   listeners for this document 
//  this one moved 
//  But the evaluator knows the sheet, so it 
//  only numbers are counted 
//  Is it already in numeric form? 
//  the references appear in the package signature or the package object   so we can use the default digest algorithm 
//  declare doubles for values 
//  x (2 bytes): A 16-bit signed integer that defines the horizontal (x) coordinate of the point. 
//  PowerPoint rotates shapes relative to the geometric center 
//  We need to invoke this even if text from this piece is not being   deleted because the adjustment must propagate to all subsequent   text pieces i.e., if text from tp[n] is being deleted, then   tp[n + 1], tp[n + 2], etc. will need to be adjusted.   The superclass is expected to use a separate sentry for this. 
//  info fields as indicated by the mask.   -1 means the bit is not set 
//  check and change row of location 
//  Set Row Color : Blue 
/* 	  18, 00,	  1B, 00,	  20, 00,	  00,	  01,	  0B, 00,	  00,	  00,	  00,	  00,	  00,	  07,	  3B 00 00 07 00 07 00 00 00 FF 00 ]	  */
// If sheet Id  is omitted, it is assumed to be the same as the value of the previous cell. 
// build a tree of POIXMLDocumentParts, this document being the root 
//  Wrap and store 
//  3D refs 
//  And the next block 
//  parse column quantifier 
//  expand:   colapsed bit must be unset   hidden bit gets unset _if_ surrounding groups are expanded you can determine     this by looking at the hidden bit of the enclosing group.  You will have     to look at the start and the end of the current group to determine which     is the enclosing group 
//   Minimum and Maximum RGB values are used in the HSL calculations 
//  no 45 ?! 
//  the stroke applies both to the shadow and the shape 
//  all plain records have been already added,   only new records need to be decrypted (tbd #35897) 
//  null does work 
//  initialized to zeros by JVM 
//  If it has children, show them 
//  we've found a full match! 
//  wingdings doesn't contain high-surrogates, so chars are ok 
//  Try to parse it as a name 
//  Change slightly, and re-test 
//  MUST be concatenated to represent the entire embedded EMF file. 
//  Won't have preserve 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getShowErrorBox()      */
//  workbook not encrypted (typical case) 
//  Custom Icon+Format - Column T 
//  Will have fat then properties stream 
/*  char 8   */
//  the VerifierHashSize field, which MUST be 20 
//  refresh the slides 
//  Pop structure into Structure HSSFSheet 
//  YK: don't know why, but XmlBeans converts leading tab characters to spaces 
//  changing B1, so A1 cached result should be cleared 
//  NOTE it's ok to create any other row. 
//  Tell parent aware records of their parent 
//  331: TRIMMEAN   332: TINV 
//  Free the memory 
//  fall through, read embedded blip now 
/*          * Reserved (4 bytes):  A field that is not used and MUST be set to 0x00000000.          */
//  first find any external book block that contains the name: 
//  page 12, point 2.1.3 
//  touch empty marker file 
// character styles 
//  Adding specific types if any exist 
//  strings are extended character strings 
//  300 - 7.2 - 7.2 - 36 
//  assertEquals("FirstSheet!$A:$A,FirstSheet!$1:$3", nr1.getRefersToFormula()); 
// set custom width for D-F 
//  Update our cached copy of the bytes that make up the PPT stream 
// noinspection ObjectEqualsNull 
//  Show the bug - evaluate another cell from the loop first 
//  Check the stream store 
//  In FS order initially 
//  marshal XAdES-X-L 
//  The byte order of the result shall be reversed [password "Example": 0x64CEED7E becomes 7EEDCE64],   and that value shall be hashed as defined by the attribute values. 
//  Set the table style. If the style is not defined, the table style 
//  In case B, there are 5 different stylings 
//  verify behavior of isDirectoryEntry 
//  We are a container record 
//  No opt record, can't have chart 
//  Create the cache if needed 
//  4 missing args, C5 is blank  
//  A1:E1 should be removed   A2:C2 will be A1:C1 
//  1-based index of a shadow style within the style matrix 
/*          * Note - to observe behaviour without caching, disable the call to         * updateValue() from FormulaCellCacheEntry.updateFormulaResult().          */
/*  Write:  */
/* procedure Assignment;var Name: string[8];begin   Name := GetName;   Match('=');   Expression;end;     * */
//  Value for OptionalRating is declared optional (minOccurs=0) in 55864.xlsx 
//  If there were gaps, output the missing rows 
//  but we at least have unit-tests which will indicate this when run on Windows 
//  Find the number deleted to that    point, and adjust 
//  Excel silently truncates double values to integers 
//  These are all subtypes of Filter, we think... 
//  nothing in common: at most they could be adjacent to each other and thus form a single bigger area   
// rotated text 
// !! We don't do this for real, we just put in 3 of them 
//  PowerPoint Document - OpenXML file format 
//  Main unchanged, ministore has a second 
//  Colours Red->Yellow->Green - Column F 
//  A part of a specification 
//  (4) In the output, remove the sign if it should not be shown or set it to 
// expected 
//  are all other characters valid? 
//  If Size is zero, this field MUST be zero bytes in length. If Size is   nonzero and the CodePage property set's CodePage property has the value CP_WINUNICODE   (0x04B0), then the value MUST be a null-terminated array of 16-bit Unicode characters,   followed by zero padding to a multiple of 4 bytes. If Size is nonzero and the property set's   CodePage property has any other value, it MUST be a null-terminated array of 8-bit characters   from the code page identified by the CodePage property, followed by zero padding to a   multiple of 4 bytes. The string represented by this field MAY contain embedded or additional   trailing null characters and an OLEPS implementation MUST be able to handle such strings. 
//  wrap the stream in a FilterInputStream to close the POIFSFileSystem   as well when the resulting OPCPackage is closed 
//  name is taken => try next one 
//   Formula needs all values between 0 - 1. 
/*  Excel V14 / 2010 - document  */
//  Will be 0 if no drawing objects in document 
//  bar space 
//  First we need to parse the content type part 
//  Generate a unique ID is id parameter is null. 
//  A Sprm is at least 2 bytes long 
//  Don't getChar() as the space has already been eaten and recorded by SkipWhite(). 
//  Create a memory part 
//  avoid OOM in Gump run 
//  private final static int TABLE_STYLE = 3;   private final static int NUMBERING_STYLE = 4; 
//  colour   pattern 
//  Grab the first bytes of this stream 
//   are compressed or un-compressed 
//  Re-fetch the pictures and check 
//  also acceptable: Table1!B1 
//  Will get ids 7, 8 and 9, as we already have 1-6 
/*              * create a new cursor, that points to the START token of the just             * inserted paragraph              */
//  notably cell refs and area refs 
//  SYSTEM_FONT - A font that is guaranteed to be available in the operating system 
//  nothing found   normal case 
//  Returns -1 if no column is found for the given index 
//  Work our way through all the codes until we    find the right one. Visio starts from the end 
//  Check for corrupt / lying ones 
//  Condition 2: Row is even, blue 
//  add tests for direct setting 
//  A 32-bit unsigned integer that specifies the number of points and associated point types that 
//  ignore some other ways of corrupted files 
//  create a row and put some cells in it 
//  end = overflow.get(0).getStart() + fcMin; 
//  12th digit 
//  Turn on comment extraction, will then be 
//  Check the core properties - will be found but empty, due    to the expansion being too much to be considered valid 
//  In the integer part, commas at the end are scaling commas; other commas mean to show thousand-grouping commas 
//  if the removed slide had notes - remove references to them too 
//  bug 60003 
//  start with height - offset, then keep adding row heights until the next one puts us over h 
//  first dry-run to calculate the total height of the text 
/* 	 * (non-Javadoc)	 * 	 * @see	 * org.apache.poi.ss.usermodel.DataValidationHelper#createDateConstraint	 * (int, java.lang.String, java.lang.String, java.lang.String)	  */
//  mask is 0x1000   line spacing 80 
//  If the BOF record was just serialized then add the IndexRecord 
//  transposed version of TestXSSFSheetShiftRows.testBug54524() 
//  parsed any options, expect exactly one remaining arg (filename) 
/*  Read the origin POIFS using the eventing API. The real work is done         * in the class ModifySICopyTheRest which is registered here as a         * POIFSReader.  */
/*  --------------------------------------------------------------------------  */
//  Initialization required in order to make the document readable by MSExcel 
//  need to tell all cells that were previously used, but no longer are,    that they are not consumed by this cell any more 
//  defaults 
/*  Value Containter  */
/* box10to20c  */
//  simple error propagation: 
//  Try one for java 1.4 
//  "Name is too long" when setting username   "Buffer overrun" 
//  Step through each of the files in the source folder and for each   open the workbook, convert it's contents to CSV format and then   save the resulting file away into the folder specified by the   contents of the destination variable. Note that the name of the   csv file will be created by taking the name of the Excel file,   removing the extension and replacing it with .csv. Note that there   is one drawback with this approach; if the folder holding the files   contains two workbooks whose names match but one is a binary file   (.xls) and the other a SpreadsheetML file (.xlsx), then the names   for both CSV files will be identical and one CSV file will, 
//  test handling if some presets are not found 
//  2 level recursion 
//  c => cell 
//  a continuation record with 3 bytes of data 
//  No Calibri 
//  Now check the low level stuff, and check that's all    been set correctly 
// TXO (and 2 trailing CONTINUE records) 
//  now we have an additional 8208 bytes, which is an exact 
//  Check we can write it out and read it back as-is 
//  check to see if we have enough room for an FC, the grpprl offset, 
//  Reset to a fresh run so we test case of run not having vertical alignment at all 
//  Sanity Checking - we're always 12 bytes long 
//  by default, line break has the font properties of the last text run 
//  However, the ministore data only covers blocks to 183 
//  One hyperlink is a real one, one is just to the top of page 
// serialize and verify that the serialized data is the same as the original 
//  verify the values to ensure future changes keep the returned information equal 
//  ignore empty polys and dummy start point (moveTo) 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getShowErrorBox()	  */
//  Third is 25 long, right aligned and normal spacing 
//  the invariant part of this record. 
//  Create a new document - ignoring the order of the old entries 
//  2.3.3 EncryptionVerifier ...   An array of bytes that contains the encrypted form of the    hash of the randomly generated Verifier value. The length of the array MUST be the size of    the encryption block size multiplied by the number of blocks needed to encrypt the hash of the    Verifier. If the encryption algorithm is RC4, the length MUST be 20 bytes. If the encryption    algorithm is AES, the length MUST be 32 bytes. After decrypting the EncryptedVerifierHash   field, only the first VerifierHashSize bytes MUST be used. 
//  Check without comments 
//   from all of IF check, True and False are V 
//  create password record 
//  SET Verifier TO 0x0000 
// 0x0fa1 RT_StyleTextPropAtom 
//  Check that the CurrentUserAtom points to the right UserEditAtom 
//  the font, such as bold and italic. This value MUST be composed of FontStyle flags 
// Create workbook and worksheet 
//  Evaluation order:   arg0 lookup_value, arg1 table_array, arg3 range_lookup, find lookup value, arg2 row_index, fetch result 
//  chart legend has no (indirect) paragraph properties 
// fall through! 
//  Text should be sheet based 
//  the dimensions for this image are different than for XSSF and SXSSF 
//  create a pivot table on a different sheet, case insensitive 
//  see Bugzilla 51187 
// Only allow column resizing if editing is allowed 
//  one specific message is expected 
//  Check it before save 
//  https://support.office.com/en-us/article/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3 
// name sales_1 refers to Commission(Sheet0!$A$1) 
//  Save and re-load, and check still there 
//  to preserve order. 
//  rounding mode is half-up 
//  structured format 
//  Note, if the row does not already exist on the sheet then create   it here. 
//  Get the index for this font, if it is not to be removed (typeface == null) 
// "(#,##0_);[Red](#,##0)" 
// only shift if the region outside the shifted rows is not merged too 
//  A 32-bit signed integer that specifies the angle, in tenths of degrees,   between the escapement vector and the x-axis of the device. The escapement vector is   parallel to the baseline of a row of text.     When the graphics mode is set to GM_ADVANCED, the escapement angle of the string can 
//  Internal target   If it isn't absolute, resolve it relative 
//  compute and cache them 
//  options byte present always (even if no character data) 
//  enough space in current record, so just read it out 
//  see http://stackoverflow.com/questions/4436397/3des-des-encryption-using-the-jce-generating-an-acceptable-key 
//  evaluate third arg and convert from 1-based to 0-based index 
// DOCUMENTARE MEGLIO IL DISCORSO DEL LIVELLO 
//  hyperlink is internal and is not related to other parts 
//  abort: close the zip input stream 
// adding the same font twice 
//  is this window is hidden 
//  0x7FFF0000 is the maximum for 32-bit zips, but less still works 
//  15 chars at end of current record 
//  Check the initial order 
//  Set a new default row height in twips and test getting the value in points 
//  Now via MAPIMessage 
//  Shift 3 to front 
// 		assertEquals(trB.getRawText().substring(0, 30), rtrB.getRawText()); 
//  Now turn on stripping 
//  First up, do we have any spare ones? 
//  Read a fifth of it, and check all's correct 
//  removing the password again 
// set the print area for the first sheet 
//  The library implementation returns 0 for an input sequence like [1, 0]. So this check is necessary. 
// two rows, one column 
//  show error box 
//  value didn't change 
//  note - does match blank 
// If the leftmost bit is 0 -- number is positive. 
//  literal list, using array constructor 
//  this should not match the criteria '<>aa'   this should match 
// 				} 
//  Now try a few built-in non date formats 
// import org.checkerframework.checker.nullness.qual.NonNull; 
// //////////////// Visio 
//  small hack to try to make this test stable, previously it failed whenever the two written ZIP files had different file-creation   dates stored.   We try to do a loop until the current second changes in order to avoid problems with some date information that is written to the ZIP and thus   causes differences 
//  This is a RPHSSub (see page 894) 
// github-55 
//  Test weird variants 
//  to another chunk which holds the data itself 
/*      * Creates a {@link ClassID} from a human-readable representation of the Class ID in standard      * format {@code "{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}"}.     *      * @param externalForm representation of the Class ID represented by this object.      */
//  Should throw exception about invalid POIFSFileSystem 
//  An 8-bit unsigned integer that specifies the weight of the font. 
//  Check the whole text 
//  end public interface LittleEndianConsts 
//  rebuild top level message from embedded message 
//  non-Javadoc: When possible, code should be implemented in the ColumnShifter abstract class to avoid duplication with   {@link org.apache.poi.xssf.usermodel.helpers.XSSFColumnShifter} 
//  Handle the PlcfHdd 
//  sprmCLidBi  
//  Second is 28 long, blue and italic 
/*  ********** START extension of Property **********  */
//  update the FIB.CCPText field (this should happen once per adjustment,   so we don't want it in   adjustForInsert() or it would get updated multiple times if the range   has a parent)   without this, OpenOffice.org (v. 2.2.x) does not see all the text in   the document 
//  First 16 bytes is header stuff 
/*  Read back:  */
//  check for empty placeholder value 
//  less optimal, but should work OK just the same. Often occurs in junit tests. 
//  Word format only 4 bytes 
//  Each cell width is 3120 in 1440ths of an inch, or 1/3rd of 6.5" 
//  the document 
// test header 
//  encrypt last record 
//  first evaluation call when ouput is desired, so iit. this evaluator instance 
//  Has one section 
//  Now do another complex file 
//  write an unencrypted workbook to disk, but any temporary files are encrypted 
//  Set the cells contents and style. 
//  MAX to one cell over 3 workbooks, absolute row reference 
/*  CTLineProperties ln =  */
// Last row of the hyperlink  First column of the hyperlink 
//  Should be able to close a document multiple times, though subsequent closes will have no effect. 
// right 
//  level 2: body placeholder on the master slide 
//  Update cell and row counts as needed 
//  If there's a trailer, there's a separator 
//  Calculations!B1 
// URL 
//  Set when a header/footer element is seen 
/*          * plcfendRef (endnote reference position table) Written immediately         * after the previously recorded table if the document contains endnotes         *          * plcfendTxt (endnote text position table) Written immediately after         * the plcfendRef if the document contains endnotes         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 24 of 210          */
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getConstraint()	  */
//  Now check the spreadsheet itself 
//  Color is an sRGB value specified by red, green, and blue fields. 
//  second x   second y 
//  x is text that is not a number 
//  Pad with the default Alpha 
//  set model 
//  Excel 
// cchFile (2 bytes) 
//  Check things match on text length 
//  or control of the bit patterns used to encode NaNs in evaluations. 
// @Ignore("bug 56454: Incorrectly handles merged regions that do not contain column 0") 
//  Should have a style defined for each type 
//  Check the default styles 
//  Note that the length doesn't include the 8 byte atom header 
//  bug 60685: fall back so that the rest of the document can be read 
//  in units of .05 of a point 
//  Set Column Color : Red 
//  if size is uneven we will have to add one so the first grpprl 
//  percent of a bracketed expression 
//  contents of brackets not numeric 
//  482 == 0x01E2; 490 == 0x01E6 
//  Check that the UserEditAtom's point to right stuff 
//  Set number, x and y 
//  it doesn't have any styles 
//  re-read the saved file and make sure headers in the xml are in the original order 
//  this can be found and means nothing 
//  Manually check the output file with Excel to see if the diagonal border is present  OutputStream fos = new FileOutputStream("/tmp/53564.xls");  wb.write(fos); 
//  London vs Copenhagen, should differ by an hour 
//  Check we still have comments where we should do 
// //// Case 11: Evaluate "Table1[[#Totals],[col]]" //////// 
//  m11 (scaleY) = eM22 (Vertical scaling component) 
//  font.color only 
//  Grab a new copy of slideshow C 
//  see test file DataValidationEvaluations.xlsx 
//  The size and format of this data is determined by information in the DIBHeaderInfo field. If   it is a BitmapCoreHeader, the size in bytes MUST be calculated as follows: 
// Set a unicode footer 
//  request processing 
//  Are HSSFHyperlink.label and XSSFHyperlink.tooltip the same? If so, perhaps one of these needs renamed for a consistent Hyperlink interface   assertEquals("label", xlink.getTooltip()); 
//  create with default name 
/* 	 * Gets the stream ID containing the actual data.  The data itself	 * can be found under a top-level directory entry in the OLE2 filesystem	 * under the name "MBD<var>xxxxxxxx</var>" where <var>xxxxxxxx</var> is	 * this ID converted into hex (in big endian order, funnily enough.)	 *	 * @return the data stream ID. Possibly <code>null</code>	  */
//  flags 'volatile' and 'space', can be combined.   OOO spec says other combinations are theoretically possible but not likely to occur. 
//  sprmPDxaRight -- 0x845d 
//  Try with a cell reference 
//  0x12 Unused   0x13 GKPIDDSI_SHAREDDOC - Must be False   0x14 GKPIDDSI_LINKBASE - Must not be written   0x15 GKPIDDSI_HLINKS - Must not be written 
//  Check the structure matches 
//  array arguments must be evaluated relative to the function defining range 
//  From a real file 
//  --- src/java/org/apache/poi/poifs/crypt/ChunkedCipherOutputStream.java  (revision 1766745)   +++ src/java/org/apache/poi/poifs/crypt/ChunkedCipherOutputStream.java  (working copy)   @@ -208,6 +208,13 @@        protected int invokeCipher(int posInChunk, boolean doFinal) throws GeneralSecurityException {            byte plain[] = (_plainByteFlags.isEmpty()) ? null : _chunk.clone();     
// copied from XWPFDocument...should centralize this code  to avoid duplication 
//  autofit layout, and this requires fixed layout 
//  the main-method sets these properties, we need to revert them here to not affect other tests 
//  third char run is 16 long 
//  check the text length after deletion 
//  Code adapted from Xalan's org.apache.xml.utils.PrefixResolverDefault.getNamespaceForPrefix() 
//  see office open xml part 4 - 5.1.2.2.30 and 5.1.2.2.32 
//  This is really odd, but excel still sometimes    outputs a file like this all the same 
//  bar border color different from fill 
//  mask is 0x020001   char flags 0x0001 = bold 
//  write out the revision mark authors table. 
//  Move comments from the source row to the    destination row. Note that comments can    exist for cells which are null   If the row shift would shift the comments off the sheet   (above the first row or below the last row), this code will shift the   comments to the first or last row, rather than moving them out of 
//         assertEquals(IndexedColors.RED.index, fmt2.getFontColorIndex()); 
//  determine the size needed for the upxs. They always fall on word 
//  Reserved (18 bytes): This field MUST be ignored. 
//  Write the file out 
//  Style records always follow after    the ExtendedFormat records 
// //// Case 14: Evaluate "Table1[[#Headers],[col1]:[col2]]" //////// 
//  blue   third char run is 16 long 
//  First thing to do is update the raw bytes of the contents, based    on the properties 
//         out = new FileOutputStream(new File(tmpDirName, "out.xls"));          wb.write(out);          out.close(); 
//  Update the atom header 
//  this allows to trigger a heap-dump at this point to see which memory is still allocated  HeapDump.dumpHeap("/tmp/poi.hprof", false); 
// boolean value 
//  These should reference themes 2 and 3 
//  3. new index is lower than old one => sheets get moved up 
//  end option bitfields 
//  (For more information, consult the Windows API Programmer's reference ) 
//  Cell show "2016年12月" 
//  Sometimes escaped 
//  0" "?/?;?/?     - length of -ve part was used   0 "#"\#\#?/? - length of text was used 
//  if there's a reference to the placeholder color,   stop evaluating further and let the caller select   the next style inheritance level 
//  Now process the various entries 
//  Get the sheet to be removed 
//  Note: If date2day==31, it STAYS 31 if date1day < 30.   Special fixes for February: 
//  width; a point on the arc. 
// if the denom is 0, fall back to the default: tmpExact=100 
//  Note - two different spellings depending on version used...! 
//  no contents: cell.setCellValue("sometext"); 
//  Check with a file that has no headers 
//  7 bytes of data (stored as an int, short and byte here) 
//  write out and read back in to trigger some more validation 
//  Is it an allowed substitution? 
//  Update our comment, if there is one 
/*      * Accessors      */
//  The y-coordinate of the ending vertex of a polyline. 
/*  CacheAreaEval is only temporary value representation, does not equal sheet selection                 * so any attempts going beyond the selection results in BlankEval                  */
//  Findbugs: URF_UNREAD_FIELD. Do not delete without understanding how this class works.  private XSSFSheet xssfSheet; 
//  But if we write out with nodes preserved, will be there 
//  Requested spacers with "_" are replaced by a single space.   Full-column-width padding "*" are removed.   Not processing fractions at this time. Replace ? with space.   This matches CSV output. 
//  And the same on the temp file 
//  create a path, rotate it about its center 
//  basic numbers 
//  auto 
/* c2 = */
//  a couple of digits more accuracy than strictly required 
//  y 
//  date formatted as 'm'   'mmm' is wider than 'm'   date formatted as 'mmm'   'mmm/dd/yyyy' is wider than 'mmm'   date formatted as 'mmm/dd/yyyy'   date formula formatted as 'mmm' 
// one row down and one cell right 
//  Same, no change 
//  Extend if needed 
//  Step through the elements of the ArrayList that was used to hold   all of the data recovered from the Excel workbooks' sheets, rows   and cells. 
// mask 
//  http://mirrors.apple2.org.za/apple.cabi.net/Graphics/PICT.and_QT.INFO/PICT.file.format.TI.txt 
//  we currently only populate the dimension during writing out 
//  no next already 
// string is expressed directly in the cell definition instead of implementing the shared string table. 
//  cell records 
//  multiplying zero by any negative quantity yields minus zero 
//  test fixed length property 
//  cell can be potentially empty ... 
//  Message should have 54 
//  Nothing special about this ID   So, do the usual thing which is by type 
// group shape  group shape 
//  bug 57721 
/* 		// Encode it again using our engine		byte[] comp = lzw.compress(new ByteArrayInputStream(testTrailerDecomp));		// Check it's of the right size		assertEquals(339, comp.length); */
//  text file isn't 
// sheet name with spaces 
//  Get raw contents from a known file 
//  string to boolean 
//  A 32-bit unsigned integer that specifies the way to use the path.   The value MUST be in the RegionMode enumeration 
//  Write the main data out 
//  Now, a slightly longer file with numeric formulas 
//  x 
//  Now grab all the SLWTs 
//  or (byte) -91 (which is 165 - 256) 
//  Check they all agree 
//  Check "-", ".", "_", "~" 
//  Special cases based on the ID 
//  Second format part ('0.000') is used for negative numbers 
//  Attachment/Recipient counter. 
//  Icons : 4 traffic lights - Column K 
//  this part is different for HSSF and XSSF 
//  int charStartAt = translator.getCharIndex( bytesStartAt );   int charEndAt = translator.getCharIndex( bytesEndAt, charStartAt   ); 
//  if so do we have storage at getHugeGrpprlOffset()   int hugeGrpprlOffset = papx.getHugeGrpprlOffset(); 
//  Normal case. Length is in characters 
//  fall-through 
//  Create row if it does not exist. 
//  same for LocalDateTime 
//  First cell should have one paragraph 
//  ignore password protected files 
//  Check it's now the same as a 
//  Save it to a different file 
//  Save, re-open, ensure it's all still there 
// <-- FAILS EVALUATION 
//  Get the right core record 
//  as there were no paragraphs yet, initialize the text body 
//  Adding Comment to cloned Sheet 3 
//  Mark it as being a Data Bar 
//  compare aggregate.serialize() with raw bytes from the record stream 
//  evaluate formulas and re-autosize 
//  row major order 
//  IF(TRUE,D2:D5,D2) or  OFFSET(D2:D5,0,0) would work too 
// using absolute references because they don't get copied and pasted anyway 
// derive this from the font information! 
//  Ignore, just means it didn't contain    a format we support as yet 
//  removing an already empty cell just falls through 
//  Sheets 3 and 5 now 
//  cap and the fill of the arrow cap. 
//  xmlns="http://schemas.openxmlformats.org/package/2006/relationships"> 
//  further confirmation that B2 was not cleared due to changing D1 above 
//  Inline string <is><t>...</t></is> pair 
//  Create the references 
//  URL Moniker 
//  Do we have any embedded pictures? 
//  now create a custom format with Pound (\u00a3) 
//  Try to evaluate without references, won't work 
//  clone sheet corrupts it 
//  Condition 1: Row divides by 10, red (will beat #1) 
//  Pivot Table Additional Info 
//     {        tabMap.put(Integer.valueOf(tabPositions[x]), Byte.valueOf(tabDescriptors[x]));      }   
//  there was a problem in the code which locates the existing print titles name record 
//  to adjust index after deletion 
// size must == 2  number of modules 
//  the last record before the drawing block 
//  Add two more styles 
//  A1:A5 should be moved to B1:B5 
//  2 missing args, C5 is blank  
//  Fetch the 2 byte value, that is safe to ignore for some types of text 
//  nothing to update 
//  "ABCD" 
// try a string cell 
/*  A 16-bit unsigned integer that specifies the version number of the system. This MUST be 0x0300.  */
//  middle knots/control points 
//  SP @ 14   SP @ 20 
//  ConversationTopic = Test 
//  Should we do anything special with these non    Container records? 
//  HSSFDataFormatter to do the work for us 
//   18 00 
//  lastPrinted 
//  Should have version, codepage, class and MAPI 
//   use this to grab the revision 
//  rounding 
//  Sorting Options   .WK? File Conversion Information  Standard Column Width   Window Zoom Magnification   Scenario Output Data 
//  fib.setCcpText(fib.getCcpText() + adjustment);   }   
// set up workbook 
//  Get the header 
//  Load in again and re-test 
//  Get the row's height in millimetres 
//  Don't cache a circular ref error result if this cell is not the top evaluated cell.   A true circular ref error will propagate all the way around the loop.  However, it's   possible to have parts of the formula tree (/ parts of the loop) to evaluate to   CIRCULAR_REF_ERROR, and that value not get used in the final cell result (see the   unit tests for a simple example). Thus, the only CIRCULAR_REF_ERROR result that can   safely be cached is that of the top evaluated cell. 
//  implicitly track the columns 
// Configure the pivot table 
//  31.03.2013 01:59:00,000   31.03.2013 02:00:00,000 (this time does not exist in TZ CET, but EXCEL does not care)   31.03.2013 02:01:00,000   31.03.2013 02:59:00,000   31.03.2013 03:00:00,000 
//  tArray   tInt(3)   tFuncVar(MAX) 2-arg   Array data: 1 col, 1 row   elem (type=string, len=1, "5") 
//  record contains a DIB. 
// Insert the newlycreated Gridset record at the end of the record (just before the EOF) 
//  CSPName may not always be specified 
//  test with longer name, just small enough file 
//  read from the zip input stream 
//  Remove any children off the current style, to    avoid orphaned nodes 
//  indirect defined name   indirect defined name pointinh to other sheet 
//  Set the raw colour, not the adjusted one 
//  Remove MergedRegions in dest row 
//  If the paragraph is the first paragraph in the footnote,    ensure that it has a footnote reference run. 
//  old bottom column of area has moved up deep within the area, and exposed a new bottom column 
// M (1000), CM (900), D (500), CD (400), C (100), XC (90), L (50), XL (40), X (10), IX (9), V (5), IV (4) and I (1). 
//  total size 
//  type 
//  of 16-bit words in the header. 
// the count of items is less by one 
//  we clamp the values, as it possible to come up with more than 100% sat/lum 
//  Update the rich text strings to point at    the new locations of the fonts   Remember that one underlying unicode string 
//  Has 2 fonts 
//  Write out and re-check 
//  Need to walk forward to find the first non-blank row 
//  The document 
//  During construction the cellStyle may be null for a Blank cell. 
//  Save and re-load, still there 
//  advance 2 rows 
//  the guides in the shape definitions are all defined relative to each other,   so we build the path starting from (0,0). 
//  make a hole 
/*  Write the summary information stream and the document summary         * information stream to the POI filesystem.  */
// POI-61045 -- in practice, there can be an extra 2 bytes 
/*  No width value set  */
//  Has no Excel Sheets 
//  Needs to come from an XBAT 
//  see TestXSSFBugs.bug54764()   see TestXSSFBugs.bug54764() 
//  Sanity check to detect garbage string lengths   16 million chars? 
//  MINIMUM ELEMENTS FOR A TABLE 
/* XDDFLineChartData lines = (XDDFLineChartData) chart.createData(ChartTypes.LINE, lineCategories,                    leftValues); */
//  process our events based on the document input stream 
//  Test the sum 
//  therefore, over-write the other. 
//  special: geometry sections (key: index, value: section) 
//  Some inline text elements get returned not as    themselves, but as CTEmpty, owing to some odd    definitions around line 5642 of the XSDs   This bit works around it, and replicates the above    rules for that case 
//  Excel thinks 2/29/1900 is a valid date, which it isn't 
//  as long as there are 3 or more digits between 
//  If we get here, we didn't break 
//  by the PenUnit field. If a zero width is specified, a minimum value is used, which is determined by the units. 
//  read optional cached text value 
//  normal number of data bytes 
//  Excludes support 
//  check paragraphs 
//  Bug 58315: there are files where there is no pr-entry for a RichTextString 
//  lined up with the output. 
//  Cell show "12/08/16" 
//  verify cell format without the conditional rule applied 
//  get table row properties (trPr) 
// undocumented 
//  If we've just finished with the cells, then fire the 
//  this object's parent Entry 
//  get the cells in this row 
//  Optimise styles 
//  if multiple HSSFHyperlinks refer to the same record 
//  A 32-bit unsigned integer that specifies the offset, in bytes from the start 
//  this can happen when the client code has created a row,   and then removes/replaces it before adding any cells. (see bug 46312) 
//  is there a change necessary for the current row? 
//  else - typical case A and B is not close to threshold 
//  len=5, 16bit   character data    padding byte 
//  Valid scale values range from 10 to 400 
//  277: CONFIDENCE 
//  242 == 0200F2; 246 == 0x00F6 
//  Update size if needed 
// A4  B4 
//  Create some styles, no change 
//  initialize xwpfchart object 
// get custom style 
// names cannot be blank and must begin with a letter or underscore and not contain spaces 
//  #1) these borders will all be medium in default color 
//  special type used by Tika 
//  re-allocate cells array as required. 
//  records were assembled in standard order, so this simple check is OK 
//  InputStream 
/*  No, it is not a summary information. We don't care                             * about its internals and copy it unmodified to the                             * destination POIFS.  */
//  And now build the piece 
//  heights. 
// now paragraph attributes 
//  Image should be in it's own run, or in a run with the end-of-special marker 
//  Remove any double quotes 
//  See bug #59786 - we'd really like a test file to confirm if this    is the right properties + if this is truely general or not! 
// Excel only indexes the first 128 buckets. 
//  From PCT to NIL: 
//  Having determined if and how to resize the rows, columns and/or the   image, create the ClientAnchor object to position the image on   the worksheet. Note how the two ClientAnchorDetail records are   interrogated to recover the row/column co-ordinates and any insets.   The first two parameters are not used currently but could be if the   need arose to extend the functionality of this code by adding the 
//  We start with 30 Rows. 
/*              * Part already existed, but was not related so far. Create             * relationship to the already existing part and update             * POIXMLDocumentPart data.              */
//  zeNew.setMethod(ze.getMethod()); 
//  there are two test-files that have no body... 
// test against strings of different length 
// un-register the single-cell array formula from the parent sheet through public interface 
//  check length-limits 
//  Note - if moving highIx down (due to lookup<vector[newMid]),   this execution path only moves highIx it down as far as newMid, not midIx, 
//  was c1 before verify 
//  We have relaxed this check, so we can read the file anyway 
//  crc32 is checked within zip-stream 
//  preserve original exception 
//  A2:C2 
//  Check text in the rich runs 
//  empty cell at left-top corner 
//  There was a previous match, find the new minimum. 
//  uniform scaling, can use target values directly 
//  max axis value 
// must be 0; 
//  A 32-bit Boolean value that specifies whether the arrow cap is filled. 
//  Write the slideshow out to a byte array 
//   buffer dictionary or not 
// let's create a few tables for the test 
//  get margin components 
//  Update column and row count 
//  Assign it; treat invalid options as "default" POI-60293 
//  row 1 
//  bug 60128 
//  Bingo, data contains this property 
//  Ensure it isn't a XLSB file, which we don't support 
//  Dummy write out, so the position winds on properly 
//  Now do 4 character styles 
//  end package scope class LocalProperty 
//  Should never happen 
// read in sample 
//  relativization against root 
//  Bits: font,align,bord,patt,prot   0 = Horizontal alignment modified   0 = Vertical alignment modified   0 = Text wrapped flag modified   0 = Text rotation modified   0 = Justify last line flag modified   0 = Indentation modified   0 = Shrink to fit flag modified   Normally 1, 0 = Merge Cell flag modified   0 = Cell locked flag modified   0 = Cell hidden flag modified   0 = Left border style and colour modified   0 = Right border style and colour modified   0 = Top border style and colour modified   0 = Bottom border style and colour modified   0 = Top-left to bottom-right border flag modified   0 = Bottom-left to top-right border flag modified   0 = Pattern style modified   0 = Pattern colour modified   0 = Pattern background colour modified   Always 111 (ifmt / ifnt / 1)   Undocumented bits   Bits: font,align,bord,patt,prot   1 = Record contains font formatting block   1 = Record contains alignment formatting block   1 = Record contains border formatting block   1 = Record contains pattern formatting block   1 = Record contains protection formatting block   0 = Text direction modified 
//  This used to throw an error before - #42794 
//  Mark it as being a Color Scale 
//  row 0 
//  Have the datasource updated 
//  or bottom of the area ref there will be a change 
//  check that it re-serializes to the same data 
//  Set the reference for the named range for worksheet 'sheet1' 
//  size extra 
// master style for text with type=TextHeaderAtom.OTHER_TYPE 
//  23-08-2016 08:51:01 which is 42605.368761574071 as double was parsed 
//  flip if necessary 
//  Save the data, ready for the calling code to do something    useful with it 
/*  store first series as template and find last series index  */
// Load existing excel with some chart on it having primary and secondary axis. 
//  Windows 10, 15.6" 3840x2160 
//  update the FIB.CCPText + friends fields 
//  Check as expected currently 
//  in Pre 3.12: setting bold=false doesn't change the internal state 
//  if the string parses as a number, it is OK 
//  Check now 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#getFormula2()	  */
//  Flag to see if need to 
//  Having very small numbers leads to different formatting, Excel uses the scientific notation, but POI leads to "0" 
//  Next 32 -> 13 
//  contains 2 bytes of data: 0x0001 or 0x0003 
//  row 2 
//  add all the insertions as text 
//  Records ~12000 seem to be related to the Comments used in PPT 2000/XP 
//  perhaps this testcase belongs on TestHSSFName 
//  The playback device context is restored by popping state information off a stack that was created by   prior SAVEDC records 
//  shape is grouped and the anchor is expressed in the coordinate system of the group  
//  height   options 1 
//  See 17.18.40 ST_HighlightColor (Text Highlight Colors) 
//  create a workbook to test with 
// default column width measured in characters 
//  System.err.println("Paragraph " + x + " is now " +   papx.getStart() + " -> " + papx.getEnd()); 
//  317: PROB 
//  Check that we can read the right data pre-write 
//  don't add the hyperlink now to text paragraph records 
//  no need to save EOF in field 
//  check for signed/unsigned shorts #58069 
//         OutputStream os = new FileOutputStream("output.xlsm"); 
// file can be written to 
/*  char 14  */
//  Set when V start element is seen 
//  Now check the first paragraph in total 
//  footer can be more than 256 bytes 
//  unknown 104f 
//  A 32-bit unsigned integer that specifies the spacing, orientation, and quality of rendering for the 
//  Note - order is important for these instance-of checks 
//  Process the value contents as required, now we have it all 
//  We don't check the type of the operands. 
// NOSONAR, it's a bit complex but monolith method, does not make much sense to divide it 
//  Extract the text as a String 
//  times.  Without caching, each subsequent cell take about 4 times longer to evaluate. 
//  Row number must be between 0 and last row 
//  Ask CellFormat to get a formatter for it 
//  write the text to the docstream and save the piece descriptor to   the 
//  Create Styles if it is missing 
//  Piccolo is disabled for POI builts, i.e. JAXP is used for parsing   so only user code using XmlObject/XmlToken.Factory.parse   directly can bypass the entity check, which is probably unlikely (... and not within our responsibility :))    DEFAULT_XML_OPTIONS.setLoadEntityBytesLimit(4096); 
//  Remove the print area on Sheet0 and change the print area on Sheet1 
//  With date is null   Via string is blank 
//  Note - incrementing loop variable here 
//  suppress IOException for interface method 
// not found in the master sheet. Use the hardcoded defaults. 
//  Go for the 2nd chunk in the stream 
// see 2.3.3 PROJECTwm Stream: Module Name Information  multibytecharstring 
//  Now test 
//  trigger handling 
//  pivot only 
//  The tab character - \t - cannot be used to create a tab space   within a cell as it is rendered as a square. Therefore, four 
// sdtContentCell is allowed to be null:  minOccurs="0" maxOccurs="1" 
//  this is also the default if parameter is not given 
//         FileOutputStream fileOutput = new FileOutputStream("/tmp/57196.xlsx");          wb.write(fileOutput);          fileOutput.close(); 
//  No print settings before repeating 
//  Problem 3: These used to fail, now pass 
//  is this window is an icon 
//  application/vnd.ms-powerpoint.presentation.macroenabled.12 
//  Grab what headers and footers have been defined   For now, we don't care about different ranges, as it    doesn't seem that .docx properly supports that    feature of the file format yet 
//  Grab all the different bits we care about 
//  Test methods common with XSSF are in superclass   Local methods here test HSSF-specific details of updating array formulas 
//  PersistPtrIncrementalBlock 
//  name and display name are different 
//  sprmPFNumRMIns  
//  Now try and open properly 
//  anchor should be set, after updateCellAnchor is through 
//  no other criteria matches a blank cell 
//  It's not worth compressing only 1 or two bytes,    due to the overheads 
//  creating a row in place of another should remove the existing data,   check that the cell is gone now 
//  Found from PersistPtrHolder 
//  fib.setCcpTxtBx(fib.getCcpTxtBx() + adjustment);   } 
// serialize and check that the data is the same as in r1 
//  sprmPBrcTop80  
//  Remove the core part 
//  ignore exceptions from old parsers that don't support these features   (https://bz.apache.org/bugzilla/show_bug.cgi?id=62692) 
//  Now all of them 
//  Paragraphs should match with lines 
//  the current element is not pushed to the stacked, i.e. it's the last 
//  306 == 0x132; 310 == 0x0136 
//         assertEquals(IndexedColors.YELLOW.index,r1pf.getFillBackgroundColor()); 
//  email, path to file and url must be valid URIs 
//  Now set another 
//  The first short at the offset is the size of the grpprl. 
//  create cell if it does not exist 
//  from extractAttachments 
//  integer, or integer portion uses all 11 allowed digits 
//  calls System.exit(): SlideIdListing.main(new String[0]); 
//  first comment works 
//  Now strip out any remaining '#'s and add any pending text ... 
// serialize and read again. The file should be readable and contain no shapes 
//  we are not currently matching, replacing, or unbuffering 
//   live within any merged regions 
//  Get row that does not exist yet 
//  Save the file and re-read it 
//  cross over 
//  line width 
//  Create the comment and set the text-author 
//  Merge in the built in formats if we haven't already 
//  see #61633 
//  A 16-bit signed integer that defines the number of bytes per scan line. 
//  Save the completed workbook 
/*          * ds:SignedInfo          */
//  seems to be a valid workbook 
//  Get structure from webservice 
//  Change address (type is not changeable) 
//  A 32-bit unsigned integer that defines the compression mode of the DIB.   This value MUST NOT specify a compressed format if the DIB is a top-down bitmap, 
//  private static POILogger _logger = POILogFactory.getLogger(XSLFTextParagraph.class); 
//  https://stackoverflow.com/questions/21855842 
//  row inp col 0x4076 (!)   col inp col 0 
//  So it's a relative part name, try to resolve it 
//  In a rotated quadrant 1 (=45-135 degrees) and 3 (=225-315 degrees), which is basically a shape in a   more or less portrait orientation, Powerpoint doesn't use the normal shape anchor,   but rotate it 90 degress and apply the group transformations.   We try to revert that distortion and return the normalized anchor.   It's strange that you'll need to rotate the shape back and forth again, but you can   think of it, as if you paint the shape on a canvas. First you rotate the canvas, which might   be already (differently) scaled, so you can paint the shape in its default orientation   and later on, turn it around again to compare it with its original size ... 
//  Check it matches 
//  The sheet referenced can't be found, sorry 
//  A signed integer that defines the amount by which to multiply the 
//  VBA source files 
//   and none of their character runs either 
//  Find a spare key, and add that 
//  read the workbook, adjust the SummaryInformation and write the data to a byte array 
// This ensures that there is only one copy. 
//  enclose 
//  Try decreasing the upper limit below the current number of formats 
// test that null doesn't throw NPE 
//  Records we pick up as we process 
//  intersected existing format runs 
//  Create cells over the selected area 
//   or none could be fetched 
// re-create the sst table every time saving a workbook 
//  extending XSLFSimpleShape is a bit unlucky ... 
//  Allocate all 
//  extra field len 
//  Note that hyperlinks do not track what they point to, so this hyperlink should still refer to test!E1 
//  check schema type loading and check if we could run in an OOM 
//  Set link cell style (optional) 
//  No comments for this slide 
//  But has core details 
//  Names don't match, not the same 
//  Check that the "PowerPoint Document" sections have the same size 
//  convert to 1-based 
//  PNG   PNG   PNG   PNG 
//  And the 2nd 
//  Arc2D requires us to draw an arc from one point to another, so we   need to calculate the angle of the start point and end point along   the ellipse   - Derived from parametric form of ellipse: x = h + a*cos(t); y = k +   b*sin(t) 
//  -1: first arg is used to select from a basic aggregate function 
//  Ref - A2   Attr 
//  also remove any comment located in that row 
//  manipulated to accommodate the image; columns and then rows. 
//  workbook-scoped name 
//  exactly the opposite 
//  comment is now in column 1 
// the second slide uses custom per-slide headers / footers 
//  end bitfields in cell options 
/*              * we have start node. end offset points to next node, separator or             * end              */
/*  else - The path is somewhere down in the POI filesystem's         * hierarchy. We need the tree node of this path's parent         * and attach our new node to it.  */
//  German "scharfes s" is uppercased to "SS"   German "scharfes s" is uppercased to "SS"   Some German umlauts with lowercase first letter is changed to uppercase 
//  Accounting -> 0 decimal places, default currency symbol 
//  Check the 100(.00)% ones 
//  Percentage values are stored as integers that are 50 times   percentage. 
//  Get close to 32767 
//  nothing 
// the address is terminated by '\u0000' 
//  The size in bytes of the FLD data structure 
/*  only invoked locally and from the junit tests  */
//  2. ptg refers to the moved sheet 
//  ordered by page number 
//  this listener has not registered before 
//  num values   bubble series type 
//  Typically from third party programs 
// Create relationship between the pivot cache defintion and the workbook 
//  It's a = condition. 
//  First run has defaults 
//   and the RC4 CryptoAPI encryption header structure 
//  Should have one style 
//  Orange "foreground", foreground being the fill foreground not the font color. 
//  Reload, and ensure they were serialised and read correctly 
//  If we did find all of rawCode with our new    byte added on, we can wait to see what happens 
//  columns. 
//  Create various cells and rows for spreadsheet. 
//  Move somewhere spare 
//  Check the hyperlinks 
//  cap used at the start/end of the line to be drawn. 
//  same as in column 4 but the font is twice larger than the default font 
//  typical case - non-encrypted stream 
//         assertNotNull(r.getWorkbookData());        assertNotNull(r.getSharedStringsData()); 
//  Special case for single cell reference 
//  perform the same check with LocalDateTime 
//  Other one doesn't have notes 
//  x coordinate of center point 
//  if wordWrap == false then we return the advance to the (right) border of the sheet 
/*          *  SET Intermediate2 TO Verifier MULTIPLED BY 2         *  SET most significant bit of Intermediate2 TO 0          */
//  TRUE   "ABCD" 
//  autosize not-evaluated cells, formula cells are sized as if the result is 0 
//  Grab the data 
//  Hex dump from bug 45784 attachment 22560 streamOffset=0x0CD1 
//  Call should modify the contents and replace the formula with the result   returns the same cell that was provided as an argument so that calls can be chained. 
//  Page 59 of 210 
//  no change if after any affected row 
//  A 32-bit unsigned integer that specifies the brush EMF Object Table index. 
//  Data is always padded out to a 4 byte boundary 
//  A 16-bit signed integer that defines the height of the bitmap in scan lines. 
//  converted from TestDrawingManager(1) 
//  special: character section 
//  Add a second one 
//  anchor of this group relative to the parent shape 
//   20 or so MAPI ones 
//  Build a formatter, and cache it 
//  If the print setup isn't currently defined, then add it    in but without printer defaults   If it's already there, leave it as-is! 
//  Fully mergeable      A B    1 x x   A1,A2,B1,B2 --> A1:B2 
//  Identify and create our temp dir, if needed 
//  Normal properties 
//  byte   3-byte 
//  Now move it to one 
//  Sine Formula: "sin x y" = (x * sin( y )) = value of this guide 
//  7 circles div 8: 7 x 360 / 8 = 315 
//  see https://blogs.msdn.microsoft.com/officeinteroperability/2013/04/22/office-open-xml-themes-schemes-and-fonts/ 
//  Again ensure contains character based offsets no matter what 
//  update children index 
// make sure all the HSSFColor constants match 
//  master and 1 have notes 
//  Raw text has \r instead 
//  Casting to int should be safe here - tables larger than the   sheet (which holds the actual data of the table) can't exists. 
//  Currently, there aren't any 
//  we can't set font since slideshow is not assigned yet 
//  "Sheet1" case etc   that was easy 
//  Level 1 and 2 collapsed, Level 3 expanded,  
//  we can append the new row at the end 
//  so far 
//  populate sheet cells 
//  Not needed by POI.  Regenerated from scratch by POI when spreadsheet is written 
//  table cells have a list of paragraphs; there is an initial   paragraph created when the cell is created. If you create a   paragraph in the document to put in the cell, it will also   appear in the document following the table, which is probably   not the desired result. 
//  Normal, superscript for 4th, normal 
//  Is it a new attachment? 
//  Check the package contains what we'd expect it to 
//  Windows Enhanced Metafile   Windows Metafile   Macintosh PICT   JFIF   PNG   Windows DIB 
//  They should all have the same date on them 
//  Open the copy in read/write mode 
//  This function index represents the LEN() function 
//  autoSize the first column and check its size before the merged region (1,0,1,1) is set: 
//  but for num_chars causes empty string to be returned. 
//  1 based   1 based 
//  edit the workbook 
//  may be 0-terminated, just trim it away 
//  An 8-bit unsigned integer that specifies the x height of the font. 
//  TODO - process 
//  assumed row ranges set-up by caller: 
//  We have to set up dates as well. 
//  lookup and result row are different 
//  don't try to match if the given byte-array is too short   for this pattern anyway 
//  An optional array of 32-bit unsigned integers that defines the lengths of   dashes and gaps in the line drawn by this pen, when the value of PenStyle is   PS_USERSTYLE line style for the pen. The array contains a number of entries specified by   NumStyleEntries, but it is used as if it repeated indefinitely.   The first entry in the array specifies the length of the first dash. The second entry specifies   the length of the first gap. Thereafter, lengths of dashes and gaps alternate.   If the pen type in the PenStyle field is PS_GEOMETRIC, the lengths are specified in logical   units; otherwise, the lengths are specified in device units. 
//  end public interface FixedField 
//  other rows 
//  readable + writable 
// should read 85 rows 
//  index should equal number of papxs that will be in this fkp now. 
//  This encodng depends on docId, password and stream position 
/*  **********  END  begin implementation of POIFSViewable **********  */
//  color in percentage is in linear RGB color space, i.e. needs to be gamma corrected for AWT color   see https://en.wikipedia.org/wiki/SRGB (The forward transformation) 
//  already exists 
//  recordSize in DWORDs 
/*          * Read the stream's header fields.          */
//  Fake up a header 
//  this paragraph is not a bullet, so reset the count array 
//  contrived example to expose bug: 
// macro comes from Common Crawl: 4BZ22N5QG5R2SUU2MNN47PO7VBQLNYIQ  A REFERENCE_NAME can sometimes only have an ascii string without  a reserved byte followed by the unicode string.  See https://github.com/decalage2/oletools/blob/master/oletools/olevba.py#L1516  and https://github.com/decalage2/oletools/pull/135 from (@c1fe) 
//  save the result 
//  nothing more to do if there are no sheets left 
/*  * Tests Match functions as loaded from a test data spreadsheet.<p> * * Tests for bug fixes and specific/tricky behaviour can be found in the corresponding test class * (<tt>TestXxxx</tt>) of the target (<tt>Xxxx</tt>) implementor, where execution can be observed *  more easily.  */
//  "Decimal" validation type 
//  Build the name of the csv folder from that of the Excel workbook. 
//  Back to normal 
//  don't add record yet - set it in storeText 
//  Work out how long the "data" is   This might be the actual data, or just a pointer 
//  try to get a message id that does not exist 
/*              * if cell style is defined (like borders, etc.) but cell text             * is empty, add "&nbsp;" to output, so browser won't collapse             * and ignore cell              */
//  Save it 
//   we need to output our pending code block 
//  comment this out to get all bottom-aligned   cells 
//  Check all of them in turn 
//  user can pass an custom object to convert fonts 
//  Initialise to empty 
//  ChunkBasedPropertyValue cval = (ChunkBasedPropertyValue)val;   TODO Lookup 
//  Check this complicated file using POIFS 
// Check for Schema element 
//  Get the part that holds the workbook 
//  Try with this name 
//  Rows being moved completely enclose the ref.   - move the area ref along with the rows regardless of destination 
//  A 16-bit unsigned integer that specifies the WMF metafile version in terms 
//   C: Explicit, Foreground 
//  15 
//  Grab records for testing with 
//  valid prefix is 'C' 
//  bookmark reference 
//  pattern   format 
//  general tests for not-equal (<>) operator 
// String overhead 
//  can't be asserted ... see bug 61300 
//   dummy end-of-row records 
//  The number of Unicode characters in the optional description string that follows. 
/*  if connecting is possible we return true here  */
//  mask makes multiples of 32 which optimises BigInteger.shiftRight 
//  pad to next 2 byte boundary 
//  Has one sheet, with values 1,2,3 in column A rows 1-3 
//  sprmCCharScale 
//  Internal 
//  A 32-bit unsigned integer that specifies the size of the DIB header, if the 
//  2-row/2-column intersection 
//  we cannot merge cells included in an array formula 
//  ignore all black mono-brushes 
//  Get cell that already exists 
//  Link still not there? Giving up. 
//  Data size 
// Another filter has already been created 
//  records we happen across 
//  always 2 
//  MCT comes after 'Sheet View Settings' 
//  infinity 
//  Test with Java style M=Month 
//  Findbugs: URF_UNREAD_FIELD. Do not delete without understanding how this class works.  this.xssfSheet = xssfSheet; 
//  used from the outside?!? 
//  Loop over each font, seeing if it is the same    as an earlier one. If it is, point users of the    later duplicate copy to the earlier one, and     mark the later one as needing deleting 
//  thrown.expectCause(Matcher<ArrayComparisonFailure>); 
//  *** sun.misc.Unsafe unmapping (Java 9+) *** 
//  The anchor specified by the escher properties is the displayed size,   i.e. the size of the already clipped image 
//  18 @ 88   *mask bit*   18 @ 106 
//  Zap the un-needed user style records   removing by index, because removing by object may delete 
// Step 2. Generate XML file. 
//  Replace cell1 
//  then draw any content within this shape (text, image, etc.) 
//  ensure that the writer is closed in all cases to not have lingering writers 
//  Should never get here 
// "Offset=0x00000612(1554) recno=71 sid=0x00FC size=0x2020(8224)\n" + 
//  Add another cell at the beginning 
//  Default sample file has none 
//  sprmCFBoldBi 
//  Each block should only ever be used by one of the 
//  short side div 32 
//  the spec only refers to two possible upxs but it mentions 
//  Default is no hyperlinks 
//  Check POI 0 based, OOXML 1 based 
//  OPCPackage  wb = new XSSFWorkbook(OPCPackage.open(file));  assertCloseDoesNotModifyFile(filename, wb); 
//  First free one is 100 
//  total size, will be determined later .. 
//  The value MUST be in the Weight enumeration table. 
// swap first column and last column numbers and relativity  Note: cannot just swap the fields because row relativity is stored in fields 3 and 4 
//  Have the child pointers identified and created 
//  false, true   false, true   false, true   false, true 
//  MS Office can insert URIs with missing authority, e.g. "http://" or "javascript://" 
//  blank eval translates to zero   Note - a blank eval in the lookup column/row never matches anything   empty string in the lookup column/row can only be matched by explicit empty string 
//  3 @ 4093 
//  When the required size is very close indded to the column size,   the calcaulation above can produce a negative value. To prevent   problems occuring in later caculations, this is simply removed 
//  corner of the destination rectangle. 
//  Create a base workbook 
//  font size 20   character run is 28 long 
//  testing based on new bug report 
//  can we reuse existing? 
// byte cInc = (byte)(((byte)(param & 0xfe00) >>> 4) >> 1); 
//  Update the byte array with the latest data 
//  0   FALSE 
//  remove client data if the placeholder was the only child to be carried 
//  300 - 7.2 - 7.2 - 0 
// a new border was added to the styles table 
// //// Case 13: Evaluate "Table1[[#Data],[col]:[col2]]" //////// 
//  Check font count 
//  for the sake of inheritance of the cryptoAPI classes   see 2.3.5.1 RC4 CryptoAPI Encryption Header   If set to 0x00000000, it MUST be interpreted as 0x00000028 bits. 
//  pick out a cell from within the second shared formula group 
//  System.err.println("Paragraph " + x + " was " + papx.getStart() + 
//  There is also much logic inside Sheet that (if buggy) might also cause the discrepancy 
//  Decompress it 
// Set the columns the correct size 
//  expand:   collapsed bit must be unset   hidden bit gets unset _if_ surrounding groups are expanded you can determine     this by looking at the hidden bit of the enclosing group.  You will have     to look at the start and the end of the current group to determine which     is the enclosing group 
//  else some other unexpected error 
/*  * HSSF Chart Title Format Record Type  */
//  Padding (variable): A set of bytes that MUST be of the correct size such that the size of the    UNICODE-LP-P4 structure is a multiple of 4 bytes. If Padding is present, it MUST be exactly    2 bytes long, and each byte MUST be 0x00.             
//  First up, we need to serialise the paragraph properties 
//  plot area background and border line 
//  num shapes in drawing   The last MSOSPID given to an SP in this DG 
//  first, we need the raw data blocks 
//  Copy over everything else unchanged 
// Test a compressed small string that has rich text formatting 
//  field_6_border_options bit map 
//  Grab the core document part, and try to identify from that 
//  Now sort these chunks lists so they're in ascending order, 
//  Write lots, so it needs another big block 
//  Relationships can't be changed, so remove the old one 
//  Bug 55791: We also need to check that the resulting file name is not already taken   this can happen when removing/adding slides, notes or charts 
//  border options bitfields 
//  cs6 = cs2 -> 22 
//  Runs itself is easy to update 
//  Parents don't matter if contents + names are the same 
//  Check the value - will be zero as it is <c><v/></c> 
//  Strip custom text in quotes and escaped characters for now as it can cause performance problems in fractions. 
// the first slide uses presentation-scope headers / footers 
//  Compress it using our engine 
//  Starts out with the default style 
//  And another where we do an in-place write 
//  try to find an alternative name 
//  The header block doesn't count, so add one 
// setting the same fill multiple time does not update the styles table 
//  basis zero has funny adjustments to the day-of-month fields when at end-of-month 
//  assumes parsing interprets the overloaded property right for XSSF 
//  unused   '?' = multiple values 
//  the BAT will be in the first spot of the new block 
//  Note - these assignments deliberately set Feb 30 date. 
//  wasn't already listening for everything, so drop   anything listener might have been listening for and   then add the listener to the set of omnivorous   listeners 
//  static final File pfxFile = TempFile.createTempFile("poitest", ".pfx"); 
//  more complicated failed 
/*          * Completion of undigested ds:References in the ds:Manifests.          */
//  The next three rows will hold the data that will be used to 
//  key: id of master 
//  1x1 corner intersection   1-row/1-column intersection 
//  We don't support negative years yet 
// expected flag  expected # of sheets  sid+size+data 
//  paragraph is 25 long   paragraph reserved field 
//  end public class EntryNode 
// If number < -549,755,813,888 or if number > 549,755,813,887, this function returns the #NUM! error value. 
//  An 8-bit unsigned integer that defines the number of color planes in the  
//  set bitfields for indention options 
// Create a unicode dataformat (contains euro symbol) 
//  strip off trailing zeros 
//  Browse default types 
//  special cases when one operand is blank 
//  same as EscherTertiaryOptRecord.RECORD_ID 
//  the old record was never registered, ignore it 
//  verify we can't read a short block 
//  normal case 
//  Should support XSSF stuff lookups 
//  Remove when SXSSFRow.shiftCellsLeft() is implemented.  
// length of the parent text 
//  Now the final pass for quoted chars: Replace any \u0000 with '' 
// If the row exists remove it, so that any cells attached to the row are removed 
//  writing 4 byte data to a 5 byte buffer 
//  It's really gone! 
//  bitfields for additional palette options 
//  the desired style does not exist in the workbook. Create a new style with desired properties. 
//  Add mini and normal sized entries to start 
//  check sheet-index with one more => throws exception 
/*  (non-Javadoc)     * @see org.apache.poi.ss.formula.EvaluationSheet#getlastRowNum()     * @since POI 4.0.0      */
//  Another 13 comes before the next 14.   This means there's nested stuff, so we 
//  those cells to populate the second drop down list. 
// ////////////////////////////// From POIFS ///////////////////////////// 
//  Check old and new are there 
//  switch XWPF and HWPF and so forth depending on the error message 
// length in bytes for this record 
//  Recheck the data in all 4 streams 
//  Setup the environment 
//  If the shared formula range precedes the master cell then the preceding  part is discarded, e.g.   if the cell is E60 and the shared formula range is C60:M85 then the effective range is E60:M85 
/* int bytesRemaining = */
// 			File f = new File(System.getProperty("java.io.tmpdir") + "/testArraysAndTables-out.xls"); 
// create relationship in document for new chart 
//  put the last chpx's end in 
//  formula, throws NotImplemnted? 
//  Checksum 
//  Actually stored as C1 to C65536 
//  cs3 = cs1 -> 21 
//  Tidy up 
//  Middle 
//  Decide what to call it 
//  Held on the 1st bit 
// //////////////// Word 
//  And finally XML 
//  Should fail if we try to add the same comment for the same cell 
//  organize the document pieces 
//  don't try to shoot in foot, please -- vlsergey   r2.setOptions((short) 0x9876); 
//  verify 
//  'stream id' field tells you 
//  Write out the rgb values 
//  Check the data 
//  Clear the cached values 
//  beat on the children allocation code 
//  just to be dead sure test conversion in java both ways 
//  Referenced in ZIP 
//  make sure, that we've read all the streams ... 
//  sprmCHresi -- 0x484e 
//  charset, padding   name length, unicode flag 
//  table has a single row by default; grab it 
//  Reserved fields 
//  Grab the unicode username, if stored 
//  some documents contain invalid values here 
//  pad the last chunk 
// set the 'pre-evaluated result 
//  Ministore has no blocks, so can't iterate until used 
// setting indexed color 
// case 2. cell.setCellValue((String)null); 
/*  Part already existed, get relation id and return it  */
//  1" 
//  A1:E1 should move to A5:E5   A2:C2 should be removed 
//  Check bits 
//  depending on the value of the SOLID_COLOR flag in the Flags. 
//  Internal reference 
//  aspect ratio. 
//  PT_BEZIERTO   Specifies that this point is a control point or ending point for a Bezier curve.   PT_BEZIERTO types always occur in sets of three.   The current position defines the starting point for the Bezier curve.   The first two PT_BEZIERTO points are the control points,   and the third PT_BEZIERTO point is the ending point.   The ending point becomes the new current position. 
//  Just normal properties 
//  be specified independently of the orientation angle of the string's characters. 
//  Ensure none of the paragraphs refer to one that isn't there,    and none of their character runs either 
//  RVA is for 'operand class': 'reference', 'value', 'array' 
//  open the file input stream   NOSONAR 
//  returns True if this row shouldn't be displayed 
// compatibility with HSSF 
//  Else, if the image is smaller than the space available 
//  Won't be styled currently 
//  We use the RecordTypes class to provide us with the right    class to use for a given type   A spot of reflection gets us the (byte[],int,int) constructor   From there, we instanciate the class 
//  Formatted numbers   TODO        assertContains(text, "55,624");        assertContains(text, "11,743,477"); 
/*          * Count of styles in stylesheet         *          * The number of styles in this style sheet. There will be stshi.cstd         * (cbSTD, STD) pairs in the file following the STSHI. Note: styles can         * be empty, i.e. cbSTD==0.          */
// flags: HyperlinkRecord.HLINK_LABEL | HyperlinkRecord.HLINK_PLACE 
//  Try to create a comments table with the same number as    the sheet has (i.e. sheet 1 -> comments 1) 
//  Do now, as characters() may be called more than once 
//  mask is 0x060002 
//  when 4 digit value appears first, the format is YYYY/MM/DD, regardless of OS settings 
// 		} 
//  An EmfPlusGraphicsVersion object that specifies the version of operating system graphics that 
//  The CellNumberFormatter.simpleValue() method uses the SIMPLE_NUMBER   CellFormatter defined here. The CellFormat.GENERAL_FORMAT CellFormat   no longer uses the SIMPLE_NUMBER CellFormatter.   Note that the simpleValue()/SIMPLE_NUMBER CellFormatter format   ("#" for integer values, and "#.#" for floating-point values) is   different from the 'General' format for numbers ("#" for integer   values and "#.#########" for floating-point values). 
//  Set up a simple IF() formula that has measurable evaluation cost for its operands. 
//  i.e. absolute from 1st row to 0th one 
//  Check our SBAT free stuff is correct 
//  write out the FontTable. 
//  handle raster op   currently the raster op as described in https://docs.microsoft.com/en-us/windows/desktop/gdi/ternary-raster-operations   are not supported, as we would need to extract the destination image area from the underlying buffered image   and therefore would make it mandatory that the graphics context must be from a buffered image   furthermore I doubt the purpose of bitwise image operations on non-black/white images 
//  using area unions 
//  else not success? Try block did not complete normally   just print stack trace and leave original ex to be thrown 
// ????  ???? 
/*  Static initialization  */
//  that is not an exact multiple of block size 
//  No change after write 
//  now write the file and read it back in 
//  much simple implementation base on SubdocumentType --sergey 
/*             The bytes for the following test:            170 : 78 : x            171 : 0 :            172 : d : <r>            173 : 35 : 5            174 : 39 : 9            175 : 0 :            176 : 2d : -            177 : 0 :            178 : 35 : 5            179 : 0 :            180 : 35 : 5            Note that we are skipping over the value "5" at offset 173.            This is an apparently invalid sequence in MS's encoding scheme            When I open the document in MSWord, I also see "\r9-55"         */
//  having a file shorter than 8 bytes previously caused an exception 
// Write out the file, read it in, and then check cell values 
//  Force 'setCellType' to create a first Record 
/*      <AnimationInfoAtom info="1" type="4081" size="28" offset="4015" header="01 00 F1 0F 1C 00 00 00 ">       00 00 00 07 04 05 00 00 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 00       00 00 00     </AnimationInfoAtom>      */
//  except in these cases Excel really tries to render them as if they were normal numbers 
//  Hold onto the size of this block that was serialized 
//  Add a default header 
// this means null value (2.5.166), do not read any bytes!!! 
//  see [MS-OFFCRYPTO] - 2.3.3 EncryptionVerifier 
//  grpprls must fall on word boundaries 
//  Is empty 
//  1 => a, not 0 => a 
//  text.append("\nThumbnail:           " + si.getThumbnail()); 
//  Check two aspects of the print setup 
//  Ensure it now has one 
//  (unnamed range) reference list 
/*  Yes, it is a summary information. We will modify it                             * and write the result to the destination POIFS.  */
//  getValue() is replaced with getAbsoluteValue() because loop variables i, j are   absolute indexes values, but getValue() works with relative indexes values 
// default values 
//  don't EVER use 1904 date windowing...tick tock.. 
//  First up, check that we can process the header properly 
//  this usually clears out previous content in the part... 
//  Saving data in the ZIP file 
//  Our initial size is 10 
//  Change the x and y 
//  Word Document - binary (OLE2CDF) file format 
//  Background ... Accent 3 color 
// What if we dont have any ranges and supbooks 
//  In the right form for a normal chunk   We'll process this further in a little bit 
//  Check read only advised 
//  for the junit test not all chars are rendered 
/*              * From: http://social.msdn.microsoft.com/Forums/en-US/3dadbed3-0e68-4f11-8b43-3a2328d9ebd5             *              * The initial value for XorArrayIndex is as follows:             * XorArrayIndex = (FileOffset + Data.Length) % 16             *              * The FileOffset variable in this context is the stream offset into the Workbook stream at             * the time we are about to write each of the bytes of the record data.             * This (the value) is then incremented after each byte is written.               */
//  this can lead to a StringBufferOutOfBoundsException, so we will add it 
//  FormulaShifter works well in terms of Ptgs - so convert CellRangeAddress to AreaPtg (and back) here 
//  update named ranges 
//  A 32-bit unsigned integer from the RecordType enumeration that identifies this record 
//  Ensure the headers and footer were set correctly.... 
//  Not sure if any tools write files like this, but Excel reads them OK 
//  https://poi.apache.org/spreadsheet/quick-guide.html#Hyperlinks 
//  sid, length   bof   flags   str-len. unicode flag   string data 
// Absolute path notation - different device 
//  Row is null since we deleted it. 
//  it doesn't have any styles   second char run is 17 long 
//  padding 
//  Also adds 4 bytes to hold the length 
//  The column width returned by HSSF and the width of a picture when   positioned to exactly cover one cell are different by almost exactly   2mm - give or take rounding errors. This constant allows that   additional amount to be accounted for when calculating how many   celles the image ought to overlie. 
//  save memory by just using the cell itself as the identity key   Note - this assumes SXSSFCell has not overridden hashCode and equals 
//  cases with three ranges 
//  bullet is valid, so increment i 
//  Used to blow up with an IllegalArgumentException 
//  by default line break has the font size of the last text run 
//  -1 just in case this column is collapsed later. 
//  610 -- 0x0262; 614 == 0x0266 
//  Check slide 1 is as expected 
// numbers are treated as word breaks  nothing happens with ascii punctuation that is not upper or lower case  nothing happens with unicode punctuation (section sign) that is not upper or lower case  nothing happens with ascii punctuation that is not upper or lower case  acronyms are not special  leading whitespace is ignored 
//  Defaults are odd 
//  Ensure we really found a Document record earlier 
//  1. sheet is outside moved sheets, no change necessary 
//  Ensure that we have a BOOK entry 
//  ignored?   lower left   lower left 
//  Now create all the relationships   (Need to create relationships before other    parts, otherwise we might create a part before 
//  Sanity Checking - we're always 40 bytes long 
//  print draft quality 
//  A 32-bit signed integer that specifies the logical x-coordinate of the upper-left 
//  Check can't shift where would overshoot 
//  end public interface BlockWritable 
// Set the default style for the pivot table 
//  attempt to overwrite a row that is already flushed to disk 
// Excel seems to max out after 128 info records.  This isn't really documented anywhere... 
//  the line chart on secondary axis 
//  height. 
//  center of rotation relative to self 
//  skip Parentheses, Attr, etc 
//  extract the payload 
// Test the cell formula 
//  "=SUMIFS(A2:A9, B2:B8, "<>Bananas", C2:C9, 1)" 
// Add the row header to the sheet 
//  check row numbers to make sure they are continuous and increasing (monotonic) 
//  sometimes the placeable header is filled/aligned to dwords. 
//  Blank 
//  To track formats and encodings 
//  Should find 4 slides 
//  aim is to get these classes loaded and included in poi-ooxml-schemas.jar 
/* 		 * Data taken from offset 0x0224 in		 * attachment 23468 from bugzilla 47001		  */
//  short side div 2 
// read cell info and check for missing comments 
//  lv1 
//  usually the shape name has its index based on the n-th embeding, but having   the prototype separate from the actual updating of the object, we use the shape id 
// re-create the removed row and cell 
// A2 -> 5.0   B2 -> A1 -> "hello"   A3 -> A2 -> 5.0   B3 -> B2 -> A1 -> "hello"  Sheet2!A1 -> Sheet1!A2 -> 5.0 
//  POI 3 
//  The default footer is an odd footer 
//         this.background = background; 
//  put the ending offset of the last property into the plcf. 
//  And set with the Charset index 
//  does match blank 
//  HeaderSize (2 bytes):  A 16-bit unsigned integer that defines the number 
//  sum of all values in the 1st row: 1 + 2 + 3 = 6 
// &B == bold  &E == double underline 
/*  Write the sections themselves.  */
//  8 @ 28 
//  Create a 2 block stream, will become a 3 block one 
//  Each attachment should have 6 normal attributes, and  
//  ensure that CTPhoneticRun is loaded by the ooxml test suite so that it is included in poi-ooxml-schemas 
//  end of area is preserved (will remain exact same row)   the top area row is moved simply 
//  this also removes the password for non encrypted files 
//     .fontindex       = 0      .formatindex     = 0      .celloptions     = fffffff5            .islocked  = true            .ishidden  = false            .recordtype= 1            .parentidx = fff      .alignmentoptions= 20            .alignment = 0            .wraptext  = false            .valignment= 2            .justlast  = 0            .rotation  = 0      .indentionoptions= 0            .indent    = 0            .shrinktoft= false            .mergecells= false            .readngordr= 0            .formatflag= false            .fontflag  = false            .prntalgnmt= false            .borderflag= false            .paternflag= false            .celloption= false      .borderoptns     = 0            .lftln     = 0            .rgtln     = 0            .topln     = 0            .btmln     = 0      .paleteoptns     = 0            .leftborder= 0            .rghtborder= 0            .diag      = 0      .paleteoptn2     = 0            .topborder = 0            .botmborder= 0            .adtldiag  = 0            .diaglnstyl= 0            .fillpattrn= 0      .fillpaloptn     = 20c0            .foreground= 40            .background= 41 
//  Check we got the sheet and the contents 
//  Header 
// TestXSSFReader.class, //converted to junit4 
//  happens for GETPIVOTDATA 
//  Find the PowerPoint bit, and get out the bytes 
//  Store in the appropriate record 
//  Assert 
//  Ensure these numbers are valid 
//  header opcode   pic size dummy 
//  When the comment box is visible, have it show in a 1x3 space 
//  Master sheet + master notes + 2 slides + 2 notes + document 
//  Add a single block one 
// get any Nums 
//  accessing directly is an optimisation 
//  Much guess-work going on here due to lack of any documentation.   See similar source code in OOO:   http://svn.services.openoffice.org/ooo/trunk/sc/source/filter/excel/xiescher.cxx   1223 void XclImpOleObj::ReadPictFmla( XclImpStream& rStrm, sal_uInt16 nRecSize ) 
//  Written by Excel 2007   rawData is multiple of 12 bytes long   appears after last cell value record and before WINDOW2 or drawing records 
//  Find the Document, and interesting things in it 
//  Row 21 
//  -1 for all 
//  POI 1 
//  As of 2015-12-27, there is no way to override a built-in number format with POI XSSFWorkbook 
//  declare a cell object reference 
//  Has one slide 
//  The first paragraph added using createParagraph() should   have the required footnote reference added to the first   run. 
/*          * The PlfLst structure contains the list formatting information for the         * document. -- Page 425 of 621. [MS-DOC] -- v20110315 Word (.doc)         * Binary File Format          */
//  So, treat it as a regular HSLF PPT one 
//  initialize hotspot diagnostic MBean 
//  already read sid of next record. so current one is finished 
//  only print slide layout, if it's a different instance 
//  PICT zip-stream can be erroneous, so we clear the array to determine   the maximum of read bytes, after the inflater crashed 
// collapse - 2 
//  Row 20 
//  for 2 columns, so now 
//  Can't work for Read-Only files 
//  bug 61381 
// //// Case 17: Evaluate "Table1[[#This Row], [col1]]" //////// 
//  add at the beginning 
//  EncryptionVersionInfo (4 bytes): A Version structure (section 2.1.4), where    Version.vMajor MUST be 0x0004 and Version.vMinor MUST be 0x0004 
//  - no change to the area 
//  no-arg constructor 
//   need to apply our normal validation rules 
//  A 32-bit PointS Object that specifies a point for the object dimensions.   The x-coordinate is the pen width. The y-coordinate is ignored. 
//  Change the Comment2000Atom 
//  in order to reduce the number of false positives we run it a few times before we fail,  
//  Only first column should move 
// collapse - 3 
//  Specifies that this point starts a disjoint figure. This point becomes the new current position. 
//  The following constants declared by the Microsoft Office Visio type   library show return values for the FromPart property.   Constant Value   visConnectFromError -1   visFromNone 0   visLeftEdge 1   visCenterEdge 2   visRightEdge 3   visBottomEdge 4   visMiddleEdge 5   visTopEdge 6   visBeginX 7   visBeginY 8   visBegin 9   visEndX 10   visEndY 11   visEnd 12   visFromAngle 13   visFromPin 14   visControlPoint 100 + zero-based row index (for example, visControlPoint   = 100 if the control point is in row 0; visControlPoint = 101 if the   control point is in row 1) 
//   it happens to be spelled. 
//  some files have "Workbook" instead 
//  stored with a special name 
//  check active sheet 
//  end of bitfields. 
/*  Yes, the current document is a property set stream.                     * Let's create a PropertySet instance from it.  */
//  --> Initialize from the initial code array (see below), depending on the passwords length.  
//  An array of 16-bit signed integers that define the coordinates of the polygons.   (Note: MS-WMF wrongly says unsigned integers ...) 
//  Now with another file only containing master text 
//  setting a precalculated int value works as expected 
//  Clone drawing relations 
//  align is set in autoshape prototype 
//  Because of missing 0-paddings in the original input files, the bytes might differ.   This fixes the comparison 
//  previous selection should be cleared 
// nominally 4 
//  As currently implemented, cell value is copied but merged region is not copied 
//  Note - for start_num arg, blank/zero causes error(#VALUE!), 
//  bug 60260: renaming a sheet with a named range referring to a unicode (non-ASCII) sheet name 
//  this test passes before the fix for 59814 
//  A 16-bit unsigned integer that defines the number of planes for the target 
//  See http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#cg 
//  Check before the optimise 
//  confirm default activation/selection 
//  aka star in native 
//  verify that we have enough data 
//  Maybe it's a string? who knows! 
//  Row '5' 
//  1904 windowing 
//  Excel Workbook - OpenXML file format 
//  Shift it down one row 
//  org.apache.poi.hwpf.converter 
//  setup for this testcase 
//  text is interesting 
//  26 
//  Create a new document from scratch 
//  Notes 
//  append the text for each footer type in the same order   they are appended in XSSFExcelExtractor 
//  Current bug in XSSF:   Call stack:     XSSFWorkbook.write(OutputStream)     XSSFWorkbook.commit()     XSSFWorkbook.saveNamedRanges()   This dumps the current namedRanges to CTDefinedName and writes these to the CTWorkbook   Then the XSSFName namedRanges list is cleared and rebuilt   Thus, any XSSFName object becomes invalid after a write 
//  get the page number for the first fkp 
//  need bouncycastle provider for this one ... 
//  when criteria is numeric 
//  first byte needs to be 0 for unsigned BigInteger 
//  some old files are not detected correctly 
//  YK: in some cases records can be moved to the preceding 
//  a file or a folder full of files. 
//  If hyperlink is fully contained in the rows that will be overwritten, delete the hyperlink 
//  Second child should be the ExOleObjAtom 
//  set inside vertical border 
//  adjust active sheet 
//  out of range 
// ther meaning is unknown 
//  result of multiplying the current y-extent by the value of the yNum member. 
//  strLen, optionFlags 
//  toplevel shapes only 
//  rows containing area bottom being shifted up: 
//  Ensure it swapped over 
//  sprmCHpsBi 
/*  Handling the document summary information is analogous to handling             * the summary information. An additional feature, however, are the             * custom properties.  */
//  Does nothing and ignores closing the wrapped stream 
/*  Create a mutable property set with a section that does not have the         * formatID set:  */
// private static final int DEFAULT_HEIGHT_BIT = 0x8000; 
//  so make a dummy FuncVarPtg for that call. 
/*  Print the list of sections:  */
//  handle (a) and (b) 
//  used to be "B3*C1-C2" 
//  A 32-bit unsigned integer that specifies text alignment by using a mask of text alignment flags.   These are either WMF TextAlignmentMode Flags for text with a horizontal baseline,   or WMF VerticalTextAlignmentMode Flags for text with a vertical baseline.   Only one value can be chosen from those that affect horizontal and vertical alignment. 
//  Sync the associated range 
//  RPHSSub 
/*  cached values  */
// make sure that the footer only appears once 
//  Add a new Normal Stream (Normal Streams minimum 4096 bytes) 
//  Finally, find all our streams 
//  sometimes there are namespaces sometimes not. 
//  don't search for RecordTypes.StyleTextPropAtom.typeID here ... see findStyleAtomPresent below 
//  // First up, trigger a full-recalculate   // Needed in case of deletes etc   getOverallRange();   
//  Return the newly created drawing 
// rows are sorted: {0, 1, 2} 
//  see DocumentAtom.SlideSize 
//  Ensure we can fetch those as custom ones 
//  application/vnd.openxmlformats-officedocument.spreadsheetml.sheet 
//  0 
//  named range or table? 
//  Try again in case there's multiple 
//  Now we have blank cell A4 
//  A 32-bit floating-point value that specifies the width of the arrow cap.   The width of the arrow cap is scaled by the width of the EmfPlusPen object that is used to draw the   line being capped. For example, when drawing a capped line with a pen that has a width of 5 pixels, 
//  for all other argument types the result is empty string 
//  Simple file 
//  a test-case to test all .ppt files without executing the full TestAllFiles 
//  Font collection should contain 3 fonts 
//  Check this sheet has an autofilter, (which has a built-in NameRecord at workbook level) 
//  Create an empty block 
//  update this if a longer pattern is added 
// this test case was triggered by Tika-1130 
//  flush all remaining data and close the temp file writer 
//  Save it and re-check 
//  Relative part name 
//  Save and manually verify that on column C we have now 13, calculated value 
//  noHeaderFooter47244.xls was created by a slightly modified POI   which omitted the HEADER/FOOTER records 
//  "; charset=ISO-8859-1"); 
//  application/msword 
//  table in the DIB header. This value MUST be in the DIBColors enumeration 
//  verify  AutoFilterInfoRecord 
//  get a reference to a line style within the style matrix. 
//  If the column is wider than the image. 
// as mentioned above, this ignores the exact space formatting in Excel 
//  ignore header size 
//  p;n;z;s parts 
//  Mark as done 
//  Is the name a valid $A$1 cell reference 
//  Throwing exceptions is okay. 
//  286: GAMMADIST 
//  Shift the 4th row up into the gap in the 3rd row 
// nominally 1 
//  both mean the same 
//  We're a new External Link Table, so nothing to remove 
//  Now build up a new one 
//  Write out and back in 
//  i.e. when shifting down, start from down and go up, when shifting up, vice-versa 
//  write out the CHPBinTable. 
//  Evaluate the cells 
//  workbookName or sheetName needs quoting   quotes go around both 
//  Next two are for the two slides 
//  Step down:   8 -> 4 -> 5 -> 1 -> 0 == String 
//  exemption for #60294 
//  this method is ALWAYS called after construction -- using   the nontrivial constructor, of course -- so this is where 
//  THE FOLLOWING THREE LINES ARE THE MAIN CHANGE compared to the non-streaming version: use the SXSSF sheet,   not the XSSF sheet (which never contais rows when using SXSSF) 
//  Check it didn't get changed 
//  support for value[space]% 
//  test cases for newer versions of Excel where d can be negative for 
//  not [128, 0, 0] 
// 1 property found 
//  de-reference area ref (note formula is in C4) 
//  Check for special cases 
//  the new facet needs to be inserted before the current facet 
//  Row 22 
//  XSSF Workbook gives helpful error 
//  Setup the inline with 0 margin 
//  New row has last col -1 
//  NULL_PEN - A null pen   PenStyle: PS_NULL 
//  make sure ptg has single private constructor because map lookups assume singleton keys 
//  Check we find a few numbers we expect in there 
//  Create the Chunk+Pointer Factories for the document version 
//  okay 
//  placeholder for tAttrIf 
//  Check it has some slides 
//  Check the normal bits 
//  For tracking what we've written out, so far 
//  create a ExternalNameRecord that will describe this name 
//  V4 and V5 never has trailers 
//  the code here seems to depend on complexData already being   sized correctly via the constructor 
//  Open the workbook and then create the FormulaEvaluator and   DataFormatter instances that will be needed to, respectively,   force evaluation of forumlae found in cells and create a   formatted String encapsulating the cells contents. 
// Getting its reference 
//  http://www.oracle.com/technetwork/articles/javase/dig-signature-api-140772.html 
//  File  wb = new SXSSFWorkbook(new XSSFWorkbook(file));  assertCloseDoesNotModifyFile(filename, wb); 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getValidationConstraint()      */
//  Check sizes 
//  we've fully matched the pattern and are returning bytes from the replacement 
//  this is an if statement without a false param (as opposed to MissingArgPtg as the false param)  i++; 
// test reading/serializing of a PNG blip 
//  Update the r:id 
//  but these extractors modify the document,   which is a no-go for this Word 6.0 file 
//  sheet1 A1 
//  longer time spans 
//   isn't tagged as doing so. Try stepping in anyway 
//  Last one is blank 
//  URI fragment 
//  for some file-types also run OPCFileHandler 
//  The negative number format has the negative formatting required,   e.g. minus sign or brackets, so pass a positive value so that   the default leading minus sign is not also output 
//  valid prefix is 'D' 
// //// Evaluate "Table1[[#Data],[col]]" //////// 
//  And how long it is   (Un-compressed codes are 1 byte each, compressed codes 
//  2 == "0.".length() 
//  A fairly complex file 
//  calls System.exit(): PPDrawingTextListing.main(new String[0]); 
//  Normally seems to be 1 
//  Create the bottom border style so we know what a border is supposed to look like 
//  Records ~12050 seem to be related to Document Encryption 
//  Set a new default row height in points and test getting the value in twips 
//  Now try to change it 
// short -- no need to safely allocate 
//  DEFAULT_PALETTE   The default palette that is defined for the current output device. 
//  No link recorded, nothing we can do 
//  check table size (+1 for the header row) 
//  DC_BRUSH   The solid-color brush that is currently selected in the playback device context. 
/*  original line  */
//  sometimes binary format has XML-format-extension... 
//  the two strokes to use 
//  create the time-stamp 
//  If the source is the root, then the relativized 
// The rowNum is 0 based 
// label 
//  2 rows   TRUE 
// == is intentionally not .equals()!  == is intentionally not .equals()! 
//  manually check the file to make sure the cell is rendered as "<poundsymbol>5"   Verified with LibreOffice 4.2.8.2 on 2015-12-28 
//  don't let text overlay the bullet and advance by the bullet width 
//  findColumnIndex should return -1 if no column header name matches 
//  note: BigInteger for extra safety 
//  already set, when we would try to change the locale by then 
//  Really no special quantifiers 
//  rethrow exception 
//  sum of all values in the 3rd column: 3 + 6 + 9 = 18 
//  Create as appropriate 
//  spit out the final grpprl 
//  Shift the 2nd row up to the first one 
//  Without reassignment here, an XmlValueDisconnectedException may occur 
//  Create the workbook with 1 sheet which contains 3 rows 
//  magenta 
//  the pattern could not be parsed correctly,   so fall back to the default number format 
//  Tell the currently evaluating cell frame that it has a dependency on the specified 
//  Delete both the files 
//  more than 32 title fail for HSSFWorkbook 
//  end public interface BATManaged 
//  A 32-bit unsigned integer that specifies the number of entries. 
//  1st read works 
// begin of interface implementation 
//  Check current text 
//  TODO track the XFs and Format Strings 
//  create named range for a single cell using areareference 
//  validation methods should detect a problem with previously added merged regions (runs in O(n^2) time) 
//  All records 
//  Would adding module.read(in) here be correct? 
//  Condition 1: Formula Is   =A2=A1   (White Font) 
//  if your series have missing values like https://stackoverflow.com/questions/29014848   chart.displayBlanksAs(DisplayBlanks.GAP); 
//  Change the current setting 
//  Write out, read, and check 
//  line spacing 80   paragprah is 28 long 
// ////////////////////////////// From Stream ///////////////////////////// 
//  Write out empty header / footer records if these are missing 
//  ./p:sp/p:txBody/a:lstStyle/a:lvl1pPr 
//  Check we don't break loading the pictures 
//  0:default mode, 1:fallback mode 
//  Normal, red, normal, blue+bold, normal 
//  else - rows have moved completely outside the area ref,   or still remain completely within the area ref 
//  Skip the header row, therefore "+ 1" 
//  Same paragraph styles 
//  unused from this point down 
//  Array data 
//  it may also make sense to have an @Internal method to convert STPatternType.Enum   but may cause errors if poi-ooxml.jar is not on the classpath 
//  Prepare for this row 
//  note - when quoted, sheetName can   start/end with whitespace 
//  Integer integer = Integer.valueOf(row.getRowNumber()); 
//  Background 2, darker 10%   YK: PPT shows slightly different color: new Color(221, 217, 195) 
//  Check the properties 
//  Greek "mu" symbol 
//  (1). See that there is a problem with the old case-sensitive property comparator 
//  comment in row 0 is gone 
// OK string appears to be equal but now lets compare formatting runs 
//  populate cells B1..F1 with simple formulas instead of plain values so we can use 
//  make this column a bit wider 
//  Convert, setup and return 
//  create the row record on the fly now. 
//  zero length   unicode options byte 
//  From a real file (embedded SWF control) 
//  when called by user code, fix the size to be valid for the header 
// do we need to store sheetId, too? 
//  A bit that specifies whether the newEAFontRef field of the TextCFException10 structure that contains this CFMasks exists.   A bit that specifies whether the csFontRef field of the TextCFException10 structure that contains this CFMasks exists.   A bit that specifies whether the pp11ext field of the TextCFException10 structure that contains this CFMasks exists. 
//  sprmCRsidProp 
//  Icons : 3 signs - Column I 
//  + or - directly next to a number is parsed with the number 
// Read the number of rich runs if rich text. 
/* 	 * (non-Javadoc)	 * 	 * @see	 * org.apache.poi.ss.usermodel.DataValidationHelper#createNumericConstraint	 * (int, java.lang.String, java.lang.String)	  */
//  Make copy since CellRangeAddress is mutable. 
//  ExternalFunction is a FreeRefFunction, nominally 255 
//  identify the source file 
//  POI column 3, OOXML column 4 
//  track new columns 
//  Prepare to copy 
//  setting line width to zero unsets the W attribute 
//  4 sheets, move a sheet from pos 2 to pos 0, i.e. current 0 becomes 1, current 1 becomes pos 2  
//  deletes are automagically propagated 
//  currently not supported 
/*  find where the deleted area overlaps with this text piece  */
//  check by index 
//  Decide where we're going to put them 
//  Then Text 
//  update mode for closePath handling below 
//  Columns moved include the last column of the area ref, but not the first   btw: (aFirstColumn < _firstMovedIndex) 
//    
//  Text Objects can have simple reference formulas   (This bit not mentioned in the MS document) 
//  Is it a formula one? 
//  To enable newlines you need set a cell styles with wrap=true 
//  '? = multiple values 
//  While we have text in need of paragraph stylings, go ahead and   grok the contents as paragraph formatting data 
// build a tree of POIXMLDocumentParts, this workbook being the root 
//  IntPtg(0)   DividePtg 
// the char that is logically trailing in Big5 encoding 
//  special case, if last text paragraph or run is empty, we will reuse it 
//  Copy in the RTF constants  
//  Validate the header on the front of the RTF 
//  mask out random crap in upper byte 
//  Serialize and read again 
//  call getTextHeight, when table is not fully populated 
/*      * Open {@code doc3} for reading and check summary information     * and document summary information. All properties removed before must not     * be found in the property streams of {@code doc3}.      */
//  doesn't happen 
//  also acceptable: Table!C3 
//  no instance of this class 
//  Columns are 0 based 
//  A 32-bit unsigned integer that specifies the number of elements in the DashedLineData field. 
//  Row '96' 
//   FAT, XFAT or Property Table. Ensure it does 
//  just dollars ? can this happen? 
//  the total may have been padded to the nearest quad-byte length 
//  starting with JDK 9 such unimportant whitespaces may be trimmed 
//  any error in an array item propagates up 
//  Will be properties on an attachment or recipient 
//  Try to read numCharacterRuns, see bug 50060 
//  height div 3 
//  0 is the empty default 
/*  manually assemble a new image package part */
//  Valid ones first 
//  Ensure they're the same 
//  add overhead of six records 
/*  check if a series was found  */
//  reverse angle for awt 
//  remember the initial transform 
//  Verify the chart was copied 
//  Format of this bit appears to be l=<id>-<time>-<number>   ID may contain hyphens. 
//  name index increased by one 
//  Get the details on this font 
//  Formula referencing one cell 
// no idea what these 3 bytes do 
//  Caller will save the resultant POIFSFileSystem to the stream/file 
//  check replace with longer text 
//  Process external hyperlinks for the sheet, if there are any 
//  height div 2 
//  nothing useful to be done for this case 
//  Handle any encoding aliases, where outlook describes it differently 
// now we can use all methods to modify charts in XWPFDocument 
//  hack to tell the difference between formula and plain value   perhaps the API could be improved: onChangeFromBlankToValue, onChangeFromBlankToFormula 
//  use "MS PGothic" if available (Windows only) ... 
//  Bug 60329: style with missing StyleID throws NPE 
// validated 
//  Change Font size and name 
//  Unsigned Integers 
//  TSP signer certificates retrieval 
//  EmfPlusBoundaryPathData object; otherwise, this field MUST contain an EmfPlusBoundaryPointData object. 
//  then draw the (dashed) line 
//  present in both but NULL except in cell records 
//  Build up the model level Slides and Notes 
//  arguments/result for this function 
//  If result is shorter than field, pretend there are leading zeros 
//  internal margins for the text box 
// the span is now splitted into three parts  <cols>    <col min="2" max="2" customWidth="true" width="12.0" />    <col min="3" max="3" customWidth="true" width="12.0" hidden="true"/>    <col min="4" max="4" customWidth="true" width="12.0"/>    <col min="7" max="7" customWidth="true" width="10.85546875" hidden="true"/>  </cols> 
//  181 onwards is free 
//   non unicode text in the file 
//  sprmCPropRMark -- 0xCA57 
//  0 0x01 - Reserved bit must be 0 
//  Check first 8 bytes 
//  redirect standard out during the test to avoid spamming the console with output 
/*  Read the custom properties. If there are no custom properties yet,             * the application has to create a new CustomProperties object. It will             * serve as a container for custom properties.  */
//  Column 1 has a font with regular colours 
//  in order to verify that there is no third param, we need to check   if we really have the IF next or some other FuncVarPtg as third param, e.g. ROW()/COLUMN()! 
//  Write the workbook to a file 
//  Create the header 
//  Fill it in 
/* long hsShtat = */
// At one point in development there were three copies of the text. 
//  sum of the frequency bins should add up to the number of data values 
//  i.e. from down to up if shifting down, vice-versa otherwise 
//  numbering to be used at each level 
//  The intersection operator is a space.  We track whether the run of    whitespace preceding "look" counts as an intersection operator. 
//  Only the first two format parts can have conditions 
//  Get the persist reference for the document persist object 
//  read all available bytes and not just "stringLength * 1(ansi)/2(unicode)"   in case we need to deal with surrogate pairs 
//  Check some numbers 
//  Not found 
/*  Read the property set streams from the POI filesystem just         * created.  */
//  org.apache.poi.hwpf.extractor 
// left margin is custom, all others are default 
//  only evaluate non empty row 
//  level 3: title placeholder on the slide layout 
//  Note: Values in arrays are in ascending order since LOOKUP expects that in order to work properly  		 column  		 A B C  	   +-------   row 1 | P Q R 
// import org.apache.poi.hssf.record.Feat11Record;  import org.apache.poi.hssf.record.Feat12Record; 
//  wrap to avoid temp warning method about auto-closing input stream 
//  Types taken from http://msdn.microsoft.com/en-us/library/microsoft.exchange.data.contenttypes.tnef.tnefattributetype%28v=EXCHG.140%29.aspx 
// make it red 
//  first check a file with 1900 Date Windowing 
//  And another file 
//  remove any existing paragraphs 
//  Check this one for being a duplicate    of an earlier one 
//  If we've reached the end of the sheet data, output any    comments we haven't yet already handled 
//  no point leaving the flag erroneously set 
//  Not a valid fraction formats (too many #/# or ?/?) - hence the strange expected results 
//  move the cells 
// lazily computed 
//  97 -> 98 -> 100 -> end 
//  for faster binary search 
//  Third is 25 long and red 
//  Now, write it out, and read it back in again fully 
//  drop time portion if present 
//  Increment the mask bit count, we've done another code 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getSuppressDropDownArrow()      */
// 490  495  990  99  49 
// fetching sheets by name is case-insensitive 
//  16 bit unsigned integer 
//  Get the master persists 
//  A 32-bit unsigned integer that defines the brush, the content of which is determined by   the SOLID_COLOR bit in the Flags field.   If SOLID_COLOR is set, BrushId specifies a color as an EmfPlusARGB object.   If clear, BrushId contains the index of an EmfPlusBrush object in the EMF+ Object Table. 
// &D == date 
//  Write out normally, will loose the macro stream 
//  If the specified partis flagged as deleted, we make it   available 
/*  cloneSheet() not implemented  */
//  awesome ;) 
//  Use the sheetname and process 
//  The target column is at either end of the multi-column ColumnInfo ci   we'll just divide the info and create a new one 
//  Clear 
//  Save it to the same file - not allowed 
//  verify signature 
/*  Create the new entry.  */
//  Change the string 
//  A 32-bit signed integer that defines the units of the SrcRect field. 
//  Propagate isUsed for duplicates and always set user styles to being used to never optimize them away 
//  NULL MUST be present, after which the remainder of this field MUST be ignored. 
// sample data to fill the sheet. 
//  The format of records in a powerpoint file are:     <little endian 2 byte "info">     <little endian 2 byte "type">     <little endian 4 byte "length">   If it has a zero length, following it will be another record  		<xx xx yy yy 00 00 00 00> <xx xx yy yy zz zz zz zz>   If it has a length, depending on its type it may have children or data   If it has children, these will follow straight away  		<xx xx yy yy zz zz zz zz <xx xx yy yy zz zz zz zz>>   If it has data, this will come straigh after, and run for the length        <xx xx yy yy zz zz zz zz dd dd dd dd dd dd dd>   All lengths given exclude the 8 byte record header   (Data records are known as Atoms) 
//  Create a cell at A2 and insert a plain list - that is one 
//  TRUE=TRUE=2=2  evaluates to FALSE 
//  check we found the time properly 
//  height div 8 
//  Findbugs: URF_UNREAD_FIELD. Do not delete without understanding how this class works. 
//  An array of 32-bit unsigned integers that specify the output spacing between the origins of adjacent   character cells in logical units. The location of this field is specified by the value of offDx   in bytes from the start of this record. If spacing is defined, this field contains the same number   of values as characters in the output string.     If the Options field of the EmrText object contains the ETO_PDY flag, then this buffer   contains twice as many values as there are characters in the output string, one   horizontal and one vertical offset for each, in that order.     If ETO_RTLREADING is specified, characters are laid right to left instead of left to right.   No other options affect the interpretation of this field. 
//  Column C   Column G 
/*              * also for backward-compatibility with prev. versions of POI             * --sergey              */
/*  Execute the test task.  */
//  A signed integer that defines the vertical extent of the viewport in device units. 
// insert header row 
//  Read the reserved bytes  
//  init built-in formats 
//  not a valid string value, but not blank 
//  check the two fonts 
//  Some badly designed methods - eg the servlet API - overload length   such that "-1" means stream finished 
//   PowerPoint stream 
//  the hmacs of the file always differ, as we use PKCS5-padding to pad the bytes   whereas office just uses random bytes   byte integrityHash[] = d.getIntegrityHmacValue(); 
//  Now, check ISNUMBER / ISTEXT / ISNONTEXT 
//  natural order   natural order 
//  first line indentation   hanging indentation: the first line start at the left margin 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#setOperator(int)	  */
//  Read the Excel file and verify its content 
/*  Parameters for test case  */
//  create anchor 
//  Put things back 
//  dump the first few bytes 
//  x2 on sheet2 defines "x=2" 
//  Then invalid ones 
//  column D: red bold text on yellow background 
//  First two slides have comments 
//  #2 pass - assign shape to table cells 
//  crappy names are because this is really one big short field (2byte)   but the docs inconsistently use it as 2 separate bytes 
//  check that parsed Ptg array converts back to formula text OK 
//  ignore endCap for now 
//  Updating cell formula, causing it to become unshared 
//  one more continuation record with 1 byte of data 
//  A 32-bit unsigned integer that defines the number of color indexes that are 
//  The workbook overrides this default format 
//  scan through the image to find the black box after the truncated data 
//  height div 5 
//  the index of the closest remaining sheet to the one just deleted 
//  create test InputStream 
//  One more mini-block will be used 
//  Add in to the list of Slides 
// First row of the hyperlink  Last row of the hyperlink 
//  Excludes 4 byte header 
//  Do the save 
//  this line is intended to compute how "November" would look like in the current locale 
// For each column, create a cache field and give it en empty sharedItems 
//  See if we can get a suitable encoding for any 
//  A 32-bit unsigned integer that specifies the offset, in bytes, from the 
//  ds:Reference with external digest value 
//  with format "yyyy-dd-MM HH:mm:ss" into "2016-23-51 08:51:01". 
//  Add Subtract Formula 
//  Reset to a fresh run so we test case of run not having property at all 
//  assigned to the class level member 
//  all top level records are position dependent 
//  Row index 1 -> 11 (row "2" -> row "12") 
//  Excel (2007) seems to choose 16bit regardless of whether it is needed 
//  EvaluationListener to check which parts of the first formula get evaluated 
//  store grpprl at hugeGrpprlOffset   grpprl.length-2 because we don't store the istd   System.arraycopy( grpprl, 2, dataStream, hugeGrpprlOffset +   2,   grpprl.length - 2 ); 
/*          * The shape id of the ole object seems to be a legacy shape id.         *         * see 5.3.2.1 legacyDrawing (Legacy Drawing Object): Legacy Shape ID         * that is unique throughout the entire document. Legacy shape IDs         * should be assigned based on which portion of the document the drawing         * resides on. The assignment of these ids is broken down into clusters         * of 1024 values. The first cluster is 1-1024, the second 1025-2048 and         * so on.         *         * Ole shapes seem to start with 1025 on the first sheet ... and not         * sure, if the ids need to be reindexed when sheets are removed or more         * than 1024 shapes are on a given sheet (see #51332 for a similar         * issue)          */
//  height div 4 
//  URI fragemnts (those starting with '#') are not encoded 
//  BIFF header 
//  now via wb.setSheetName 
//  Replace any newlines with spaces, otherwise it    breaks the output 
//  Base properties. 
//  Set the default name of the table.  This must not conflict with any defined names. 
//  http://services.globaltrustfinder.com/adss/tsa 
//  check the file size first, in case we are working on uncompressed streams 
// Can there be more than one BOF for a sheet? If not then we can 
//  emfs are sometimes truncated, read as much as possible 
//  Ensure that core properties are added if missing 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#setExplicitListValues(java.lang.String[])	  */
//  Normally should happen only in developement phase, so just throw   exception 
// re-create the removed cell 
//  test reading zero 
//  Custom/Unknown, skip 
//  set up the fc 
//  Check to ensure that a row was recovered from the sheet as it is   possible that one or more rows between other populated rows could be   missing - blank. If the row does contain cells then... 
//  TRUE 
//         assertEquals(IndexedColors.RED.index, fmt3.getFontColorIndex()); 
//  column B: #,##0 
//  check replace with shorter text 
//  extract encrypted ooxml file and write to custom encrypted zip file 
//  TextObjectRecord.sid   size 18 
//  create a new file 
//  Custom Validation type 
//  bits 5-6 in the _flags specify the type   of selection behavior this list control is expected to support 
//  Match so far, good 
//  same as star_16, but twice in native 
//   yet to add 
//  start of this record to the source bitmap bits. 
//  0xf020 space   0xf021 exclam   0xf022 universal   0xf023 numbersign   0xf024 existential   0xf025 percent   0xf026 ampersand   0xf027 suchthat   0xf028 parenleft   0xf029 parentright   0xf02a asteriskmath   0xf02b plus   0xf02c comma   0xf02d minus sign (long -)   0xf02e period   0xf02f slash   0xf030 0   0xf031 1   0xf032 2   0xf033 3   0xf034 4   0xf035 5   0xf036 6   0xf037 7   0xf038 8   0xf039 9   0xf03a colon   0xf03b semicolon   0xf03c less   0xf03d equal   0xf03e greater   0xf03f question   0xf040 congruent   0xf041 alpha (upper)   0xf042 beta (upper)   0xf043 chi (upper)   0xf044 delta (upper)   0xf045 epsilon (upper)   0xf046 phi (upper)   0xf047 gamma (upper)   0xf048 eta (upper)   0xf049 iota (upper)   0xf04a theta1 (lower)   0xf04b kappa (upper)   0xf04c lambda (upper)   0xf04d mu (upper)   0xf04e nu (upper)   0xf04f omicron (upper)   0xf050 pi (upper)   0xf051 theta (upper)   0xf052 rho (upper)   0xf053 sigma (upper)   0xf054 tau (upper)   0xf055 upsilon (upper)   0xf056 simga1 (lower)   0xf057 omega (upper)   0xf058 xi (upper)   0xf059 psi (upper)   0xf05a zeta (upper)   0xf05b bracketleft   0xf05c therefore   0xf05d bracketright   0xf05e perpendicular   0xf05f underscore   0xf060 radicalex (doesn't exist in unicode)   0xf061 alpha (lower)   0xf062 beta (lower)   0xf063 chi (lower)   0xf064 delta (lower)   0xf065 epsilon (lower)   0xf066 phi (lower)   0xf067 gamma (lower)   0xf068 eta (lower)   0xf069 iota (lower)   0xf06a phi1 (lower)   0xf06b kappa (lower)   0xf06c lambda (lower)   0xf06d mu (lower)   0xf06e nu (lower)   0xf06f omnicron (lower)   0xf070 pi (lower)   0xf071 theta (lower)   0xf072 rho (lower)   0xf073 sigma (lower)   0xf074 tau (lower)   0xf075 upsilon (lower)   0xf076 piv (lower)   0xf077 omega (lower)   0xf078 xi (lower)   0xf079 psi (lower)   0xf07a zeta (lower)   0xf07b braceleft   0xf07c bar   0xf07d braceright   0xf07e similar '~'   0xf07f not defined 
//  vertical center 
//  ensure that we are initialized 
//  QualifyingProperties 
//  height div 6 
//  make sure we are still readable 
//  Ensure the value presence / absence is consistent for the new type 
//  verify proper behavior with non-zero index 
//  It is fine for the other values to be zero 
//  One block of text within that 
//  No border set 
//     is getting on for black magic... 
//  end watermark paragraph 
//  Open via a HWPFDocument 
//  Had valid print settings before repeating 
//  unset the space before on null input 
//  Decompress 
//  data from these fields comes after the Ptg data of all tokens in current formula 
//  Last view is now of the slide 
//  cached for performance, used to format numeric cells for string comparisons.  See Bug #61764 for explanation 
//  Try by type 
// IRR-NPV relationship: NPV(IRR(values), values) = 0 
/*  Place the property into the section.  */
//  Bug 57165: We also need to check that the resulting file name is not already taken   this can happen when moving/cloning sheets 
// GUID is zero 
//  shouldn't happen, but just in case 
//  adds two new rercords 
// 6 characters wide 
//  boolean criteria 
//  copyRowFrom should update existing destRow, rather than creating a new row and reassigning the destRow pointer   to the new row (and allow the old row to be garbage collected)   this is mostly so existing references to rows that are overwritten are updated 
//  Evaluate specific cells and check results 
//  this cast might look strange - if the setters would be public, it will become obsolete 
/*  Read the POIFS:  */
//  current indent level for evalution; negative value for no output 
//  cells 
//  so the sheet record count should not change 
// expanded 
//  Files and descriptions 
//  verify behavior of getEntry 
//  Set modification flags to 1: by default options are not modified 
//     private NPOIFSFileSystem poifs; 
//  Filter everything 
//         assertEquals(IndexedColors.GREEN.index, fmt1.getFontColorIndex()); 
//  XAdES-EPES 
//  "ABCD"   "E" 
//  no default implementation -- skip 
//  int fcMin = docStream.getOffset(); 
//  Identified bug 46898 
//  get default 
//   than that for the last number 
// Also acceptable: SUM($H10:I$3), but this AreaReference isn't in ascending order 
//  field info 
// The first user-defined format starts at 164. 
//   so it gets properly cached 
// &F == workbook file name 
//  ArcTan Formula: "at2 x y" = arctan( y / z ) = value of this guide 
//  Should now be the same 
//  note that months in Calendar are zero-based, in LocalDateTime one-based 
//  97 should now be the end, and 98 free 
//  and the offset where the bitmap starts 
//  Optimize 
//  Copy over start and end, ignoring the 16 byte date field in the middle 
//  How much to skip for the num pointers + any extra data? 
//  default character properties for paragraphs with level=1 
// Getting it sheet name 
//  Size ranges due to different fonts on different machines 
//  SIDs from earlier BIFF versions 
//  Visio - ooxml 
//  Note - XmlBeans handles entity encoding for us, 
//  test the source 
//  Merge destCell's hyperlink to srcCell. Since destCell does have a hyperlink, this should copy destCell's hyperlink to srcCell. 
//  literal 
//  the positioning 
//  Then HTML 
//  shortening due to rounding 
// ruler internals 
//  Use style 
//  horizontal 
//  The value MUST be in the FamilyType enumeration table. 
//  y coordinate of first point on ellipse 
//  A is number 1 
//  (21 is mini fat, 22 is first mini stream block) 
// o_groupsNumber++; 
//  x% 
/* 		 * Pattern for media type.		 *		 * Don't allow comment, rule M1.15: The package implementer shall		 * require a content type that does not include comments and the format		 * designer shall specify such a content type.		 *		 * comment = "(" *( ctext | quoted-pair | comment ) ")"		 *		 * ctext = <any TEXT excluding "(" and ")">		 *		 * TEXT = <any OCTET except CTLs, but including LWS>		 *		 * LWS = [CRLF] 1*( SP | HT )		 *		 * CR = <US-ASCII CR, carriage return (13)>		 *		 * LF = <US-ASCII LF, linefeed (10)>		 *		 * SP = <US-ASCII SP, space (32)>		 *		 * HT = <US-ASCII HT, horizontal-tab (9)>		 *		 * quoted-pair = "\" CHAR		  */
//  unique to this shape on the page? 
//  first/second control point 
//  Iterating over the hours exposes any rounding issues. 
// remove the reference in the calculation chain 
//  as per BIFF8. (some old versions used 0x223) 
//  dealing with splines makes this more complex 
//  Shift front 1 back 
//  [wbB]BSheet1!B2 references (among other things) [wbA]AnotherSheet!A1:B2 
//  POI appends a trailing slash tpo avoid "Expected authority at index 13: javascript://"   https://issues.apache.org/bugzilla/show_bug.cgi?id=53734 
//  Verify comments are in the position expected 
// short circuit if fraction is 0 or 1 
//  unset old values   assuming no value for first is no values at all 
//  Simple strings 
//  Check rule M4.1 -> A format consumer shall consider more than   one core properties relationship for a package to be an error   (We just log it and move on, as real files break this!) 
//  Create row 
//  sprmPDtap -- 0x664a 
//  Try on headers 
//             retval.records.supbookpos = retval.records.bspos + 1;              retval.records.namepos    = retval.records.supbookpos + 1;          } 
//  assertArrayEquals(adOrig.getIntegrityHmacValue(), adReload.getIntegrityHmacValue()); 
//  fast saved only  applySprmPChgTabs (newPAP, varParam, opSize); 
//  [A1]   adjusted to [A]  A 
//   Docs "official" 
//  Write collapse field 
//  This is in contrast to the code below,, where NumberEvals values (for   example 0.01) *do* resolve to equivalent boolean values. 
//  ignore; 
//  It's a code, translate it if necessary 
//  sprmCBrc 
//  vertical alignment 
//  A is at 0x92, 0x92 
//  the "minor" axis, so this ratio does not have to be greater than 1. 
//  Easy inline string 
//  Open it read only, then close and delete - allowed 
//  sheet name with digit in the first position always requires delimiting 
//  can happen for older XML Parsers, e.g. we have a CI Job which runs with Xerces XML Parser 
//  size of the row gutter to the left of the rows   size of the column gutter above the columns   maximum outline level for row gutters   maximum outline level for column gutters 
//  Now a simpler file 
//  create a dummy sheet consisting of our test data 
//  Check that with a valid font, it's still ok 
//  Have a new one added 
//  this should be 12 as XSSFSimpleShape creates a default paragraph (no text), and then we added to that 
//  Strip off the null terminator if present 
//  Exports elements and attributes mapped with tables 
//  only allow a ConnectException because of timeout, we see this in Jenkins from time to time... 
//  Reserved data 
//  Invert first/last row, but refer to same area 
//  Both 
//  This one is allowed too 
//  cast is safe, the iterator is just defined using the interface 
//  check that the information was added successfully to the filesystem object 
//  StreamSize (8 bytes): An unsigned integer that specifies the number of bytes used by data   encrypted within the EncryptedData field, not including the size of the StreamSize field.   Note that the actual size of the \EncryptedPackage stream (1) can be larger than this   value, depending on the block size of the chosen encryption algorithm 
//  Skip over the header row 
//  in the xmlsec jar file 
//  And the macro itself 
//  Check the first one, links to 56737.xlsx 
//  note this should return the raw formula result, not the "unwrapped" version that returns a single value. 
//  as we haven't prepended the password length into the input array 
//  All use the default base style 
//    General codepage: Message codepage property. 
//  Case of a package created from scratch 
//  AttrPtg.class, // [volatile ] // POI doesn't do this yet (Apr 2009)   len 19   [A1:B2]   [C3:D4] 
// notify sheets 
//  Copy each cell from the source row to 
//  'refersToFormula' has not been set yet 
//  Add the default thresholds 
//  Give a generic error if the OLE2 signature isn't found 
//  Strip the [] wrapper, if still present 
//           {              short[] brcLeft = rgtc[x].getBrcLeft (); 
//  this won't have sheet references because we built the cell references without them 
//  calc settings block 
//  evaluate formula for cell refs then get their values 
// assertTrue("isSetCollapsed", !col.isSetCollapsed() || !col.getCollapsed());  assertFalse("getCollapsed", col.getCollapsed()); 
/*  handle case where MDETERM is operating on an array that that is not completely filled */
//  Copy the new file over the old one if save() succeed 
//  Re-check VLOOKUP one 
//  are automatic page breaks visible 
//  2^0   2^1   2^2   2^3   2^4   2^5   2^6   2^7   2^8   2^9   2^10   2^11   2^12   2^13   2^14   2^15 
//  assure they are in place:      [BOFRecord]      [CountryRecord]      [SUPBOOK Internal References  nSheets= 3]      [SUPBOOK Add-In Functions nSheets= 1]      [EXTERNALNAME .name    = ISODD]      [EXTERNSHEET]      [EOFRecord] 
//  Add the new Column 
//  Note - nChars is 8-bit 
//  Each cell conatins a fixed number of co-ordinate points; this number   does not vary with row height or column width or with font. These two   constants are defined below. 
//  real data from a real file! 
//  We assume we can continue, even in degraded mode ... 
//  This encoding depends on docId, password and stream position 
//  Don't close re-used test resources! 
//  Save this into the filesystem 
//  with one difference; a number prefixed to the items text. 
//  Following row 0, we should have 1, 2, then dummy, then 20+21+22 
//  Write out our children, and stuff them into the Escher layer 
// 495  499   995  999 
//  true, true   false, true   false, true   false, true   false, true 
//  Create a SlideAtomsSets, not caring if they're empty 
//  Copy the data, ready to pass to PictureData 
// name of the zip entry holding sheet data, e.g. /xl/worksheets/sheet1.xml 
// If this number argument is non numeric, this function returns the #VALUE! error value. 
/*  Create a mutable property set as a copy of the original read-only             * property set.  */
//  Remove row from index 2 
//  Check they were set correctly 
//  Now we can fetch the character and paragraph properties 
//         checkRecordsTogether(records, sheetRecords); 
//  With a cell that's not in a merged region, we'll get that 
//  first see what slide layouts are available by default 
//  GUID stream 
//  01 18 27 00 03 20 00 00 E8 03 08 08 0C 20 03 00 ..'.. ....... .. 
//  Now the current edit offset 
//  set this to the white on red cell style   we defined above 
// above  right  bottom 
// too small 
//  adding a duplicate or overlapping merged region should not   raise an exception with the unsafe version of addMergedRegion. 
//  Go for the first if we can't otherwise decide... 
//  read in the main stream. 
//  unused1, unused2 - Undefined and MUST be ignored. 
//  bug 56781: name validation only checks for first character's validity and presence of spaces 
//  Used only for piece table grpprl's not for PAPX 
//  Starts empty, other that Properties and BAT 
//  defaults for placeholders are defined in the slide master 
//  The header has up to 109 BATs, and extra ones are referenced    from XBATs 
//  swap start and end if out of order 
//  multi-cell formula   rows 3-5 don't exist yet 
//  It's a >/>= condition. 
//  normal way to interfere with, so we need to add the namespace under the hand ... 
//  Enumeration 
//  except that the sign bit is ignored 
//  Look it up for the external workbook 
// 7 bits reserved + 1 bit type 
/* XSLFPictureShape shape = */
//  A 32-bit floating-point value that specifies the width of the line drawn by the pen in the units specified 
//  Check for the english text in the mixed line 
//  Check text properties first - should be unchanged 
//  expand table 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#createErrorBox(java.lang.String, java.lang.String)	  */
// writing to disk; reading in and verifying palette 
/*      * The following definitions are for property IDs in the first     * section of the Document Summary Information property set.      */
//  Check can't shift more than we have 
//  Change 
//         out = new FileOutputStream(new File(tmpDirName, "out_optimised.xls"));          wb.write(out);          out.close(); 
// but this disagrees with file above 
//  Two calls means two elements, no clever collapsing just yet. 
/*  Constants for margins  */
//  this '==' matches +0.0 and -0.0 
//  Now custom ones 
//  A 32-bit unsigned integer that specifies the size in bytes of this record in the 
// Don't known to handle... 
//  Save that requested portion of the data  
//  use a local object first to not assign a partly constructed object   in case of failure 
//  Attachments doesn't have them 
//  The first weight of the NURBS. 
//  Serialize escher records into one big data structure and keep note of ending offsets. 
//  The XBAT count makes no difference, as we flatten in memory 
//  Iterator order should be fixed when iterator is created 
//  rectangle that can be drawn around the image stored in the metafile. 
//  assert that the comments are created properly after reading back in 
//  on a word boundary 
// this shows up only as a phonetic run and should not appear  in the extracted text 
//  It's based on a normal one 
//  Get the record data. 
//  image/gif http://www.w3.org/Graphics/GIF/spec-gif89a.txt 
//  LogFontExDv Object 
// special case for files saved in Office 2007 
//  Read the buffer again 
//  Row 2 
//  Removing root element 
//  result = name1.compareTo(name2); 
//  Set the the repeating rows and columns on the third sheet. 
//  don't alert for expanded sizes smaller than 100k 
//  are defined by this object. 
//  Check we can find the entries we expect 
//  non-null not equal null, returns true 
//  the "fractional % 1" captures integer values in improper fractions 
// length then null terminator. 
//  Check that the row's height will accommodate the image at the required   dimensions. If the height of the row is LESS than the required height   of the image, decide how the application should respond - resize the 
// i.e. POI has already included them in the slide's getTextParagraphs() 
// The test file requires that JCE unlimited be installed.  If it isn't installed, skip this test. 
//  An 8-bit unsigned integer that specifies the proportion of the font. 
// this tests that we're ignoring text shapes at depth=0 
//  A 16-bit signed integer that defines the horizontal (x) coordinate of the point. 
/*              * The order of sheets is defined by the order of CTSheet elements in workbook.xml              */
//  the id could already be taken after insertion/deletion of different tables 
//  0-7 duplicates of 8-15 for compatibility (OOXML spec pt.1 sec. 18.8.27) 
//  Used to throw a NPE 
//  Check print areas after re-reading workbook 
//  Row 1 
//  remove unneccessary infos, so we don't need to specify the type 
//  +1 for index record 
//  All the embedded directories we spotted 
//  windows 10, 1080p, MS Office 2016, system text scaling 100% instead of default 125%   Windows 10, 15.6" 3840x2160 
//         } 
//  dest rows overlap top of area   - truncate the top 
//  Looks like it ought to be 19... 
//  ??? 0x20 -> 0x23 
/*  XML markup  */
// See 59830.xls for this record. 
//  Update the Workbook stream in the file 
//  finished with additive expression 
//  A 32-bit unsigned integer that specifies a brush style for the pen from the WMF BrushStyle enumeration     If the pen type in the PenStyle field is PS_GEOMETRIC, this value MUST be either BS_SOLID or BS_HATCHED.   The value of this field can be BS_NULL, but only if the line style specified in PenStyle is PS_NULL. 
//  For now, create the initial style in a low-level way 
//  create cells with num patterns 
//  DEC2HEX 
//  the buffered image might be rescaled, so we need to calculate a new src rect to take   the image data from 
//  Because of custom properties, match on ID not literal property object 
//  the shape. 
// check the low-level stuff 
//  Padding (variable): A set of bytes that MUST be of correct size such that the size of the UTF-8-LP-P4   structure is a multiple of 4 bytes. If Padding is present, each byte MUST be 0x00. If    the length is exactly 0x00000000, this specifies a null string, and the entire structure uses    exactly 4 bytes. If the length is exactly 0x00000004, this specifies an empty string, and the    entire structure also uses exactly 4 bytes 
//  URL 
// ??        textFormatter[0x2E] = new SimpleDateFormat("[h]:mm:ss"); 
//  don't search twice and potentially skip items 
//  Check the chart on the 2nd sheet 
//   and one shouldn't go in after that! 
//  now apply a named style to a new cell 
//  bitmap file-header, corresponds to a   Windows  BITMAPFILEHEADER structure 
// dump first 100 bytes of the atom data 
//   This only works for Excel since OpenOffice or LibreOffice Calc does not support literal numeric data series. 
//  The mask, between 1 and 255, which is used when 
//  Build the Offset-Picture lookup map 
// move merged regions completely if they fall within the new region boundaries when they are shifted 
//  pred '=' matches blank cell but not empty string 
/*          * IF (Verifier BITWISE AND 0x4000) is 0x0000         *    SET Intermediate1 TO 0         * ELSE         *    SET Intermediate1 TO 1         * ENDIF          */
//  Now create the ClientAnchorDetail object, setting the from and to 
//  "ROUNDUP(3987*0.2, 2) currently fails by returning 797.41") 
//                 throw new EvaluationException(ErrorEval.CIRCULAR_REF_ERROR);              }          /*          Circular references are not dealt with directly here, but it is worth noting some issues.            ANY one of the return statements in this method could return a cell that is identical          to the one immediately being evaluated.  The evaluating cell is identified by srcCellRow,          srcCellRow AND sheet.  The sheet is not available in any nearby calling method, so that's          one reason why circular references are not easy to detect here. (The sheet of the returned          cell can be obtained from ae if it is an Area3DEval.)            Another reason there's little value in attempting to detect circular references here is          that only direct circular references could be detected.  If the cycle involved two or more          cells this method could not detect it.            Logic to detect evaluation cycles of all kinds has been coded in EvaluationCycleDetector          (and FormulaEvaluator).           */          } 
//  sometimes it fails on machines that are busy at the moment.   
//  indicate that this sheet is now done 
//  Get the header. 
/*  Create the tree model with a root node. The latter is         * invisible but it must be present because a tree model         * always needs a root.         *         * The tree's root node must be visible to all methods.          */
// don't care, named ranges are not allowed to include structured references 
//  don't switch the font group for a few default characters supposedly available in all fonts 
//  see issue #61841 for impact on VLOOKUP in particular 
//  all columns are equally sized 
//  Handle case of a corrupt last record, whose claimed length    would take us passed the end of the file 
//  beginning of the line cap and the end of the line. 
//  5 shorts + 1 byte 
//  if the Compression value specifies JPEG or PNG format. 
//  use HwmfEmbeddedType literal for conversion 
//  The value is a 64 bit Windows Filetime 
//  Format number conditionally using a thousands separator. 
//           } 
//  int remainingBytes = LittleEndian.getInt( data, offset + 4 ); 
//  Bug 52233: Ensure that we have a col-array even if write() removed it 
//  Ensure character offsets are really characters 
//  Try and find the next sheet name that is unique 
// verify that records cached in  TextRun and EscherTextboxWrapper are the same 
//  duplicate found, increase the number and start iterating again 
//  Wrap and return 
//  font height = xc8 
//  test properties of embedded message 
//  Row 0 
// test handling of non-standard header/footer options 
//  Save parts. 
//  size=0x0004   unused 
//  Construct double from condition. 
//           the Encryption Matrix 
//  A fairly simple file - ooxml 
//  A number specification   Note: careful that in something like ##, that the trailing comma is not caught up in the integer part 
//  Load back the XSSFWorkbook just to check nothing explodes 
//  seems to be always present regardless of author text 
//  X=balance, Y=shift 
//         setShapeType(inverse ? ShapeType.LINE_INV : ShapeType.LINE);      }            /**       * Gets the orientation of the line, if inverse is false, then line goes       * from top-left to bottom-right, otherwise inverse equals true        *       * @return inverse the orientation of the line       */      public boolean isInverse() {          return (getShapeType() == ShapeType.LINE_INV);      } 
//  An array of SmartTagIndex that specifies the indices. 
//  later. 
//  1996 
// adding one here because 0 indicates a global named region; doesn't make sense for print areas 
//  200x200 pixels 
//  matches Excel's rendering. 
//  workbook.setPrintArea(0, reference); 
//  Calibri is not available on *nix systems, so we need to use another similar free font 
//  Copy the input file in the output directory 
// remember "special" bits. 
//  private static final BitField _weekday = BitFieldFactory.getInstance(0xe000); 
//  assign new embedding 
//  set repeating rows and columns twice for the first sheet 
//  Write out the Property Streams 
//  percentage 
/* If an HSSFUserException user exception is thrown, ignore it. */
//  what's this do?? 
//  use a user set page no, instead of auto 
// A4:B7 should be elongated by 1 row  C4:B7 should be elongated by 1 row 
//  LinkTable can start with either of these 
//  write collapse field 
//  Note: Cell references start from the second row... 
//  Bytes -> Chars 
//  POI saves images as image1.png, image2.png, etc. 
//  Ask DataFormatter to handle the String for us 
//  sprmPFDyaAfterAuto 
//  Handling for special kinds of records follow 
//  Now a much more complex document 
//  only use the bytes that could be read 
//  collapse columns - 1 
//  okay so there ISN'T a column info record that covers this column   so lets create one! 
//  TODO const 
/* 	  20 00	  00	  01	  1A 00 // sz = 0x1A = 26	  00 00	  01 00	  00	  00	  00	  00	  00 // unicode flag	  07 // name	  29 17 00 3B 00 00 00 00 FF FF 00 00 02 00 3B 00 //{ 26	  00 07 00 07 00 00 00 FF 00 10                   //  }	  20 00	  00	  01	  0B 00 // sz = 0xB = 11	  00 00	  01 00	  00	  00	  00	  00	  00 // unicode flag	  07 // name	  3B 00 00 07 00 07 00 00 00 FF 00   // { 11 }   */
//  Is this document too old for us? 
//  SP @ 26   SP @ 32 
//  remove the border and verify state 
//  A workbook stream is never empty, so crash instead   of trying to keep track of nesting level 
//  Write the PowerPoint streams to the current FileSystem   No need to do anything to other streams, already there!  
//  First at low level 
/*          * sttbfBkmk (table of bookmark name strings) Written immediately after         * the previously recorded table, if the document contains bookmarks.         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 27 of 210          */
// Specifies the file type. It must be set to the signature word BM (0x4D42) to indicate bitmap. 
//  A 32-bit unsigned integer whose definition MUST be in the MapMode enumeration 
// Need to include the insets in the calculation of the row height to use. 
//  change [wbA]AnotherSheet!A1 (from 2 to 3) 
//  layout does not have anchor info either, it is in the slide master 
/*  (non-JavaDoc), inherit JavaDoc from EvaluationSheet     * @since POI 3.15 beta 3      */
//  Grab the SlideAtomSet's, which contain    a SlidePersistAtom and then a bunch of text    + related records 
//  Test again the last row number which should be 2 
//  A completely unknown formula name (not saved in workbook) should still be parseable and renderable 
//  use a new line at the paragraph break 
//  no exceptions 
//  see https://stackoverflow.com/questions/39196145 for problems with SunMSCAPI   and why we can't sign the calculated digest 
//  see SlideAtom.USES_MASTER_SLIDE_ID 
//  Write out and back in again   This used to break 
//  Always find 4 two byte entries. Sometimes find 9 
//  outline group) 
//  Ensure it has some date letters in it 
//  make sure there is no exceptions 
//  First up, fields can be nested...   A field can be 0x13 [contents] 0x15   Or it can be 0x13 [contents] 0x14 [real text] 0x15 
//  Last useful one is the unique slide identifier 
//  Check the RGB part (no tint) 
//  How about with parameters? 
//  update formulas on other sheets that point to rows that have been moved on this sheet 
//  row is after and things are moved down 
/* private */
//  First up, grab the "Current User" stream 
//  Cache values to speed up performance of   getStartRowNumberForBlock / getEndRowNumberForBlock, see Bugzilla 47405 
//  ... and the content if it has not been added yet. 
//  red 
//  s.setStart( CPtoFC(node.getStart()) );   s.setEnd( CPtoFC(node.getEnd()) ); 
//  Create another worksheet 'sheet2' in the new workbook 
/*  The class has no renderer, try the superclass, if any.  */
//  Now change all subsequent ones 
//  new row inherits  default height from the sheet 
//   without concurrency issues 
//  max axis value   major increment 
//  Check the cached values 
//  See if we know about the type of it 
//  update formulas on this sheet that point to rows which have been moved 
//  verify limits 
//  Keep track of any shape records created so we can match them back to the object id's. 
//  Low level contents of the file 
//  Finally, save the record 
//  100/32768 ~= 0.003 
//  Check that the text sizes are still as expected 
//  font index is 1   font size 24 
// address length 
// K11 
//  unicode flag  
//  Biff 2 and 5+ share the same SID, due to a bug... 
//  And some more, attributes will be copied from previous run 
// another weird feature of powerpoint: for picture id we must add 0x4000. 
//  set top border 
//  First up, is this an internal date format? 
//  check for the optimization 
//  Check we can get at all the contents 
//  by default we do nothing here 
//  Set value 
//  ignored 
/*  Write the number of sections in this property set stream.  */
/* 		 * Sanity check. Always advance the cursor by the correct value.		 *		 * getRecordSize() must return exactly the same number of bytes that was written in fillFields.		 * Sometimes it is not so, see an example in bug #44770. Most likely reason is that one of ddf records calculates wrong size.		  */
//  These values are specific to BIFF8 
//  This happens three times in test sample file "29982.xls"   Also several times in bugzilla samples 46840-23373 and 46840-23374 
// there may be some efficiencies, but this should do for now. 
// cchFile (2 bytes)  char type  count = 30 
/*  Print the number of sections:  */
//  320: HARMEAN 
//  The styles should have been updated for the new sizes 
//  Int 
//  application/vnd.ms-word 
// Set a unicode header (you guessed it the euro symbol) 
//  width is roughly proportional to the number of characters 
//  Excel encodes the sum of a single argument as tAttrSum 
//  Peek at the first few bytes to sanity check 
//  getCachedFormulaResult() returns 0 for not evaluated formula cells 
//  note that the Date and Calendar examples use a zero day of month which is invalid in LocalDateTime  
//  Check the non-CF colours in Columns A, B, C and E 
/*              * Microsoft Office Word 97-2007 Binary File Format (.doc)             * Specification             *              * Page 78 of 210             *              * sprmCPropRMark (opcode 0xCA57) is interpreted by moving the first             * parameter byte to chp.fPropRMark, the next two bytes to             * chp.ibstPropRMark, and the remaining four bytes to             * chp.dttmPropRMark.              */
//  Grab the hslf.record type 
// short 
//  titles on slide2 
// Set 0 or 255 index of ColumnStyle. 
//  Now repeat with 4096 block sizes 
// Gnumeric produces spreadsheets without styles 
//  (see links in applyColorTransform() for more info) 
//  set some variables in the FileInformationBlock. 
// let's check also that returns the correct table 
//  assert that we can write/read it in memory 
//  try in the middle 
//  font size 20   colour blue 
//  Remove colour formatting if present 
//  Shuffle from ARGB to RGBA 
//  Done reading from input stream   Ok to return now 
//  Microsoft Base Cryptographic Provider is limited up to 40 bits   http://msdn.microsoft.com/en-us/library/windows/desktop/aa375599(v=vs.85).aspx 
//  create 2 fonts objects 
//  275: CHIINV 
//  wb.setActiveSheet(0); 
// calglin Cell.setCellFormula(null) for a non-formula cell 
//  Ensure the text lengths are as we'd expect to start with 
//  If the core properties part does not exist in the part list,   we save it as well 
//  write out EncryptionInfo 
//  <p:ph idx="1"/> 
// 	        FileOutputStream fos = new FileOutputStream("embed.xls");  	        wb.write(fos);  	        fos.close();          } 
//  Record specific dumps 
//  to remove the array formula 
//  end public interface DocumentEntry 
//  some record types may get skipped (e.g. DBCellRecord and ContinueRecord) 
//  Set cell color : +2(user style + proxy of it) 
//  character run is 96 long 
//  Unknown directory, skip silently 
//  remove all slides, corresponding notes should be removed too 
//  FALSE 
//  before getting the workbook size we must tell the sheets that   serialization is about to occur. 
//  This one isn't allowed 
// expect: baseText (phoneticText) 
//  val axis 1 (left) 
//  Check we get the right extractors now 
//  An array of EmfPlusPointF objects that specify the output position of each character glyph.   There MUST be GlyphCount elements, which have a one-to-one correspondence with the elements   in the Glyphs array.     Glyph positions are calculated from the position of the first glyph if the REALIZED_ADVANCE flag in 
//  parentIndex equal 0xFFF indicates no inheritance from a cell style XF (See 2.4.353 XF) 
//  local refs on other sheets are unaffected 
//  paragraph reserved field   mask is 0x1800 
//  i've no idea.. possible values are 1 for down, 2 for up and 3 for both...0 for none..   maybe a diagnal line? 
//  sprmPDxcLeft 
//  Check the contents of the formulas 
//  Entry stream 
// Default value = 1 will be used  
//  lacking row count, evaluated will be right 
//  There might be a few more bytes, which are a reserved field 
//  if basis is invalid the result is #NUM! 
//  we want to draw the shape from the top-left 
//  never happens - blanks eventually get translated to zero 
//  So we don't confuse users, give them back    the same object every time, but create    them lazily 
//  Table column names with special characters need a single quote escape 
// This is the border to paint when there is no border  and the cell has focus 
//  what the ?? 
//  TODO - AttrPtg.class, // Excel prepends this 
/*      * Unlike TestFormulaFromSpreadsheet which this class is modified from, there is no     * differentiation between operators and functions, if more functionality is implemented with     * array formulas then it might be worth it to separate operators from functions     *      * Also, output matrices are statically 3x3, if larger matrices wanted to be tested     * then adding matrix size parameter would be useful and parsing would be based off that.      */
//  Tack it onto the end of our chain 
//  point number 
//  Should have added 2 more blocks to the chain 
//  no block size, because its a streaming cipher 
//  Icons : Default - Column H, percentage thresholds 
//  Get the name of it 
//  0x200 - Undefined and MUST be ignored 
//  and with an enum 
//  check if we were created by POIFS otherwise create a new dummy POIFS for storing the package data 
//  8 bytes cached number is a 'special value' in this case 
//  How many hyperlinks do we really have? 
//  We add up to three columns for each existing one: non-overlap   before, overlap, non-overlap after. 
//  and finally update cryptoapi setting 
//  Check the sheet offsets 
//  invalid dx array 
/*          * reserve already occupied drawing ids, so reserving new ids later will         * not corrupt the document          */
//  Try with explicit rows / columns 
//  Each mapping in this Map has a key consisting of a   POIFSReaderListener and a value cosisting of a Set of   DocumentDescriptors for the documents that POIFSReaderListener 
//  Update the best fit column widths for auto-sizing just before the rows are flushed 
//  DataObjectFormat 
//  hugeGrpprlOffset );   
//  The StringBuffer's contents are the source for the contents   of the cell. 
//  Check by the names 
//  After the second of a given type,    it seems to be 4 bytes giving the start,    then 4 bytes giving the length, then 
//  propid, complex ind   size of complex property   propid, complex ind   value   propid, complex ind   size of complex property 
//  https://math.stackexchange.com/questions/2772737/how-to-transform-arbitrary-rectangle-into-specific-parallelogram 
// all we know is that the the length of <code>NoteStructureSubRecord</code> is always 22 bytes 
// custom format 1  custom format 2 
//  Add one more mini-stream, and check 
//  interpreted ascii 
//  add empty property elements otherwise Powerpoint doesn't load the file ... 
//  by shifting rows... 
//   and background=64 for the auto colouring 
//  must be external function 
//  false, true   false, true 
//  Previously only one was inserted MB 23 May 2010 
//           {              short[] brcRight = rgtc[x].getBrcRight (); 
//  parent sheet 
//  Set which area the table should be placed in 
// single-cell array formulas behave just like normal cells - we can change the cell type 
//  Add another cell, specifying the cellType 
//  Is this a new code (un-compressed), or    the use of existing codes (compressed)? 
//  Use them to build up the SSlideLayoutAtom 
//  It fails with 4-part format because the call to CellFormat ignores 'use1904Windowing' 
//  lighter 60% 
//  dest rows overlap bottom of area   - truncate the bottom 
//  These should work without throwing an Exception 
//  remember the initial transform and restore it after we are done with the drawing 
/*          * From the spec:         * For a multi-cell formula, the c elements for all cells except the top-left         * cell in that range shall not have an f element;          */
//  by default set hide object off 
//  Basic checks 
// return new ArrayEval().evaluate(srcRowIndex, srcColumnIndex, args[0], args[1]); 
//  prior to the fix the line below failed with 
//  no methods 
//  the POIFSDocument this property is associated with 
// Read the size of extended data if present. 
//  File via POIFileStream (java.nio) 
//  ContinueRecord.sid   size 3   unicode compressed   'AB'   ContinueRecord.sid   size 16 
//  Handle the case of it being garbage 
// should not happen if the input argument is valid 
//  add dummy move-to at start, to handle invalid emfs not containing that move-to 
//  parameters 2, 2, -1 should mean : move row range [2-2] one level up 
//  ffff 
//  Check case where top input is of the wrong type 
//  the POIFSReaderListeners who listen to all POIFSReaderEvents 
//  optimisation 
//  scan breadth-first, so parent-relations are hopefully the shallowest element 
//  second string 
//  do some goofy math to demonstrate decimals 
//  for testing only 
//  TextBytesAtom 
// the UNC or local path to a video file. 
// Relative path notation - up 
//  Everything is fine at this point, cell is red 
//  string criteria 
//   Calculate the Hue 
// cell A1 has a link to 'Target Sheet-1'!A1 
/*          * An array of LVLs is appended to the PlfLst. lcbPlfLst does not         * account for the array of LVLs. -- Page 76 of 621 -- [MS-DOC] --         * v20110315 Word (.doc) Binary File Format          */
//  N.B. assuming sign bit is zero 
/*  Put the custom property into this map.  */
//  Read all of it again, check it began at the start again 
//  Add 6 fonts, some duplicates 
/*                  * ECMA-376 Part 2 - 3rd edition                 * 13.2.4.16 Manifest Element                 * "The producer shall not create a Manifest element that references any data outside of the package."                  */
//  Next part of expanded record handling 
//  into many non-shared formulas), but if they ever were, the same rules would apply. 
// System.setProperty("org.apache.poi.util.POILogger", "org.apache.poi.util.SystemOutLogger"); 
//  Now we can have the ExternSheetRecords, 
//  Now manually clear all, will see the new value 
//  Next up is a set of flags, but only bit 3 is used! 
/*  End XML markup  */
// assign the comment to the cell 
//  Formula for center of ellipse by Junichi Yoda & nashwaan:   -> From http://visguy.com/vgforum/index.php?topic=2464.0     x1,y1 = start; x2,y2 = end; x3,y3 = control point     x0 =   ((x1-x2)*(x1+x2)*(y2-y3)-(x2-x3)*(x2+x3)*(y1-y2)+D^2*(y1-y2)*(y2-y3)*(y1-y3))/(2*((x1-x2)*(y2-y3)-(x2-x3)*(y1-y2)))   y0 =   ((x1-x2)*(x2-x3)*(x1-x3)/D^2+(x2-x3)*(y1-y2)*(y1+y2)-(x1-x2)*(y2-y3)*(y2+y3))/(2*((x2-x3)*(y1-y2)-(x1-x2)*(y2-y3)))   radii along axis: a = sqrt{ (x1-x0)^2 + (y1-y0)^2 * D^2 }   
//  this is kind of a hack, as picture/ole shapes can have a shape type of "frame"   but rendering is handled like a rectangle 
//  It's all low bytes 
//  application/vnd.ms-outlook 
//  ShapeId is different 
//  Unhelpful low-level error, sorry 
//  check that valid formula does not throw exception 
//  Sanity Checking 
//  This would add the random value in the middle of the filename so that test runs wouldn't overwrite files 
//  although not documented, we need the same padding as with agile encryption   and instead of calculating the missing bytes for the block size ourselves   we leave it up to the CipherOutputStream, which generates/saves them on close()   ... we can't use "NoPadding" here     see also [MS-OFFCRYPT] - 2.3.4.15   The final data block MUST be padded to the next integral multiple of the   KeyData.blockSize value. Any padding bytes can be used. Note that the StreamSize   field of the EncryptedPackage field specifies the number of bytes of    unencrypted data as specified in section 2.3.4.4. 
//  Excel treats date 0 as 1900-01-00; EOMONTH results in 1900-01-31 
//  initialize the hotspot diagnostic MBean field 
//  object data was already set 
//  Check that the cells now contain 
//  Ensure we're getting a sensible length 
//  cross tests with pv 
//  V4 and V5 never has separators 
//  Document shouldn't have any image relationships 
//  width of '0' is less then width of '10'   columns 1, 2 and 3 should have the same width   columns 1, 2 and 3 should have the same width   10.0000 and '10.0000' 
// end class 
//  if the next user edit atom offset is already known, we would go into an endless loop 
//  Zip + 4 format 
//  Grab current size 
//  any arbitrary constant will do 
//  samples from http://www.excelfunctions.net/Excel-Ceiling-Function.html   and https://support.office.com/en-us/article/CEILING-function-0a5cd7c8-0720-4f0a-bd2c-c943e510899f 
//  once again with removing one cell 
//  Does it exist via the external book block? 
//  Shift the second row down 1 and write to temp file 
//  A 32-bit unsigned integer that specifies the graphics mode from the GraphicsMode enumeration 
//  One sheet 
//  The y-coordinate of a control point. 
//  sprmPShd -- 0xc64d 
//  c2 remains the master formula 
//  Test that defaultRowHeight is a truncated short: E.G. 360inPoints -> 18; 361inPoints -> 18 
//  Excel and LibreOffice behavior: ignore merged cells for auto-sizing.   POI behavior: evenly distribute the column width among the merged columns.                 each column must be auto-sized in order for the column widths                 to add up to the best fit width. 
// should be [0.0, 1.0, null, 2.0, 3.0, 4.0, 6.0, null] 
//  Write out and read back in again 
// the second sheet is of type 'chartsheet' 
//  A3:A5 
//  start just after BOF record (INDEX is not present in this list) 
//  'true' is wider than '0'   10 and '10' should be sized equally   formula result is unknown, the width is calculated  for '0' 
/*                      * We don't know how to handle all cases in HTML, but at                     * least simplest case shall be handled                      */
//  default height is 20 points 
//  Re-evaluate and check 
//  underline, family   charset, padding 
//  Check all names fit within range, and use    DeletedArea3DPtg 
//  negative zero *is* less than positive zero, but not easy to get out of calculations 
//  Build a tree of POIXMLDocumentParts, this workbook being the root 
//  weird: m\\/d\\/yyyy  
//  Turn the Type and ID into helper objects 
//  note name 'A' 
/*              * Maybe the BuildFileTest was subclassed and there is             * no initialized project. So we could avoid getting a             * NPE.             * If there is an initialized project getTargets() does             * not return null as it is initialized by an empty             * HashSet.              */
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationHelper#createIntegerConstraint(int, java.lang.String, java.lang.String)	  */
//  Test overwriting an existing row 
//  the rest seem to be mutually exclusive 
//  The ref IDs are 4 and 6 
//  solid 
//  Core properties 
//  compute slope.. 
//  Cell opts ...   Alignment 20 
//   and update the format record for this 
//  axis type 
/*  ======= Name pointing to deleted sheet ======  */
// length of the document link including trailing zero 
//  simple state machine for keeping track of what we are doing 
//  full row ranges are not parsed properly yet.   These cases currently work in svn trunk because of another bug which causes the  
//  Finally, check we can do a similar 512byte one too 
//  rectangular inclusive-inclusive bounds, in device units, of the smallest 
//  from POIFS 
//  Check if the part name URI is absolute 
//  last cell # + 1 
//  no border style and STBorderStyle.NONE are equivalent   POI prefers to unset the border style than explicitly set it STBorderStyle.NONE 
//  Second cell of array formula, NOT OK for xlsx files 
// "poifs/protected_agile.docx", 
//  the first record after the drawing block 
//  create a blank slide and import content from the 4th slide of themes.pptx 
//  be sure to reset cached value 
//  because it is included in a merged region (Excel like behavior) 
//  "=SUMIFS(A2:A9, B2:B9, "=A*", C2:C9, 1)" 
//  It isn't bold or italic 
//  Create a workbook 
//  Now the Escher bits 
//  process the byte array 
//  Check the relations on it   Note - rId3 is a self reference 
/*  next index in the records list where the new series can be inserted  */
//  next is the 'Worksheet Protection Block' 
//  copy of parent logic; we need to call our own read() instead of super.read(), which delegates instead of calling our read 
//  check the result 
//  if the target(x) is a string, but parses as a number   it may still count as a match, only for the equality operator 
//  I feel too lazy to check if this isreqd :-/  
//  0.5%	3%	1%	4% 
//  20 short fields (rwFirst ... itblAutoFmt) 
//  Copy the font 
//  Arial, as unicode 
//  Create a worksheet 'sheet1' in the new workbook 
//  placeholder text for slide numbers 
//         	targetWorkbook.write(os); 
//  nFormats 
//  Finish 
//  Performance optimization: explicit boxing is slightly faster than auto-unboxing, though may use more memory 
//  may be -1 (0xFFFF)   may be -1 (0xFFFF) 
//  11 bytes length   formula of link   index to ref entry in extern sheet 
// max shapeId in the slide   number of shapes in the slide  insert 3 shapes and make sure the Ids are properly incremented 
/*              *  The first row simply contains the numbers 1 - 300.             *  The second row simply refers to the cell value above in the first row by a simple formula.              */
//  corrupt file, cannot read header 
//  need to avoid instanceof, to work around a 1.6 compiler bug 
//  then set it on a normal slide 
//  OpenOffice inserts 0xB3 instead of 0xAD.   protected static final byte[] SEGMENTINFO_CUBICTO2 = new byte[]{0x00, (byte)0xB3}; 
//  Cell Formula with Area Reference 
//  int versions of above, using 0-based indices 
//  zero is FALSE, everything else is TRUE 
//  Hint about the raw excel value 
//             // this is too simplistic 
//  Check hyperlinks again 
//  Copy docs 
//  314 == 0x013A; 318 == 0x013E 
//  Log, but don't change, rather than breaking 
// we can probably cache this information, but this should be a sparsely used function 
//  account for footer row(s) in auto-filter range, which doesn't include footers 
//  An 8-bit unsigned integer that specifies the set of character glyphs.   It MUST be a value in the WMF CharacterSet enumeration.   If the character set is unknown, metafile processing SHOULD NOT attempt   to translate or interpret strings that are rendered with that font.   If a typeface name is specified in the Facename field, the CharSet field 
//  character run is 96 long   mask is 0x030004 
//  Set all the default values 
// Offset=0x0008DB37(580407) recno=160 sid=0x003C size=0x1048(4168) 
//  Now add an orphaned one 
//  formulas are just literal constants "1".."5" 
//  Strings 
//  boolean ppt2007 = sc.findFirstOfType(RecordTypes.RoundTripContentMasterId.typeID) != null; 
//  Get the document 
//  ftSbs (currently UnknownSubrecord) 
//  The master persists 
//  row0 will be shifted on top of row1, so this URL should be removed 
//  a new name is inserted in the end of the SupBookRecord, after the last name 
//  there are special cases where this can be, see comments in constructor above 
// link to a file in the current directory 
//  name is not an internal or external name 
//  A value that identifies the type of metafile. The value for an EMF+ metafile is 0xDBC01. 
//  now we can validate the cell 
//  E4 to G9 of sheet 4 make up the table 
// int ifmtLength = 2; 
//  We start with 3 text runs, each with their own set of styles,   but all sharing the same paragraph styles 
//  the replacement is empty, go straight to NOT_MATCHED 
// swallow 
/* 	 * URI Characters definition (RFC 3986)	  */
// sometimes in older Excel 97 .xls files,  the requested length is wrong.  Read all available characters. 
//  unquoted sheet names must start with underscore or a letter 
//  manipulate 
//   left, center or right. Not exhaustive 
//  Document and CustomXML parts totally different [Julien C.] 
//  TextProp order is according to 2.9.20 TextPFException, 
//  INDIRECT is a special case 
// Sheet0 
// standard 24-byte tail of a file link 
//  If we don't do this, we get ".6e5" instead of "6e4" 
//  end public interface POIFSReaderListener 
//  Default 
//  connection start 
//  Workbook + Named Range only 
//  " -> " + sepx.getEnd()); 
//  Work out what MAPIProperty this corresponds to 
//  a failed invocation of Cell.setCellFormula leaves the cell 
//  Set everything up 
//  Set our type 
// calculate the correct pos as our run/irun list contains hyperlinks and fields so is different to the paragraph R array. 
//  Start again! 
// style table is not set, remember fontIndex and set the run properties later,  when setStylesTableReference is called 
//  Finish up the row 
//  the calculation chain in XSSF is empty in a newly created workbook, so we cannot check if it is correctly updated 
// HSSF: 171 
//  Test that validates the table header value can be parsed from a document 
//  else not '~?' or '~*' 
//  character run is 25 long 
//  They want time, that's normal 
//  bytes 
//  report exceptions if there were any 
//  Should have two sheets 
//  Round trip and check 
//  make sure formula in sample is as expected 
// 	public LinkedList<ExcelAntSet> getSetters() {  		return setters;  	} 
//  equal within 1% 
//  second and third sheets miss DefaultColWidthRecord 
//  Create style. But don't use it. 
//  second part is not compatible with an area ref e.g. A1:OFFSET(B2, 1, 2)   reset and let caller use explicit range operator 
//  get 1st paragraph in cell's paragraph list 
//  Usually stringRec is null here (in agreement with what the formula rec says).   In the case where an extra StringRecord is erroneously present, Excel (2007)   ignores it (see bug 46213). 
//  make sure that cached start and end cell references   can be synchronized with the underlying CTTable 
//  As per OOO documentation Sec 3.2.4 "Token Class Transformation", "Step 1"   All direct operands of value operators that are initially 'R' type will   be converted to 'V' type. 
//  usually text height == 88, but font rendering is plattform dependent 
//  field, only the first VerifierHashSize bytes MUST be used. 
//  transformation is applied reversed ... 
//  the underlying writer is GZIPSheetDataWriter 
//  Update the new positions based on    deletes that have occurred between    the start and them 
//  backwards because theoretically this is one short field 
//  287: GAMMAINV 
//  Special handling for whole-column references   Represented internally as x$1 to x$65536    which is the maximum range of rows 
//  level list item...... 
//  avoid bombing out during exception handling 
//  Often, but not always has an unused short at the end 
//  Check IDs are still right 
// This is actually the 4th quadrant 
//   whole of the stream 
//  keep the dcontext state, if the next record is an EMF+ record   only reset it, when we are processing EMF records again 
//  not sure where that last byte comes from 
//  Set headers 
//  skip until the next quote 
//  File link or URL.   Absolute path.   Has label/description. 
// Can't seem to find this documented but from the biffviewer it is clear that  Excel only records the indexes for the first 128 buckets. 
//  the line cap to be used at the start/end of the line to be drawn. 
//  border type 
// at start of next cell or end of row, return the cellAddress if it equals currentRow and col 
//  Regular numeric style formats 
//  Custom formats - check text is stripped, including multiple spaces 
//  Get the text from the Quill Contents 
//  Check the type 
// the top-left cell of a merged region is not regarded as merged 
//  Shifting back up again, now two rows 
/*  Check the command-line arguments.  */
//  Fill up to hold 109 BAT blocks 
//  ensure that the stream is properly closed here if an Exception   is thrown while opening 
//  set the "needs recalculate" by default to avoid Excel handling conditional formatting incorrectly   see bug 52122 for details 
//  Feed in the stuff from  chunks_parse_cmds.tbl 
//  Get the ID of the first slide 
//  docs say 406...because of a bug Microsoft support site article #Q184647)   double + short + int 
//  check that neither valid nor invalid formula throw an exception 
// Length of special info run. 
//  application/vnd.ms-officetheme 
//  solid fill 
//  LogFontPanose Object 
//  version number of new picture   header opcode 
//  verify circular refs are still detected properly 
//  A 32-bit unsigned integer that specifies the type of metafile that is embedded in the 
//  Get complex data 
//  only try to get the TC entries if they exist... 
//  Start xxx 
//  that more may be added in the future 
//  adjacent address are merged 
//  2. Try to re-get the patriarch 
//  check for padding 0 bytes. 
//  all rows have the same height 
//  Act   evaluate SUM('Skye Lookup Input'!A4:XFD4), cells in range each contain "1" 
//  Bugzilla 50033 
//  formula is parsed with slightly different RVA rules: (root node type must be 'reference') 
//  An XForm object that defines a two-dimensional linear transform in logical units.   This transform is used according to the ModifyWorldTransformMode to define a new value for 
//  org.apache.poi.hwpf.model 
//  Test that renaming named ranges doesn't break our new named range map 
//  Grab the edit offset 
//  And check the contents 
//  First up, try with a few built in date formats 
/*  **********  END  implementation of DirectoryEntry **********  */
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#getOperator()	  */
// Substitute the template entries with the generated sheet data files 
//  Tell the base workbook to close, does nothing if  
//  Write into the new FileSystem 
//  region may not be the one that contains the target, if a conditional formatting rule applies to multiple regions 
//  Just notes, no slides 
//  must be an expression, then.  Overloading by Excel in the file formats. 
//  sometime emfs remove object table entries before they set them   so ignore requests, if the table entry doesn't exist 
//  ADTL Palette 0 
//  do nothing...nothing changed. 
//  clone the sheet drawing along with its relationships 
//  WRONG! 
//  Remove the relationships part 
//  plus pne   plus pne 
//  Ask, will get 181 
//  It MUST be the UnitPixel value of the UnitType enumeration 
//  current y-extent. 
//  by the time this gets called, all other document parts should   have been loaded, so it's safe to build the document structure 
//  here it is useful to add the cause to not loose the original stack-trace 
//  Use POIFS to query that lot 
//  A 32-bit unsigned integer that specifies how to handle edge conditions with a value from the WrapMode enumeration 
//  A 32-bit unsigned integer that specifies the number of polygons. 
//  <a:sysClr val="windowText" lastClr="000000"/> 
//  Create a new workbook 
//  trailing newlines are ignored 
//  Ensure the escher layer knows about the added records 
// this file derives from common crawl: see Bug 60677 
//  the schema type loader is cached per thread in POIXMLTypeLoader.   So create a new Thread and change the context class loader (which would normally be used)   to not contain the OOXML classes 
//  fallback for unsupported glyphs 
//  Get the Core Properties 
//  Moving to an earlier point in the array   Grab everything between the two points 
//  only non-null if a subshape 
//  Check they have what we expect 
//  A SlideShow with three slides 
//  Area3DPxg [sheet=Table ! A2:A7] 
//  WHITE_BRUSH - A white, solid-color brush   BrushStyle: BS_SOLID   Color: 0x00FFFFFF 
//  Check range bounds against grid max 
//  Note boundaries - skip outer quotes 
//  Need to walk backward to find the last non-blank row   NOTE: n is always negative here 
//  Border Styles, in BorderStyle/STBorderStyle enum order 
//  interestingly, in testing, a validation value of the string "TRUE" or "true"    did not match a boolean cell value of TRUE - so apparently cell type matters   also, Excel validation is case insensitive - "true" is valid for the list value "TRUE" 
//  Because we don't properly know about all the details of the old    section properties, and we're trying to decode them as if they    were the new ones, we sometimes "need" more data than we have. 
//  step over column name chars until first digit for row number. 
/*  use "0" for the id. See ECM-576, 20.2.2.3  */
//  additionally try the other getText() methods 
//  For now, only consider the first one 
//  302: WEIBULL 
//  Pick a predictable format + location + timezone 
//  Marshall the properties inside a XML   Document 
//  boolean values when the target(x) is a string 
//  cells C4:C6 are not included in array formula, 
//  18 @ 4078 
//  01 18 31 00 03 20 00 00   E8 03 06 08 07 08 08 08 09 10 01 00 0C 20 04 00   00 00 00 88 1E 00 00 00 
// remove all 
// check that setting formula result works 
// bad module.offset, try brute force 
//  Create a workbook with one sheet and size the first three somewhat   larger so we can fit the chemical structure diagram in. 
/*          * We skip the signing certificate itself according to section         * 4.4.3.2 of the XAdES 1.4.1 specification.          */
//  after shifting, the two named regions should still be there as they   are fully inside the shifted area 
//   all our bits 
//  =============== Private methods ======================== 
//  Grab our 7x pre-data 
//  removed sheet was the active one, reset active sheet if there is still one left now 
//  Custom formats with text 
//  by creating Cells out of order we trigger the handling in onDocumentWrite() 
//  Note String comparisons are case insensitive 
//  361: AVERAGEA 
/*          * An array of LFO structures. The number of elements in this array is         * specified by lfoMac. -- Page 424 of 621. [MS-DOC] -- v20110315 Word         * (.doc) Binary File Format          */
// the check below failed prior to fix of Bug #47804 
//  Should now have a mini-fat and a mini-stream 
//  add list data on same sheet 
//  Grab the guts record, adding if needed 
// getDefaultColumnWidth returns width measured in characters  getColumnWidth returns width measured in 1/256th units 
// set font 2 to 10 point type 
//  This can be part of date, elapsed, or number 
//  This is observable in version 3.0 
//  draw line decorations 
//  Check the digital signature part   Won't be there in this file, but we    need to do this check so that the    appropriate parts end up in the    smaller ooxml schemas file 
// reserved 
//  Good, well supported 
//  case CellType.BOOLEAN 
//  when running in Gump, the VM is very slow, so we should allow much more time 
//  If this part has been created from scratch and/or the data buffer is   not   initialize, so we do it now. 
//  record in bytes, including the 12-byte record header and record-specific data. 
//  Re-open and check 
//  workbook scope only 
//  Happy day flow - evaluate A1 first 
// revert to a blank cell 
//  Strip the sheet name,   CTWorksheet.getTableParts defines in which sheet the table is 
//  Get a clean filesystem to start with 
// options_field+first_formula_size+first_unused+sec_formula_size+sec+unused; 
//  if cell values have changed, clear cached format results 
//  Finish up 
//  Setup our header block 
//  the document to be considered valid. 
//  increment the count for this level 
// first byte 
//  Microsoft Office Word 97-2007 Binary File Format (.doc) Specification 
//  Extract using the model code 
//  Anchor entirely within one cell. 
//  2 bytes blank 
//  Raw Pictures contained in the pictures stream 
// draw a thick black border on the row at the bottom using BLANKS 
//  This condition commented out, as Word seems to set outline levels even for     paragraph with other styles than Heading 1..9, even though specification     does not say so. See bug 49820 for discussion. 
//  recurse to continue matching 
//  String stream 
//  0xFC000000 MUST be zero and MUST be ignored 
//  This value MUST be less than or equal to 8,192. 
//  match 
//  Note - CommonCrawl shows there's more variation in these than          the documentation suggests, so accept common clusters around          the "correct" value as well 
//  Grab the SlidePersistAtom with the highest Slide Number.   (Will stay as null if no SlidePersistAtom exists yet in 
//  Open from the temp file in read-write mode 
//  TODO Test the indent 
//  Grab the base name of the font they've asked about 
/*              * plcflst (list formats) Written immediately after the end of the             * previously recorded, if there are any lists defined in the             * document. This begins with a short count of LSTF structures             * followed by those LSTF structures. This is immediately followed             * by the allocated data hanging off the LSTFs. This data consists             * of the array of LVLs for each LSTF. (Each LVL consists of an LVLF             * followed by two grpprls and an XST.)             *              * Microsoft Office Word 97-2007 Binary File Format (.doc)             * Specification; Page 25 of 210              */
//  The condition to apply. 
//  write out the SectionTable. 
//  Should have two virtual chunk commands, a 
//  restore the transform 
/*          * JSR105 ds:Signature creation          */
//  y   width 
//  4 @ 152 
//  end public class DocumentNode 
//  Phone number format 
//  fallback to the usual suspects 
//  it's wrap text property should be set to 'true' 
//  Performance optimization: build sheet cache the first time this is called   to avoid re-creating the XSSFEvaluationSheet each time a new cell is evaluated   EvaluationWorkbooks make not guarantee to synchronize changes made to   the underlying workbook after the EvaluationWorkbook is created. 
//  OOXML Strict is not yet supported, see bug #57699 
//  Via set defaults 
/*          * Add a merge area          */
//  Flag: cccUUUUU    c1a: offset 0 / 0x000    c1b: length 6+2  -> {\rtf1\a    c2a: offset 16 / 0x010    c2b: length 1+2  ->  def    c3a: offset 182 / 0xb6    c3b: length 0+2  -> la    n   g   1   0   2 
//  when reading the picture elements, each time a segment is read, the cipher needs   to be reset (usually done when calling Cipher.doFinal) 
//         CellStyle cs = workbook.createCellStyle();          cs.setShrinkToFit(false);          row.createCell(0).setCellStyle(cs); 
//  The hyperlinks may come before the fonts,    or slightly in front 
//  Write the PPT stream into the POIFS layer 
//  every quote must be followed by another 
//  A 32-bit unsigned integer that specifies the value in the LineJoin enumeration, which specifies how   to join two lines that are drawn by the same pen and whose ends meet. At the intersection of the two 
// int len = _sections.size(); 
//  ID information taken from http://msdn.microsoft.com/en-us/library/microsoft.exchange.data.contenttypes.tnef.tnefattributetag%28v=EXCHG.140%29.aspx 
//  If an error occurs while reading the next level of openZipEntrySourceStream, free the acquired resource 
//  aptg is part of a formula in a cell that was just copied to another row   aptg row references should be updated by the difference in rows that the cell was copied   No other references besides the cells that were involved in the copy need to be updated   this makes the row copy significantly different from the row shift, where all references   in the workbook need to track the row shift 
//  Confirm expected size of first record, and ushort strLen. 
// each slide uses its own master 
//  from stream 
//  no need to write a single empty MergeCellsRecord 
//  Plus check core details are there 
//  And the others 
// convert <t>string</t> into a text run: <r><t>string</t></r> 
/*  This name is not visible in Word 2010 anywhere  */
//  Excel Workbook - either binary or OpenXML 
//  Then by String 
//  no exception at this point 
//  As an additional check, recover the defauls footer and   make sure that it contains two paragraphs of text and that 
/*              * Microsoft Office Word 97-2007 Binary File Format (.doc)             * Specification             *              * Page 78 of 210             *              * sprmCDispFldRMark (opcode 0xCA62) is interpreted by moving the             * first parameter byte to chp.fDispFldRMark, the next two bytes to             * chp.ibstDispFldRMark, the next four bytes to             * chp.dttmDispFldRMark, and the remaining 32 bytes to             * chp.xstDispFldRMark.              */
// Bug54686 patch sets default behavior of # #/## if there is a failure to parse 
//  Wind on our length + our header 
//  Initially has Properties + BAT but nothing else 
//  Set up defaults. 
//  Update the new position 
//  note - no moniker GUID   "\\\\MyServer\\my-share\\myDir\\PRODNAME.xls" 
//  check attributes of paragraphs 
//  Set value to the first cell 
//  now check again 
//  user defined function   in the token tree, the name is more or less the first argument 
//  Find our children 
//  Get the table 
//  OOO calls this SHEETLAYOUT 
//  the slide, or only master slide's ones do) 
//  Shift 3 forward 
//  do not clear the part here 
//  Horizontal flipping applies only to shape outline and not to the text in the shape. 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getEmptyCellAllowed()	  */
//  Check slide 2 is as expected (was re-ordered from 3) 
//  Allocate a block if needed, otherwise figure    out what the next block will be 
//  Determine the maximum overall level 
//  X=ok, Y=balance 
//  sprmPFInnerTtp  
//  The spec says that there should be 6 bytes at the    end, which must be there and must be zero   However, sometimes Excel forgets them... 
//  Check the MID Ptgs in Row 2 have V RefPtgs for A1 
//  other files containing ole10native records ... 
//  Sanity check the length 
//  testNames.xls contains a VB function called 'myFunc' 
/*  Accesseurs  */
//  Note: structured references are evaluated and resolved to regular 3D area references. 
//  A 32-bit unsigned integer that defines the size, in bytes, of the image.   If the Compression value is BI_RGB, this value SHOULD be zero and MUST be ignored.   If the Compression value is BI_JPEG or BI_PNG, this value MUST specify the size of the JPEG 
//  remove these elements if present as it results in invalid content when opening in Excel. 
//  cached for performance, used with cell text comparisons, which are case insensitive and need to be Locale aware (contains, starts with, etc.)  
//  Special Handling of 1035=PPDrawingGroup and 1036=PPDrawing 
//  it has to be continuous digits 
//       favor of setSpacingLine(double, LineSpacingRule) 
//  In case A, all has the same spacing and alignment 
//  Do the fiddly namespace bits on the inline   (We need full control of what goes where and as what) 
//  Trigger flattening of user model and corresponding update of dgg record. 
//  necessary to substitute a TrueType font with another name. 
//  the safe version of addMergedRegion should throw when trying to add a merged region that overlaps an existing region 
//  skip header 
//  An EmfPlusPath object that specifies the boundary of the brush. 
//  Finds the record at a given position 
//  make sure that the number is positive 
//  skip any top frames inside junit.framework.Assert 
//  this is probably always zero 
//  Has 2 headers 
//  result.put(Integer.valueOf(0x0406), result.get(Integer.valueOf(0x06))); 
//  actually ordered, so iteration order is predictable 
//  2 0x04 - reserved bit must be 0 
//  for OOXML we need to set formula1 to the quoted csv list of values (doesn't appear documented, but that's where Excel puts its lists)   further, Excel has no escaping for commas in explicit lists, so we don't need to worry about that. 
//  This document has 15 styles 
//  Set the type of the icon set 
//  Line ending in its own run each time! 
//  /p:sldMaster/p:txStyles/p:titleStyle/a:lvl1pPr 
//  null cell A5 is shifted 
//  ======================   Only do additional copy operations here that cannot be done with Row.copyFromRow(Row, options)   reasons: operation needs to interact with multiple rows or sheets 
//  Turn it into an array 
//  not quite - if written by google docs 
//  These can be part of date, or elapsed 
//  Reference to a named range in our own workbook, as if it 
//  SigningCertificate 
//  2 * (2^2) 
// windows 1251 
// delete the CTSheet reference from workbook.xml 
//  iterate over shapes and check shapeId 
//  Link our new workbook 
//  Ensure it got the right namespaces 
//  check for object identity 
//  Now Look at the code 
//  text isn't quite the format rule... 
//  1 less than distance to end of if FuncVar(size=4). +4 for attr skip before   1 less than distance to end of if FuncVar(size=4). 
//  Now check the contents 
// enforces singleton 
//  check if the cell is inside the table 
//  Tint doesn't have the alpha 
/*  Width is a percentage, e.g. "33.3%" or 50 times percentage value, rounded to an integer,  */
//   then the properties at the end 
//  create a row 
//  between excel and java (e.g. 9.9..9E-8) 
//     /**       * Sets the orientation of the line, if inverse is false, then line goes       * from top-left to bottom-right, otherwise use inverse equals true        *       * @param inverse the orientation of the line       */ 
//  Grab the type 
//  expected to change in place (although this is not a strict requirement) 
//  Check it's now like data 
// set top-left corner of the picture, 
//  STD Moniker 
//  Calculate the size of the records from the end of the BOF   and up to the RowRecordsAggregate... 
//  default value 
//  test some other cached value types  
// read available styles 
//  We need to buffer the whole file into memory when    working with an InputStream. 
// REFERENCE_REGISTERED must come immediately after  REFERENCE_NAME to allow for fall through in special case of bug 62625 
//  That's when we're out of both 0x13s and 0x15s 
//  formula cell 
//  the other bytes will be encoded, when setNextRecordSize is called the next time 
//  set dummy size, in case of dummy dimension can't be set 
//  Create a slideshow covering it 
//  to row 8   from col 4   to col 6   no flags set 
//  Grab the reference ID 
//  unary plus is a no-op 
//  check we found july properly 
//  do end-work here, we don't do this in a finally as we log   Exception 
//  Can't think of a good way to check whether a directory is actually deleted since it would require the VM to stop.   Solution: set TempFileCreationStrategy to something that the unit test can trigger a deletion" 
//  An optional blend pattern for the path gradient brush. If this field is present, it MUST contain either 
//  FIXME 
//  Wind on 
//  Can go to the end, but not past it 
//  mapping <java AffineTransform> = <xform> 
//  A 32-bit signed integer that specifies attributes of the character glyphs that affect the appearance of 
//  test with just long enough name, small file 
//  ... also need to handle invocation in case of a filled chunk 
//  set the fc in the section descriptor 
// simulate a continues drawing record 
//  Check the last data block 
// fontFmt.setFontColorIndex((short)11); 
//  Icons : 3 symbols with backgrounds - Column L 
//  sheet3 A1 
//  nobody was listening for this document before 
//  Note: These fields are protected to help with unit testing   Other classes shouldn't really go playing with them! 
//  Normal behaviour 
//  stay within - no change   move completely out - no change   moved exactly to top - no change   truncation at top   moved exactly to bottom - no change   truncation at bottom 
//  range will be C1:D1 
//  All done! 
// The ppt object to write into. 
//  These crazy ones are valid 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#getValidationType()	  */
//  attempt update input at cell A2 (which is missing) 
//  Either the save operation succeed or not, we delete the temporary file 
//       {          shds[x].serialize(buf, 1 + (x * ShadingDescriptor.SIZE));        }        size += SprmUtils.addSpecialSprm((short)0xD609, buf, sprmList); 
//  Do we have a pending buffer for the mini stream? 
//  calls System.exit(): SLWTTextListing.main(new String[0]); 
//  Try to retrieve the target part 
//  calcMode="manual" is unset when forceFormulaRecalculation=true 
//  recStream is exhausted; 
//  We don't parse the contents, so    nothing will have changed 
//  the xml signature classes will try to find a special TransformerService,   which is ofcourse unknown to JCE before ... 
//  remove the directory after the tests 
//  as per "Microsoft Excel Developer's Kit" book   older version of SXVDEX - doesn't seem to have a sub-total name 
//  restart the loop given the new index 
//  --> For each character in the password:        --> For every bit in the character, starting with the least significant and progressing to (but excluding)             the most significant, if the bit is set, XOR the keys high-order word with the corresponding word from  
// should be 4 
//  Note - everything but BlankEval counts 
//  should not include "12345678" - note that the input value was negative 
/*                  * Re-initialize the c14n else the namespaces will get cached                 * and will be missing from the c14n resulting nodes.                  */
//  Set a date format 
//  Jan. 1, 2000 
//  open the zip entry source stream 
//  90 to 270 
//  54 chars, 21 + 17 + 16 
//  Check the fills on them at the low level 
//  Now check the details of one or two 
//  Paste values only 
//  If linespacing >= 0, then linespacing is a percentage of normal line height. 
//  split to 3 records 
//  Now process the date 
//  BAT, Props, SBAT, MIni 
// now Slide.getShapes() should return an empty array 
//  assumes the object returned by EvaluationCell.getIdentityKey() has a well behaved hashCode+equals 
//  Try a few likely suspects... 
//  get next-available numberFormat index.   Assumption: gaps in number format ids are acceptable   to catch arithmetic overflow, nextKey's data type   must match numberFormat's key data type 
//  compare the hashes 
//  This 32-bit unsigned integer is unused and MUST be set to zero. 
//  http://msdn.microsoft.com/en-us/library/office/gg615594(v=office.14).aspx   repeated slideIds can be overwritten, i.e. ignored 
//    Moving to a later point in the array   
//  3 @ 4093   *mask bit* 1,3,5 
//  keep going, this shouldn't cancel things 
//  22 -> 88 simple sequential stream 
//             os.close();          } 
//  5 -> num 
// make some noise 
// noinspection StatementWithEmptyBody 
//  cs5 --> 25 -> 24 
//  @deprecated 3.15 beta 2. getBorderStyle will only work on BorderStyle enums instead of codes in the future. 
//  some extra checks to make sure we don't hide some other bug with the rounding 
// if whole part has to go into the numerator 
//  Try with one with the entities in the Content Types 
//  e.g. XSSFEventBaseExcelExtractor passes a null-document 
//  Read in the header 
//  clean up the directory that POIFSDump writes to 
//  no pane configured 
//  default margins from slide master 
//  special cases where docx-handling breaks, but OPCPackage handling works 
//  for each cell in sheet, if cell belongs to an array formula, check if merged region intersects array formula cells 
//  check if cell is on the same sheet as the table 
//  count of bytes in sttbfffn   table stream offset for sttbfffn 
//  Bug 59004   the adjust value are format dependent, we scale them up so they match the OOXML ones.   see https://social.msdn.microsoft.com/Forums/en-US/33e458e6-58df-48fe-9a10-e303ab08991d/preset-shapes-for-ppt?forum=os_binaryfile 
/*  Turn the property set into a summary information property. This is         * done by setting the format ID of its first section to         * SectionIDMap.SUMMARY_INFORMATION_ID.  */
//  Firstly, check if there are any speech marks (") in the field;   each occurrence must be escaped with another set of spech marks   and then the entire field should be enclosed within another   set of speech marks. Thus, "Yes" he said would become   """Yes"" he said" 
//  Empty directory 
//  We need this before we can detect Encrypted Documents 
//  A 32-bit signed integer that specifies the logical height of the destination rectangle. 
// "poifs/protect.xlsx",  "poifs/protected_sha512.xlsx",  "poifs/extenxls_pwd123.xlsx", 
//  second part is not compatible with an area ref e.g. S!A1:S!B2   where S might be a sheet name (that looks like a column name) 
//  fill the "known" image data 
//   we seem to loose it 
//  [G7] 
//  With a cell that isn't defined, we'll get null 
/*  Copy the property set to the destination POI file                     * system.  */
//  make sure header / footer is properly linked to underlying data  
//  The first two POINT values specify the bounding rectangle of the ellipse.   The second two POINT values specify the radial vectors for the ellipse.   The radial vectors are cast from the center of the bounding rectangle.   The path starts at the POINT where the first radial vector intersects the   bounding rectangle and goes to the POINT where the second radial vector   intersects the bounding rectangle. The drawing direction is always counterclockwise.   If the path has already been started, a line is drawn from the last POINT to   the starting POINT of the arc; otherwise, a new path is started.   The number of arc segments drawn equals the number of segments divided by four. 
//  to hand when turning the Ptgs into a string 
//    and its origin is the upper-left corner. Top-down bitmaps do not support compression. 
//  old Excel files, which we only support simple text extraction of 
//  More complicated strings 
//  Saving the workbook should not change the sheet names 
//  Load a different file   This file has has something in lines 1-33 
//  name has sheet-level scope 
//  256 colors 
//  Now do the character stylings 
//  Ensure the right element 
//  Was \r\r but gets emptied 
//  byte intbuf[] = new byte[LittleEndianConsts.INT_SIZE];   byte shortbuf[] = new byte[LittleEndianConsts.SHORT_SIZE]; 
// set default properties for a TextBox 
//  minor increment 
//  m10 (shearY) = eM21 (Vertical proportionality constant) 
//  add these to the header 
//  Two Levels Down 
//  Failing that try via the raw headers  
//  Return our first spot 
//  compare with natural sort order 
//  none currently 
//  Have we hit the end of the file yet? 
//  An EmfPlusGraphicsVersion object that specifies the version of operating system graphics that was used 
//  Open without preserving nodes 
//  <Relationship   TargetMode="External"   Id="rIdx"   Target="http://www.custom.com/images/pic1.jpg"   Type="http://www.custom.com/external-resource"/> 
//  Reserved; set to zero 
//  comment-extraction and formula extraction are not well supported in event based extraction 
//  This record seems to have different valid encodings 
//  Normalise the format string 
//  More checking of shared features stuff 
/*  A tree node for the POI filesystem does not yet                 * exist.  */
//  force recalculation of internal fields 
// The ValueRecordsAggregate use a tree map underneath.  The tree Map uses the CellValueRecordInterface as both the  key and the value, if we dont do a remove, then  the previous instance of the key is retained, effectively using  double the memory 
//  Tell the header that we've got our first SBAT there 
//  We don't want #REF! errors if we copy a row that contains cells that are referred to by other cells outside of copied region 
//  Check things parse as expected: 
//  Look out outline details of start 
//  Check the signature matches 
//  index to last column and relative flags 
//  hidden bit only is altered for this outline level.  ie.  don't uncollapse contained groups 
//  This is the name of the HotSpot Diagnostic MBean 
//  A1: SUM(B1: IZ1) 
//  Get the row and it's height 
//       assertRefPtgA1('V', getPtgs(cell), 4); // FIXME!        assertRefPtgA1('V', getPtgs(cell), 9); // FIXME! 
//  series number   format flags 
//  A 32-bit floating-point value that specifies the distance between the 
//  reference ends with the delimited name.    Assume names like: "Sheet1!'A1'" are never legal. 
// calculation chain is auxiliary, remove it as it may contain orphan references to deleted cells 
//  last 4 bytes in block   first 4 bytes in next block 
//  Check that they're apparently the same 
// activeTab (Active Sheet Index) Specifies an unsignedInt  that contains the index to the active sheet in this book view. 
//  unset points if percentage is now set 
//  Check taken 
//  The proper way to do hyperlinks(!) 
//  a test-case to test this locally without executing the full TestAllFiles 
//  Options of 0x000F means container record   However, EscherTextboxRecord are containers of records for the    host application, not of other Escher records, so treat them    differently 
// draw a simple bar graph 
//  that is rather small 
//  This is fun - blue if positive time,    red if negative time or green for zero! 
//  Ask for another, will get our first XBAT 
//  To start with, find the most recent in the byte offset domain 
//  Read the FAT blocks 
//  The formula has an array with 3 rows and 5 columns 
//  line.setLineCompound(other.getLineCompound());   line.setLineDashing(other.getLineDashing()); 
//  Throw IllegalStateException if the argument CellRangeAddress intersects with 
// paint the filled rectangle at the bottom left hand position 
//  Parameters 
//  current junits are asserting incorrect behaviour 
//  Decode 
//  DEVICE_DEFAULT_FONT   The default font that is provided by the graphics device driver for the current output device 
//  Recursively delete 
//  merge 
//  Can't rely on field_2_numIdClusters 
//  As expected 
//  verify behavior of getName 
//  all these operations are on an area ref spanning rows 20 to 25 
//  explicit range ':' operator 
//  The rules for generating the auto numbers are as follows. If the   following paragraph is also   an auto-number, has the same type/scheme (and startAt if defined on   this paragraph) then they are   considered part of the same group. An empty bullet paragraph is   counted as part of the same   group but does not increment the count for the group. A change of   type, startAt or the paragraph   not being a bullet resets the count for that level to 1. 
// check we can read the trimmed record 
//  thus search for it 
//  the next byte index after the string ends 
//  Grab the header 
//  Compare the header and the text 
//  add content to each cell 
//  File BLIP Store Entry (FBSE) 
//  fill in any gaps if there are empty cells with comment mixed in with non-empty cells 
//  It helps to round the inprecise reciprocal values to i. 
//  check for too much precision 
//  near lowest normal number   lowest normal number   highest subnormal number   subnormal number 
//  nothing matched => throw the exception to the outside 
//  adjust all the affected comment-structures now   the Map is sorted and thus provides them in the order that we need here, 
//  Check to see if we've walked off the end of the string. 
//  axis type   x 
//  don't try to handle Date value 0, let a 3 or 4-part format take care of it  
//  check new location where the ref points to 
//  across a shape, when the image is smaller than the area being filled. 
//  But when we ask for the string, that is sorted for us 
//  finally also write it out via the streaming interface and verify that we still can read it back in 
//  according to exact definition of isDeleted() 
//  Try writing just into 3 blocks worth 
//  Has two slides 
//  1-row/1-column intersection 
// InputStream stream = HSSFTestDataSamples.openSampleFileStream(") 
//  convenient access to namespace   private static final ErrorEval EE = null; 
//  found an unread record 
//  If a 14 comes before the next 13, then   zap from the 13 to the 14, and remove 
/*  After adding a custom property with the same name the size must still         * be one.  */
//  178 -> 179 -> 180 -> end 
//  Test using an existing workbook saved by Excel 
//  create directory if it doesn't exist 
//  FtPioGrbit (pictFlags) 
/*  Initialize the "byteOrder" field.  */
//  Don't carry over matches, but keep everything     else as it was 
// drawingNumber = #drawings.size() + 1 
//  Clear contents cache 
//  First 12 -> 11 
// stored strings table 
//  If it isn't unknown or custom, store it for lookup 
//  Now try to turn it into id + type 
//  Shift rows 1-3 down 3 in the current one.  This tests when 
//  The TextPiece is already in characters, which 
//  Write out our text 
//  The font list comes slightly later 
//  =myFunc("_") 
//  Check the one referring to the previously existing workbook behaves 
//  32768 produces an invalid XLS file 
/*  Write double word.  */
//  Off we go 
//  except with a thick black border at the bottom 
//  Can be opened at the OPC level 
// 				sheet.createRow(rowIndex); 
//  Then rows 4-10 are defined 
//  The list of entries we've written out 
//             wb.write(os); 
//  Returns EscherContainerRecord, but really msofbtClientTextbox 
//  check for XAdES-BES 
//  If this attribute is omitted, then a value of 0.1 inches is implied 
//  Get a font, and slightly change it 
//  Static evaluator won't work, as no references passed in 
//  Look for latest core records that are slides or notes 
//  Create a cell at A1 and insert a single, bulleted, item into 
//  make sense of the image data 
//  Flags whether the string is Unicode.   Classname of the embedded OLE document (e.g. Word.Document.8) 
//  only 2 text nodes where text is collected: 
//  default to 0, if indentLevel is not set 
//  For -ve numbers, gets a bit more complicated... 
/*  Have the property streams been read yet? (Only done on-demand)  */
//  Set the delete on exit flag, unless explicitly disabled 
// print hex dump if failed 
//  The compressed code sequence is held over 2 bytes 
//  from /p:sldMaster/p:txStyles/p:otherStyle/a:lvl1pPr/a:defRPr 
/*  @see <a href="http://msdn.microsoft.com/en-us/library/dd905225(v=office.12).aspx">2.3.5 Office Binary Document RC4 CryptoAPI Encryption</a>  */
//  Modulo Formula: "mod x y z" = sqrt(x^2 + b^2 + c^2) = value of this guide 
//  index in the color scheme 
//  Connector, shapes and text boxes are all two cell anchors 
//  value is 'denormalised' which means it is less than 2^-1022   excel displays all these numbers as zero, even though calculations work OK 
//  Create a from part way down the byte stream 
//  Keep this code in sync with {@link RowShifter#shiftMergedRegions} 
//  No revision given, as not enough data. Odd 
//  GB2312 charset 
// add a relationship with internal target: "#Sheet1!A1" 
//  This document is widely available on the internet as "blair.doc".   I tried stripping the content and saving the document but my version   of Word (from Office XP) strips this table out. 
//  A 32-bit unsigned integer that specifies the index of the pattern brush 
//  a failed invocation of Row.removeCell leaves the row   in the state that it was in prior to the invocation 
//  Check it's of the right size 
//  First, copy the base css 
//  Write collapse flag (stored in a single col info record after this 
//  Note that again, an HSSFCellStye object is required and that 
//  this is not the same as in XSSFRelation.WORKBOOK, as it is usually used by embedded charts   referencing the original embedded excel workbook 
/*  * Identifies both built-in and user defined formats within a workbook.<p> * See {@link BuiltinFormats} for a list of supported built-in formats.<p> * * <b>International Formats</b><br> * Since version 2003 Excel has supported international formats.  These are denoted * with a prefix "[$-xxx]" (where xxx is a 1-7 digit hexadecimal number). * See the Microsoft article * <a href="http://office.microsoft.com/assistance/hfws.aspx?AssetID=HA010346351033&CTT=6&Origin=EC010272491033"> *   Creating international number formats * </a> for more details on these codes.  */
//  Force encoded operand class for tArray 
//  this evaluation is done, reset indent to stop logging 
//  A 16-bit signed integer that defines the horizontal (x-axis) coordinate, in 
// serialize and assert against the source data 
//  values chosen to produce rounding anomaly 
/* Cell c2 = */
//  values are in the range [0..100] (usually ...) 
//  manual override for one function name which contains lowercase characters 
//  HSL code is public domain - see https://tips4java.wordpress.com/contact-us/ 
//  this shouldn't happen 
//  ignore all ref strings 
// bug59858 shows that dirstream may not be in this directory (\MBD00082648\_VBA_PROJECT_CUR\VBA ENTRY NAME)  but may be in another directory (\_VBA_PROJECT_CUR\VBA ENTRY NAME)  process the dirstream first -- "dir" is case insensitive 
//  A 32-bit signed integer that specifies the height, in logical units, of the font's   character cell or character. The character height value, also known as the em size, is the   character cell height value minus the internal leading value. The font mapper SHOULD   interpret the value specified in the Height field in the following manner.     0x00000000 < value:   The font mapper transforms this value into device units and matches it against   the cell height of the available fonts.     0x00000000   The font mapper uses a default height value when it searches for a match.     value < 0x00000000:   The font mapper transforms this value into device units and matches its   absolute value against the character height of the available fonts.     For all height comparisons, the font mapper SHOULD look for the largest font that does not 
// xNum 
//  known result 
//  ID of the OLE stream containing the actual data. 
//  178 -> 179 -> 180, 181+ is free 
//  add many sheets so "first visible" is relevant 
//  The y-coordinate of the ending vertex on an arc. 
// single-cell array formula 
/*  ===============================================================	 *                 External Serialisation Methods	 * ===============================================================	  */
//  Ensure we still have one section, 5 paragraphs 
//  unset to defauls 
//  of the number of 16-bit words in the entire metafile. 
//  = cs1 
//   we split one compressed bit into two 
//  Check it still has 2 slides 
//  3rd is right aligned + normal line spacing 
//  A1:O1 
//  overwrite the hyperlink at dest cell with srcCell's hyperlink   if srcCell doesn't have a hyperlink, clear the hyperlink (if one exists) at destCell 
//  If there are specified categories, find out if this has one of them 
//  Look up the local sheet 
//  21 jumps to 89, then ends 
// the correct amount. 
//  retrieve the newly created named range 
// Offset=0x00000612(1554) recno=71 sid=0x00FC size=0x2020(8224) 
//  will be handled by workaround below 
// System.setProperty("org.apache.poi.util.POILogger", "org.apache.poi.util.SystemOutLogger");  System.setProperty("poi.log.level", "3"); 
//  incorrect margin constant 
//  The idx attribute refers to the index of a fill style or   background fill style within the presentation's style matrix, defined by the fmtScheme element.   value of 0 or 1000 indicates no background,   values 1-999 refer to the index of a fill style within the fillStyleLst element 
//  2017-12-01 09:54:33 which is 42747.412892397523 as double 
// check that the added pictures are accessible after write 
//                 // successful tests should be silent 
//  Excel day 30000 is date 18-Feb-1982   0.7 corresponds to time 16:48:00 
//  startPos is 1x1 area ref, numChars is cell ref 
// none is not the same as "not set", therefore the following doesn't work any more  assertFalse(ctBorder.isSetLeft()); 
//  Unused: UUF_UNUSED_PUBLIC_OR_PROTECTED_FIELD 
//  create a workbook 
//  encoded Ptg size   unknown int 
//  reference itself 
//  second char run is 17 long   font.color only 
// Can't have -1 bytes read in the error message! 
//     public final static short       OBJECT_TYPE_POLYGON            = 9;      public final static short       OBJECT_TYPE_CHECKBOX           = 11;      public final static short       OBJECT_TYPE_OPTION_BUTTON      = 12;      public final static short       OBJECT_TYPE_EDIT_BOX           = 13;      public final static short       OBJECT_TYPE_LABEL              = 14;      public final static short       OBJECT_TYPE_DIALOG_BOX         = 15;      public final static short       OBJECT_TYPE_SPINNER            = 16;      public final static short       OBJECT_TYPE_SCROLL_BAR         = 17;      public final static short       OBJECT_TYPE_LIST_BOX           = 18; 
/*  ********** START implementation of Entry **********  */
// /////////////////////////////////////////// 
//  lazy initialization 
//  one of the limits was reached, report it 
//  Also check all use the default style 
//  sprmPRsid -- 0x6467  
//  only for built in styles 
//  Grab the block size 
//  note there is no "clear2 B2 91" here because B2 doesn't depend on C1 anymore 
//  3072 - main SpContainer id 
//  Now check we get the right formula back for 
//  Add some text to the empty header 
//  collapsed: 
//  If written, will be the usual size 
//  set the font 
//  E4 to H9 of sheet 5 make up the table 
//  base weight of font   character set identifier   index into ffn.szFfn to the name of 
//  Write out the (new) header 
//  Final spacer 
//  keep the unknown records for re-serialization 
//  very naive impl, may need to be optimized 
//  Handle Parent-aware Records 
//  aggregate drawing records. 
//  = 2006-10-13T15:06:00.123+00:00 
//  process in chunks as we have a limit on size of column now 
//  Columns being moved completely enclose the ref.   - move the area ref along with the columns regardless of destination 
/*  Make the tree UI element visible.  */
//  Type is 70, or 0x46 
// The group itself is a shape, and always appears as the first EscherSpContainer in the group container. 
//  The argument is regular reference 
//  Change to a non unicode author, will stop being unicode 
//  1st is bold 
//  Covered Scenarios:   * row copy on same sheet   * row copy between different sheets in the same workbook 
//  read cell range address list with all affected ranges 
//  
//  Border 0   Palette 0 
//  It is a null terminated string 
//  Update for each new position 
//  row before and things are moved up 
//  Theme colours aren't tinted 
//  normal exit point 
//  validate with another office file (Excel 2013) 
//  reset otherwise a lot of ooxml tests will fail 
// autofilters seem to alway have this magic number 
//  Formula referencing an area 
//  and at last, use the default factory 
//  Loop over until they're all gone 
//  convert to zero based 
//  see TextFunction.TRIM for implementation 
// row with totals below 
// Bug54771a.docx and Bug54771b.docx test slightly   different recursion patterns. Keep both! 
//  sprmPBrcBottom80   
//  With nothing set 
//  Create a split with the lower left side being the active quadrant 
//  add clipping in case of a source subimage, i.e. a clipped source image   some dstBounds are horizontal or vertical flipped, so we need to normalize the images 
//  {   throw new UnsupportedOperationException(   "This Paragraph has no dataStream storage." );   }   we have some storage... 
//  backcolor   pattern 
//  this should only throw an error when evaluating the formula. 
//  create a XAdES time-stamp container 
//  Grab the picture object 
//  Save the package in the output directory 
//  Now add some empty ones 
//  Chain it 
//  For encrypted files:   The ObjectPool storage MUST NOT be present and if the file contains OLE objects, the storage   objects for the OLE objects MUST be stored in the Data stream as specified in sprmCPicLocation. 
//  Create nameid entries. 
//  Ensure it's not now too long 
//  Just grab the header, not the whole contents 
//  Now check where they crop up 
//  Row 18 is blank 
//  first line is chart title 
// skip fBidi  
//  textIdx = headerIdx + 1; 
//  Mask of the bits in the options used to store the image format. 
//  values 1001 and above refer to the index of a background fill style within the bgFillStyleLst element. 
//  I have not checked Excel to know if this is a LibreOffice or a POI problem. 
//  bool2 bitfields 
//  assumes other object is one of us, otherwise ClassCastException is thrown 
//  fails with IllegalArgumentException("Multiple cell comments in one cell are not allowed, cell: A1")   because createCellComment tries to create a cell at A1   (from CellAddress(anchor.getRow1(), anchor.getCell1())),   but cell A1 already has a comment (comment1).   Need to atomically create a comment and attach it to a cell.   Current workaround: change anchor between each usage   anchor.setCol1(1); 
// First row of the hyperlink 
//  We have a previous filled result. 
//  Pass the themes table along to things which need to     know about it, but have already been created by now 
//  Read FSPA and Escher information   _fspa = new FSPATable(_tableStream, _fib.getFcPlcspaMom(), 
//  which would be more efficient. 
//  don't try to shoot in foot, please -- vlsergey   r.setOptions((short)0x000F); 
//  Ensure the escher layer reflects the text changes 
//  perhaps this code should be moved to HexDump 
//  Write the matching OBJ record 
//  Push the time forward a bit and check 
// the second hyperlink now belongs to A6 
//  POIFS -> hssf 
/* int osVersion = (int) */
// the limit 
//  end indention options bitmask sets 
//  /p:sldLayout /p:cSld/p:spTree/p:sp/p:nvPr/p:ph[@type="ctrTitle"] 
// arbitrary sanity threshold 
//  ensure that sheets are moved up and removed sheets are not found any more 
// Test high row bound 
//  XXX: enrich 
//  Sheet based name 
/* Row: 0: Level: 3 Collapsed: false Hidden: falseRow: 1: Level: 3 Collapsed: false Hidden: falseRow: 2: Level: 2 Collapsed: false Hidden: falseRow: 3: Level: 1 Collapsed: false Hidden: falseRow: 4: Level: 0 Collapsed: false Hidden: falseRow: 7: Level: 3 Collapsed: false Hidden: trueRow: 8: Level: 3 Collapsed: false Hidden: trueRow: 9: Level: 2 Collapsed: true Hidden: trueRow: 10: Level: 1 Collapsed: true Hidden: trueRow: 11: Level: 0 Collapsed: true Hidden: falseRow: 14: Level: 3 Collapsed: false Hidden: trueRow: 15: Level: 3 Collapsed: false Hidden: trueRow: 16: Level: 2 Collapsed: true Hidden: falseRow: 17: Level: 1 Collapsed: false Hidden: falseRow: 18: Level: 0 Collapsed: false Hidden: falseRow: 20: Level: 3 Collapsed: false Hidden: trueRow: 21: Level: 3 Collapsed: false Hidden: trueRow: 22: Level: 2 Collapsed: true Hidden: trueRow: 23: Level: 1 Collapsed: true Hidden: falseRow: 24: Level: 0 Collapsed: false Hidden: falseRow: 27: Level: 3 Collapsed: false Hidden: trueRow: 28: Level: 3 Collapsed: false Hidden: trueRow: 29: Level: 2 Collapsed: false Hidden: trueRow: 30: Level: 1 Collapsed: true Hidden: trueRow: 31: Level: 0 Collapsed: true Hidden: false          */
//  Create the store 
// This should not happen. bug 59858 
/*  This is the expected behaviour.  */
//  First child is at 0x64b3 
//  Return the size less the header 
//  Literal Value Expression 
//  range will be C1:C1 
//  Save 
/*  char 13  */
//  Copy the data to the dictionary in the new place 
//  is compressed unicode 
//  Row "2" moved to row "12", and the formula has been updated. 
//  And make it non-contiguous 
//  Search backwards for '!' because sheet names can contain '!' 
//  validate 
// Get values for start row, start and end column 
//  E1 is null 
// Starting value from M$ empircal study. 
//  cannot extract date if only one hyphen is in the   string... 
//  raw hex data 
// or new XSSFWorkbook(); 
// inch  reserved 
//  This test is written as expected-to-fail and should be rewritten   as expected-to-pass when the bug is fixed. 
//  Then check our children in turn 
//  Color is undefined. 
//  Now read at various points 
/*  Remove all properties supported by HPSF from the summary         * information (e.g. author, edit date, application name) and from the         * document summary information (e.g. company, manager).  */
//  no DIR stream with offsets yet, so store the compressed bytes for later 
//  normally this results in #VALUE!,   but errors in individual cells take precedence 
//  record to the DIB header. 
//  Call methods to calculate how the image and sheet should be 
//  compare cell value to each item 
//  maximum 9 
//  Set 
//  all static methods, so no need for a public constructor 
//  Create a just-sub 2gb file 
//  C1   D1   E1 
//  Was this position a match? 
//  we will not paint empty paragraphs 
// getting cells from an empty row should returns null 
//  delete row 0-24, row 74 - 99 && change cell 3 on row 39 to string "MODIFIED CELL!!" 
//  row or cell does not exist 
//  sheet1 A2 formulae 
//  Write out and read back 
// label_opts  link_opts 
//  Checksum (may be wrong...) 
//  sprmPFInTable 
//  expected 
//  Now repeat it with spanning multiple blocks 
//  only one currency symbols is allowed 
//  50 characters divided by 1/20th of a point 
//  Open package 
//  NOSONAR   this also catches NoClassDefFoundError, which may be due to a local class path issue   This may occur if the code is run inside a web container   or a restricted JVM   See bug 61170: https://bz.apache.org/bugzilla/show_bug.cgi?id=61170 
// super.defaultColumnStyle(); 
//  field_3_cell_options bit map 
//  195: DSTDEVP 
//  (zero hyperlinks gets numberOfPLCs=1) 
//  The pivot table's data source is on the same sheet in A1:E7 
//  Now ask for a free one, will need to extend the SBAT chain 
//  A 16-bit signed integer that defines the ... coordinate 
// remove non-existing 
//  Complain if it's not 
//  pattern   weight 
//  _header.setPropertyStart has been updated on write ... 
// wb.write(new FileOutputStream(new File("C:\\temp\\test.xlsx"))); 
//  The start of the change is before we end 
//  Write out our HPFS properties, with any changes 
//  some colors 
//  as expected 
//  This row-shift should destroy the CF region 
//  Delegate test 
//  Add to the ptrData offset lookup hash 
//  Figure out if we are to suppress either the integer or fractional part.   With # the suppressed part is removed; with ? it is replaced with spaces. 
//  Notes of master 
//  don't write the old one as we'll use the correct name shortly 
//  there are 3 others besides the one at A32769:H32769 
// calculate dx2, offset in the rightmost cell 
//  Case 1: bullet=false, leftMargin=0, indent=0. 
//  Do we need to do anything? 
//  finally, if we had at least one cell we can populate the optional dimension-field 
//  this iteration is ordered by page number 
//  int nChars 
//  The elements MUST be in increasing order, and their values MUST be between 0.0 and 1.0, inclusive. 
//  Highly unlikely that this will be true but, if the width of a series   of columns is exactly equal to the required width of the image, then   simply build a ClientAnchorDetail object with an inset equal to the   total number of co-ordinate positions available in a column, a   from column co-ordinate (top left hand corner) equal to the value   of the startingColumn parameter and a to column co-ordinate equal   to the toColumn variable.   
// plain string value 
// or:  extends Var1or2ArgFunction { 
//  grab UserEditAtom 
//  Get the username length 
//  A pseudo special Excel dates 
//  Row 9 is empty, but with a blank at E9 
//  Table numbers need to be unique in the file, not just    unique within the sheet. Find the next one 
/*  Open file to decompress  */
//  These appear in the middle of the cell records, to    specify that the next bunch are empty but styled   Expand this out into multiple blank cells 
//  Get to a multiple of two 
//  map of tracked columns, with values containing the best-fit width for the column   Using a HashMap instead of a TreeMap because insertion (trackColumn), removal (untrackColumn), and membership (everything)   will be called more frequently than getTrackedColumns(). The O(1) cost of insertion, removal, and membership operations   outweigh the infrequent O(n*log n) cost of sorting getTrackedColumns(). 
//  a user edit atom is usually located 36 byte before the smallest known record offset  
//  5 paragraphs should get us to the end of our text 
//  Take a look in detail at the first couple of 
// Test a small string that is uncompressed 
//  Default name already taken, not index based, nothing free 
//           {              short[] brcBottom = rgtc[x].getBrcBottom (); 
// As per the equals method lets do this in stages 
//  A 32-bit unsigned integer that specifies the size, in bytes, of the 
/*  Set the properties.  */
//  Check date too 
//  subshapes if they exist 
//  Data entries 
//   new stream, save the start block offset 
//  default font size 
// create a CTRst bean attached to this SstDocument and copy the argument CTRst into it 
//  Contents must match 
//  http://www.techonthenet.com/excel/formulas/irr.php 
//  The HSSF has a max of 2^16 rows and 2^8 cols 
//  The cache hits would be 24 if fully evaluating all arguments of the   "IF()" functions (Each of the 8 formulas has 4 refs to formula cells   which result in 1 cache miss and 3 cache hits). However with the   short-circuit-if optimisation, 2 of the cell refs get skipped 
//  multiple master, OpenType font. The maximum number of values in the array is 16. 
//  Now re-check with preserving 
//  relative to the height of the shape. 
// creating custom palette 
//  Grab the 12 bytes that is "SSlideLayoutAtom" 
// color RGB will be extracted from theme 
//  Set one 
// ??        textFormatter[0x2C] = new DecimalFormat("_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)"); 
//  trying to extract width and height from pictures content: 
/*                  * Problems reading from the actual ByteArrayInputStream should                 * never happen so this will only ever be a ZipException.                  */
//  Empty dirs are fine 
//  Read the first file again 
//  expected here 
// add a picture in this workbook. 
//  find comment in A1 before we set the comment in B2 
//  Textual value 
//  If the field contains either embedded separator or EOL   characters, then escape the whole field by surrounding it   with speech marks. 
// the Application property must be set for new workbooks, see Bugzilla #47559 
//  as indicated by the Height value. 
//  first/second knot 
//  D1 is a blank cell 
//  options 
//  notes master aren't yet supported ... 
//  hidden: 
//  First is 30 long, left aligned, normal spacing 
//  Fill Palette 20c0 
//  Assert the repeat header is false by default 
//  count 
//  Truncate the password to 15 characters 
//  A 32-bit unsigned integer that defines the brush, the content of which is   determined by the S bit in the Flags field. 
//  Note - in Microsoft terms:    BAT ~= FAT    SBAT ~= MiniFAT    XBAT ~= DIFat 
//         + " font " + (font == null ? "<null>" : font.getFontName())); 
//  Updated our cached list of SlideListWithText records 
//  Memory consumption for a HashMap and TreeMap is about the same 
//  set properties to indent the resulting XML nicely 
// check if the cloned sheet has drawings 
//  logger.info("Created Row " + i); 
//  Keep in sync with {@link ColumnShifter#removalNeeded} 
//  simple test to at least cover some parts of the class 
//  Update and write out the Current User atom 
//  Report the first 5 children, to give a flavour 
//  TODO - PowerPoint   TODO - Publisher   TODO - Visio 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#setFormula1(java.lang.String)	  */
//  Value is only there for non-formula, non min/max thresholds 
// sheet name with no spaces 
//  Add a duplicate, check the right one is picked 
// B2:C3 
//  It SHOULD be 0x0000. 
//  Test idea: iterate over cells in the reference worksheet, they all have the R attribute set.   For each cell from the reference sheet find the corresponding cell in the problematic file (with missing R) 
//  Fixed by GR, we should not close it here 
//  Write out any extra bits 
/*  Read second word.  */
//  bold weight = x190   supersubscript 
//  Reset 
//  Can't think of a good way to check whether a file is actually deleted since it would require the VM to stop. 
//  setting spid only works with a vml drawing object   oleObj.setSpid("_x0000_s"+(1025+objectIdx)); 
//  else as is   else signed integer 
//  A 16-bit unsigned integer that identifies this record type 
//  sprmPFInnerTableCell 
//  Load individual sheets. The order of sheets is defined by the order 
/*  See comment at top of file  */
//  Start by finding the notes records 
//  required for displaying the DIB. If this value is zero, all color indexes are required. 
//  A 32-bit unsigned integer that specifies the total number of consecutive META_ESCAPE_ENHANCED_METAFILE 
//  Red 
//  Document to image is down a directory 
// Test that we get null for undefined rownumber 
//  tAttrIf 
/*  * Tests for logical ISxxx functions as loaded from a test data spreadsheet.<p>  */
// add CT_Drawing element which indicates that this sheet contains drawing components built on the drawingML platform. 
//  These ones specify colours, who knew that was allowed? 
//  meaningful only of _numberOfFlushedRows>0   meaningful only of _numberOfFlushedRows>0   meaningful only of _numberOfFlushedRows>0 
//  invalid date formats -- will throw exception in DecimalFormat ctor 
//  row 2 | X Y Z 
//  Add the core records for this new Slide to the record tree 
//  Document 
//  Change text via rich 
//  Check created ones get the right column 
//  Calculate how far the image will project into the next row. Note   that the height of the last row assessed is subtracted from the 
//  Append 
// noinspection SillyAssignment 
/*  * Created on May 8, 2005 *  */
//  Add a sheet with one row 
//  -> May be null 
//  end public class IntMapper 
/*  Use the convenience methods.  */
// continued part 
//  Column 'B' 
//  Non-integers of non-scientific magnitude are formatted as "up to 11   numeric characters, with the decimal point counting as a numeric   character". We know there is a decimal point, so limit to 10 digits. 
//  Odd is the default 
//  v2 version opcode 
//  Bump down by one, so still points    at the same sheet 
/*  A 32-bit signed integer that defines the x coordinate, in logical coordinates,         * of the ... corner of the rectangle.          */
//  verify behavior of isEmpty 
//  Ensure we have Table Columns 
//  the bar chart 
//  file GUID   file options   shortFileName: "YEARFR~1.XLS" 
//  Create cells 
//  If fractional part is zero, and numerator doesn't have '0', write out   only the integer part and strip the rest. 
//    B tAttrIf 
// Workbook wbBack = _testDataProvider.writeOutAndReadBack(wb); 
//  Apply the font 
//  shifting to next piece start 
//  Create a new RecordStream and use that 
//  optional multiple record occurs more than one time 
//  Everything we need is already there 
// Set cell style  cell.setCellStyle(style); 
//  Check the bytes are the same 
//  reserved2 - MUST be zero and MUST be ignored. 
//  These are represented as something like     C$1:C$65535 or D$1:F$0 
//  isUnicode = true; 
// Do not allow an incorrect rotation to be set 
// bit9*2^8 + bit8*2^7 + bit7*2^6 + bit6*2^5 + bit5*2^4+ bit3*2^2+ bit2*2^1+ bit1*2^0 
//  Font properties (maybe other too???) can have an index of -1   so we check the master for this font index then 
//  first char run is 21 long   it doesn't have any styles 
//  ftLbsData (currently UnknownSubrecord) 
/*  ********** START implementation of DocumentEntry **********  */
//  And read it back in 
//  was used to create this object. 
//  comment should be null but will fail due to bug 
//   the docs on their datastructure... 
//  HSSF has 32/255 limits as part of the Spec, XSSF has no limit in the spec, but Excel applies a 255 length limit!   more than 255 fail for all 
//  Add same border another to same cell, should not create another style 
// as unsigned  pad to 16-bit 
//  Record how far along the stream we have moved 
//  Create a package 
//  toString on a date-formatted cell displays dates as dd-MMM-yyyy, which has locale problems with the month 
//  already present 
//  Seems to be written by MSAccess   contains text "[Microsoft JET Created Table]0021010" 
//  We have a compressed sequence 
//  The pivot table's data source is on the same sheet in A1:D4 
//  set specified timeout if non-zero 
//  Columns moved include the first column of the area ref, but not the last column   btw: (aLastColumn > _lastMovedIndex) 
//  convert all LabelRecord records to LabelSSTRecord 
//  'Page Settings Block' 
//  things should be back to normal now 
//  and requests to the OS to delete the file will fail. 
//  hyperlink starts within current textrun 
//  the property types 
//  extractor.close(); 
//  Figure out the values of the sub properties 
//  LittleEndian.putInt(buf, fcOffset, papx.getEndBytes() + fcMin); 
//  give up without doing any security critical stuff: 
/*  * Tests lookup functions (VLOOKUP, HLOOKUP, LOOKUP, MATCH) as loaded from a test data spreadsheet.<p> * These tests have been separated from the common function and operator tests because the lookup * functions have more complex test cases and test data setup. * * Tests for bug fixes and specific/tricky behaviour can be found in the corresponding test class * (<tt>TestXxxx</tt>) of the target (<tt>Xxxx</tt>) implementor, where execution can be observed *  more easily.  */
//  currently we ignore an eventually center setting 
//  The last remaining sheet should always be active+selected 
//   fonts from the start and end of the font list 
//  Special case for the non-existant 1900 leap year 
//  Maximum permitted row number should be 65535. 
//  First part of expanded record handling 
//  Life is easy when we have no footers, headers or unicode! 
//  not sure what is the best value sample-here, only "1" did not work on some platforms... 
//  Obsolete 
//  Check the contents of the 2nd block 
//  fix the usermodel container 
/*          * Page 88:         *          * "The plcfhdd, a table whose location and length within the file is         * stored in fib.fcPlcfhdd and fib.cbPlcfhdd, describes where the text         * of each header/footer begins. If there are n headers/footers stored         * in the Word file, the plcfhdd consists of n+2 CP entries. The         * beginning CP of the ith header/footer is the ith CP in the plcfhdd.         * The limit CP (the CP of character 1 position past the end of a         * header/footer) of the ith header/footer is the i+1st CP in the         * plcfhdd. Note: at the limit CP - 1, Word always places a chEop as a         * placeholder which is never displayed as part of the header/footer.         * This allows Word to change an existing header/footer to be empty.         *          * If there are n header/footers, the n+2nd CP entry value is always 1         * greater than the n+1st CP entry value. A paragraph end (ASCII 13) is         * always stored at the file position marked by the n+1st CP value.         *          * The transformation in a full saved file from a header/footer CP to an         * offset from the beginning of a file (fc) is         * fc=fib.fcMin+ccpText+ccpFtn+cp."          */
//  then anyway 
// <p:ph sz="half" idx="1"/>   anchor is not defined in the shape 
// check EscherDggRecord - a workbook-level registry of drawing objects 
//  each polygon in the object. 
//  Finally, write out the children 
//  Visio - not handled yet 
//  can't use ZipHelper here, because its in a different module 
//  For the 2nd, should give similar answers for   the two methods, differing only in line endings 
//  simple cache hit - immediate re-evaluation with no changes 
//  Add to the mini stream 
//  white 
//  tRefN(B1) 
//  the created path starts at (x=0, y=0).   this used to scale each path element to the path bounding box, 
//  update each shape according to its own additional copy rules 
//  Repeat the header 
//  User specified shapes are interesting 
//  check for internal references (e.g. '#Sheet1!A1') 
//  pre-calculate all the sheet sizes and set BOF indexes 
//  FOR EACH PasswordByte IN PasswordArray IN REVERSE ORDER 
// create a custom data format 
//  get a table cell properties element (tcPr) 
//  "FG" 
// check that EscherDgRecord is updated 
//  check CHOOSE() 
//  B3 is a master shared formula, C3 and D3 don't have the formula written in their f element.   Instead, the attribute si for a particular cell is used to figure what the formula expression   should be based on the cell's relative location to the master formula, e.g.   B3:        <f t="shared" ref="B3:D3" si="0">B1+B2</f>   C3 and D3: <f t="shared" si="0"/> 
//  sprmCRgLid0 
//  Decide how big it is 
//  a continuation record with 3 bytes of data   one more continuation record with 1 byte of data 
/* Cell cell = */
//  every element from midIx to highIx was the wrong type   move highIx down to the low end of the mid values 
// https://en.wikipedia.org/wiki/Code_page_950 
//  Now a style on another workbook 
//  Check ":", "@" 
//         int field_2_numIdClusters = field_5_fileIdClusters.length + 1; 
//  256 bytes required   257 bytes required 
/*  Print the name of the property set stream:  */
//  Set values 
//  Turn each one into a XSSFHyperlink 
//  node colors 
//  Check contents, they should not contain the text from POI web site after colon! 
//  Verify it has empty properties 
//  Do nothing, user dont have to know 
//  NOSONAR, it's more readable this way   NOSONAR, it's more readable this way 
//  see if we have InteractiveInfo in the textrun's records 
//  Red + green bg 
//  Carry on reading in as normal 
/* firstRowToShift */
//  font size 24   colour red 
//  Iterate over all DB entries. 
/*              * If there is a document summry information stream, read it from             * the POI filesystem.              */
//  ensure that we create the "build" directory as it might not be existing   in the Sonar Maven runs where we are at a different source directory 
//  Sets type to DXA  
//  4 sheets, move a sheet from pos 1 to pos 2, i.e. current 2 becomes 1, current 1 becomes pos 2  
//  "up to 11 numeric characters, with the decimal point counting as a numeric character" 
//  Move onto the next BAT 
//  Generate a unique new filename 
//  end public interface POIFSConstants; 
//  check for color scale 
//  setting dash width to null unsets the SolidFill element 
//  always an error with 2-D area refs   Note - the type of error changes if the pRowArg is negative 
//   Just cut it off!. 
//       write out and give back 
/* ptgs = */
//  New object each time 
//  Work out which Pictures aren't referenced by    a \u0001 in the main text   These are \u0008 escher floating ones, ones    found outside the normal text, and who 
//  Now get those objects 
//  Check the atom 
//  1 row is blank.  Write to a another temp file 
//  from protected file 
/*  Write the section list, i.e. the references to the sections. Each         * entry in the section list consist of the section's class ID and the         * section's offset relative to the beginning of the stream.  */
/* box9x9      */
//  2048 - main SpContainer id 
//  sprmCRgLid1 
//  3 shorts + 7 bytes 
//  use XWPF instead of HWPF and XSSF instead of HSSF as the file seems to have the wrong extension 
//  Populate 
//  overwrite the row 
/*  char 3   */
//  A 32-bit unsigned integer that specifies a level to associate with the graphics state.   The level value can be used by a subsequent EmfPlusRestore record operation to retrieve the graphics state. 
//  TODO - introduce MarginBaseRecord 
//  Check they're currently right 
//  We need to add the records to the SLWT that deals   with Slides. 
//  note - dates may not actually span Feb-29, but it gets counted anyway in this case 
//  create a new org.apache.poi.poifs.filesystem.Filesystem 
//  Add the references to the DBCells in the IndexRecord (one for each block)   Note: The offsets are relative to the Workbook BOF. Assume that this is   0 for now..... 
// Dont allow column reordering 
//  Do we know what to do with it? 
//  Content type manager 
// rebuild the _rows map 
// top  right 
//  Something else inside [] which isn't supported! 
// int            pathLength = path.length(); 
// wb.dumpDrawingGroupRecords(true);  wb.dumpDrawingGroupRecords(false); 
//  end public interface Entry 
//  small numbers 
//  The x-coordinate of the ending vertex of an arc. 
// Check to ensure no other names have the same case-insensitive name at the same scope 
//  use a test file with a xml file bigger than 100k (ZipArchiveThresholdInputStream.GRACE_ENTRY_SIZE) 
//  assertContents("message.rtf", rtf.getData()); 
// link to http://www.lakings.com/ 
//  Check font use in cell styles 
//  From WithLinks.ppt 
//  only geometry sections can have duplicate names   sections can be found in the master too, if there are no attributes here! 
//           }          }          break;        } 
//  Header - size or type unchanged 
//                         final int w = bi.getWidth();                          final int h = bi.getHeight();                            int[] line = new int[w];                            WritableRaster wr = bi.getRaster(); 
//  CURRENTLY FAILS with "Sheet0!$A$1:$C$6" 
//  0-based 
/*  Check if the result is a DocumentSummaryInformation stream, as         * specified.  */
//  handle MulRK records 
//  important - no formatting data if text is empty 
/*  package  */
//  ColumnInfo ci for a single column, the target column 
//  Skip over the File ID 
//  YK: XmlBeans silently replaces all ISO control characters ( < 32) with question marks.   the same rule applies to "not a character" symbols. 
//  each FKP must start on a 512 byte page. 
//  Load up again, check all links still there 
//  Write the POI filesystem to a (temporary) file doc3 and close the latter. 
//  A 32-bit unsigned integer that specifies the number of points in the PointData array. 
//  large numbers 
//  v => contents of a cell 
//  legend 
//  preserve space for the FileInformationBlock because we will be writing 
//  If a table is added after getTable is called it should still be reachable by XSSFWorkbook.getTable 
/*  int hSize =  */
//  height basis   scale 
//  shape width can be smaller that the sum of insets (this was proved by a test file) 
//  First slide is 256 / 4 
// Test a uncompressed small string that has rich text and extended text 
//  sprmPDxcLeft1 
//  write out the DocumentProperties. 
//  Get the single-byte values by iterating through the Unicode characters.   For each character, if the low byte is not equal to 0, take it.   Otherwise, take the high byte. 
// string for hyperlink 
//  Now we know the length of the username, 
//  must contain at least an empty paragraph 
//  As we preserved, should also have a few other streams 
//  Ensure we fell off the end 
//  all shapes have a theme color="accent1" 
//  after clearing all values it also works 
//  This one is allowed, even if it's really odd 
//  the sheet naming rules are vague on whether unicode characters are allowed   assume they're allowed. 
//  row has a single cell by default; grab it 
//  expected during normal test 
// default format for new cells is General 
//  When parsing the BStoreDelay stream, [MS-ODRAW] says that we 
//  Check the relations 
//  Check the counts now 
//  Condition the inclusion of new line characters so as to   avoid an additional, superfluous, new line at the end of 
//  Encryption layer is a BIFF8 binary format that can be read by POIFSFileSystem,   used for both HSLF and XSLF 
//  Length 4 
//  Modify core part 
//  For anything else not directly held in as a POIFS directory 
//  40: DCOUNT 
//  number args converted to text 
//  Try constructing two attributes 
//  Properties now extends over 2 blocks 
//  update table area 
//  Check Rule M4.1 
//  Simple slideshow, record order matches slide order 
//  named ranges and tables can start with underscore or backslash   see https://support.office.com/en-us/article/Define-and-use-names-in-formulas-4d0f13ac-53b7-422e-afd2-abd7ff379c64?ui=en-US&rs=en-US&ad=US#bmsyntax_rules_for_names 
//  try add at beginning 
//  Excel seems to handle this by accessing past the end of the result vector. 
//  write an encrypted workbook to disk, and encrypt any temporary files as well 
//  we initialize our fields 
//  range2 encloses range1, so replace it with the enclosing one 
//  The cubic Bezier curves SHOULD be drawn using the current pen. 
//  This causes the error 
//  Create a cell and put a value in it. 
//  cell has a value 
//  Map of Entry instances, keyed by their names 
//  Now, read each one in in turn 
//  Find the start/end of the group. 
// header key  hmf 
//  occurs during successful test 
//  All finance functions have 3 to 5 args, first 4 are numbers, last is boolean   default for last 2 args are 0.0 and false   Text boolean literals are not valid for the last arg 
//  we did not get an exception, so it seems this is a HSSFWorkbook 
//  Reset, should go back to only one buffer full read 
//  The initial value is set when populating the dictionary 
//  Start with an empty set 
// I use varParam[0] and newTAP._itcMac interchangably 
//  Look in children if we are a container 
//  The subrange [19, 299] is expected to be replaced with a EscherAggregate object 
//  ??   ??   O8   HEX2DEC   O2 
//  Check if part already exist 
//  just ensure that the exception is created correctly, even with unknown sids 
//  Put back to normal 
// Step 3. Substitute the template entry with the generated data 
//  If it is already expanded do nothing. 
//  Loop over our values, looking for chunk based ones 
//  second char run is 17 long 
// Get cell one to the right and one down from position, add both to AreaReference and set pivot table location. 
//   to the base, and check we can get it back again 
/*      * Some Record IDs used by POI as 'milestones' in the record stream      */
//  First, check names 
//  Can't use literal numbers for column sizes, as    will come out with different values on different    machines based on the fonts available.   So, we use ranges, which are pretty large, but 
//  copy properties from last paragraph / textrun or paragraph end marker 
//  ---- begin optimization to avoid painting background ---- 
//  row was not parseable as an Integer, such as a BigInt   therefore name passes the not-a-cell-reference criteria 
// remove a row only if the row has no cell and if the outline level is 0 
//  Will show 0 if first 
//  set new encryption settings 
//  rect : 8 bytes (top, left, bottom, right: integer) 
//  51 -> 103 is the next 
//  testing 
//  Some more cases of removing sheets 
//  these IDs duplicate those from table1 and may be cause of https://bz.apache.org/bugzilla/show_bug.cgi?id=62906 
//  Raw book reference, without a sheet 
/*  1 + 2 + 5 + 9  */
//  spanning using overlapping blocks 
//  select the last child node only if we need to map to a single cell 
//  Solution: set TempFileCreationStrategy to something that the unit test can trigger a deletion" 
//  Fetch all font names 
//  for tests 
//  sprmCFMathPr 
//  These are POI-specific error codes   It is desirable to make these (arbitrary) strings look clearly different from any other   value expression that might appear in a formula.  In addition these error strings should   look unlike the standard Excel errors.  Hence tilde ('~') was used. 
// Add filter on forth column 
// backslashes needed for unicode escape 
//  position adjustments 
//  Length 8 
//  Build splat'd out text version 
//  Add one 
//  Now both 
//  Word Document - OpenXML file format 
//  read properties and pictures, with old encryption settings where appropriate  
//  Windows 
//  A breakpoint in ValueRecordsAggregate.handleMissingSharedFormulaRecord(FormulaRecord)   should get hit during parsing of Sheet1.   If the test spreadsheet is created as directed, this condition should occur.   It is easy to upset the test spreadsheet (for example re-saving will destroy the   peculiar condition we are testing for). 
//  Then the rest of the CF Header details 
// //// Case 3: Evaluate "Table1[#Totals]" //////// 
//  Icons : 3 flags - Column M (all) 
//  The y-coordinate of a curve's beginning control point relative to the 
//  only set new sheet if there are still some left 
//  sprmPDyaAfter 
//  only copy direct backgrounds - not backgrounds of master sheet 
//  The value MUST be from the UnitType enumeration 
//  498 == 0x01F2; 502 == 0x01F6 
//  Assign to us 
//  SSSlideLayoutAtom stuff 
//  unknown / unsupported / corrupted property, skip 
// http://en.wikipedia.org/wiki/Future_value 
//  reserved must be 0 
//             "alterman_security3.pptx", 
//  between the beginning control point and ending vertices of the arc. 
//  the upx will always start on a word boundary. 
//  so that the temporary files created can be disposed up by cleanup()  
//  Check we have the right cell 
//  sign and exponents same, but fractional bits are different 
//  The ToPart property identifies the part of a shape to which another   shape is glued, such as its begin point or endpoint, one of its edges,   or a connection point. The following constants declared by the Visio type   library in member VisToParts show possible return values for the ToPart   property.   Constant Value   visConnectToError -1   visToNone 0   visGuideX 1   visGuideY 2   visWholeShape 3   visGuideIntersect 4   visToAngle 7   visConnectionPoint 100 + row index of connection point 
//  Write out our HPFS properties, if we have them 
//  TODO Properly detect Ext ones from the xml 
//   dictionary to start at 
// base ptg 
//  Process any existing pictures if we haven't yet 
//  Now we have enough information to go on. Create the arc. 
//  expected one image 
//  Check contents 
// group shape 
//  Mark any that aren't used as needing zapping 
//  to avoid having to iterate all rows/cells in each add/remove of a row or cell 
//  this column collapsing bug only occurs when the grouped columns are different widths 
//  always init. to non-null just for defensive avoiding NPE 
//  A2 will hold our test formulas 
//  You're allowed something like dd/mm/yy;[red]dd/mm/yy    which would place dates before 1900/1904 in red 
//  100 is our first free one 
//  Pad to the end of the block with -1s 
//  Save, re-load, re-check 
//  First three rows are blank 
//  field. This value SHOULD be zero if PenStyle does not specify PS_USERSTYLE. 
//  Bingo. Now, where do we store it? 
//  first check some cases that should not be a date, also call multiple times to ensure the cache is used 
// should be [0.0, 1.0, 4.0, 5.0, 6.0, null, null, null] 
//  Document should start with:     0F 00 E8 03 ## ## ## ##       (type 1000 = document, info 00 0f is normal, rest is document length)     01 00 E9 03 28 00 00 00       (type 1001 = document atom, info 00 01 normal, 28 bytes long) 
// Test the header 
//  TODO - test some specific format strings 
//  NotesHeadersFootersContainer 
//  Should come out with 10 slides, no notes 
//   A: Theme Based, Foreground 
// return trailing alone  there may be some subtleties here 
//  Cosine Formula: "cos x y" = (x * cos( y )) = value of this guide 
//  Don't save modifications 
/*  pad values to 4-bytes  */
// 		}  		return false;  	} 
//  Check to see if name is a named range in the workbook 
//  Verify that we have a footnote reference in the first paragraph and not   in the second paragraph. 
//         StylesTable table = xlsToAppendWorkbook.getStylesSource();          List<XSSFCellFill> fills = table.getFills(); 
//  Ensure the tab index 
/*  the scope is workbook */
/*  TODO  */
//  final int opacity = (int) ( characterRun.getIco24() & 0xFF000000l )   >>> 24; 
//  Name in the wrong format 
//  there is one range from 2048 - 2387 
//  Check number of paragraphs by counting number of newlines 
//  Assign the comment to the cell 
// body specifies DDE data item 
//  An optional array of 32-bit signed integers that specify the values of the font axes of a 
//  Interpolate between the two 
//  (null) == (null), (null) < (non-null) 
/*          * Read the summary information stream and the document summary         * information stream from the POI filesystem.         *         * Please note that the result consists of SummaryInformation and         * DocumentSummaryInformation instances which are in memory only. To         * make them permanent they have to be written to a POI filesystem         * explicitly (overwriting the former contents). Then the POI filesystem         * should be saved to a file.          */
//  Ensure all indicies get updated, then -1 tested 
//  A 32-bit floating-point value that contains the limit of the thickness of the join on a mitered corner 
//  non-null string not less than empty cell   for completeness   just in case - not a typical possibility 
/*  decrement usage counter  */
//  Encoded dist for tAttrChoose includes size of jump table, but   countTokensToBeSkipped() does not (it counts whole tokens). 
//  missingUnderBits is (0..3) 
//  Check that the source file/folder exists. 
//  after removing the only active/selected sheet, another should be active/selected in its place 
//  Swap them around 
//  Verify a few offsets: 0->50 is a stream 
//  rId3 is mailto 
//  When we find them, print out their IDs 
//  If the user has chosen to overlay both rows and columns or just   to expand ONLY the size of the columns, then calculate how to lay   the image out ver one or more rows. 
//  Bugs 60858 and 56420 show predicate can be null 
//                 logDebug("invoke " + operation + " (nAgs=" + numops + ")"); 
//  -- CHANGE the shift to positive once the behaviour of the above has been tested 
//  input row 0 
//  line cap 
//  add a new shape and link OLE & image part 
//  A 32-bit unsigned integer that specifies the number of graphics formats contained in this record. 
//  Sanity Checking - we're always at least 8+10 bytes long 
//  formula: internal quotes become double double, surround with double quotes 
//  Partially mergeable: multiple possible merges      A B    1 x x   A1,A2,B1 --> A1:B1,A2 or A1:A2,B1 
//  Change on comment on sheet 1, and add another into    sheet 2 
//  Now a row only freezepane 
//  find forward distance to first RowRecord 
//  Bingo 
//  Arrange 
// creating a HWPF document 
//  Well the format runs are equal as well!, better check the ExtRst data 
//  supporting Extended chars 
//  separate old version of Xerces not found => use the builtin way of setting the property 
//  This is an unsigned byte read from the stream 
/*  In an excel generated array formula, the formula property might be set, but the string is empty in slave cells  */
//  Write out and read back in again, ready for    the next run of the test 
//  Can this byte start a new rawCode, or does 
//  format   forecolor index 
//  priorities start at 1, if it is less, it is undefined, use definition order in caller 
//  use extension instead of enum name, because of "jpeg" 
//  try to parse the cell value as a double and return it  
//  useful offsets 
//  find the posistion of the Add-In SupBookRecord in the workbook stream, 
//  "A1=1" should return false   "A1=\"1\"" should return true 
//  Default $ in a different locale 
/*  **********  END  implementation of POIFSReaderListener **********  */
//  Attr 
//  Check the header 
//  Now check it's the right data 
//  eek, undocumented text type 
//  Ensure the minimum number of columns 
//  some files that are broken, eg Word 95, ... 
//  no digits at end of str 
//     public final static short       OBJECT_TYPE_BUTTON             = 7; 
//  no need to change anything if position is correct 
//  and the 1 byte size of the grpprl. 
//  Attr   CHOOSE 
//  namespacePrefixes.put(XML_DIGSIG_NS, ""); 
//  By String 
//  its OK to not serialize empty page break records 
//  Alternatively, a future implementation of evaluate could return #NAME? error to align behavior with Excel   assertEquals(ErrorEval.NAME_INVALID, ErrorEval.valueOf(evaluator.evaluate(cell2).getErrorValue())); 
//  a red bordered box in the background, to show/verify the table dimensions 
//  /p:sldMaster/p:txStyles/p:bodyStyle/a:lvl1pPr 
//  '-' means empty: 
//  These are bytes as looked up in the dictionary   It needs to be signed, as it'll get passed on to 
//  setup first knots/weights/control point 
//  the full size of the bmp 
//  Row 3 -> 19 
//  A 32-bit signed integer that specifies the saved state to restore relative to   the current state. This value MUST be negative; –1 represents the state that was most   recently saved on the stack, –2 the one before that, etc. 
//  The 14th block is the FAT 
//  cell will no longer be a formula cell 
//  flatten multiple nested RefListEval 
//  Check the flags 
//  optional record missing 
/*  final  */
//  Consider extending by a bit more than requested 
//  Regular MAPI Properties, normally on the message 
/*  generating parameter instances  */
//  Create, and change 
//  Create sub workbook if required 
//  prepare CSS classes for later usage 
//  All errors get translated to #REF! 
//  Open it from that temp file 
//  But also check that another wb isn't 
//  Tidy 
//  Records that are interesting 
//  sprmPDyaAbs 
//  Return the result as a StringEval. 
// Just one text box here 
//  TODO: use parameter 
//  ANSI_FIXED_FONT - A fixed-width font   Charset: ANSI_CHARSET   PitchAndFamily: FF_DONTCARE + FIXED_PITCH 
//  because the dev kit shows the masks for it as 2 byte fields 
//  make sure the changes to the names stick after writing out the workbook 
// Create a new sheet then search for the sheet and make sure that the  sheetPane shows it. 
//  policy.setCopyCellValue(true).setCopyCellStyle(true) 
//  end draw thick black border 
//  Special number NaN /Infinity   Normally one would not create HybridDecimal objects from these values 
//  An invalid BorderStyle constant 
//  dark red 
//  each table row of the document contains data for two functions 
//  Excel does not resolve it to a boolean. 
//  cryptoapi (PPT only supports cryptoapi...) 
//  A 32-bit unsigned integer that MUST be the same as Size and MUST be the   last field of the record and hence the metafile. 
//  A 32-bit unsigned integer that specifies how to use the Color value to determine the area for   the flood fill operation. The value MUST be in the FloodFill enumeration 
//  size of the canvas in points 
// jmh need to do colour 
// PageSettingsBlock 
//  A 32-bit unsigned integer that defines the x-coordinate of the point. 
// simulate correct answer 
//  adding one here because 0 indicates a global named region; doesn't make sense for print areas 
//  Set the levels onto it 
//  default match_type is 1.0 
//  no System.exit here, as we also run in junit tests! 
//  Read and ensure things are where they should be 
//  xfrm is not set, the query is delegated to the slide master 
//  Skip over any padding 
//  roll over all sub task elements in one loop.  This allows the   ordering of the sub elements to be considered.  
//  The first knot of the NURBS. 
//  Ask for it as a Java date, and have it converted 
//  bitfields in alignment options 
// xml part of chart in document 
//  quoted identifier - can't concatenate anything more 
//  sheet. 
/*  Write the POI filesystem back to the original file. Please note that             * in production code you should take care when write directly to the             * origin, to make sure you don't loose things on error  */
//  New cell references are also valid. 
//  cell remains a formula cell, but the cached value is changed 
//  github-77: mutable static fields could be changed by malicious code or by accident.   These byte arrays should be package protected. 
//  trailing \n causes must be preserved 
//  Couldn't be found 
//  index < limit -- insert into the middle 
//  // Do for each affected part 
//  Check for the chinese only text line 
//  iterate backwards due to possible calls to ctWorksheet.removeConditionalFormatting(j) 
//  total height of all rows assessed so far. 
//  else - string cannot be converted to boolean 
//  expect RangePtg, but perhaps also UnionPtg, IntersectionPtg etc 
//  add OLE part metadata to sheet 
//  check for errors in predicate and return immediately using this error code 
//  shiftedRange should not be null. If shiftedRange is null, that means   that a hyperlink wasn't deleted at the beginning of shiftRows when   identifying rows that should be removed because they will be overwritten 
//  A string of Length Unicode characters that contains the name of the font family. 
//  https://msdn.microsoft.com/en-us/library/dd911027(v=office.12).aspx 
//  note behaviour changes here 
//  check if the password has been changed 
//  else - top area row has been replaced - both area top and bottom may move now 
//  ooxml does have a separate cell type of 'blank'.  A blank cell gets encoded as   (either not present or) a numeric cell with no value set.   The formula evaluator (and perhaps other clients of this interface) needs to   distinguish blank values which sometimes get translated into zero and sometimes   empty string, depending on context 
//  Wind on by 4 bytes per sheet found 
//  ensure file-handle release 
//             fileOut.close();          } 
//  test if second sheet is set up 
//  A WMF RectL object. It is not used and MUST be ignored on receipt. 
//  If they requested spacers, with "_",    remove those as we don't do spacing   If they requested full-column-width    padding, with "*", remove those too 
//  NOTE - only occurs if a comment is placed in A1 first 
//  Now look for UserEditAtoms 
//  "A1=1" should return false 
//  apr 
//  Check we get an error with a made up one 
//  199: DCOUNTA 
//  This array MUST exist if and only if the wListType field is not equal to 0. 
// short chsDiff = (short)((param & 0xff0000) >>> 16); 
// sortTopLeftToBottomRight swapped firstColumn and lastColumn because firstColumn is absolute 
//  Column 'A' 
//  Default + TNR + Courier 
//  revert the change 
//  Remove the character too 
//  dummy function that returns NA   don't care about the implementation, we are not interested in evaluation   and this method will never be called 
//  With 
//  A3 
//  get the rgdxaCenters 
//  from https://support.office.com/en-us/article/DAYS360-function-B9A509FD-49EF-407E-94DF-0CBDA5718C2A 
//  Non-index based, check if default is free 
//  Building the info block   First 20 bits = offset number = slide ID (persistIdFld, i.e. first slide ID of a continuous group)   Remaining 12 bits = offset count = 1 (cntPersistFld, i.e. continuous entries in a group) 
//  the cipher output stream pads the data, therefore we can't reuse the ZipEntry with set sizes   as those will be validated upon close() 
// set cell style 
//  row or overlay the image across a series of rows. 
//  display vertical scrollbar 
//  If no properties part has been found then we create one 
//  Re-serialize and check again 
//  Check if font belongs to workbook 
//  in XSLF, slidenumber and date shapes aren't marked as placeholders opposed to HSLF 
//  Grab contents 
//  update Table 
//  If RegionMode is RGN_COPY, this data can be omitted and the clip region 
//  Create a spreadsheet with some formula errors in it 
//  stay compatible with the range used by XSSF, map from ]90..180] to ]0..-90]   we actually don't need to do anything here as the internal value is stored in [0-180] anyway! 
//  char have some space 
//  A5 
//  Take a look at the embedded objects 
//  positive value means percentage spacing of the height of the first line, e.g.   the higher the first line, the bigger the space before the paragraph 
//  Create cell style with ALIGN_CENTER_SELECTION 
/* 			 * "A ToggleOperand value that specifies whether the text is excluded from the proofing analysis. By default, text is not excluded from the proofing analysis."			 * 			 * Word (.doc) Binary File Format. Copyright (c) 2012 Microsoft			 * Corporation. Released: October 8, 2012			  */
//  Must be at least 24 bytes long 
//  Move forward 
//  Some German umlauts with uppercase first letter is not changed 
//  used only for KEY comparison (HSSFRow) 
//  Check to see if the font metric file was specified   as a system property 
//  header can be more than 256 bytes 
//  includes all data and header/footer rows 
// count of body objects 
//  application/vnd.openxmlformats-officedocument.wordprocessingml.document 
//  A 32-bit value that MUST be 0x00000000 and MUST be ignored. 
//  sometimes we hold the stream here and thus need to ensure it is closed at some point 
//  Get the last viewed slide ID 
//  An optional 32-bit floating-point value that specifies the distance from the start of a line to the   start of the first space in a dashed line pattern. This field MUST be present if the   PenDataDashedLineOffset flag is set in the PenDataFlags field of the EmfPlusPenData object. 
/*  Initialize the "classID" field.  */
//  SignedSignatureProperties 
//  Set line.separator for bug61182   System.setProperty("line.separator", "\n"); 
// cached result of a formula 
//  How far up to look 
// we must remember the position of the continue record. 
//  Check in Content-ID field 
//  the cell address iterator iterates in row major order 
//  intended to crash after reading 10000 bytes 
/*          * N.B. no need to synchronize this because: - we don't care if the buffer is created multiple times (the data         * is ignored) - we always use the same size buffer, so if it it is recreated it will still be OK (if the buffer         * size were variable, we would need to synch. to ensure some other thread did not create a smaller one)          */
// level  length of the path ) 
//  " -> " + papx.getEnd()); 
//  Append this run to the paragraph.  
//  This calcualtion of Precision does not always provide results within   Allowed Error. It compensates for loss of significant digits that occurs. 
//  make sure special reg-ex chars are treated like normal chars 
//  Longer link at 10 
// simulate the bad padding at the end of the workbook stream in attachment 23483 of bug 46987 
//  Serialise to bytes, then grab the right ones out 
// bottom 
//  Cells must contain at least an empty paragraph 
//  Examine one of the paragraphs is present in all 3 formats, surrounded by markup tags 
//  Check gone so far 
//  allocate the buffer on the heap if we cannot map the data in directly 
//  Give up and return a generic one 
// The relationship Id references the part containing the drawingML definitions. 
//  With a cell that's the primary one of a merged region, we get that cell 
//         checkRecordsTogether(records, workbookRecords); 
//  avoid zip bomb detection 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#setEmptyCellAllowed(boolean)      */
//  Formula result is a string   This is stored in the next record 
//  check for text paragraph modifications 
//  The first section has 5 paragraphs 
//  Might be better to separate out the n p and z formats, falling back to p when n and z are not set.   That however would require other code to be re factored.   String[] formatBits = formatStrIn.split(";");   int i = cellValue > 0.0 ? 0 : cellValue < 0.0 ? 1 : 2;    String formatStr = (i < formatBits.length) ? formatBits[i] : formatBits[0]; 
//             FileOutputStream fileOut = new FileOutputStream("/tmp/bug48495.xlsx"); 
//  by setting the maximum allowed ratio of miter length to line width. 
//  Need 4 paragraph styles 
//  Then the other 
//  read in the table stream. 
//  Usually (result === cce.getValue())   But sometimes: (result==ErrorEval.CIRCULAR_REF_ERROR, cce.getValue()==null)   When circular references are detected, the cache entry is only updated for 
//  Now check if it's a container or not 
// Test low cell bound 
//  Evaluate and test 
//  application/vnd.ms-excel 
//  this sometimes causes exceptions 
//  actual data from file saved by Excel 2007 
//   there doesn't seem to be any use of that in Outlook 
//  TODO: Add this reference to each slide as well 
// make it the color at palette index 0xf (white) 
//  Write it into a temp output array 
//  set a positive indent of a 0.5 inch. This means "First Line" indentation:   |<---  indent -->|Here goes first line of the text   Here go other lines (second and subsequent) 
//  digit in first pos   plain underscore OK   underscores and digits OK 
//  first ask the context color and if not found, ask the actual color bean 
//  Do we need to go up a directory or two from   the source to get here?   (If it's all the way up, then don't bother!) 
// protect objs&scenarios(normal) 
//  formula cells always have a value. If the cell is blank (either initially or after removing an 
//  One of the spline's knots (other than the last one or the first two). 
//  the custom line cap is based. 
//  now hPos >= h, so end row = r, now figure offset 
/*              * A 32-bit unsigned integer that specifies the background mode             * and MUST be in the BackgroundMode (section 2.1.4) enumeration              */
/*              * move the cursor to the previous element until a) the next             * paragraph is found or b) all elements have been passed              */
//  Do we have a definition for this font with just the name? 
//  Write out our header 
/*      * Insert a new CTCol at position 0 into cols, setting min=min, max=max and     * copying all the colsWithAttributes array cols attributes into newCol      */
//  Now copy the contents to the stream 
//  strLen 2   16 bytes for 2 format runs 
//  Sometimes there's some cruft at the end 
//  update formulas 
//  Simple 
//  non-Javadoc: When possible, code should be implemented in the ColumnShifter abstract class to avoid duplication with   {@link org.apache.poi.hssf.usermodel.helpers.HSSFColumnShifter} 
//  implemented both by a cfRule "text" attribute and a formula.  Use the formula. 
//  Required for clone methods 
/*  deliberately avoiding this one    TestUnfixedBugs.class, */
// if part is already committed then return 
//  verify proper behavior with non-zero offset 
//  Now start with one with 3 entries 
// //// Case 7: Evaluate "Table1[#Totals]" //////// 
//  Bump down by one, so still points at the same sheet 
// If number < -512 or if number > 512, this function returns the #NUM! error value. 
//  ... and to add its relationship ... 
/*      * Add the \1OLE marker entry, which is not the Ole10Native entry.     * Beside this "\u0001Ole" record there were several other records, e.g. CompObj,       * OlePresXXX, but it seems, that they aren't necessary      */
/*  Width is determined by content.  */
//  Some workbooks have no shared strings table. 
//  now check read/write mode 
//  00none/01super/02sub   00none/01single/02double/21singleaccounting/22doubleaccounting   ?? defined by windows api logfont structure?   ?? defined by windows api logfont structure?   must be 0 
// get default font and check against default value 
//  check if the percentage value is scaled 
//  else - no problems so pop current frame 
//  Figure out our block size 
//  Should be 19 + length + 8 + 4 big 
//  Store it 
//  1) corrupted xlsx (unreadable data in the first row of a shifted group) already comes about 
//  also tell the LinkTable about the removed sheet  index hasn't change in the linktable 
//  NOSONAR 
//  Have we gone over the mini stream limit yet? 
//  When it matches:     Sets the font colour to dark green     Sets the background colour to lighter green 
// Set the rows to the correct size 
// 	              double delta = Math.abs(expValue.getNumericCellValue()-actValue.getNumberValue());  	              double pctExpValue = Math.abs(0.00001*expValue.getNumericCellValue());  	              assertTrue(msg, delta <= pctExpValue); 
//     assertFalse( DateUtil.isADateFormat(formatId, formats[i]) ); 
//  sections 
/*  Create the tree UI element.  */
//  check content of entire textbox 
//  Set table width to 6.5 inches in 1440ths of a point 
//  The value should now be 3 
//  unused3 - Undefined and MUST be ignored.   reserved1 - MUST be zero and MUST be ignored. 
//  Rename sheet-scoped name to "name2", check everything is updated properly 
//  TODO: apply emf transform 
//  but bigger errors are a concern 
//  Check them 
//  End of Normal 
//  Copy the style 
//  This code relies on the padding bytes not starting with BOFRecord.sid 
//  Note: don't change the code here, it is required for Eclipse to compile the code 
//  Grab the pointer to the trailer 
//  no-arg constructor is private because of undefined super call with locale 
// String strippedFormatStr = formatStr.replaceAll("\\\\ ", " ").replaceAll("\\\\.", "").replaceAll("\"[^\"]*\"", " ").replaceAll("\\?", "#"); 
//  verify behavior of getParent 
//  remove the comment cell ref from the list if we're about to handle it alongside the cell content 
//  Between the start and 0x200 we have    CHNKINK(space) + 24 bytes    0x1800    TEXT + 6 bytes    TEXT + 8 bytes    0x1800    STSH + 6 bytes    STSH + 8 bytes    0x1800    STSH + 6 bytes    STSH + 8 bytes   but towards 0x200 the pattern may    break down a little bit 
//  Note - the standard java type conversion from double to int truncates toward zero.   but Math.floor() truncates toward negative infinity 
// Set sources and references 
//  supersubscript   underline, family 
//  Process all body elements 
//  Try both SMTP and EX files for recipient 
//  If the third row is set to repeat, but not the second,   isRepeatHeader should report false because Word will 
//  Look out outline details of end 
//  A 32-bit unsigned integer that specifies the number of rectangles in the RectData field. 
//  (Don't remove the records though) 
//    Geometry   
// for strict parsing; confirm that firstRow==lastRow and firstCol==colLats (2.4.28) 
//  Then we have the indentLevel field if it's a paragraph collection 
//  Have the evaluation done, with exceptions 
//  yellow 
//  Forth is left aligned + normal line spacing (despite differing font) 
// Continue Record overhead 
//  case-sensitive 
// // ContentHandler methods //// 
/* 		 * According to interface, 0.0 should be returned for		 * uninitialized double properties.		  */
//  Fetching the array is quicker than working on the new style    list, assuming we need to read many of them (which we often do),    and assuming we're not making many changes (which we're not) 
//  skip reserved 
//  TODO Add CF Ex, and remove from UnknownRecord  
//  Set the padding around text in the cells to 1/10th of an inch 
//  Bug 51448 reported that  Evaluation Cache got messed up after 256 sheets 
//   the form __<name>_<id><type> 
//  Update the cell styles to point at the  
//  If the part list is null, we parse the package to retrieve all parts. 
// Special handling for when there's only an ascii string and a REFERENCED_REGISTERED  record that follows.  See https://github.com/decalage2/oletools/blob/master/oletools/olevba.py#L1516  and https://github.com/decalage2/oletools/pull/135 from (@c1fe) 
/*  Cipher feedback chaining (CFB), with an 8-bit window  */
//  Check text properties first 
/*  The document does not have custom properties.  */
//  workbook can be null in unit tests 
//  Then there are 3 one block ones 
//  Out of data, can't be any more properties to go   remember the mask and return 
// individual column 
//  note - values like "A$1:$C$20" don't get this far  
// paint the border 
//  see http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4796385 
//  various cases with two ranges 
//  Work up until we find a unique number (there could be gaps etc) 
//  System.err.println("Section " + x + " is now " + sepx.getStart()   + " -> " + sepx.getEnd()); 
//  Open a new copy of it 
// FROM MS http://office.microsoft.com/en-us/excel-help/rate-HP005209232.aspx  Bet accuracy with 128  1.0e-8 
//  test same functions ignoring hidden rows over a copy of the same data 
//  added images have indexes 0,1,2....19 
//  Returns #NUM! because the number and the multiple have different signs 
// check for anything from rows before 
//  Biff 2   Biff 3+ 
// Setting its name 
// reset to 0 for length calculation 
/*          * Listed fields won't be treat as UnhandledDataStructure. For all other         * fields FIBFieldHandler will load it content into         * UnhandledDataStructure and save them on save.          */
//  perform the same checks with LocalDateTime 
//  Add it, if it doesn't exist 
/*  * Tests that Comment2000 works properly. * TODO: Test Comment200Atom within * * @author Nick Burch (nick at torchbox dot com)  */
//  Now, handle the other aspects like  
// test for proper char offset conversions 
//  Taken from bugzilla attachment 24661 (offset 0x1E73) 
//  Mini Fat   Mini Stream   Main Stream 
//  0 -> string   1 -> num   2 missing   3 missing   4 -> blank 
//  else - columns have moved completely outside the area ref,   or still remain completely within the area ref 
//  Save and re-load, without having touched the properties yet 
//  3 @ 5 
//  Sheet1 
//  sprmPJc80  
//  Now do the alternate call, which zaps the formulas 
//  functions that are available in Excel 2007+ have a prefix _xlfn.   if you save such a .xlsx workbook as .xls 
//  6 isVolatile 
//  A 32-bit unsigned integer that specifies the number of palette entries. 
//  all other operators don't need second arg 
//  107 -> 154 is the next 
//   consider converting all these (ptg instanceof XxxPtg) expressions to (ptg.getClass() == XxxPtg.class) 
//  If it has children, walk them 
//  Try to evaluate everything 
//  if the sheet being cloned has a drawing then remember it and re-create it too 
//  Copy in the header 
//  confirm results 
//  Throws exception here 
// one row above destHeaderRow  one row below destRow3 
//  Different styles in one paragraph 
//  Inline string outer tag 
//  Check the english bits 
//  Now the result lines up like it is supposed to with the specials' indexes 
//  Where each style has ended up, and if we need to 
//  leap year 
/*  ********** START extension of Entry **********  */
//  NOTE could also throw a NullPointerException() if desired 
// 215: DBCS (JIS in BIFF3) 
//  Fix the line ending 
//  Now load it and check 
//  Add past 10 
//  the BOFRecord can represent either the beginning of a sheet or   the workbook 
// set page numbers in the footer 
//  At this point start and end cell reference are cached 
//  cData 
// try to parse the BrtBundleSh  if there's an exception, catch it and  try to figure out if this is one of the old beta-created xlsb files  or if this is a general exception 
//                                 // TODO: use clamp color here 
//  E:F,9:12 
//  An optional, 32-bit unsigned integer that identifies the type of comment record.   See the preceding table for descriptions of these record types.   Valid comment identifier values are listed in the following table.     If this field contains any other value, the comment record MUST be an EMR_COMMENT record 
//  2 byte fields   4 short fields 
//  between the beginning and ending vertices of the arc. 
// Handle the special AUTOMATIC case 
//  string. This value MUST be composed of DriverStringOptions flags 
//  32-bit unsigned integer that specifies the value in the LineJoin enumeration that specifies how to   join two lines that are drawn by the same pen and whose ends meet. At the intersection of the two 
//  initialize our streams for writing. 
//  Check that the last few records are as we expect 
//  Write out our type 
//  verify the picture that we read back in 
/*  only for agile encryption  */
//  numeric value cell 
//  but the cloned sheet's password should remain unchanged 
//  Check again on the word one 
// create a sheet for each month 
//  Implementation Notes List:   --> In this third stage, the reversed byte order legacy hash from the second stage shall 
//  Write and read back 
//  Decode the encoded character 
//  Should match despite time-zone 
/*  HSSFCellStyle style = */
//  Of course, named range names cannot have '$' 
//  Equivalent to 0 <= CellReference.convertColStringToIndex(colStr) <= ssVersion.getLastColumnIndex() 
// not necessarily set 
//  do initial read to increment the read index beyond zero 
//  Rows being moved completely enclose the area ref.   - move the area ref along with the rows regardless of destination 
//  Validate the resizeBehaviour parameter. 
// Sets the pivotTableDefinition tag 
//  do not auto delete the title 
//  attempt to add conditional formatting 
//  Sanity Checking - including whole header, so treat    length as based of 0, not 8 (including header size based) 
//  removeArrayFormula should return the same cells as setArrayFormula 
//  A 32-bit unsigned integer that specifies the index of the logical font object   in the EMF Object Table 
//  Check that after close we can no longer read 
// make sure we return null for that instead of throwing OutOfBounds 
// Test 2D and 3D Ref Ptgs with absolute row (Ptg row number shouldn't change) 
//  otherwise, this value MUST be ignored. 
// this content appears only in the glossary document  once we add processing for this, we can change this to contains 
//  First, check for OOXML 
//  keys are DocumentDescriptors, values are byte[]s 
//  4 ints 
//  Write out the children 
//  Check we found all the conditional formatting rules we should have 
//  We're looking for a EscherOptRecord 
//  change existing numeric cell value 
//  check for default result : excel implementation for 0,0   is different to Math Common. 
//  Now change a value that should no longer affect B2 
//  overlie. 
//  Get two more, unchanged 
//  only for digital signatures 
//  Check things are as expected 
//  boolean isStream = StreamDescriptorEntry.flagStream.isSet(entry.flags); 
//  Close it 
//  the source is still a valid zip archive.   prior to the fix this used to throw NotOfficeXmlFileException("archive is not a ZIP archive") 
//  needed here due to calls to findFirstRecordLocBySid before we're done 
//  bookmarks 
//  Check they start as we expect 
//  An 8-bit unsigned integer that defines the number of adjacent color bits on  
//  Icons : 3 arrows - Column O 
// setting the same border multiple times should not change borderId 
//  Constants from MS-OVBA: https://msdn.microsoft.com/en-us/library/office/cc313094(v=office.12).aspx 
//  test document write protection with password 
//     /**       * Constructs an escher graphics object.       *       * @param escherGroup           The escher group to write the graphics calls into.       * @param workbook              The workbook we are using.       * @param forecolor             The default foreground color.       */      public EscherGraphics( HSSFShapeGroup escherGroup, HSSFWorkbook workbook, Color forecolor)      {          this(escherGroup, workbook, forecolor, 1.0f);      } 
//  ignore anything else 
//  Change sheet 0 to be very hidden, and re-load 
// check that NamePtg refers to the correct NameRecord 
//  Single chart, two sheets 
// initialize the supeclass with a blank worksheet 
//  See page 681 
//  unexpected error 
//  Try each cell individually 
//         assertEquals(32, rec.field_1_stream_id_offset); 
//  However, all BATs can contain 128/1024 blocks 
//  NOTE: XWPFDocument.createFootnote() delegates directly         to XWPFFootnotes.createFootnote() so this tests         both creation of new XWPFFootnotes in document         and XWPFFootnotes.createFootnote(); 
// set a thin border 
//  empty row 
//  set the bit that specifies that the default settings for the row height have been changed. 
//  normalize angle, in case it's < -360 or > 360 degrees 
//  Now decompress it again 
//  If the arrow cap is not filled, only the outline is drawn. 
//  See how long it is. If it's under 28 bytes long, we can't 
//  A 32-bit unsigned integer that specifies the size, in bytes, of the EnhancedMetafileData field. 
//  If target URI is empty 
// byte hpsPos = (byte)((param & 0xff0000) >>> 8); 
//  Use the first stroke to create an outline of the shape 
//  if a hslf cell is merged, it won't appear in the cell matrix, i.e. it doesn't exist   therefore this is always false  
//  Reference to a single cell in a different sheet, which needs quoting 
//  POI is not thread-safe - so we can switch to unsynchronized xmlbeans mode - see #61350   Update: disabled again for now as it caused strange NPEs and other problems   when reading properties in separate workbooks in multiple threads   DEFAULT_XML_OPTIONS.setUnsynchronized(); 
/*          * plcfsed (section table) Written immediately after the previously         * recorded table. Recorded in all Word documents         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 25 of 210          */
//  Only last column should move 
//  so we use something more reliable 
//  contains a DIB. 
//  Finally, we have a series of lengths + hyperlinks 
//  just check that we do not throw Exception 
//  The assertEquals() passes with 1-part format 
//  save the result as new data 
//  From DXA to AUTO: 
//  note - same results when criteria is a string that parses as the number with the same value 
/*         The following cases are tested (copied from FormulaParser.parseStructuredReference)           1 Table1[col]           2 Table1[[#Totals],[col]]           3 Table1[#Totals]           4 Table1[#All]           5 Table1[#Data]           6 Table1[#Headers]           7 Table1[#Totals]           8 Table1[#This Row]           9 Table1[[#All],[col]]          10 Table1[[#Headers],[col]]          11 Table1[[#Totals],[col]]          12 Table1[[#All],[col1]:[col2]]          13 Table1[[#Data],[col1]:[col2]]          14 Table1[[#Headers],[col1]:[col2]]          15 Table1[[#Totals],[col1]:[col2]]          16 Table1[[#Headers],[#Data],[col2]]          17 Table1[[#This Row], [col1]]          18 Table1[ [col1]:[col2] ]         */
//  Has some data 
//  area is moved up => overwritten area is [startRow + n, startRow + n + movedRows] 
//  Excel prefers to encode 'SUM()' as a tAttr token, but this evaluator   expects the equivalent function token 
/*  Read the names of the origin and destination POI filesystems.  */
//  Font is Calibri 
//  convenient access to namepace 
//  Without a password, can't be read 
// Initialise the Panel 
//  In case B, all 4 sets have different alignments 
//  '?' = multiple values 
//  Type: 17   Addr: 014fd8bc  Offset: f8   Len: 20   Format: 54   From: 8a94 
//  It's in the built in range 
// reads null-terminated unicode string 
// should never happen 
//  documents must be at least this size to be stored in big blocks 
//  the width of the shape. 
// width of columns in the span 
// github-43: https://github.com/apache/poi/pull/43 
//  try to access some of the content 
//  1900 windowing (LocalDateTime) 
//  tika bug 1072 
//  Tint doesn't have the alpha   tint = -0.34999   255 * (1 + tint) = 165 truncated 
//  then stroke the shape outline 
//  Now copy 
//  Weds 
//  These aren't really typical sheets... Let it go though,    we can handle them roughly well enough as a "normal" one 
//  Add a default set of thresholds and colors 
//   pending then finish 
//  overwrite existing destRow with row-copy of srcRow 
//  Convert both values to ints to perform the test. 
//  use zero for null 
// top 
//  Deserialize 
//  Process chunk streams into their chunks 
//  false, true   false, true   false, true 
//  m01 (shearX) = eM12 (Horizontal proportionality constant) 
//  but will throw an NotImplementedFunctionException or return a #NAME? error value if evaluated. 
// REFERENCE_ORIGINAL(0x33), 
//  header row 
//  Check if any rows have already been flushed out 
//  data descriptor signature "PK\007\008"   crc-32   compressed size (zip64)   uncompressed size (zip64) 
//  Non-indexed parts: Word is taken, Excel is not 
//  Reference to a single cell in a different sheet 
//  match exactly one character 
//  create 3 cell styles 
// top-level element in sheet.xml 
//  For now, pretending to be an atom. Might not always be, but that    would require a wrapping class 
/*  ----------------------------------------------------------------------  */
//  Now get the chunk to process its commands 
//  That's all, just return 
//  from https://stackoverflow.com/questions/50873700/ 
//  ony a few distinct record IDs are encountered by the existing POI test cases:   0x1065 // many   0x01C2 // several   0x0034 // few   No documentation could be found for these 
//  without ColumnInfoRecord 
//  end bitfields 
//  Create main part relationship 
//  vertical 
//  check if enough items were performed 
//  make sure the potentially large byte-array is freed up quickly again 
// OBJ 
//  Add to the map 
// Set cell value  cell.setCellValue("r" + rnd.nextInt()); 
//  object in the EMF Object Table 
//  start of this record to the source bitmap header in the BitmapBuffer field. 
//  Now moving over the 2**15 boundary 
//  2x2 corner intersection 
//  keep destination, i.e. do nothing 
//  Only first row should move 
//  Simple email first 
//  this only works, when the paddings are mocked to be the same ... 
//  Make this cell ref look like a 1x1 area ref. 
//  They happen to go between the two slides in Ref terms 
//  search for errors array by array, not pair by pair 
//  A NURBS formula: knotLast, degree, xType, yType, x1, y1, knot1,   weight1, .. 
//  Add another duplicate 
// Create pivotCache and sets up it's relationship with the workbook 
//   the dummy cell records 
//  Have initial ones put in place 
//  H1, MID is used in the expression IF checks, so A1 should be V 
//    Use these to wrap error messages coming up so that we have at least   some idea where the error was located   
//  Now move to one with indexed rgb values 
//  Now check contents 
//  WMF metafile in the WinMetafile field. 
//  not [255, 255, 153] 
//  currently disabled test case row 
/*      * Test apply(Object value) with a Boolean as parameter      */
// buffer to memory for multiple tries 
//  (Avoids false positives on the rest of pattern 3) 
//  Check on tables 
//  assert that md5 after closing is the same, i.e. the source is left intact 
// ************ End SXSSF-specific methods ***************// 
//  reserved   reserved 
//  Valid date formats -- cell values should be date formatted & not "555.555" 
//  Check the number of text runs on interesting sheets 
//  look up sheet by name from external workbook 
//  the previous bytes matched part of the pattern 
//  should really be part of workbook stream, but some apps seem to put this before WINDOW2 
//  Fits 
//  Add 5 
//     protected native void incRef();      protected native void decRef(); 
//  formula2 and value2 are mutually exclusive 
//  File -> either 
//  The subrange [19, 38] is expected to be replaced with a EscherAggregate object 
//  sheet is in same workbook 
//                   assertEquals(msg, expected.getErrorCellValue(), actual.getErrorValue());                } 
// and again 
// just grab the raw data 
//  Check if this property is found in the mask 
//  this also handles booleans 
//  We know that FontCharset only has valid entries in it,    so we can just set the int value from it 
/* 	 * (non-Javadoc)	 * 	 * @see	 * org.apache.poi.ss.usermodel.DataValidationHelper#createTextLengthConstraint	 * (int, java.lang.String, java.lang.String)	  */
//  https://stackoverflow.com/questions/39636138 
//  is interested in; used to efficiently manage the registry 
//  as tested in Excel: 
//  A1 is a number 
// r.setRowNum(( short ) rownum); 
//  Reset the row and column counts - new workbook / worksheet 
//  Find the trailer 
//  XSSF does multi-sheet references differently, so this is the same as the first 
//  Firstly, try with one that triggers on InterfaceHdrRecord 
//  change a low level cell 
//  Type: 17   Addr: 014fd84c  Offset: d4   Len: 20   Format: 54   From: 8a94 
//  get the second 
//  sprmPDxaWidth 
//  Copy the properties of the one before to afterwards   Will go:    Original, until insert at point    New one    Clone of original, on to the old end 
//  collect cells into a temporary array to avoid ConcurrentModificationException 
//  list example will be re-used 
//  Now write out the slideshow 
//  Formulas 
//  test bad number formats 
//     return "0";   } 
//  And with ints not bytes 
//  decompress it using our engine 
//  Cell Formula with Reference 
//  First child should be the ExHyperlinkAtom 
//  Update the main record 
//  Make sure that XSSFTable.findColumnIndex returns the column index relative to the first   column in the table, not the column number in the sheet   column I in worksheet but 0th column in table 
//  Manjaro Linux, 24", 1920x1080(519x292 mm), 94x94 dpi   Windows 10, 15.6" 3840x2160   Windows 10, 13.3" 1080p high-dpi   Ubuntu Xenial, 15", 1680x1050   Mac 
//  The built-in name must consist of a single Area3d Ptg. 
//  NumberOfMembers (2 bytes):  A 16-bit unsigned integer that is not used. 
//  Fix line endings (Note - won't get all of them 
//  Now do the top level chunks 
//  Cruft at the end, as found from real files 
//  Open the Word document file and instantiate the XWPFDocument class. 
/*  char 12  */
//  write the workbook to the output stream   close our file (don't blow out our file handles 
//  replace drawing block with the created EscherAggregate 
// number of indentation levels 
//  used for collections 
//  check for fill 
//  Shift the 2nd row on top of the 0th row 
// Indentation increment for compact rows 
//  It's fine to go with the specified instead of the   normal 
//  Decompress a previously found module and store the decompressed result into module.buf 
//  dashes are in units of line width 
// name3 and name4 refer to Sheet2 and should not be affected 
//  Lookup between the PersitPtr "sheet" IDs, and the position 
//  CharFlagsTextProp: 3 doesn't have, 4 does 
//  with one difference; the bullet character prefixed to the items text. 
//  check formulas on other sheets 
// optimization if offset == 0 use "Normal" style 
//  Block use should be almost the same, except the properties    stream will have grown out to cover 2 blocks   Check the block use is all unchanged 
//  Within that, grab out the Hyperlink atoms 
//  To: 'Ashutosh Dandavate' <ashutosh.dandavate@alfresco.com>,     'Paul Holmes-Higgin' <paul.hh@alfresco.com>,     'Mike Farman' <mikef@alfresco.com>   Cc: nickb@alfresco.com, nick.burch@alfresco.com,     'Roy Wetherall' <roy.wetherall@alfresco.com>   (No BCC shown)  
//  Firstly, have the child added in at the end 
//  in pixelsper-meter, of the target device for the DIB. 
//  Can work with the special one 
/*  **********  END  implementation of FixedField **********  */
//  If this part is a relationship part, then delete all relationships of 
// define position of the drawing in the slide 
//  Work on the current one   Need to do this, as we don't handle    all the possible entries yet 
//  More scary internal setters 
//  check leading 0 
//  options   record id   remaining bytes 
// open existing file 
//  Decompress it, removing any trailing padding as needed 
//  some non-conformant applications don't write the magic code in 
//  Loop over the records, printing the text 
//  Process the excludes 
// TODO 
//  ensure all held resources are freed 
//  paragraphs.add(p); 
//  write cached data to stream 
//  check at max record size 
//  Call should modify the contents, but leave the formula intact 
//  Remove range2, since it is completely inside of range1 
// no Z, assume Z 
//  Add the new StyleTextPropAtom after the TextCharsAtom / TextBytesAtom 
/*  bug #60977, when writing a file multiple times,              * and there are custom properties and an existing package part,             * replace, don't append to raw document byte array              */
// now format the results 
//   of CTExternalReference elements in the workbook 
//  Check the titles 
// auto-size picture relative to its top-left corner 
//  decrypt header and read length to be decrypted 
//  need *something* between BOF and EOF 
//  read in the written file 
// 				throw new RuntimeException(e);  			}  		}   else verify record ordering by navigating the raw bytes 
//  Check they're not being silly, and asking for a built-in one... 
//  last record can optionally be a RoundTripCustomTableStyles12Atom 
//  positioned up from the base line of the text. 
// Copy from "in" to "out" up to the string "<sheetData/>" or "</sheetData>" (excluding). 
//  skip first item 
//  formula cell has not been evaluated yet 
//  Ensure any underlying resources, such as open files,    will get cleaned up if the user calls #close() 
//  compute width of the header column 
//  End the row 
//  actual BoolEval values get interpreted as FALSE->0 and TRUE->1 
//  then use default setting, which is cryptoapi 
//  Create a 2 block stream, will become a 1 block one 
/*          * 6.4.14 fo:region-body         *          * The values of the padding and border-width traits must be "0".          */
//  register another one 
//  end public class IntegerField 
//  Global Crs types do have params 
//  Visio - binary 
//  Should not be able to write to an output stream that has been closed 
//                 } 
//  Type (2 bytes):  A 16-bit unsigned integer that defines the type of metafile 
//  invalid arguments 
// cached formula value is set and cell's type='STR' 
//  OLE2 - File 
//  AttrPtg [sum ] 
//  show us the text 
/*  @see <a href="http://msdn.microsoft.com/en-us/library/dd925810(v=office.12).aspx">2.3.4.10 \EncryptionInfo Stream (Agile Encryption)</a>  */
//  also mark column styles as being used 
//  Add a row to the existing non-empty sheet 
// get our minimum values 
//  Create a new font and alter it. 
//  Now check 
//  Un-used style, can be removed 
// fOle  fOleLink  	private static final int OPT_CLIP_FORMAT_MASK      = 0x7FE0; 
/* 	     * The dataValue can't be taken as a mask, as sometimes certain properties	     * are explicitly set to false, i.e. the mask says the property is defined	     * but in the actually nibble the property is set to false	      */
// private int o_groupsNumber = 0; 
/*      * Sets the cell type to type if it is different      */
//  Unprotected, wrong password, opens normally 
//  place comment in A1 
/*  * Implementation of the various ISxxx Logical Functions, which *  take a single expression argument, and return True or False.  */
//  If there's a sheet name, strip it off 
//  this one fails: sheet.showInPane((short)i, 0); 
//  TODO: generate CombObj stream 
// get default font 
// HeaderRecord  FooterRecord  HeaderFooterRecord   DimensionsRecord   WindowTwoRecord 
//  1 = one time, M = 1..many times, * = 0..many, 0 = optional 
//  An optional 32-bit signed integer that specifies the distribution of the pen width with respect to   the coordinates of the line being drawn. This field MUST be present if the PenDataNonCenter flag is   set in the PenDataFlags field of the EmfPlusPenData object, and the value MUST be defined in the   PenAlignment enumeration 
//     {        list.add(keyIT.next());      }      Collections.sort(list);   
//  Rich test file A 
// assign a hyperlink to A4 
// this check works both for Escher and PowerPoint records 
//  Check what we just read. 
// some basic get* accessors 
//  list all properties 
//  Ask Scratchpad, or fail trying 
// TestXSSFHeaderFooter.class, //converted to junit4 
//  then with event based one 
//  end public interface POIFSViewable 
//  Is it XWPF? 
//  The drawing group record always exists at the top level, so we won't need to do this recursively. 
// According to the spec, MSOffice doesn't pay attention to this value. 
//  Rich test file B 
/*  Add another custom property.  */
//  Second char style is coloured, 00 00 00 05, and 17 long 
//  An optional EmfPlusTransformMatrix object that specifies a world space to device space transform for   the path gradient brush. This field MUST be present if the BrushDataTransform flag is set in the 
//  Add a picture to the first paragraph 
// sheet.setRowSumsBelow alters this field too 
//  Blank and Null the same 
//  Create A from scratch 
/*  Xml elements in content type part  */
//  Check for digit or letter 
//  Now 4 real cells, all strings 
// assertEquals(32.4.0, r3.getFontSize()); 
// use 100 as the default denom if something went horribly wrong 
//  cell with a reference value 
//  re-align local vars in this test case 
//  Almost at the end is some more text 
//  always interpreted as horizontal 
//         Iterable<HwmfEmbedded> getEmbeddings(); 
//  multiple threads at the same time 
//  Allocate our new BAT as the first block in the XBAT 
//  get the first cell 
//         headerF.getParagraphs().get(0).insertNewRun(0).setText(fText1); 
// Need to check what the font is currently, so we can reapply it after  the range is completed 
//   			HSSFWorkbook wb = new HSSFWorkbook();  			HSSFSheet sheet = wb.createSheet();  			HSSFRow row = sheet.createRow(rowIndex); 
//   as that's a sign of a screwed up record 
//  split at slash, but keep leading slash 
//  update: now the locale will be (if not set otherwise) always Locale.getDefault() (see LocaleUtil) 
//  On page two, has explicit styles, but on runs not on 
//  Mini stream will get one block for fat + one block for data 
//  Now, build the linked or dependent drop down list that will   occupy cell B1. The key to the whole process is the use of the   INDIRECT() function. In the buildDataSheet(0 method, a series of   named regions are created and the names of three of them mirror   the options available to the user in the first drop down list   (in cell A1). Using the INDIRECT() function makes it possible   to convert the selection the user makes in that first drop down   into the addresses of a named region of cells and then to use 
//  end calc settings 
//  1st is left aligned + normal line spacing 
//  TODO Have a map 
//  of all things 
//  Don't process this just yet, need the BOFRecord 
// the actual link, terminated by '\u0000' 
//  value in row 10 
//  never matches (also inconsistent with above three cases).   for example '>5' does not match '6', 
//  probably most people will use one listener 
//  Any subclass of OperandPtg is mutable, so it's safest to not share these instances. 
//  Should now be the same as data_a 
// add CTLegacyDrawing element which indicates that this sheet contains drawing components built on the drawingML platform. 
//  Save, and re-load the file 
//  register the user-defined function in the workbook 
//  keep stepping over values until the right type is found 
//  It's a </<= condition. 
//  Discover how many sheets there are in the workbook.... 
//  98 is actually the last block in a two block stream... 
//  int lfoOffset = _fib.getFcPlfLfo(); 
//  bitmask order can be different 
//  298 == 0x12A; 302 == 0x12E 
//  catch clauses optimised to handle more specific problems. 
//  Setup 
//  0x2 is reserved 
//  Column 'D' 
// in the serialization procedure the original structure of records must be preserved 
// test file derives from govdocs1 147240.xls 
//  Any picture text? 
//  Grab the VBA project root 
//  A 32-bit unsigned integer that specifies how to interpret values in the color 
//  Remove all the old cells from the row we'll    be writing to, before we start overwriting    any cells. This avoids issues with cells    changing type, and records not being correctly 
/*      * Helper - determine length of zero terminated string (ASCIIZ).      */
//  even if R attribute is not set,   POI is able to re-construct it from column and row indexes 
//  sprmCFSpecVanish 
//  check no other records 
//  still a problem parsing the number - probably out of range 
//  Color is a regular one 
/*  Initialize the number-to-name and number-to-length map:  */
//  This character looks like a solid, black, loser case letter 'o' 
//  also remove the corresponding CTCell from the _row.cArray,   it may not be at the same position right now 
//  allow files with much lower inflation rate here as there is no risk of Zip Bomb attacks in this developer tool 
/*         final Class<? super T> clazz;        final T instance;        final Class<R> returnType;        final String methodName;        final Class<?>[] parameterTypes;        final Object[] parameters;        final R expected;        final R actual = POITestCase.callMethod(clazz, instance, returnType, methodName, parameterTypes, parameters);        assertEquals(expected, actual);         */
//  both do hold what is expected. 
//  Set a default footer and capture the returned XWPFFooter object. 
//  sprmCFItalicBi 
//  Grab the contents 
//  Header isn't in BATs 
//  cross tests with fv 
//  no instance fields 
//  Note - observed behavior of Excel:   Error values like #VALUE!, #REF!, #DIV/0!, #NAME? etc don't cause this COUNTA to return an error   in fact, they seem to get counted 
//  Note: when entity_expansion_limit==0, there is no limit! 
//  Google App engine returns null for user.name, see Bug 53974 
//  Check the contents of the 3rd block 
//  null-termination 
//  nope, they must have different results, because of garbage   assertEquals(   extractor2.getTextFromPieces().replaceAll("[\\r\\n]", ""),   extractor2.getText().replaceAll("[\\r\\n]", "")); 
//   as required 
//  NOSONAR - should not be closed here 
//  0x03, stringLen 
// check that the formula evaluator returns the correct result 
//  mimic test sample from http://office.microsoft.com/en-us/excel-help/sumifs-function-HA010047504.aspx 
//  Other thingy 
//  Now properties 
//  child offset is left to 0,0 
// Expected ptg stack: [NamePtg(myFunc), StringPtg(arg), (additional operands go here...), FunctionPtg(myFunc)] 
//  Is it XSSF? 
// see private use area 
//  5 more blank rows 
//  not an auto-number bullet 
//  Code limits to #### as that is as slow as we want to get 
//  Look at the pictures table 
//  only adjusted when first date is last day in Feb 
//  Close the current zip file, so we can overwrite it on all platforms 
//  notify all cells in this row that we are going to shift them,   it can throw IllegalStateException if the operation is not allowed, for example, 
//  a POIFS file which is not a Workbook 
//       buf = new byte[(itcMac * ShadingDescriptor.SIZE) + 1];        buf[0] = (byte)itcMac;        ShadingDescriptor[] shds = newTAP.getRgshd(); 
//  the record body can take different forms.   The form is dictated by the values of 3-th and 4-th bits in field_1_option_flag 
// by default comments are hidden 
//  Any special record handling occurs once we have the class 
//  sid, size   row, col, xfIndex   extra 00 byte here 
//  all regions should still start at row 3, and elongate by 1 row 
//  Names must match 
//  Now create our Escher children 
//  original contributions by Axel Richter on https://stackoverflow.com/questions/47065690   additional title formatting from https://stackoverflow.com/questions/50418856   and legend positioning from https://stackoverflow.com/questions/49615379   this would probably be an answer for https://stackoverflow.com/questions/36447925 too 
//  Find any persist ones first 
//  Use the built-in font metrics file off the classpath 
//  dark green 
//  test properties of rebuilt embedded message 
//  set some value 
//  demonstrate adding/naming and deleting a sheet 
//  10 @ 4086 
//  offset += Stshif.getSize(); 
//  We need this trick to correctly measure text 
//  Shift Row Breaks 
// test that the regions were spread out over the appropriate number of records 
//  Extract the zip entry content to put it in the part content 
//  Print the attribute into 
//  "<Conventional>_Sheet1" 
//   private static final int PAP_TYPE = 1;    private static final int CHP_TYPE = 2;    private static final int SEP_TYPE = 4;    private static final int TAP_TYPE = 5; 
//  Paranoid replacement... 
//  The ministore should be one big block bigger now 
//         snapToAnchor(p1, anchor);          snapToAnchor(p2, anchor); 
//  check continue record 
//  New size based on the same logic as ArrayList 
//  Process the first argument as a file 
// the font being added twice 
//  Ditto 
//  Check the number of arguments passed to the main method. There   must be two, three or four; the name of and path to either the folder   containing the Excel files or an individual Excel workbook that is/are   to be converted, the name of and path to the folder to which the CSV   files should be written, - optionally - the separator character   that should be used to separate individual items (fields) on the   lines (records) of the CSV file and - again optionally - an integer   that idicates whether the CSV file ought to obey Excel's or UNIX   convnetions with regard to formatting fields that contain embedded   separator, Speech mark or EOL character(s).     Note that the names of the CSV files will be derived from those   of the Excel file(s). Put simply the .xls or .xlsx extension will be   replaced with .csv. Therefore, if the source folder contains files   with matching names but different extensions - Test.xls and Test.xlsx   for example - then the CSV file generated from one will overwrite   that generated from the other. 
//  Get the footer 
//  the created ExternalNameRecord will be appended to it 
//  Error constant literals all contain '#' and other special characters 
//  Now try a problem one with drawing records in it 
/*      * Excel uses relations on sheets to store the details of      *  external hyperlinks. Check we can create these OK,      *  then still read them later      */
//  Try to evaluate, with the other file 
//  scratchpad classes are not available, so we use something pre-cooked 
//  do some strange things with it ;) 
// style.setHidden(false); 
//  plex which will be written later to the tableStream. 
//  Column 0 has a font with colours from a theme 
//  Try to make sense of the data part:   Data part is made up of a number of these sets:     32 bit info value  		12 bits count of # of entries        base number for these entries     count * 32 bit offsets 
// private static final String BIFF8_LAST_COLUMN = SpreadsheetVersion.EXCEL97.getLastColumnName();  private static final int BIFF8_LAST_COLUMN_TEXT_LEN = BIFF8_LAST_COLUMN.length();  private static final String BIFF8_LAST_ROW = String.valueOf(SpreadsheetVersion.EXCEL97.getMaxRows());  private static final int BIFF8_LAST_ROW_TEXT_LEN = BIFF8_LAST_ROW.length(); 
//  committing twice did add the XML twice without clearing the part in between 
// the WordArt and text box count tests will fail  if this content is available via getTextParagraphs() of the slide in POI  i.e. when POI is fixed, these tests will fail, and 
//  Return ###...### (255 #s) to match Excel 2007 behaviour 
//  remove any characters that should be replaced 
//  this code is required to make sure all the necessary classes are loaded 
// a new fill was added to the styles table 
// Take care of the funny 4th quadrant issue  The 4th quadrant (-1 to -90) is stored as (91 to 180) 
//  even this #VALUE! error gets used by COUNTIF as valid criteria 
//  Every one of these component records is optional   (The whole WorksheetProtectionBlock may not be present) 
//  Now re-generate our CTHyperlinks, if needed 
//  4th read blows up as it loops back to 0 
/*  Find out whether the current document is a property set                 * stream or not.  */
//  HSSF + XSSF   Normally just XSSF   Normally just XSSF 
//  Use Reflection to get us the full OOXML-enabled version 
/*  Indicate that we're done  */
//  Not a supported type   Skip onto the EOF, then complain 
//  TextCharsAtom 
//  Check they were added properly 
//  detect header 
/*              * Per Excel help:             * https://support.office.com/en-us/article/Manage-conditional-formatting-rule-precedence-e09711a3-48df-4bcb-b82c-9d8b8b22463d#__toc269129417             * stopIfTrue is true for all rules from HSSF files, and an explicit value for XSSF files.             * thus the explicit ordering of the rule lists in #getFormattingRulesForSheet(Sheet)              */
//  set the RowRecord empty for the moment 
/*  Create the summary information property set in the POI file             * system. It is given the default name most (if not all) summary             * information property sets have.  */
//  let's find one that is not undefined 
//  Remove, goes back to default 
/* HSSFPatriarch dg = */
//  5.38.1 External References 
/*  Add the POI filesystems to the tree.  */
//  One Level Down 
//  duplicate of 1   duplicate of 2   two have gone 
//  A2 to A6 should be gone 
// dive into the shape container and search for InteractiveInfoAtom 
//  sprmPDxaLeft1 -- 0x8460 
//  Buffers which map to a file-portion are not closed automatically when the Channel is closed   therefore we need to keep the list of mapped buffers and do some ugly reflection to try to    clean the buffer during close().   See https://bz.apache.org/bugzilla/show_bug.cgi?id=58480,    http://stackoverflow.com/questions/3602783/file-access-synchronized-on-java-object and 
//  be nice 
// 0x0FAC RT_StyleTextProp9Atom 
//  Embeded bits are checked in    TestExtractorFactory 
/*  Excel V14 / 2010 - chart  */
//  Convert excel date format to SimpleDateFormat.   Excel uses lower and upper case 'm' for both minutes and months.   From Excel help: 
//  sub-normal negative numbers also display as '-0' 
//  BOF 
//  Add a test mini stream 
// setTheme 
//  Check for rule M1.6, M1.7, M1.8 
//  the desired style already exists in the workbook. Use the existing style. 
//  Stub the sheets, so sheet name lookups work 
//  URL, EMAIL, and FILE links anchored on a shifted cell should be moved 
//  XSSF supports >32,767 formats 
// add negative thickness so we go the other way 
//  found it 
//  Ignore, invalid format 
//  Is it a name or a function? 
//  init paragraphs 
//  should be sized as 'Jan' 
/*              * If there is a document summry information stream, read it from             * the POI filesystem, else create a new one.              */
//  if there is a globalPrecision we will use it unless there is also   precision set at the evaluate level, then we use that.  If there   is not a globalPrecision, we will use the local precision. 
//  multiplying or dividing minus zero by a positive quantity yields minus zero 
//  Won't be in all list 
//  Grab the first 512 bytes   (For 4096 sized blocks, the remaining 3584 bytes are zero) 
//  First attachment should have 22 
//  with explicitly empty third parameter 
//  should really evaluate, but HSSFCell can't call HSSFFormulaEvaluator   just use cached formula result instead 
//  sometimes there are "fake" cells which we need to exclude 
//  Create conditional formatting, CELL1 should be yellow if CELL0 is not blank. 
//  Absolute Value Formula 
//  don't want to include the sheet name twice 
//  Master - unchanged 
//  cannot check on result because on some machines we get back false here! 
//  base class for cell reference "things" 
//  Building namespace 
//  simple case - expand area by shifting top upward 
//  font stuff 
//  bounds checking 
//  number of formula cells that needed to be evaluated. 
//  And a multi block one 
//  A 16-bit unsigned integer that specifies how to interpret the points 
//  Check the final block too 
//  Sort out headers and footers 
//  Find a real RecordContainer record 
//  customize bullets 
//  Add something to the filtered subdir that gets ignored 
//  (who knows what they mean though...) 
//  If there's nothing to find, skip it 
//  use filename instead of File object to omit full pathname in test name 
//    C tAttrIf 
//  And again, just to be sure 
//  the next column. 
//  Each polygon SHOULD be outlined using the current pen, and filled using the current brush and   polygon fill mode that are defined in the playback device context. The polygons defined by this   record can overlap. 
// check initial position 
//  finished with Term 
//  Create the extractors 
// we cannot set individual formulas for cells included in an array formula 
//  0x0001  A bit that specifies whether the characters are bold.   0x0002  A bit that specifies whether the characters are italicized.   0x0004  A bit that specifies whether the characters are underlined.   0x0008  Undefined and MUST be ignored.   0x0010  A bit that specifies whether the characters have a shadow effect.   0x0020  A bit that specifies whether characters originated from double-byte input.   0x0040  Undefined and MUST be ignored.   0x0080  A bit that specifies whether Kumimoji are used for vertical text.   0x0100  aka "unused3" - sometimes contains the strikethrough flag    0x0200  A bit that specifies whether the characters are embossed.   0x0400  An unsigned integer that specifies the run grouping of additional text properties in StyleTextProp9Atom record.   0x0800   0x1000   0x2000   0x4000  Undefined and MUST be ignored.   0x8000  Undefined and MUST be ignored. 
//  Delete a directory, and add one more 
//  jumpTable   chooseOffset 
//  Create the Shape for it 
// set sample data 
//  Verify we only got one block 
// Makes repeated calls to super.read() until length is read or EOF is reached 
// setAlternateExpression must be set in conjuction with setRowSumsBelow 
//  Get the booleans as bytes 
// standard 24-byte tail of a URL link. Seems to always be the same for all URL HLINKs 
//  Save the new ptr data 
//  ConditionalFormattingTable 
//  some other values 
//  see 2.4.6 MSOCDIR 
/*          * An array of LFOData that is parallel to rgLfo. The number of elements         * that are contained in this array is specified by lfoMac. -- Page 424         * of 621. [MS-DOC] -- v20110315 Word (.doc) Binary File Format          */
//  for XSSF also test with SXSSF 
//  pane id 3 is always present.  see OOO sec 5.75 'PANE' 
//  Now, build our slide 
// add chart object to chart list 
//  only evaluate differences 
//  pitch request   when 1, font is a TrueType font 
//  top of area is preserved (will remain exact same row)   the bottom area row is moved simply 
//  non-TNEF files 
// test that the HemfCommentEMFPlus record at offset 1 
//  And at the start 
// still have 3 sheets 
// it contains only cashed result of the previous FormulaRecord evaluation 
//  And with NPOIFS 
//  Set the columns to repeat from column 0 to 2 on the first sheet 
// ///////////////////////////////////// 
//  Text 
//  Add the Calc block and set it 
//  ---------- POI Logger methods implemented for testing ---------- 
// link: Sheet1!A1 
//  Save the string into a String Record, creating one if required 
//  Get the contents for now 
//     {        Integer key = Integer.valueOf(LittleEndian.getInt(grpprl, offset));        Byte val = Byte.valueOf(grpprl[(LittleEndian.INT_SIZE * (addSize - x)) + x]);        tabMap.put(key, val);        offset += LittleEndian.INT_SIZE;      }        tabPositions = new int[tabMap.size()];      tabDescriptors = new byte[tabPositions.length];      ArrayList list = new ArrayList();        Iterator keyIT = tabMap.keySet().iterator(); 
//  generic header   page 23, point 2.4.2   tag is the property id and its type 
//  Find the base TextProp to base on 
// Sum up the second column 
//  Type: 16   Addr: 0143aff4  Offset: 80   Len: 54   Format: 46   From: 8a94 
/*  * Sheet-level policies   */
//  should be .001 
// Save the template 
//  Int - 2   Attr 
//  "Whole number" validation type 
//  47: DVAR 
// check creation of first row 
//  The ShapeId is not equal?    assertEquals(c.getNoteRecord().getShapeId(), c2.getNoteRecord().getShapeId()); 
//  png,gif,jpg or null for test   -1 for all 
//  two consecutive quotes is the escape sequence for a single one   skip this and keep parsing the special name 
//  Most recent core records 
//  Handle end of row 
//  Store the 2 block one, should use 2 mini blocks, and request 
//  Cell show "D-16" 
//  this definitely would have failed due to 27349 
//  can't use List.indexOf here because it checks the records for equality and not identity 
//  unencrypted 
/*  Ignoring a property without a name.  */
//  Figure out the length, in bytes and chars 
// check that 
// string is writing double bytes. 
/*          * Make sure we insert right after the ds:SignatureValue element, just         * before the first ds:Object element.          */
//  Update the Slide Atom's ID of where to point to 
//  the top evaluation frame 
//  mask is 0x030004 
//  Simulating badly encoded cell formula of "=/1"   Not sure if Excel could ever produce this 
/*              * Extended properties are a predefined set of metadata properties             * that are specifically applicable to Office Open XML documents.             * Extended properties consist of 24 simple properties and 3 complex properties stored in the             *  part targeted by the relationship of type              */
//  Iteratating over the hours exposes any rounding issues. 
//  ODF / ODS - File 
//  Sheet0 because it uses "Sheet" + sheets.size() as starting point! 
//  Can only find on the right sheet ref, if restricting 
//  often COLINFO gets encoded 1 byte short   shouldn't matter because this field is unused 
//  Check if the part name URI ends with a forward slash [M1.5] 
//  Search the referenced drawing in the list of the sheet's relations 
//  Create a header with a 1 row, 3 column table   changes made for issue 57366 allow a new header or footer   to be created empty. This is a change. You will have to add   either a paragraph or a table to the header or footer for 
//  total size is currently the size of one FC 
//  horiz align   vert align   display mode 
//  Billet for formula in rec 
//  Now, do a new file from scratch 
//  object specified by the ObjectId value in Flags field. 
//  Check the Hyperlinks 
/* offset += */
//  Grab the next 16 bits of data 
//  normal bracket, not a symbol 
//  Update the counts and start positions  
//  Check the details 
//  contentControls.add(c); 
/*              * use StdDev, aboveAverage, equalAverage to find:             * comparison value             * operator type              */
//  Pad to next 2-byte boundary 
//  Open the existing file, tweak one value and   re-calculate 
// first bit == 1?  second bit == 1? 
//  center point 
//  add logic for hyperlinks etc, like in shiftRows()  
//  MIN to a range of cells over 3 workbooks, absolute reference 
//  If no password was given, use the default 
// FuncVarPtg 
// bullet.offset 
//  And with a footer, also on notes 
//  Ask for another, will get our 2nd XBAT 
//  Fifth is 1 long, underlined and different+bigger font + red 
//  no instance initialisation 
//  slightly different from PowerPoint! 
//  optional EmfPlusImageAttributes object in the EMF+ Object Table. 
//  test legacy xored-hashed password 
//  confirm("FIXED(1.234567890123459,15,TRUE)", "1.234567890123450"); 
//  100 onwards is free 
/*  for Var1or2ArgFunction:	@Override	public ValueEval evaluate(int srcRowIndex, int srcColumnIndex, ValueEval arg0) {	}	@Override	public ValueEval evaluate(int srcRowIndex, int srcColumnIndex, ValueEval arg0, ValueEval arg1) {	}	 */
//  natural order              int start = end - 1;                // reverse order   natural order 
//  If you don't have an image at the end of all readers 
//  Alignment happens after the scaling but before any offset. 
/*  => Writing isn't yet supported...		// write out the file		File file = TempFile.createTempFile("StressTest", ".msg");		writeToFile(mapi, file);				MAPIMessage read = new MAPIMessage(file.getAbsolutePath());		assertNotNull(read.getAttachmentFiles());		assertNotNull(read.getDisplayBCC());		assertNotNull(read.getMessageDate());		 */
//  A NURBS formula. 
//  don't close the path 
//  Turn the string array into a single string 
//  Update formulas that refer to rows that have been moved 
//  Our escher container record should contain several   SpContainers, the first of which is the group shape itself 
//  Save this properties set 
//  A 32-bit unsigned integer that specifies how the transform specified in Xform is used. 
//  PT_LINETO   Specifies that a line is to be drawn from the current position to this point, which 
/*          * Inch (2 bytes):  The number of logical units per inch used to represent the image.         * This value can be used to scale an image.         * By convention, an image is considered to be recorded at 1440 logical units (twips) per inch.         * Thus, a value of 720 specifies that the image SHOULD be rendered at twice its normal size,         * and a value of 2880 specifies that the image SHOULD be rendered at half its normal size.          */
//    B tAttrSkip 
/*  This is the root path of the POI filesystem. Its tree             * node is resp. must be located below the tree node of             * the POI filesystem itself. This is a tree node with the             * POI filesystem's name (this the operating system file's             * name) as its key it the path-to-node map.  */
/*  BAD_DATE!  */
//  Create arrays for parts attached to the workbook itself 
//  Check the FAT was properly processed 
//  97+98 is another 
// basic extraction works, 
//  ignore errors for documents with incorrect extension 
/*  Read double word.  */
//  Get the offset to the previous incremental save's UserEditAtom   This will be the byte offset on disk where the previous one 
//  Note - no '!' or '?' suffix 
//  Ensure that random square brackets remain 
//  safe because immutable 
//  Zero fat blocks isn't technically valid, but it'd be header only 
// Assume identical cell styles aren't consolidated  If XSSFWorkbooks ever implicitly optimize/consolidate cell styles (such as when the workbook is written to disk) 
/*  Read the POI filesystem.  */
/*  TODO: NPE?        sheet.dumpDrawingRecords(false);        sheet.dumpDrawingRecords(true); */
//  grpprl.length - 2 ); 
// link to a place in this workbook 
//  If height or width are omitted, it is assumed to be the same height or width as reference. 
//  Should now have 109+127 = 236 BATs 
//  create 50 cells (0-49) (the += 2 becomes apparent later 
//  subtract jump table size 
//  test deletion of sheet 0 and signing 
//  Level 1 collapsed, Level 2 expanded, Level 3 collapsed  
//  ignore alternate content choices, we won't know anything about their namespaces 
/*  char 7   */
/*          * If it's a self reference, the last one or two bytes (depending on char type) are the         * unused field. Not sure If i need to bother with this...          */
//  after which the remainder of this field MUST be ignored. 
// (#,##0.00_);(#,##0.00) 
//  Excel seems to always write the DIMENSION record, but tolerates when it is not present   in all cases Excel (2007) adds the missing DIMENSION record 
//  Bugzilla 53041: Hyperlink relations are duplicated when saving XSSF file 
//  we need to skip row if he don't have cells at all 
// //// Case 15: Evaluate "Table1[[#Totals],[col]:[col2]]" //////// 
//  first, copy contents from existing war 
//  Output after we've seen the string contents 
//  one special case of ControlPtg 
//  verify the various ways to construct a ZipSecureFile 
//  need to remap the fractions, because Java doesn't like repeating fraction values 
//  Each cell style has a unique xfs entry   Several might share the same styleXfs entry 
//  IntPtg(1)   IntPtg(0) 
//  This is a Phs (see page 881) 
//  Test directly with the .SSS style 
//  Ask for the raw values 
// hmf 
// reference values 
//  cat axis 1 (bars) 
//  Now do the padding if needed 
//  xmlContent.setXmlStandalone(true); 
//  date value for July 8 1901 1:19 PM 
//  stream needs to be kept open 
//  perform the same checks using LocalDateTime 
//  grpprlOffset = offsetOffset + index + (grpprlOffset % 2); 
//  uncomment to observe more intuitive behaviour   StringEval se = (StringEval)x; 
//  no changes on row "3" 
//  tag 
/*           In powerpoint anchor of a shape is its top left corner.          Java graphics sets string coordinates by the baseline of the first character          so we need to shift up by the height of the textbox         */
//  Check the new formulas: Function won't change, Reference will 
//  Test a few simple bits off a simple header 
//  0x400000 MUST be zero and MUST be ignored 
//  Only test cases omit the book (expecting it not to be needed) 
//  4 bytes, total size of record not including this field   2 bytes, unknown, mostly [02 00]   ASCIIZ, stored in this field without the terminating zero   ASCIIZ, stored in this field without the terminating zero   2 bytes, unknown, mostly [00 00]   see below   ASCIIZ, stored in this field without the terminating zero   varying size, the actual native data   some final flags? or zero terminators?, sometimes not there 
//  levels   initialise the levelCount array - this maintains a record of the 
//  end border option bitfields 
//  only move 3D refs that refer to the sheet with cells being moved   (currentExternSheetIx is irrelevant) 
//  3 --> 1 
//  Trim trailing A 
//  single column ColumnInfoRecord starting at index 0 
//  The sizes and zoom ratios 
//  Tell it its Sheet ID, if it cares 
//  normal column condition   Should not throw, checked above. 
//  Get the slide ID 
// System.err.println("drawing east"); 
// TextCFException9 + SIException 
//  297: STANDARDIZE 
//  Need to find a DrawingGroupRecord that contains a EscherDggRecord 
//  Look in detail at one 
//  Indirect.evaluate has different signature 
//  if not found, ask the master 
//  Overlaps with 8 - 9 (before and overlap replacements required) 
//  Check 
//  the cell referred to by this formula will be replaced 
//  check that it is there now 
//  in some locales the the decimal delimiter is a comma, not a dot 
//  TODO: distinguish underline type 
/*  * Default Character Run style, from which other styles will override * TODO Share logic with {@link XWPFRun} which also uses CTRPr  */
//  Check we can round-trip - try to set a new one to a cell range 
//  If it's a named property, rather than a standard 
//  supports search in null or empty string 
//  Columns moved were originally *completely* within the area ref 
//  An optional 32-bit floating-point value that specifies the miter limit, which is the maximum allowed   ratio of miter length to line width. The miter length is the distance from the intersection of the   line walls on the inside the join to the intersection of the line walls outside the join. The miter   length can be large when the angle between two lines is small. This field MUST be present if the   PenDataMiterLimit flag is set in the PenDataFlags field of the EmfPlusPenData object. 
// German lowercase eszett, scharfes s, sharp s 
//  the formula returns TRUE is the formatted date in column C equals to the string in column D 
//  Links to the three sheets, shared strings and styles 
//  more complex case - back link into wbA 
// save the workbook and read the property 
//  disabled for the time being, as the results aren't promising 
// System.setOut(new PrintStream(TestBiffViewer.NULL_OUTPUT_STREAM));   use a NullOutputStream to not write the bytes anywhere for best runtime  
//  /p:sldMaster/p:cSld/p:spTree/p:sp/p:nvPr/p:ph[@type="body"] 
//  x1 on sheet1 defines "x=1" 
//  expected: the zip file is invalid   this test does not care if open() throws an exception or not. 
//  Re-check on load 
// low-level bean holding cell's xml 
//  This formula should evaluate to the contents of B2, 
//  Is the name actually on our workbook? 
//  Test effect of setting width type to a new value 
//  Test copy whole thing 
//  sid=0x0409   size=0x0006 
//  Set the level for each column 
//  Ident 0   Border 0 
//  Strings are equal, but one or the other has formatting runs 
//  sprmPDxaLeft80  
//  Verify a few next offsets 
//  Next four bytes are the type 
//  ignore StartElement: 
//  reserve a slot for the record 
//  Try evaluating all of them, ensure we don't blow up 
//  deactivate scaling/translation in super class, by specifying the dimension of the texture 
//  Add space required to write the DBCELL record (whose reference was just added). 
//  Created at has a +3 timezone and milliseconds     2006-10-13T18:06:00.123+03:00 
//  add some contents to table so that the table will need expansion 
//  basis four has funny adjustments to the day-of-month fields when at end-of-month 
//  application/vnd.openxmlformats-officedocument.vmlDrawing   ?!MIME_TYPES.put(Pattern.compile(".*vmlDrawing.*"), ".dwg"); 
//  it seems much simpler -- sergey 
//  usually doesn't happen ... 
//  Stored in the Attachment blocks 
//  Column 'C' 
//  Pivot Table and Query Table Extensions 
// first byte(s) of variable length section of std is the length of the 
//  Check inside 
// AbsFirstRow AbsLastRow references should't change when copied to a different row 
//  #2) these cells will have medium outside borders and thin inside borders 
// Create new row  Row row = worksheet.createRow(i); 
//  these fail before the fix for 59814 
// the header row: centered text in 48pt font 
//  fallback to LATIN if the font for the font group wasn't defined 
//  the spec does not specify a length-limit, however Excel reports files as "corrupt" if they exceed 255 bytes for these texts... 
//  table size reduced -   clear all table cells that are outside of the new area 
//  49: LINEST 
//  See if we already have it cached 
//  Get a new FileSystem to write into 
// get customized font 
//  Shift 3 to back 
//  Check the other way 
/*  *  Convert java DateFormat patterns into Excel custom number formats. *  For example, to format a date in excel using the "dd MMMM, yyyy" pattern and Japanese *  locale, use the following code: * *  <pre><code> *      // returns "[$-0411]dd MMMM, yyyy;@" where the [$-0411] prefix tells Excel to use the Japanese locale *      String excelFormatPattern = DateFormatConverter.convert(Locale.JAPANESE, "dd MMMM, yyyy"); * *      CellStyle cellStyle = workbook.createCellStyle(); * *      DataFormat poiFormat = workbook.createDataFormat(); *      cellStyle.setDataFormat(poiFormat.getFormat(excelFormatPattern)); *      cell.setCellValue(new Date()); *      cell.setCellStyle(cellStyle);  // formats date as '2012\u5e743\u670817\u65e5' *  </code></pre> * * TODO Generalise this for all Excel format strings  */
//  This array MUST exist if and only if the fValidPlex flag (0x2) is set 
//  Save, load back in again, and check 
/*  check if a user model series object was created  */
// save workbook 
//  there is no way from the model to tell if the list is fixed values or formula based. 
// workbook.dispose(); 
//  Split out the fractional part if we need to print a fraction 
//  we have some files that are not actually OOXML and thus cannot be tested here 
//  Get cell that does not exist yet 
/*  Write the summary information and the document summary information             * to the POI filesystem.  */
//  The stability classifier is useful to reduce memory consumption of caching logic 
//  check the exact case reported in 'bug' 43901 - notice that the cellNum is '0' based 
//  Should Q10/Q11 be checked? 
//  single column range 
//  Should have two, both strings 
//  Number, but almost certainly with a special style or format 
//  TODO Cache these evaluation sheets so they aren't re-generated on every getSheet call 
//  This (should) include the 8 byte header size 
// 				OutputStream os = new FileOutputStream(f);  				wb.write(os);  				os.close(); 
// path to the file (plain ISO-8859 bytes, NOT UTF-16LE!) 
//  dark cyan 
//  Don't know (and can't get) the workbook date windowing (1900 or 1904)   so assume 1900 date windowing 
//  this should be 2 as XSSFSimpleShape creates a default paragraph (no text), and then we add a string to that. 
//  Now handle our special cases 
//  Check it took those changes 
//  check by name 
//  The y-coordinate of a curve's ending control point relative to the 
//  calculate total size of the header and first encoded char   ushort len, at least one character byte 
//  Often (but not always) the datasize for the sub-record 
//  add another sheet and apply the borders to it 
//  Image signature 
//  For negative numbers:   - If the cell format has a negative number format, this method   is called with a positive value and the number format has   the negative formatting required, e.g. minus sign or brackets.   - If the cell format does not have a negative number format,   this method is called with a negative value and the number is   formatted with a minus sign at the start. 
// none is not the same as "not set", therefore the following doesn't work any more  assertFalse(ctBorder.isSetRight()); 
//  Create the Styles Table, and associate the Themes if present 
//  fails only for useMergedCell=true 
//  First free one is at 15 
//  Style dxfs 
//  Finally back to big again 
//  These come after the real ones 
// Now create real formula based validation. 
// 		super(pointer, store, chunkFactory); 
// we are now a normal formula cell 
//  A 32-bit unsigned integer that specifies the checksum for this record. 
//  Needs reference not value 
//  Fits in, wait for next byte 
// this tests consecutive runs within a cell (not a paragraph) 
// label: 
//  The number of elements in the array specified in the StyleEntry 
//  test INFO 
//  no ':' 
//  Check it's a regular chunk 
//  colour red   character run is 96 long 
// // ROW VECTORS 
//  Title is underlined 
//  original quantity only has 53 bits of precision   these quantities may have errors in the 64th bit, which hopefully don't make any difference 
//  Has 3 paragraphs on page one, a break, and 3 on page 2 
// 75% scale 
//  end of bitfields for indention options   border options 
//  end public class LongField 
//  undo previous increment 
// break; 
//  update cell references to clear the cache 
//  record types -- palette options 
//  Low level contents 
//  Report where it went 
//  Create a formula parser 
//  SUM to one cell over 3 workbooks, relative reference 
//  sprmPDxaLeft -- 0x845e 
//  flag 
// _fib.serialize(mainBuf, 0); 
/*  Getters  */
// If DEC2BIN requires more than places characters, it returns the #NUM! error value. 
//  it has to be based on the 2nd row width 
// the following three statements are required only for HSSF 
//  set a negative indent of a 1 inch. This means "Hanging" indentation:   Here goes first line of the text   |<---  indent -->|Here go other lines (second and subsequent) 
//  Ignore NPE 
// read and verify the string representation 
//  try to read the source file once again 
//  The Styles Table should have the themes associated with it too 
//  everything from '!' to '~' (includes letters, digits, punctuation 
//  Is it a date? 
//  clone so we can re-use aptg in calling method 
//  Give up and use the null logger 
/*  headerIdx = -1,  */
//  CustomViewSettingsRecordAggregate blocks 
//  Switch the arrays 
//  first short is already read as _nFibNew 
//  verify proper behaviour with empty byte array 
//  device. This value MUST be 0x0001. 
//  This is when we're in trailing zeros, and the format is '?'.   We still strip out remaining '#'s later 
//  build a range of the columns that are overwritten, i.e. the target-area, but without   columns that are moved along 
//  write the sepx to the document stream. starts with a 2 byte size 
//  for negative BigInteger, top byte is negative 
//  Create a footer with a Paragraph 
//  TODO - junit 
// optimization, as this may be expensive for lots of ranges 
/*  ********** START begin implementation of POIFSViewable **********  */
//  Save and re-load 
//  Placeholders can't be grouped 
//  update values 
//  tables.add(t); 
//  don't copy hlink properties 
//     private void resolveRangeOverlapTest(String a, String b, String...expectedOutput) {          CellRangeAddress rangeA = CellRangeAddress.valueOf(a);          CellRangeAddress rangeB = CellRangeAddress.valueOf(b);          CellRangeAddress[] result = CellRangeUtil.resolveRangeOverlap(rangeA, rangeB);          verifyExpectedResult(result, expectedOutput);      } 
/*  Now we know that we really have a property set. The next                         * step is to find out whether it is a summary information                         * or not.  */
//  Now we're able to do the length of the last edited user 
//  NOTE that for HSSF (.xls) negative shifts combined with positive ones do work as expected   
//   have zero size and no start block 
//  anchor of the body text is missing in the slide layout, llokup in the slide master 
//  The 32-bit signed integers that defines the corners of the bounding rectangle. 
//  "abc" & 2 + 3 & "def"   evaluates to "abc5def" 
// 		setters.add( setter ); 
//  You shouldn't save the the same file, do a close instead 
//  Cell show "2016年12月8日" 
//  C3 = =A1 
//  All Style records start as "builtin", but generally    only 20 and below really need to be 
//  Now try on footers 
//  verify that the null-value is actually set even if there was some value in the cell before 
//  Reset, check it goes back to where it was 
//  all these operations are on an area ref spanning rows 10 to 20 
//  Now write the entire document out, and read it back in... 
//  ignore font metrics differences on windows / linux (... hopefully ...) 
//  (Makes sure we don't accidently skip the end ones) 
//  This is a new string -- we didn't see it among the   strings we've already collected 
//  Check directly 
//  value MUST match the character set of that typeface. 
//  And how much we're using 
//  call table delete 
//  Ensure we actually found the parts we want to check 
//  see java.awt.Color#darken() 
//  Save for next time 
//  And evaluate the other way too 
//  Add a copy of this property 
//  use the fib to determine the name of the table stream. 
//  and then an ArrayList whose elements encapsulate the text 
//  first paint the shadow 
// the source sheet has one relationship and it is XSSFDrawing 
//  for now only encode characters below 32, we can add more here if needed 
//  Try to move one off a different row 
//  original image dimensions (for formats supported by BufferedImage) 
// This would imply that this break shall be treated as a simple line break, and break the line after that word: 
// stFile 
//  There are 10 SXVDEX records in the file (not uploaded) that originated bugzilla 46918   They all had the following hex encoding: 
//  arg1 is evaluated to boolean before arg0 is decoded 
// init exactDenom and maxDenom 
//  digest the message 
//  y (4 bytes): A 32-bit signed integer that defines the vertical (y) coordinate of the point. 
//  set row height; units = twentieth of a point, 360 = 0.25" 
//  TODO: set east asian font family - MS Office uses "MS Mincho" or "MS Gothic" as a fallback   see https://stackoverflow.com/questions/26063828 for good explanation about the font metrics   differences on different environments 
//  mask is 0x1800 
//  Tell them of the positions of the other records though 
//  Sanity check the size they've asked for 
//  If str looks like a cell reference, but is out of (row/col) range, it is a valid   named range name   This behaviour is a little weird.  For example, "IW123" is a valid named range name   because the column "IW" is beyond the maximum "IV".  Note - this behaviour is version 
//  Freeze just one row 
//  Set a cell value within the conditional formatting range whose rule would resolve to True. 
//  colour blue   character run is 25 long 
//  These are in MBD... under the root 
//  some emf comments are truncated, so we don't use readFully here 
//  SUM to a range of cells over 3 workbooks 
//  Save the attribute for it 
// step 2. Read array of CTSheet elements, wrap it in a LinkedList 
//  metafileHeader 
//  If the record is continuable, when the continue bit is set, this field will be present.   Continuing objects have multiple EMF+ records starting with EmfPlusContinuedObjectRecord.   Each EmfPlusContinuedObjectRecord will contain a TotalObjectSize. Once TotalObjectSize number   of bytes has been read, the next EMF+ record will not be treated as part of the continuing object. 
//  sprmCKcd 
//  Check the text 
//  Last is a mailto 
//  Sanity check names 
// CTHdrFtr ftr = buildHdrFtr(pStyle, pars);				// MB 24 May 2010   MB 24 May 2010 
//  DirectoryChunks have 0 byte contents 
//  When parsing a document, look to see if you know about that type    of the current record. If you know it's a type that has children,    process the record's data area looking for more records   If you know about the type and it doesn't have children, either do    something with the data (eg TextRun) or skip over it   If you don't know about the type, play safe and skip over it (using    its length to know where the next record will start)   
//  will never be used, since we will call method after formula evaluation 
// 6 starting bytes  +1 is for the zero byte 
//  int _multiple; 
// these are in the numbered ordered list  26 = OL 2  27 = OL 2.1  28 = OL 2.2  29 = OL 2.2.1 
//  else don't subvert original exception. just print stack trace for this one 
// the line below failed prior to fix of Bug #47889 
//  nasty math time 
/* CellFormat cellFormat = new CellFormat("_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"??_-;_-@_-");        CellFormatResult result = cellFormat.apply(cellValueO);        assertEquals("    1,234.56 ", result.text); */
//  But not a Workbook one 
//  java.lang.IllegalStateException: EOF - next record not available 
//  just try to trash the functionality with some byte-patterns 
//  Check for the chinese text in the mixed line 
//  if papersize, scale, resolution, copies, landscape 
//  Level 3 collapsed, others expanded  
//  all errors in the second arg translate to #VALUE! 
//  should have been prefixed with DrawingRecord (0x00EC), but bug 46280 seems to allow this 
//  allow to find out what the actual difference is in CI where this fails currently 
//  Finally footer(s), if present 
//  Copy the moved block to its new location 
//  ok we've read a EmfPlusInteger15 
//  154 == 0x009A; 158 == 0x009E 
//  short-circuit if it indicates elapsed time: [h], [m] or [s] 
//  Save it out 
//  An EmfPlusPointF object that is not currently used. It MUST be set to {0.0, 0.0}. 
//  use existing PersistDirectoryEntry, need to increase entry count 
//  sprmPBrcRight80 
//  empty string is not valid boolean   must be "TRUE" or "FALSE" 
//  Grab the bit to move  
//  Second level 
//  Move onto the next SBAT 
//  non-Javadoc: This abstract class exists to consolidate duplicated code between XSSFColumnShifter and HSSFColumnShifter   (currently methods sprinkled throughout HSSFSheet) 
//  For +ve numbers, should be Space + currency symbol + spaces + whole number with commas + space 
// Minimun version required to update the pivot cache 
/*      * this test simulates the generation of bugs 60320 sample file     * as the padding bytes of the EncryptedPackage stream are random or in POIs case PKCS5-padded     * one would need to mock those bytes to get the same hmacValues - see diff below     *     * this use-case is experimental - for the time being the setters of the encryption classes     * are spreaded between two packages and are protected - so you would need to violate     * the packages rules and provide a helper class in the *poifs.crypt package-namespace.     * the default way of defining the encryption settings is via the EncryptionInfo class      */
//  Give a general wrapped exception for the problem 
//  Set with the Charset itself 
// load the urls from the sheet .rels 
//  3D relative document link 
//  Look for certain entries in the stream, to figure it   out from 
//  otherwise you can end up modifying the built in style and effecting not only this cell but other cells. 
//  extract generated validation from sheet 
//  master has notes 
//  Delete the specified part 
//  verify proper behavior with negative offset 
//  Float 
//  Check a few other bits too 
//  If the first number in the whole format is the numerator, the   entire number should be printed as an improper fraction 
//  immutable - OK to return this 
//  Ensure that the changes were persisted 
//  create a sheet, set its title then delete it 
//  Start of file 
//  Create a map from this XWPF-level enum to the STBorder.Enum values 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getEmptyCellAllowed()      */
//  Our placeholder master text   This shouldn't show up in the output   String masterText =       "Click to edit Master title style\n" +       "Click to edit Master subtitle style\n" +       "\n\n\n\n\n\n" +       "Click to edit Master title style\n" +       "Click to edit Master text styles\n" +       "Second level\n" +       "Third level\n" +       "Fourth level\n" +       "Fifth level\n"; 
//  workbook with cells missing the R attribute 
//  must be 0 (reserved) 
// that should be read as a byte 
//  format flags 
//  Check it was allocated properly 
//  style record is the same between multiple getCellStyle() calls. 
//  skip ";@" duplets 
//  adding CHPX from fast-saved SPRMs 
//  2^8 - 1 
//  Case of a package previously open 
//  2 short fields 
//  So, start again 
//  ObjRecord will appear after serializetion 
//  Expected 
//  alpha (%) 
//  Nothing for us to do 
//  hint field for gui, can/should be set to zero 
// HSSF: 225 
//  records chars already deleted 
//  Try writing 3 full blocks worth 
//  OK - differs in the 31st char 
//  adjust for "There is no 4" 
// or new HSSFWorkbook(); 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#getOperator()	  */
//  replacement: 
//  An EmfPlusARGB object that specifies the edge color to use when the WrapMode value is WrapModeClamp. 
//  rotate the arc back to the original coordinate system 
//  Handle anything left over 
//  For 51875 
//  All others EAST_ASIAN 
// skips through the prms before we reach the piece table. These contain data  for actual fast saved files 
//  fill color was not found, check if it is defined in the theme 
//  val axis 2 (right) 
//  and then deleting the row that contains the cell. 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getErrorBoxText()	  */
//  Sanity check the property's type against the value's type 
//  for scientific/engineering notation 
//         optRecord.setEscherProperty(new EscherSimpleProperty(EscherProperties.LINESTYLE__LINEWIDTH, LINEWIDTH_DEFAULT)); 
// LbsDropData  flags  the number of lines to be displayed in the dropdown  the smallest width in pixels allowed for the dropdown window  num chars  compression flag  padding byte 
// sid+size+data 
// second sheet 
//  adjust insert pos to insert after 
//  Saving the part in the zip file 
//  Can work with POIFS 
/*      * Shifts rows between startRow and endRow n number of rows.     * If you use a negative number, it will shift rows up.     * Code ensures that rows don't wrap around<p>     *      * Additionally shifts merged regions that are completely defined in these     * rows (ie. merged 2 cells on a row to be shifted). All merged regions that are     * completely overlaid by shifting will be deleted.<p>     *      * TODO Might want to add bounds checking here     *     * @param startRow               the row to start shifting     * @param endRow                 the row to end shifting     * @param n                      the number of rows to shift     * @param copyRowHeight          whether to copy the row height during the shift     * @param resetOriginalRowHeight whether to set the original row's height to the default      */
/*      * MB 24 May 2010. Created this overloaded buildHdrFtr() method because testing demonstrated     * that the XWPFFooter or XWPFHeader object returned by calls to the createHeader(int, XWPFParagraph[])     * and createFooter(int, XWPFParagraph[]) methods or the getXXXXXHeader/Footer methods where     * headers or footers had been added to a document since it had been created/opened, returned     * an object that contained no XWPFParagraph objects even if the header/footer itself did contain     * text. The reason was that this line of code; CTHdrFtr ftr = CTHdrFtr.Factory.newInstance();     * created a brand new instance of the CTHDRFtr class which was then populated with data when     * it should have recovered the CTHdrFtr object encapsulated within the XWPFHeaderFooter object     * that had previoulsy been instantiated in the createHeader(int, XWPFParagraph[]) or     * createFooter(int, XWPFParagraph[]) methods.      */
//  Identify bug 46479c 
//  Test the last Row number it currently correct 
//  xfrm is not set, the query is delegated to the slide layout 
//  A 32-bit unsigned integer that specifies the value from the LineCap enumeration on which 
//  special case 
/*  ********** START implementation of POIFSWriterListener **********  */
//  Note - only BlankEval counts 
//  This value MUST be the one's-complement of the result of applying an XOR operation to all WORDs in the EMF stream. 
// Copy the rest of "in" to "out". 
//  Attribute MAPI 
//  need to parse AlternateContent again,   otherwise the child elements aren't typed,   but also XmlAnyTypes 
//  278:CRITBINOM 
//  Find the SST record 
//  if both parameters are invalid, remove the extension mask 
// The leftmost bit is 1 -- this is negative number  Inverse bits [1-9] 
//  Always matches (inconsistent with above two cases).   for example '<>123' matches '123', '4', 'abc', etc 
//  Make redundant update, and check re-evaluation 
// the second sheet doesn't have overridden column widths 
//     assertEquals(632, decomp.length); 
//  unused   '? = multiple values 
//  Check it worked 
//  A 32-bit unsigned integer that specifies the index of the first entry to set. 
//  MissingArg -> BlankEval -> empty string (in concatenation) 
//  Check some of the content 
//  everything else is a path 
//  Sanity Checking - including whole header, so treat 
//  colour red 
//  link type   reference type   options 
// define named ranges for the inputs and formulas 
//  out of paragraphs 
//         	os.close();          } 
//  normally MSODRAWING(0x00EC) would come here before SXVIEW 
//  Grab the text 
//  Create the POIFS document 
//  +1 to convert to 1-based 
//  Document to itself is the same place (empty URI) 
//  String  wb = new SXSSFWorkbook(new XSSFWorkbook(file.getPath()));  assertCloseDoesNotModifyFile(filename, wb); 
//  If there is no custom palette, then this creates a new one that is   a copy of the default 
// sheet.createDrawingPatriarch() should return the same instance of XSSFDrawing 
//  Bytes -> Bytes 
//  Style the table 
// this was chosen to match the earlier limitation of max denom power  it can be expanded to get closer to Excel's calculations  with custom formats # #/#########  but as of this writing, the numerators and denominators  with formats of that nature on very small values were quite 
// p._baseStyle = _baseStyle; 
//  2 chart sheet -> data on 1st, chart on 2nd+3rd 
//  convert word 97 colour numbers to 0xBBRRGGRR value 
//  Re-read the String if we're a 7 bit one 
//  process documents 
//  3 columns   2 rows 
/*  Create a new POI filesystem containing the origin file's         * property set streams:  */
// Relative path notation - for EXCEL.exe - fallback 
//  Add another formula referencing these workbooks 
//  A 32-bit floating-point value that specifies the amount by which to scale an EmfPlusCustomLineCap 
//  width from millimetres into Excel's column width units. 
//  sprmPFSideBySide  
//  Externally defined named ranges or macro functions 
//  assumption: the render type is exclusive 
// re-create the sheets 
//  BATs 
//  write, read back and check that our text box is there 
//  Expected values 
/* 		 * parameter = attribute "=" value		 *		 * attribute = token		 *		 * value = token | quoted-string		  */
// cached dgg 
// langId 
//  sheet2 A1 
//  And how many bits we've already set 
//  default charset 
//  Recursive call. 
//  Set the name for the named range for worksheet 'sheet2' 
//  runs found in PPDrawing are not linked with SlideListWithTexts 
//  write the file 
// double marginHeader = defaultMargins[4];  double marginFooter = defaultMargins[5]; 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#setShowPromptBox(boolean)	  */
//  474 == 0x01DA; 478 == 0x01DE 
//  0 length header 
//  continue without log, this is expected in some setups   NOSONAR - also catch things like NoClassDefError here   throttle the log somewhat as it can spam the log otherwise 
//  index to ref entry in extern sheet   index to first row 
// silently return if ImageIO failed to read the image 
//  OR XSSFWorkbook 
/*  not used  */
//  Add three new ones 
//  remove row from _rows 
//  get inside horizontal border components 
//  Output the old rawCode 
//  as the code-under-test and the testcase code are written the same way (have the same bugs).  
//  Re-open, and check 
//  Strip header 
//  Check text and stylings 
//  Technically a sheet doesn't need the same number as    it's comments, and clearly someone has already pinched    our number! Go for the next available one instead 
//  If there are not three consecutive PT_BEZIERTO points, an error results. 
/*              * we have more property types that can be converted into Java             * objects, but current API need to be preserved, and it returns             * other types as byte arrays. In future major versions it shall be             * changed -- sergey              */
//  Figure out what sort of Stream to create, create and return it 
//  too many arguments 
/*  Class ID       */
//  unsupported crypto api header  
//  Fetch fresh copies to test with 
//  ensure that file handles are closed (use revert() to not re-write the file) 
//  Check - will have un-used sectors now 
// lazy-compute hashCode 
//  Otherwise, check the type to see if it's text 
//  The 7th field is day of week, which we don't require 
//  Even page header is optional, only return 
//  allow for format string variations 
//  also trivial, but not as obvious ... left shift the   bits high and use that clever static method in Double   to convert the resulting bit image to a double 
//  format   index 
// flip vertical 
//  A 16-bit unsigned integer that defines the fill operation to be performed. This   member MUST be one of the values in the FloodFill Enumeration table: 
//  XSSF eventmodel (SAX) or the memory-heavy XSSF usermodel (DOM).  
//  Create a relationship ID for this link.  
//     Cipher cipher = null; 
//  Now create the POIFS Version 
//  of the ole object multiple times 
//  initially empty 
// Confirm that the sring will be compressed 
//  in order to transform a bar chart into a column chart, you just need to change the bar direction 
//  array formula), set value to 0 
//  4 bytes (recordSize) + 2 bytes (recordFunction) 
// finally set column widths, the width is measured in units of 1/256th of a character width 
//  Grab the table stream. 
//  Error handling for lookup_range arg is also unusual 
//  Step through the rows in the sheet and accumulate a total of their 
//   knows what else... 
//  textMark: PRODNAME!C2 
//  6 bytes unused 
// MUST be 0x1 
/*  Processing entries of the zip file  */
//  "standard" cases 
//  we sometimes have wrong extensions, so for some exceptions we try to handle it   with the correct FileHandler instead 
//  in the source bitmap header. This value MUST be in the DIBColors enumeration 
// highest allowed rows and column (XFD and 0x100000) 
//  B1:B3 will be removed 
/* 	   The following is a dump of the OBJ record corresponding to an auto-filter	   drop-down list. The 3rd subrecord beginning at offset 0x002e (type=0x0013)	   does not conform to the documentation, because the length field is 0x1fee,	   which is longer than the entire OBJ record.	   00000000 15 00 12 00 14 00 01 00 01 21 00 00 00 00 3C 13 .........!....<.  Type=0x15 Len=0x0012 ftCmo	   00000010 F4 03 00 00 00 00	                              0C 00 14 00 00 00 00 00 00 00 ................  Type=0x0c Len=0x0014 ftSbs	   00000020 00 00 00 00 01 00 08 00 00 00 10 00 00 00	                                                      13 00 ................  Type=0x13 Len=0x1FEE ftLbsData	   00000030 EE 1F 00 00 08 00 08 00 01 03 00 00 0A 00 14 00 ................	   00000040 6C 00	                  00 00 00 00                               l.....            Type=0x00 Len=0x0000 ftEnd	 */
// Deserialize the record. 
//  font belongs to different workbook 
//  shape. 
/*  int streamDescriptorArraySize = (int)  */
//  Thresholds should be Min / (evenly spaced) / Max 
//  Update pointers 
//  Empty properties 
//  if you ever want to change the underlying data 
//  concrete implementations can make sense of this hint, 
//  Check case where bottom is greater than top 
//  Is 2006-01-24 (2nd day of week) 10:26:15.205 
//  else Number 
//  A 32-bit unsigned integer that specifies the units used for the EmSize field. These are typically the 
// 16-byte link moniker: HyperlinkRecord.URL_MONIKER 
//  sid=0x0009 
//  reserved3 - An optional unsigned integer that MUST be zero, and MUST be ignored. It   MUST exist if and only if fPp10ext is TRUE. 
//  Get the offset to the persist pointers   This will be the byte offset on disk where the preceding 
//  Output the worksheet name   Works by ordering the BSRs by the location of    their BOFRecords, and then knowing that we 
/*  Write 8 bytes.  */
/*  Write it to a POIFS and the latter to disk:  */
//  Add a border should create a new style 
//  Now add a 2nd, and check again 
//  It's not a double. 
//  this is id of the element which is 1-based: <row r="1" ... > 
//  Add to the lists 
//  Grab the versions 
//   to \r(00)\n(00)(00)(00) 
//  examples from https://support.office.com/en-us/article/DAYS360-function-B9A509FD-49EF-407E-94DF-0CBDA5718C2A 
//  this is the main point of bug 47198 
//  We're now able to load steams 
//  Need to add a new one 
//  Now load the rest of the properties, which need to be adjusted 
//  all other centuries are *not* leap years 
//  (2) Determine the result's sign. 
/* 		 * this class is currently only used here, but could be moved to a		 * common package if needed		  */
//  generated name 
//  apply borders to sheet 
//  Accounting -> 0 decimal places, UK currency symbol 
//  Add another one 
//  Grab the colour 
//  B is at 0x0A, 0x0E 
//  Page 51 of public specification begins 
//  Invalid type -> exception 
// according to the spec, a ruby object  has the phonetic (rt) first, then the actual text (base)  second. 
//  alignment 
//  XSSF only. HSSF version wouldn't be so simple. And also this test is contained in following, more complex tests, so it's not really important. 
//  a failed invocation of Row.removeCell leaves the row 
//  line is not drawn 
//  might need to keep track of where exactly these belong 
//  scratchpad was not on the path, ignore and continue 
// Test high row bound exception 
//  Find the end of the SBAT stream, and add the sbat in there 
//  $A:$A 
//  Not found in this lot 
//  If they type (including the bonus 0xF018) is 0, skip it 
// log values to ensure these values are accessible to subclasses 
//  create our event factory 
//  Physical justification of the paragraph 
//  Now turn if back off again 
// The maximum column width for an individual cell is 255 characters 
// Use third column (month) as columns (side by side) 
//  ToDo - test exceptions are as expected 
//  Make sure we just do the best we can 
//  They should all have a 3512 byte metafile rendered version 
//  First, check overall 
/*  >>  0 */
//  avoid O(N^2) performance scanning through all regions for each row 
//  Strip out the semicolon if it's there 
//  For position dependent records, hold where they were and now are   As we go along, update, and hand over, to any Position Dependent 
//  Get a cell, create as needed 
//  Throws exception because we cannot read here 
//  name length, unicode flag   Arial, as unicode 
//  Grab text from slide's PPDrawing 
// EscherDgContainer and EscherSpgrContainer length exceeds the actual length of the data 
//  Open our file without core properties 
//  So if asked, just output uncompressed 
/*  remove packagepart relationship  */
//  Simply chain the call to the overloaded convertExcelToCSV(String,   String, String, int) method and ensure that certain embedded   characters are escaped in accordance with Excel's formatting   conventions 
//   look out for the title records 
//  Add one more, and re-check 
//  252: FEQUENCY 
//  161 -> 166 is the next 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#getFormula1()	  */
// short externSheetIndex = getWorkbook().checkExternSheet(sheetIndex);  name.setExternSheetNumber(externSheetIndex); 
// freeze the first row 
/*      * instances evaluate the values for a region and return the positive matches for the function type.     * TODO: when we get to use Java 8, this is obviously a Lambda Function.      */
// this works recursively to pull embedded tables from within cells 
//  (They're a different CTPicture, under the drawingml namespace) 
//  (2) Verify that the fixed property comparator works right 
//   the Chinese one the same as the English one 
//  BrushDataFlags field of the EmfPlusPathGradientBrushData object. 
//  JUnit asserts 
// UNC path notation 
//  Firstly, claculate how much of the image should overlap into 
//  skip over new line breaks (we paint 'clear' text runs not starting or ending with \n) 
//  style cell as desired 
//  FIXME: this method would be more useful if it could convert any Color to an XSSFColor   Currently the only benefit of this method is to throw an IllegalArgumentException   instead of a ClassCastException. 
//  Named ranges, macro functions 
//  Test the index   Again, the formula string will be right but 
/*  Override content type  */
//  If we got a duplicate which is used, mark the one we're keeping as used 
//  BitmapInfoHeader   A 32-bit signed integer that defines the width of the DIB, in pixels.   This value MUST be positive.   This field SHOULD specify the width of the decompressed image file, 
//  Add comments 
//  Lots of IF cases 
//  in this case, excel ignores the column move 
//  Check the order 
// "test\n" appears twice: once as the "title" and once in the text. 
//  JDK 8 seems to add an empty locale-string to the list returned via DateFormat.getAvailableLocales()   therefore we now cater for this special locale as well 
//  add reference to OLE part 
//  setting dash width to null unsets the Dash element 
//  Add core properties to part list ... 
//  First 4 bytes from the outputstream 
/*  End check OPC compliance  */
// inch 
//  Add Divide Formula 
//  by default table cell has no borders 
//  no fill   font size is 40pt and scale factor is 90% 
//  It's a string. 
//  skip 2 byte to ensure 32-bit alignment of this structure. 
//  All other ControlPtgs and ScalarConstantPtgs cannot be used with ':' 
//  currently not evaluating anything. 
//  empty on purpose 
//  An int one 
//  end public class BitField 
//  from row 3    to row 8 
//  Build up all the style objects 
//  one way (of many) to cause the discrepancy is with a badly behaved record: 
//  update charts 
//  range formula expressions can't start with quotes (I think - anyone have a creative counter example?) 
//  Ensure it really is a notes record 
//  0.1"   0.1"   0.05"   0.05" 
//  not a valid string value, and not a blank cell (that's checked earlier) 
//  formula1 and value1 are mutually exclusive 
//  not the first formula cell in the group 
//  Create lots of fonts 
//  SignedProperties 
//  call to handle correct/incorrect values 
//  Add some rows and columns 
//  explicitly initialize drawing and shapes from _spTree 
//  there are some predefined styles 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#createErrorBox(java.lang.String, java.lang.String)      */
/*  Default content type  */
//  Cases that were very slow 
//  Verify sheet 1 
//  seems to be a valid document 
//  basic response generation 
//  when shifted by less than -1 negative amount (try -2) 
//  try shape properties in slide 
//  ignore some file-types that we do not want to handle here 
//  2) attempt to create a new row IN PLACE of a removed row by a negative shift causes corrupted   xlsx file with  unreadable data in the negative shifted row.  
/*  ********** START implementation of POIFSReaderListener **********  */
//  A SlideShow with one slide 
//  TODO - whole row refs 
//  The argument in Excel is false when it *should* pass through the origin. 
//  make something like <Relationships 
/*  A 32-bit unsigned integer that specifies the index of the logical palette object             * in the EMF Object Table. This index MUST be saved so that this object can be             * reused or modified.              */
/*  OS version     */
//  match up variable-length properties and their chunks 
//  97 -> 98 -> END 
//  Unix 
//     protected int getKeySizeInBytes() {          return getEncryptionInfo().getHeader().getKeySize() / 8;      } 
//  B3 is in the middle of the dependency tree 
/*  check if releasing this elements glues two segments into one  */
//  Check that the last paragraph ends where it should do 
//  Grab the data from the workbook stream, however 
//  this is a naive way of handling the left, center, and right   header and footer delimiters, but it seems to be as good as   the method used by XSSFExcelExtractor 
//  no 75 ?! 
// length is stored at the index section in the table  and it is recorded in the first short. 
//  Spaces are skipped 
//  Process the last contents as required. 
//  YK: the line below used to assert empty string which is wrong   if source and target are the same they should be relaitivized as the last segment, 
//  Note - multiple failures are aggregated before ending. 
//  hidden bit only is altered for this outline level.  ie.  don't un-collapse contained groups 
//  the first line is at least two times higher than the second 
/*          * initialize map.  Every built-in has this format:         * <styleName>         *   <dxfs>         *     <dxf>...</dxf>         *     ...         *   </dxfs>         *   <tableStyles count="1">         *     <tableStyle>...</tableStyle>         *   </tableStyles>         * </styleName>          */
//  Not set in the file 
//  Extended properties 
//  Load the main stream and FIB 
//  Verify sheet 3 
//  A 32-bit signed integer that specifies the number of points in the BoundaryPointData field. 
//  unknown 1022 
/*             The "m" or "mm" code must appear immediately after the "h" or"hh"            code or immediately before the "ss" code; otherwise, Microsoft            Excel displays the month instead of minutes."           */
//  intervening spaces between '$', '-', '+' are OK 
//  The value MUST be in the Letterform enumeration table. 
//  this needs patch #49658 to be applied to actually work  
//  Verify sheet 2 
//  if 'M' precedes 's' it should be minutes ('m') 
//  address: "http://www.regnow.com/softsell/nph-softsell.cgi?currency=USD&item=7924-37" 
//  Hook up the workbook evaluators to enable evaluation of formulas across books 
//  DataValidityTable, ConditionalFormattingTable,   even PageSettingsBlock (which doesn't normally appear after 'View Settings') 
//  set up (and check) first level   points to cellB 
//  indent for the level 
//  one of the other args was not an AreaRef 
// //// Evaluate "Table1[@]" (equivalent to "Table1[#This Row]") //////// 
//  Note - asymmetric with UnaryMinus   -"hello" evaluates to #VALUE!   but +"hello" evaluates to "hello" 
//  shouldn't change anything at all 
//  sheet1!A4+sheet1!C2+A2 
//  A 32-bit signed integer that specifies the logical width of the destination rectangle. 
//  should never come here 
// Creates default settings for the pivot table 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#getFormula1()	  */
//  Open directly 
//  If there's a jump in rows, fire off missing row records 
//  Default name free 
//          System.err.println(i + "\t" + comp[i] + "\t" + testTrailerComp[i]);        } 
//  Copy formula verbatim (no shifting). This is okay because copyCellFrom is Internal.   Users should use higher-level copying functions to row- or column-shift formulas. 
/*                 final File fileIn = HSSFTestDataSamples.getSampleFile(testFile);                final File reSavedFile = new File(fileIn.getParentFile(), fileIn.getName().replace(".xls", "-saved.xls"));                FileOutputStream fos = new FileOutputStream(reSavedFile);                wb2.write(fos);                fos.close();                 */
//  Check the various macro related bits can be found 
//  no embedded blip 
//  a test case that returns ErrorEval.VALUE_INVALID :   the dimensions of the first and second criteria ranges are different 
//  A 32-bit unsigned integer that specifies the 32-bit-aligned size of the entire 
//  protected field on XSSFShape 
//   between class loading and first use 
//  TODO - make POI use isVolatile 
/*  * Tests INDIRECT() as loaded from a test data spreadsheet.<p> * * Tests for bug fixes and specific/tricky behaviour can be found in the corresponding test class * (<tt>TestXxxx</tt>) of the target (<tt>Xxxx</tt>) implementor, where execution can be observed *  more easily.  */
//   			ERFListener erfListener = null; // new MyERFListener();  			EventRecordFactory erf = new EventRecordFactory(erfListener, null); 
//  calculate total size of the header and first encoded char   ushort len, byte optionFlags, at least one character byte 
//  check for DocumentEncryptionAtom, which would be at the last offset   need to ignore already set UserEdit and PersistAtoms 
//  For some reason "am/pm" becomes AM or PM, but "a/p" becomes a or p 
//  BitmapCoreHeader 
//  Set some more, save + reload 
//  JAXB: 
//  Return how many bytes were used 
//  encryptionInfo is set from outside 
//  start reading 
// Get index of the named range with the name = "NamedRangeName" , which was defined in input.xls as A1:D10 
//  the image out across one or more columns. 
//  Publisher 
// column width is set in units of 1/256th of a character width 
//  for the lower level list items. 
//  row inp row 4   col inp row 1 
/*  Yes: return the corresponding DirectoryEntry.  */
//  initially it is good 
//  DecimalFormat.DOUBLE_FRACTION_DIGITS, which is default scoped 
//  if bullet color is undefined, return color of first run 
//  can bins be not sorted?  bins = Arrays.stream(bins).sorted().distinct().toArray(); 
//  remember the initial transform and restore it after we are done with drawing 
// default resolution is 72 dpi 
//  Try to turn a into b 
//  New thumbnail 
//  whole document, including additional text from shape 
//  Save an re-load, check it appears 
//  Invert first/last column, but refer to same area 
//  strict OOXML 
//  Only update the style bytes, if the styles have been potentially   changed 
//  Actual embedded objects. 
//  was empty, just fill it 
//  Won't contain custom 
//  first 11 bytes compressed = 12 bytes uncompressed 
// next 16 bytes is a ptg aray 
//  Already linked! 
//  sprmPNest is only stored in grpprls linked to a piece table. 
/*          * Even if top and bottom margins are set to 0 PowerPoint         * always sets extra space between the text and its bounding box.         *         * The approximation height = ascent*2 works good enough in most cases          */
//  Ran out of data 
//  just expand the inner group 
//  Add a few edge colours in 
//  see HwmfFont#height for details 
// verify existing hyperlink in A3 
//  Now get formulas not their values 
//  Pass along the record(s) 
//  Check slide 2 is as expected 
//  no changes on row "1" 
//  Note - Unlike with numbers, it seems that COUNTIF never matches 
//  for far east languages supported only for format always 0 for US 
//  String criteria in COUNTIF are case insensitive: 
//  Name lookup requires some equivalent object of the Workbook within xSSFWorkbook. 
//  [MS-DOC], v20140721, 2.6.4, sprmSNFtn 
//  We have rows 0, 1, 2, 20 and 21   Row 0 has 1 entry, 0   Row 1 has 4 entries, 0+3   Row 2 has 6 entries, 0+5   Row 20 has 5 entries, 0-5   Row 21 has 7 entries, 0+1+3+5+6   Row 22 has 12 entries, 0+3+4+11 
//  it seems like interface 'ArrayEval' does not even exist yet 
//  the BOFRecord can represent either the beginning of a sheet or the workbook 
//  Re-check the comment 
//  item 
//  if the presentation doesn't contain pictures - will use a null set instead 
//  Pass on 
//  Just check we can write them back out into a filesystem 
/*      * Sets the CellStyle that applies to the given     *  (0 based) column.      */
//  this is true only if all values in set were valid sheet indexes (between 0 and nSheets-1, inclusive) 
//  dry-run in a 1x1 image and return the vertical advance 
//  option bitfields 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#setSuppressDropDownArrow(boolean)	  */
/*          * dop (document properties record) Written immediately after the end of         * the previously recorded structure. This is recorded in all Word         * documents         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 23 of 210          */
//   1st block is at 0 
//  check that setting RR&C on a second sheet causes a new Print_Titles built-in 
//  Text paragraphs 
/*      * Indicates that the formula evaluates to an error. The value of E is the     * current value (an error message string); the value of the V attribute is     * the last valid value.      */
// The low-order 15 bits contain the row height.  The 0x8000 bit indicates that the row is standard height (optional) 
//   form must actually be an absolute URI 
//  thousands separators not allowed after '.' or 'E' 
//  01 00 00 00 
//  special long hyphen 
//  Base part 
// header 
//  other tests 
//  throw IllegalStateException if the argument CellRangeAddress intersects with 
//  <-- end option flags 
//  Alignment 20   Ident 0 
//  XSLFSlide#createSlide() with no arguments creates a blank slide 
// Style configurations 
//  whitespace around this gets trimmed OK 
//  Make URI 
//  If it starts with [DBNum1] or [DBNum2] or [DBNum3] 
//  Check we can evaluate it correctly 
//  no matches 
//  VBA project directory, process 
//  chart.setTitleOverlay(overlay); 
//  write out the StyleSheet. 
//  Rename the other name to "name" and check everything again 
// the OLE2 Class Name of the object 
//  toString must be reliable 
//  Save and manually verify that on column C we have 0, value in template 
//  Try to open it and read the contents 
//  Change the date 
//  If we didn't, then the file is probably corrupt 
//  Set the mask bit for us 
//  major increment   minor increment 
//  bit 2 reserved 
//  1 header row + 1 data row  
//   the 29th of Feb 1900 
//  A 32-bit unsigned integer that specifies the type of data in the RegionNodeData field.   This value MUST be defined in the RegionNodeDataType enumeration 
//  Prints out the records in the tree 
// in a new record all the bits are 0 
//  on some environments in CI we see strange failures, let's verify that the size is exactly right   this can be removed again after the problem is identified 
//  expand columns - 1 
//  entirely inside, matches no boundaries 
//  =myFunc2("_") 
//  Overwrite 
//  data taken from bugzilla 47384 att 23830 at offset 0x13A0 
//  get the listeners interested in that document 
//  row is moved up by the shifting 
//  keystore files 
//  Strip the sheet name, 
//  YK: preserve StorageClsid, it is important for embedded workbooks, 
//  If we've moved onto a new row, the ensure we re-set 
//  destination columns enclose the area (possibly exactly) 
//  Delete the specified part from the package. 
// TODO finish me 
//  Latest version 
//  Has three slides 
//  category space   format flags 
//  Convert the String into column and row indices then chain the   call to the overridden addImageToSheet() method. 
//  A signed integer that defines the horizontal extent of the viewport in device units. 
//  up to JDK 10 we did use Mockito here, but OutputStream is   an abstract class and fails mocking with some changes in JDK 11   so we use a simple empty output stream implementation instead 
//  Distinguish between string and number. 
//  get the last cell 
/*          * we don't support 2003 Word extensions in STSHI (but may be we should         * at least not delete them, shouldn't we?), so our structure is always         * 18 bytes in length -- sergey          */
//  POIFS properties corrupted   No actual contents   contains xml-entity-expansion   contains xml-entity-expansion   contains shared-string-entity-expansion 
//  Condition 2: Cell Value Is  less than      50   (Green Fill) 
//   if it's set 
//  Header(s), if present 
//  context color overrides the theme 
//  3 uncompressed unicode chars   Continue sid   rec size 16 (1+15)   next chunk is compressed   15 chars 
//  Now try to set them to the same values, and ensure that 
//  POI internal error codes 
//  554 == 0x022A; 558 == 0x022E -- long 
//  row is part of the shifted block 
//  Blank line before next entry 
/*  ********************* real code follows ***************************  */
// adding a duplicate 
//  Create a row and put some cells in it. Rows are 0 based. 
//  complex rules to choose lookupVector and resultVector from the single area ref 
//  Without short-circuit-if evaluation, evaluating cell 'A1' takes 3 extra evaluations (for D1,E1,F1) 
//  for cell 
//  If not, ask the OLE2 code to check, with Scratchpad if possible 
//  Use all three of the four in cell styles 
// the 10th cell contains sum over week days, e.g. SUM(C3:I3) 
//  Check it's as expected 
//  A tAttrSkip 
//  width of '0' is less then width of '10'   10 and '10' should be sized equally   formula result is unknown, the width is calculated  for '0'   10.0000 and '10.0000' 
//  Shift 1 to end 
//  get fcMin and fcMac because we will be writing the actual text with the   complex table. 
/*  Write the property set stream to the POIFS.  */
//  306: CHITEST   307: CORREL   308: COVAR   309: FORECAST 
/*  Create a buffer for the decompressed files  */
//  need to set the anchor before height calculation 
//  only remove it if the current row is not part of the data that is copied 
// should only be 1 
//  A 32-bit unsigned integer that MUST be set to the value 0x08007664. 
/*  Excel V14 / 2010 - workbook  */
//  while matching, this is where the bytes go. 
//  E8 03 08 08 0C 20 03 00 00 00 00 88 16 00 00 00 ..... .......... 
//  Short circuit for the null logger, which 
// Parse 
//  runs.add(run); 
//  Quick doesn't have them 
//  If we haven't found out what logger to use yet,    then do so now   Don't look it up until we're first asked, so    that our users can set the system property 
/*  int dataCRC =  */
//  Set the name for the named range for worksheet 'sheet1' 
//  TODO ... 
//  Ignore the ones we know to be rubbish 
//  may as well write original data back so as to minimise differences from original 
//  Read 
//  range will be C1:E1 
/*  fixed the problem as well              * comment.setColumn(cell.getColumnIndex());             * comment.setRow(cell.getRowIndex());              */
//  TODO Update ext_formatting_length 
//  Process the named ranges 
//  Add a text cell 
//  86: TYPE 
//  Do nothing 
//  Check children 
//  The code below would encode tFuncVar(SUM) which seems to do no harm 
//  verify there was an exception while closing the file 
/*      * Test apply(Object value) with a String as parameter      */
//  The value MUST be in the StrokeVariation enumeration table. 
// END OF COPIED CODE 
//  Calculate decimal number 
//   which is more what you'd expect 
//  A 32-bit unsigned integer that specifies the value in the LineCap enumeration that indicates the line 
//  password protected files without known password 
//  'true' is wider than '0'   columns 1, 2 and 3 should have the same width   columns 1, 2 and 3 should have the same width 
//  the source rectangle 
//  backcolor 
//  A 16-bit signed integer that defines the y-coordinate, in logical units, of the 
//  Set the size on the root in terms of the number of SBAT blocks   RootProperty.setSize does the sbat -> bytes conversion for us 
/* box10x10    */
//  don't know how to check correct result .. for the moment, we just verify that the file can be read. 
//  start all threads 
//  If sheet needs to be saved, use a java.lang.ref.WeakReference to avoid garbage collector gridlock. 
// create a blank type cell (no value) 
//  Now try again, to get the real small block 
//  Should only have SlideAtomSets if the second one 
/*          * sttbSavedBy (last saved by string table) Written immediately after         * the previously recorded table.         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 27 of 210          */
//  confirm formula parsing doesn't care about argument count or type 
// nominally 78 
//  PropertyTable 
//  enforced by the 8224 byte limit 
//           byte[] oldTabArray = oldPAP.getRgdxaTab();            byte[] newTabArray = newPAP.getRgdxaTab();            byte[] newTabDescriptors = newPAP.getRgtbd();            byte[] varParam = new byte[2 + oldTabArray.length + newTabArray.length +                                       newTabDescriptors.length];            varParam[0] = (byte)(oldTabArray.length/2);            int offset = 1;            System.arraycopy(oldTabArray, 0, varParam, offset, oldTabArray.length);            offset += oldTabArray.length;            varParam[offset] = (byte)(newTabArray.length/2);            offset += 1;            System.arraycopy(newTabArray, 0, varParam, offset, newTabArray.length);            offset += newTabArray.length;            System.arraycopy(newTabDescriptors, 0, varParam, offset, newTabDescriptors.length);              size += SprmUtils.addSprm((short)0xC60D, 0, varParam, sprmList); 
//  A 32-bit unsigned integer that specifies the size, in bytes, of the source bitmap bits. 
//  There might be 2 more bytes, which are a reserved field 
//  ecb - only for standard encryption 
//  test invalid indexes OOBE 
//  check ratio out of bounds 
//  results. 
//  less than three arguments 
//  Shift 1 back 
//  Process it as a name 
//  each row-block has a DBCELL record.   The offset of each DBCELL record needs to be updated in the INDEX record 
//  sheet2 B1 
//  Get the PPT version 
//  RETURN Verifier BITWISE XOR 0xCE4B 
//  Construct double from ValueEval. 
//  4 @ 152   *mask bit*   18 @ 122 
// //////////////// Excel 
//  NaNs   Currently these test cases are not critical, since other limitations prevent any variety in 
//  weight   format 
//  Sheet 1 has a header with center and right text 
//  Style 
//  now insert (or append) newStr 
//  IDs 
//  Failing because by default there are no colours left in the palette. 
//  Save in a predictable encoding, not raw bytes 
//  Delete overwritten hyperlinks 
/*              * If a master has one top-level shape, a shape that inherits from             * that master inherits the descendant elements of that master             * shape. If a master has more than one master shape, a shape that             * inherits from that master inherits those master shapes as             * subshapes.              */
//  size equals _baseLength bytes for known variables plus 2 bytes for name   length plus name length * 2 plus 2 bytes for null plus upx's preceded by 
//  override some tests which do not work for SXSSF 
//  A y-coordinate of a point on the infinite line; paired with x-coordinate 
//  some other unexpected error 
//  Ask to have the values looked up 
/* int length =  */
// remove the rows part 
//  integer portion uses all 11 digits   half-up here too 
//  Check the contents of the 1st block 
//  test finding the right comment for a cell 
//  setting a null password shouldn't introduce the protection element 
// print areas are one based 
//  Cell objects created before a row shift are still valid.   The row number of those cell references will be shifted if   the cell is within the shift range. 
//  [MS-OGRAPH].pdf says that the data of this record is an OfficeArtFDGSL structure   as described in[MS-ODRAW].pdf sec 2.2.33 
// per-slide headers / footers 
//  The actual dimensions don't matter as much as having XSSF and SXSSF produce the same size drawings 
//   header in the size 
//  Fix the line endings 
//  Fetch / Add the TextProp 
//  rounds last digit 
//  Check the SLWTs contain what we'd expect 
/*  Retrieve the section containing the properties to modify. A             * summary information property set contains exactly one section.  */
//  When the two-arg version of INDEX() has been invoked and the reference 
//  the world-space to page-space transform in the playback device context. 
//  end public class POIFSViewEngine 
// get default cellStyles 
//  application/vnd.ms-powerpoint.slideshow.macroenabled.12 
//  built-ins doc uses 1-based dxf indexing, Excel uses 0 based.   add a dummy node to adjust properly. 
//   we need to move further inside the block) 
//  c5 should be null 
//  now wPos >= w, so end column = c, now figure offset 
//  402 == 0x0192; 406 == 0x0196 
//  [len=23]   [C1]   [C1]   [0]   [B1]   [OFFSET nArgs=3]     [sum ] 
//  if a cell is not blank then convert the old value to string 
//  Contains two forms, one with a range and one a list 
// if no exceptions where raised, the document is valid 
/*          * Read the sections, which are following the header. They         * start with an array of section descriptions. Each one         * consists of a format ID telling what the section contains         * and an offset telling how many bytes from the start of the         * stream the section begins.         *          * Most property sets have only one section. The Document         * Summary Information stream has 2. Everything else is a rare         * exception and is no longer fostered by Microsoft.          */
//  could this have trouble with double precision/rounding errors and date/time values?   do we need to allow a "close enough" double fractional range?   I see 17 digits after the decimal separator in XSSF files, and for time values,   there are sometimes discrepancies in the final decimal place.     I don't have a validation test case yet though. - GW 
//  Should get much bigger now 
//  Where are things? 
//  some other sanity checks 
//   a few sample ones 
//  result should be an area eval "B10:B10" 
//  Excel/MATCH() seems to have slightly abnormal handling of errors with   the last parameter.  Errors do not propagate up.  Every error gets   translated into #REF! 
//  Try to open the workbook 
// _x000D_ is converted into carriage return 
//  The mini block block counts now run to 191 
//  This document also has 22 styles 
//  New files start with 4 built in fonts, and 21 built in styles 
//  font files need to be downloaded first via   ant test-scratchpad-download-resources 
//  add reference to image part 
//  we know the offset already, so decompress immediately on-the-fly 
//  different default style indexes for HSSF and XSSF/SXSSF 
// &N == page numbers 
//  Even with invalid fonts we still get back useful data most of the time...  
//  cached for performance, to avoid reading the XMLBean every time a conditionally formatted cell is rendered 
// of support for device-independent bitmaps (DIBs) 
//  Apply a font 
//  line color 
// paragraph styles 
//  Check drawing height 
//  Serialize a block of cells for those rows 
//  Retrieves core properties part 
//   styles aren't actually being used (don't touch built-in ones) 
//  Remove the character we're supposed    to match the space of / pad to the    column width with 
//  First up, get the number of attributes 
// queue the first non-header record 
//  one extra byte for first char 
//  Figure out the type 
//  Reload 
// AbsFirstColumn AbsLastColumn references should't change when copied to a different column 
//  Formula 
//  it's always the first element in the List 
//  Compare in detail to b 
//  by default even when we support it we won't   want it to be protected 
// refer to different objects 
//  drop down 
//  The order of slides is defined by the order of slide atom sets in the 
/*  copy data, to avoid instance-equality  */
//  read-only mode works! 
//  Shift the first row to the end 
//  next cell found 
//  top of area is preserved (will remain exact same column)   the bottom area column is moved simply 
//  l1 = LittleEndian.getInt(src, o1); o1 += LittleEndian.INT_SIZE;   }   final byte[] v = new byte[l1];   System.arraycopy(src, o1, v, 0, v.length);   value = v;   break; 
//  next 2 are special cases of OperationPtg 
//  Do we have a notes for this? 
//  tweak the format pattern to pass tests on JDK 1.7,   See https://issues.apache.org/bugzilla/show_bug.cgi?id=53369 
//  the bounding rectangle is optional and only read when options are given 
//  start with one byte 'type' code for each value 
//  copy all values to 2nd array and a map for lookup of index 
//  Blue (1 byte): An 8-bit unsigned integer that defines the blue intensity value for the palette entry. 
//  paragraphs 
//  Now 5 blank rows 
//  Reset the text on the last run   Need to ensure it's a run that really has styles! 
// write the modified property back to POIFS 
//  The reported symptom of this bugzilla is an earlier bug (already fixed) 
//  goss version of CPtoFC - this takes into account non-contiguous textpieces   that we have come across in real world documents. Tests against the example   code in HWPFDocument show no variation to Ryan's version of the code in   normal use, but this version works with our non-contiguous test case.   So far unable to get this test case to be written out as well due to   other issues. - piers     i'm commenting this out, because it just doesn't work with non-contiguous   textpieces :( Usual (as for PAPX and CHPX) call to TextPiecesTable does.   private int CPtoFC(int CP)   {   TextPiece TP = null;   
//  remove existing hyperlink records 
//  Ensure the print setup 
//  fractional digits 
//  make it bold 
//  Try to add after a mid-record 
//  Print the contents 
//  Old style detection (Reserved = 0xFF) 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#setSuppressDropDownArrow(boolean)      */
//  If we get here, then there aren't any free sectors 
//  Fills 
//  it grew again? 
// the first check with blank workbook 
//  when parsing of the given uri fails, we can either   ignore this relationship, which leads to IllegalStateException   later on, or use a dummy value and thus enable processing of the   package 
// rich text string 
//  Do not throw NPE 
//  Copy attachments and recipients. 
//  The 4096 byte LZW dictionary is pre-loaded with some common    RTF fragments. These come from RTFLIB32.LIB, which ships    with older versions of Visual Studio or the EDK 
//  A1 = 1 
//  Ensure that this is a font we know about 
// (a piece of code that used to work up to POI 3.0.2) 
// average of 1_000 and 10_000 
//  Theme text shouldn't show up   String themeText =       "Theme Master Title\n" +       "Theme Master first level\n" +       "And the 2nd level\n" +       "Our 3rd level goes here\n" +       "And onto the 4th, such fun....\n" +       "Finally is the Fifth level\n"; 
//  start from the beginning  
//  second run properties 
// //// Case 2: Evaluate "Table1[[#Totals],[col]]" //////// 
//  Across two colums 
//         assertEquals("Microsoft Enhanced RSA and AES Cryptographic Provider", info.getHeader().getCspName()); 
//  Highlight Positive values - Column C 
//  a sheet with no cell comments should return an empty map (not null or raise NPE). 
//   document, which might be regular or fast-saved 
//  ignore exception here 
//  HyperlinkRecord.HLINK_URL | HyperlinkRecord.HLINK_ABS | HyperlinkRecord.HLINK_LABEL 
//  need to remove password data 
//  false parameter 
// EOFRecord 
//  Check we look up the correct style 
//  Details checks 
//  Textbox objects are also treated as shape objects. 
//  Check default limit 
//  Load 
// create string from xml tree 
/*  Check rule M1.8  */
//  No attachments 
//  Inputs!A1   Inputs!B1 
//  don't copy endParaRPr to the run in case there aren't any other   runs   this is the case when setText() was called initially   otherwise the master style will be overridden/ignored 
//  sprmCShd80 
//  visibility raised for testing 
//  no need to check for contain1. The key come from it 
//  write the first excel file 
//  Change the number 
//             p_wb.write(fileOut); 
//  check behavior with setCellFormulaValidation 
//  Now evaluate, they should all be changed 
//  1:1 
//  An optional WMF RectL object that defines a clipping and/or opaquing rectangle in logical units. 
// //// Case 6: Evaluate "Table1[#Headers]" //////// 
//  measured in Excel 2013. Sizes may vary. 
// sheet.createFreezePane(0, 3); 
//  364: STDEVPA   365: VARPA   366: STDEVA   367: VARA 
// Bug54868 patch has a hit on the first string before the ";" 
//  Category Axis Data 
//  Check for unreserved character "-", ".", "_", "~" 
//  Try to find the name of the font for our symbol 
//  Initialize the datasource 
//   private static void handleTabsAgain(ParagraphProperties pap, SprmOperation sprm)    {      byte[] grpprl = sprm.getGrpprl();      int offset = sprm.getGrpprlOffset();      int delSize = grpprl[offset++];      int[] tabPositions = pap.getRgdxaTab();      byte[] tabDescriptors = pap.getRgtbd();        HashMap tabMap = new HashMap(); 
//  don't bother about boiler plate text on master sheets 
//  x   y 
//  But not a Workbook one and not a Summary one 
//  default to dummy name 
/*  Not and ending mark  */
//  maybe we don't need that as an instance variable anymore 
/*          * Check ds:Signature node.          */
//  extra facilitator members 
//  special characters work 
//  assert that the number of parts remained the same 
/* workbook */
//  0 -> 21 are simple 
//  Shift from 3 back 
//  Check we detect the string properly too 
//  Convert it's contents into a CSV file 
//  if we have a file-type that we can read, but no extension, we try to determine the   file type manually 
//  rt   reserved   engine id 
// columns for 11 weeks starting from 9-Jul 
/*         assertEquals("[Array Formula] N7 cell type", CellType.FORMULA, cell.getCellType());        assertEquals("[Array Formula] N7 cell formula", "{SUM(H7:J7*{1,2,3})}", cell.getCellFormula());         */
//  Now even more complex 
//  Write out the values 
//  Write the future header first 
//  OOO: the 4th way Xcl stores a unicode string: not even a Grbit byte present if length 0 
//  Make a note of the index number of the right most cell. This value   will later be used to ensure that the matrix of data in the CSV file 
//  corner cases 
//  A 16-bit unsigned integer that provides information about how the operation is 
//  caused NPE on some cells 
//  Simply replace the .xls or .xlsx file extension with .csv 
//  prevent close of stream by transformer: 
//  Encrypt it 
/*  Write the new POIFS to disk.  */
// make absolutely certain that sequential calls don't throw InvalidFormatExceptions 
//  one blank row 
//  We should have both sets 
//  Multi-Sheet references are not supported 
//  First time we've seen the module. Add it to the ModuleMap and decompress it later 
//  Return what we find 
//  A 16-bit unsigned integer used to validate the correctness of the embedded EMF stream. 
//  has single digit round trip error 
//  According to bugzilla 48332,   "SoftArtisans OfficeWriter for Excel" totally skips field 6   Excel seems to be OK with this, and assumes zero. 
//  Check the contents of them - parse the summary block and check 
//  Output the mask and the data 
//  accent2 is theme1.xml is <a:srgbClr val="C0504D"/> 
// here we are checking if part if embedded and excel then set it to chart class  so that at the time to writing we can also write updated embedded part 
//  CONTINUABLE is not always correctly set, so we check the version field if this record is continued 
//  Empty story 
//  Try adding this new byte onto rawCode, and    see if all of that is still found in the 
// 			mapi.write(stream); 
//  We're on the end of the chain 
//  An 8-bit unsigned integer that specifies the arm style of the font. 
//  A tAttrIf 
//  mask off the two low-order bits, 'cause they're not part of   the number 
//  Strip off fields and macros if requested 
//  units that were employed when designing the font. The value MUST be in the UnitType enumeration 
//  An array of DashedLineDataSize floating-point values that specify the lengths of the dashes and spaces in a dashed line. 
//  return 0;     EscherProperty property = optRecord.lookup( 0x0102 ); 
//  (Comments in PPT97 are normal Escher text boxes) 
// wbr.write(new FileOutputStream("c:/temp/yyy." + _testDataProvider.getStandardFileNameExtension())); 
//  Now check we get the right stuff back 
//  Can't delete yet, has stuff 
//  Old or new style word document? 
//  scale to bounding box (bug #53176) 
//  A 32-bit unsigned integer that specifies how to interpret values in the color table 
//  Create a new empty POIFS in the file 
//  Check it still has 3 slides 
//  test regular-colored (non-indexed, ARGB) sheet 
//  moved sheet was the active one 
//  from the workbook 
//  area ref   spaces in area ref   special chars in sheet name   redundant sheet name quotes   case-insensitive sheet name   spaces around cell ref   spaces around cell ref   explicit arg1. only TRUE supported so far 
//  formula to get rendered as COLUMN($A$1:$IV$2) or ROW($A$2:$IV$3)  
//  And add to the main list 
// body specifies an external defined name 
//  attach the comment to the cell 
//  This color is visible when the source rectangle processed by an EmfPlusDrawImage record is larger than the image itself. 
//  hyperlink should still refer to test!E1 
//  recalculate now since we already have the data bytes available anyhow 
//  Should have used 9 blocks 
//  is this correct? 
// Add by Zhang Zhang test error situation when remaining bytes > avalible bytes 
//  field_4_alignment_options bit map 
//  check the built in list   or if the regular list   has all entries. 
//  A 32-bit signed integer that specifies the logical y-coordinate of the upper-left 
//  Should be 4 of them 
//  Try evaluating both 
//  invoking from cell C1 
//  Top level frame, there is no 'cell' above this frame that is using the current cell 
// remove this guard. So be safe it is left here. 
//  Formula row references should be adjusted by destRowNum-srcRowNum 
//  find comment in A1 
//  We can't do much yet with latent styles 
/*          * Invoke the signature facets.          */
// for compatibility with HSSF we have to set column width in units of 1/256th of a character width  the column is 5 characters wide  the column is 13 characters wide 
//  Now, create the chunk 
//  Save, and re-load 
//  the essense of the Newton-Raphson Method 
//  units, of the point where drawing is to start. 
//  check to see if we have enough room for an FC, a BX, and the   grpprl 
//  binary data is appended without DataFormat header 
//  Find the key, and return that 
//  try parsing a formula pointing to a different external sheet 
//  create cells with bad num patterns 
// application/vnd.ms-visio.viewer 
//  newer excel formats are 
//  Try and read each byte in turn 
//  this should be 3 as we overwrote the default paragraph with setText, then added 2 new paragraphs 
//  TODO - instantiable superclass 
//  level 1 : default title style on the master slide 
//  try to load truncated pictures by supplying a BufferedImage   and use the processed data up till the point of error 
//  ensure that the paragraph contains at least one character 
// still have five records 
//  Update references to the name 
//  Cell show  
//  A 32-bit unsigned integer that specifies the number of characters in the FamilyName field. 
// formula 
//  B1 is a string, with the wanted text in it 
//  formula extracted from bugzilla 45234 att 22141 
//  External reference to our own workbook's name 
//  Check we can see some bits of it 
//  intentionally empty 
//  fix invalid leadings (leading == 0) 
//  sign bit is in the same place for long and double: 
//  Split escher records into separate MSODRAWING and OBJ, TXO records.  (We don't break on 
//  If the stream is not closed on exception, it will keep a file descriptor to tmp, 
//  Notes - added at start 
//  add at the end 
//  For To, CC and BCC, try to match the names    up with their email addresses. Relies on the    Recipient Chunks being in the same order as 
//  Check the different kinds of formulas 
//  A floating-point value that defines the horizontal/vertical focus scale. 
//  grpprl = grpprl containing only a sprmPHugePapx2 
//  do not auto-close the slideshow 
// all of the path strings start with either 0x02 or 0x01 followed by zero or  more of 0x01..0x08 
//  Now we have the size of the details, which is 20 
//  Set to the value from the notes' sheet id 
/*  ===============================================================	 *                   External Move Methods	 * ===============================================================	  */
//  zin.available() doesn't work for entries 
//  this is necessary so that we do not write an empty <cols/> item into the sheet-xml in the xlsx-file   Excel complains about a corrupted file if this shows up there! 
//  A WMF RectL object that defines the destination bounding rectangle in device units. 
//  returns an error in Excel 2007 & earlier 
//   Get RGB values in the range 0 - 1 
//  Spacer ones 
//  if we didn't output OLE - output field value 
//  4 bytes - size of contents   13/15 00 00 01 
//  sprmCFNoProof -- 0x875 
//  Reserved, 4 bytes, all 0 
//  Will show as C:C, but won't know how many   rows it covers as we don't have the sheet 
//  be escaped by preceding it with a backslash. 
// build a tree of POIXMLDocumentParts, this presentation being the root 
//  non-null string greater than empty cell 
//  apparently bits 8 and 9 are unused 
/* Sheet sheet1 = */
//  actually, this is looking more like a number 
// 5. Convert all back slashes to forward slashes 
//  bitfields for options 
//  Apply one, changes 
//  Loop over the sets, showing what they contain 
//  Create a workbook with print areas on 2 sheets 
// expected order of records: 
//  OLE embeddings relation name 
//  Note about last param '2':   - Excel expects single row or single column when entered in UI, but process this OK otherwise 
//  We've spare ones from 100 to 128 
//  one more than it is 
//  Rich test file 
//  not [255, 102, 0] 
//  Should be two groups and a text 
//  specifies the size, in bytes, of the bitmap file - must add the length of the header 
//  name refers to this sheet 
/*  OPC Compliance methods  */
//  default font size for text boxes 
//  If there's any other bits of data, keep them about 
// defensive null checks; don't know if they're necessary 
// if highest bit !=1 then continue 
//  A format String must be built to ensure that the contents of the 
//  27-31 
//  Pick a predictable date format + timezone 
//  Row 3 (zero-based) was empty, so Row 11 (zero-based) should be empty too. 
//  forecolor 
// col must exist 
//  just plain '~' 
//  Save and re-open, ensure it still works 
//  Get useful things from our base slideshow 
//  unknown 
//  This one is one of the nasty auto-locale changing ones... 
//  This would be very complex to support 
//  TODO: Some kind of structure. 
//     {        Integer key = ((Integer)list.get(x));        tabPositions[x] = key.intValue();        tabDescriptors[x] = ((Byte)tabMap.get(key)).byteValue();      }        pap.setRgdxaTab(tabPositions);      pap.setRgtbd(tabDescriptors);    } 
//  skip empty runs 
//  Row 7 is blank / blank / number / number / number 
//  Protected, wrong password, throws Exception 
//  different syntax for plain area ref 
//  It isn't a text tag 
//  ok, it's just a plain ol' int; we can handle this   trivially by casting 
//  truncate the bottom of the area by the moved columns 
//    General codepage fallback: Message locale ID property. 
//  Work out how many FAT blocks remain in the XFATs 
//  350: ISPMT   351: DATEDIF   352: DATESTRING 
//  8 bytes of reserved zeros (top level properties stream only) 
//  Check we can read them correctly 
//  character run is 1 long   mask is 0x070004 
//  sprmCMajority50 -- 0xCA4C   unCompressCHPOperation (oldCHP, newCHP, 0x47, param, varParam,   styleSheet, opSize); 
//  null constant 
//  Should not throw POIXMLException: java.io.IOException: Unable to parse xml bean when reading back 
//  only for user defined styles 
//  true, true   true, true   true, true 
// wb.write(new FileOutputStream("/tmp/outnocomment.xlsx")); 
//  character run text 
//  Ensure Paragraph Character styles match 
//  Check some that aren't there 
//  Did we miss any cells? 
/*  @see <a href="http://msdn.microsoft.com/en-us/library/dd907466(v=office.12).aspx">2.3.6 Office Binary Document RC4 Encryption</a>  */
//  0 if slide has no notes. 
//  generate the TSP request 
//  No bulleting info included 
// set default properties for an autoshape 
// assertTrue("getCollapsed", col.getCollapsed()); 
//  Create a map from this XWPF-level enum to the STVerticalJc.Enum values 
//  wmf files in pptx usually have their placeable header    stripped away, so this returns only the dummy size 
//  rgb color 
//  level1, level2, level3 
// windows 1250 -- this test file was generated with OpenOffice  see https://bz.apache.org/ooo/show_bug.cgi?id=12445 for the inspiration 
//  Rows moved include the first row of the area ref, but not the last row   btw: (aLastRow > _lastMovedIndex) 
//  Plain 
//  Top level 
//  see also CVE-2008-3014 - https://dl.packetstormsecurity.net/papers/attack/CVE-2008-3014.pdf ;) 
//  Ask again, will still get 100 as not written to 
/*  A 32-bit unsigned integer that specifies the number of points in the points             * array. This value MUST be one more than three times the number of curves to             * be drawn, because each Bezier curve requires two control points and an             * endpoint, and the initial curve requires an additional starting point.             *             * Line width | Device supports wideline | Maximum points allowed             *    1       |            n/a           |          16K             *   > 1      |            yes           |          16K             *   > 1      |             no           |         1360             *             * Any extra points MUST be ignored.              */
//  <<---- 
//  modify anchor 
/*          * Read a couple of bytes from the stream.          */
//  can't have a space between the table name and open bracket 
//  some default input values 
//  because of tangens nature, the values left [90°-270°] and right [270°-90°] of the axis are mirrored/the same 
//  This might be a real email, or might be 
//  create named range for a single cell using cellreference 
//  Check that the record re-serializes correctly 
//  scale   index to font table 
//  Try again at the end 
//  "xps" - Doesn't have a core document 
//  intervening spaces not allowed once the digits start 
//  A 32-bit unsigned integer that specifies the total size of the EMF stream embedded in this 
//  consume padding 
//  Keep going 
//  Clean up temporary resources 
//  else no breaks 
//  Ask, will get 100 
//  The second knot of the spline. 
//  Cell Formula 
//  the correct value. 
// if you're here, no pattern matched, throw exception 
/*  remove POIXMLDocument from relations  */
//  check if we should remove this row as it will be overwritten by the data later 
//  check for EmfPlusInteger7 value 
//  sid=0x0209 
//  If the criteria arg is a reference to a blank cell, countif always returns zero. 
//  if it is a plain text box then take defaults from presentation.xml 
// JMH I am only overriding this to get a picture of the time taken to paint 
//  end x coordinate, relative to parent 
//  Icons : 5 arrows grey - Column P     
//         assertEquals(IndexedColors.AUTOMATIC.index, fmt4.getFillForegroundColor()); 
//  also adjust the number of merged regions overall 
//  Extended phonetics data   Minimum size is 14 
//  Turn our InputStream into something NIO based 
//  New document won't have them 
//  If we get here, it's got no associated proper links yet   So, add the missing reference and return 
//  Number or string? 
//  Start adding new codes after the constants 
/*  ======= Name pointing to 3rd sheet ======  */
//  no result on empty 
//  reduce size by 2 rows and 2 columns 
//  and also use the remaining bytes, which might contain padding bytes ... 
//  for now expect this to fail, when we fix 57699, this one should fail so we know we should adjust   this test as well 
// serialize and check again 
//  If we're not using merged cells, skip this one and move on to the next. 
//  evaluate() 
// only shift if the region outside the shifted columns is not merged too 
// This forces ctpicturebase to be included in the poi-ooxml-schemas jar 
//  Santuario xmlsec 
//  hyperlinks on this row are unaffected by the row shifting, so the hyperlinks should not move 
//  this handling is only based on try and error ... not sure why h/xslf is handled differently. 
//  now: also allow explicitly disable styles and there aren't any non rich text runs anymore 
//  Same, no change, SBAT remains empty 
//  Often, but not always has 6 unused bytes at the end 
//  Excel counts blank values in range as not equal to any value. See Bugzilla 51498 
//  Fix up row heights if required 
//  Read and check 
//  valid cell reference 
//  Get text works with \n 
//  A 32-bit unsigned integer that specifies the offset to the output string, in bytes,   from the start of the record in which this object is contained. 
//  major increment 
/*          * plcffld*** (table of field positions and statuses for annotation         * subdocument) Written immediately after the previously recorded table,         * if the ******* subdocument contains fields.         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 24 of 210          */
//  CellAddress=B1, shifted to B4 
//  How far through the input and output streams we are 
//  LogPaletteEntry objects, if they exist, MUST precede this field. 
// shift down the top row on Sheet1. 
//  define the third style to be the default 
//  from ms excel 
//  adding PAPX from fast-saved SPRMs 
//  the CipherOutputStream adds the padding bytes on close() 
//  = 2007-06-20T07:57:00Z 
//  Excel 2013 and LibreOffice 4.2.8.2 both treat columns with merged regions as blank 
//  verify cannot delete the root directory 
//  didn't find digits or '.' 
// Offset=0x00002636(9782) recno=72 sid=0x003C size=0x010D(269) 
//  Get the main document stream 
/*  *************** record code follows **********************  */
//  test Table - a complex group of shapes containing text objects 
//  The y-coordinate of the ending vertex of an arc. 
//  check initial state 
//  Check if the part name does not have empty segments. [M1.3] 
//  negative value means absolute spacing in points 
//         resolveRangeOverlapTest("C1:D2", "C2:C3");      } 
// Use first column as row label 
//  check fail 
//  sid=0x0009   size=0x0004 
//  Border from a style direct, red 
// need to check, else blows up on some records - bug 34435 
//  255 clears border inherited from row 
//  Check the second one, links to 56737.xls, slightly differently 
//  Cell show "Thursday, December 8, 2016" 
//  For all of the contents rows, check that DataFormatter is able 
//  this formula evaluates to an Excel error code '#N/A' 
//  If we didn't get a real string, don't even cache it as we can always find this out quickly 
//  increase size by 1 row and 1 column 
//  nextSid should be for a DVRecord.  If anything comes between the DV header record    and the DV records, Excel will not be able to open the workbook without error. 
//  Anticipates the location of where a workbook will be written to   Note that if TEST_OUTPUT_DIR is not set, this will create temporary files   with unique names. Subsequent calls with the same argument may return a different file.   Gets a test data sample file, deleting the file if it exists.   This is used in preparation for writing a workbook out to the returned output file.   testName is a filename fragment and should not include the extension 
//  An EmfPlusRectF object that specifies a portion of the image to be rendered. The portion of the image 
//  SBAT still unused 
//  sprmPFWidowControl 
//  don't do this for very large sheets as it will take a long time 
//  the cipher can't be final, because for the last chunk we change the padding 
/*  * Created on May 29, 2005 *  */
//  info of chicago project:   "... LZ compression algorithm in the format used by GNU Zip deflate/inflate with a 32k window ..."   not sure what to do, when lookup tables exceed 32k ... 
//  Add the length+code to the buffer   (The position is the first 12 bits, the 
//  crossing point   label frequency 
//  expected results are on the row below 
//  center of text relative to this shape 
//  Reserved or invariant locale behavior 
//  Add a new style, also rotated 
// <-- FAILS EXPECTATIONS 
//  Applies to a child 
//  It MUST NOT include the size of itself or the size of the AlignmentPadding field, if present. 
//  Expected badly behaved sheet record to cause exception 
//  any NoteRecords that follow the drawing block must be aggregated and and saved in the tailRec collection 
// YK: should throw an exception if requesting boolean value from a non-boolean formula 
//  check if InputStream is still intact 
//  Check it has the length + compressed marker 
//  Firstly set up a sequence of formula cells where each depends on the  previous multiple 
/*          * clx (encoding of the sprm lists for a complex file and piece table         * for a any file) Written immediately after the end of the previously         * recorded structure. This is recorded in all Word documents         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 23 of 210          */
//  Save the CSV file away using the newly constricted file name 
//  color in percentage is in linear RGB color space, i.e. needs to be gamma corrected for AWT color 
//  Add another cell at the end 
//  extraData 
//  jan 
//  Copy the whole lot 
//  SIDs from newer versions 
//  Don't check for a Zip header, as to maintain backwards    compatibility we need to let them seek over junk at the    start before beginning processing. 
//  Change our cell record to use this style 
//   2^3^2    evaluates to 64 not 512 
// rwFirst, rwLast, colFirst, colLast 
/* File file = new File("/tmp/63509.xlsx");            try(FileOutputStream outputStream = new FileOutputStream(file)) {                workbook.write(outputStream);            } */
//  An 8-bit unsigned integer that specifies the clipping precision.   The clipping precision defines how to clip characters that are partially outside the clipping region. 
/* 		 * Have a check between available bytes and bytesRemaining, 		 * take the available length if the bytesRemaining out of range.		  */
//  run a number of files that might fail in order to catch    leaked file resources when using file-leak-detector while   running the test 
//  BUT adding positive zero gives positive zero 
//  Make sure values are saved and re-read correctly. 
// shouldn't have a sheet w/o a SelectionRecord, but best to guard anyway 
//  Build an input stream of it 
//  NOT: (2 *2) ^ 2 -> int int multiply int power 
//  removed sheet was below the active one => active is one less now 
//  adjust cell column style 
//  no change if before any affected row 
//  A 32-bit unsigned integer that specifies the value in the LineCap enumeration that indicates 
//  Add one more stream to each, then save and re-load 
// register a new drawing group for the cloned sheet 
//  Mini Stream + SBATs first, as mini-stream details have 
//  131: N   140: DATEVALUE   141: TIMEVALUE   142: SLN   143: SYD   144: DDB 
//  Check the 12(.34)% ones 
//  the best-fit width for both flushed rows and random access window rows 
//         remainingData  =  new byte[bytesRemaining];          System.arraycopy( data, pos + size, remainingData, 0, bytesRemaining ); 
//  Check filtering down 
//  calls System.exit(): TextStyleListing.main(new String[0]); 
// a span of columns [2,4] 
//  whole row and whole column ranges currently not supported 
//  See note above. XSSFNames become invalid after workbook write 
//  Stored in the file as us-ascii 
//  Save the final package to a temporary file 
//  De-register it 
// //// Case 9: Evaluate "Table1[[#All],[col]]" //////// 
//  else 
//  verify that getEntries behaves correctly 
//  Cell show  
// example from Excel help 
//  The StringBuffer's contents are the source for the contents 
//  First pass - figure out where all the position dependent     records are going to end up, in the new scheme   (Annoyingly, some powerpoint files have PersistPtrHolders 
//  test with -1 
//  NOSONAR  this.mask1 = source[startIndex];  this.mask2 = source[startIndex + 1]; 
//  Get the built in format, if there is one 
//  Setup the inline 
//  Check the 123(.45)% ones 
//  A 32-bit unsigned integer that specifies the number of rectangles in this region. 
// we are still of 'formula' type 
/*              * OOo doesn't like ds namespaces so per default prefixing is off.              */
//  start new PersistDirectoryEntry 
//  anchor is not defined in the shape 
// Removing root element 
//  Note down the index number of the bottom-most row and   then iterate through all of the rows on the sheet starting   from the very first row - number 1 - even if it is missing.   Recover a reference to the row and then call another method   which will strip the data from the cells and build lines   for inclusion in the resylting CSV file. 
//  Minimum Value Formula 
//  Ensure the value passed to the formattingConvention parameter is 
//  Compute the high-order word of the new key: 
//  Normal smtp address 
// passing null unsets the color 
// stFile  unused (2 bytes as we're using double-byte chars) 
//  mere bunk 
//  adding blank to "abc" gives "abc" 
//  Fill the XBAT, which means filling 127 BATs 
//  character run is 30 long 
//  always write 'rt' field as 0x01C1 
//  Calculate and print the actual fraction (improper or otherwise) 
//  Standard built in format 
//  Load relationships if any 
//  Excel seems to write this value, but it doesn't seem to care what it reads 
//  Note - this is unusual for BIFF records in general, but normal for header / footer records:   when the text is empty string, the whole record is empty (just the 4 byte BIFF header) 
// integral test: check that the read-write-read round trip is consistent 
//  min axis value 
//  different stream, if the file is cryptoapi encrypted 
//  num categories   num values 
//  Add a third one 
//  Test changing the three sections value 
//  A 32-bit unsigned integer that specifies the offset to the palette entries from the start of this record. 
//  printable, but not compilable with current compiler encoding 
/* HSSFCellStyle style = */
//  If it's an external target, we don't 
//  and delete the old part to replace it thereafeter 
//  We certainly found an encoded character, check for length   now ( '%' HEXDIGIT HEXDIGIT) 
//  Check we got the styles we'd expect 
/*              * plflfo (more list formats) Written immediately after the end of             * the plcflst and its accompanying data, if there are any lists             * defined in the document. This consists first of a PL of LFO             * records, followed by the allocated data (if any) hanging off the             * LFOs. The allocated data consists of the array of LFOLVLFs for             * each LFO (and each LFOLVLF is immediately followed by some LVLs).             *              * Microsoft Office Word 97-2007 Binary File Format (.doc)             * Specification; Page 26 of 210              */
//  -1 to convert definedNameIndex from 1-based to zero-based 
//  all these operations are on an area ref spanning columns 10 to 20 
//  And the all-in fetch 
//  Will keep the mini stream, now empty 
// cchFile (2 bytes)  char type = unicode 
//  verify proper behavior with negative index 
//  doesn't happen ... 
//  1%	0.5%	3%	4% 
//  First child should be the ExMediaAtom 
//  Check the colours 
//  relative url will be resolved to an absolute url, therefore this doesn't equals to "slide2.xml" 
//  Look for any text in any of our pictures or drawings 
/*  This exception will not be thrown because we already                         * checked above.  */
//  empty row at left-top corner 
/*  if last relation to target part was removed, delete according target part  */
//  Old Word Documents where we can at least extract some text 
//  account for row records in this row-block 
//  Weds 28th April 2010 @ 12:40:56 UTC 
//  Will have dropped to 8 
//                 recs[9],  //HeaderFooterRecord 
//  Write out to a byte array, and to a temp file 
//  character run is 30 long   mask is 0x020001 
//  some Records do not implement clone, ignore those for now 
/*  No: We have to create the directory - or return the root's                 * DirectoryEntry.  */
// 0 1 2 3 4 5 6 7 
//  mismatch -> unbuffer 
//  keep this first, as some constructors below want it 
//  make sure that all evaluators have the same listener 
//  we want to compare on identity here on purpose   as we want to ensure that both lists contain the   same documents, not copies! 
//  Remember the "@" positions in last-to-first order (to make insertion easier) 
// expandRow(rowIndex); 
//  sprmPFDyaBeforeAuto 
//  had one case where the re-saved could not be re-saved! 
//  see https://bz.apache.org/bugzilla/show_bug.cgi?id=60980 
//  Only work on user added ones, which come after 20 
// add one for zero byte 
//  And also write to some bytes for checking 
//  For testing - all should be numeric 
//  A1:E1 should be removed 
//  add "\u5e74 \u6708 \u65e5" for Chinese/Japanese date format:2017 \u5e74 2 \u6708 7 \u65e5 
//  Add the new slide into the last PersistPtr 
//  Type: 14    Addr: 011eb2ac  Offset: 1dd4    Len:  14d   Format: 52  From: 24 
//  Level 1 collapsed, others expanded, should only have 4 rows, all hidden:  
//  bit 15 is unused 
//  Apparently, it's the second least significant bit 
//  Filter more 
//  Next up, check they have the same number of children 
/*  exception is thrown -> server not available  */
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationHelper#createDateConstraint(int, java.lang.String, java.lang.String, java.lang.String)	  */
//  how the code used to behave.  
//  Where in the stream does the "number of pointers" offset live? 
// 499  999 
//  Old cell value should not have been overwritten 
//  Function "Text" uses custom-formats which are locale specific   can't set the locale on a per-testrun execution, as some settings have been   already set, when we would try to change the locale by then 
//  bitfields for palette options 
// Create relationship between pivotTable and pivotCacheDefinition without creating a new instance 
//  set equal to size of sprmPHugePapx grpprl 
//  Excel 2010 gives 51.74384236453200 
//  set second sheet 
//  Now create 
//  Create a cell at A3 and insert a numbered list into that cell.   Note that a couple of items have been added to the listItems 
//  color in sRGB color space, i.e. same as AWT Color 
//  Change Font size 
//  show numbers to associate shapes with ids.. doesn't always work 
// create a target sheet and cell 
/* 	 * Note - the next three fields are very similar to those on	 * EmbededObjectRefSubRecord(ftPictFmla 0x0009)	 *	 * some observed values for the 4 bytes preceding the formula: C0 5E 86 03	 * C0 11 AC 02 80 F1 8A 03 D4 F0 8A 03	  */
//  Sheet name only applies if not a global reference 
//  mask out upper bits to produce 'wrapping' at the maximum column ("IV" for .xls and  "XFD" for .xlsx) 
//  changed protected to public 
//  Exact times differ slightly 
//  make the row height bigger  (in twips - 1/20 of a point) 
//  Verify names in wb2 
//  old bottom row of area has moved up deep within the area, and exposed a new bottom row 
//  For now, try filling in the fields 
//  Update the properties streams in the file 
//  open the zip input stream   NOSONAR 
//  intentionally shadowing variables here   center 
//  Doesn't fit, output 
//  Save the raw bytes, should be raw RTF 
//     public final static short       OBJECT_TYPE_CHART              = 5;      public final static short       OBJECT_TYPE_TEXT               = 6; 
//  picture 
// assumes Locale prints number decimal point as a period rather than a comma 
//  Shift from 3 front 
//  literal list, using formula constructor 
//  unknown ushort   _address: "yearfracExamples.xls" 
//  taken from libre office export, it won't open, if this is left to 0 
//  see more details in https://issues.apache.org/bugzilla/show_bug.cgi?id=51710 
// // COLUMN VECTORS 
//  black 
// adjust column width to fit the content 
//  calls System.exit(): SlideAndNotesAtomListing.main(new String[0]); 
//  Check it's the same now 
//  Check now the same 
//  Check the text has the newline 
// Sheet worksheet = wb.createSheet("sample"); 
// read record header 
//  create the comment in two different ways and verify that there is no difference 
//  we don't even support double stream files 
//  Enable this to write out + check in Excel 
//     [EOFRecord] 
//   with the next byte 
//  An optional 32-bit signed integer that specifies the shape for both ends of each dash in a dashed line.   This field MUST be present if the PenDataDashedLineCap flag is set in the PenDataFlags field of the   EmfPlusPenData object, and the value MUST be defined in the DashedLineCapType enumeration 
//  Should have two SLTWs 
//  16 colors 
//  These even crazier ones are also valid 
//  unset font size in presentation.xml. The value should be taken from master slide 
//  need them in formatting and priority order so logic works right 
//  Type: ff   Addr: 014fffac  Offset: 0    Len:  0   Format: 60   From: 8a94 
// arial is the default font 
//  Excel can read this OK 
/*              * TAPXs are actually PAPXs so we have to make sure we are only             * trying to uncompress the right type of sprm.              */
//  Has masses of text   Until we fixed bug #41064, this would've     failed by now 
//  the above has been tested 
//  A 16-bit value that MUST be 0x0000 and MUST be ignored. 
//  We don't have enough data in the record to cover    all the properties the mask says we have 
// Test a uncompressed small string that has rich text formatting 
//  also ensure that all buffers are unmapped so we do not keep files locked on Windows   We consider it a bug if a Buffer is still in use now!  
//  determine font group ranges of the textrun to focus the fallback handling only on that font group 
// calculation chain is removed as well 
// check the formula 
//  A 32-bit unsigned integer that specifies the number of scan lines. 
//  and srcRows does not contain null rows 
//  special case exponent differs by 1.  There is still a chance that with rounding the two quantities could end up the same 
//  Used to format numeric cell values. 
//  HeaderBlock 
//  Remove the part 
//  Doesn't fit, can't be a match 
//  If we didn't have a good match or at least except a first empty element 
//  try to load picture in gray scale mode   fallback mode for invalid image band metadata   see http://stackoverflow.com/questions/10416378 
//  Powerpoint 
//  Rename the name, comment comes with it 
//  Delete the 2nd sheet 
//  Image size (excluding the 8 byte header) 
//  Put our test files in a non-standard place 
//  Paragraph with table 
//  field_9_fill_palette_options bit map 
/*  FIXME:  */
//  Mark it as being an Icon Set 
/*  Get the root directory. It does not have to be created                     * since it always exists in a POIFS.  */
//  An optional 32-bit signed integer that specifies how to join two lines that are drawn by the same pen   and whose ends meet. This field MUST be present if the PenDataJoin flag is set in the PenDataFlags   field of the EmfPlusPenData object, and the value MUST be defined in the LineJoinType enumeration 
//  check for previous version of file format 
// The array of Slide's text runs must be updated when new text shapes are added. 
//  just in case we end iteration 
//  Next paragraph is all in one style, but a different one 
//  bitmap. The value of this field MUST be 0x01. 
//  create a control path and knots 
/*  do we have to delete from this text piece?  */
//  we should have the same color for the column styles 
//  x coordinate of first point on ellipse 
/*  sprmPIlfo -- 0x460B  */
//  comes from the slide master 
//  this would cause ClassCastException below 
//  pattern of length 1 
//  Check slide 3 is as expected (was re-ordered from 2) 
//  a double is an IEEE 8-byte float...damn IEEE and their goofy standards an 
//  Two named ranges called "name1", one scoped to sheet1 and one globally 
//  srcRegion is fully inside the copied rows 
//  rectangle and optionally a brush pattern, to achieve the final color. 
// NKB Testing only that logging classes use gives no exception      Since logging can be disabled, no checking of logging      output is done. 
//  check content of second paragraph 
//  Now store a reference to the BAT in the required place 
//  were defined in a different workbook 
//  auto-filter must be registered in workboook.xml, see Bugzilla 50315 
//  Check the fat info looks sane 
//  Delete it 
// where A2 is defined above 
//  There is no summary information yet. We have to create a new one 
//  ten column ColumnInfoRecord 
//  The first token is empty, the second is the root node 
// length of the address including the tail. 
//  Check each workbook in turn, and verify that the colours 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#createPromptBox(java.lang.String, java.lang.String)      */
//  POI apparently can't create a document from scratch,   so we need an existing empty dummy document 
//  Final dummy cell for the end-of-row 
//  Then the contents of all the properties 
/*  short + short + long */
//  We now have 2 BATs, but no XBATs 
//  added extra facilitator members   FFN structure containing strings of font names 
// now do not include phonetic runs 
//  iterate through piece descriptors raw bytes and create 
//  Doesn't have data 
//  keep only those relationships which id is registered in the sourceIds 
//  Special handling for whole-column references 
//  SP @ 32 
//  Save in ZIP   Add entry in ZIP 
//  2nd slide is not updated 
//  rearrange the sheets several times to make sure the names always refer to the right sheet 
//  docs are wrong (0x231 Microsoft Support site article Q184647) 
//  A segment of an EMF file. The bytes in consecutive META_ESCAPE_ENHANCED_METAFILE records 
//  4 ints and 2 shorts 
// assertEquals("123",     dfUS.formatRawCellContents(-123.321, -1, "0 ?/?;0")); 
//  extract text from a powerpoint that has a header in the notes-element 
//  First check it isn't on the Workbook 
//  Via a POIFSFileSystem, will spot it's actually a .xlsx file    encrypted with the default password, and open 
//  long side 
//  An array of Count points that specify three points of a parallelogram.   The three points represent the upper-left, upper-right, and lower-left corners of the parallelogram.   The fourth point of the parallelogram is extrapolated from the first three.   The portion of the image specified by the SrcRect field SHOULD have scaling and shearing transforms   applied if necessary to fit inside the parallelogram. 
//  +            _cipher.update(_chunk, 0, posInChunk, _chunk);   +            byte bla[] = { (byte)0x7A,(byte)0x0F,(byte)0x27,(byte)0xF0,(byte)0x17,(byte)0x6E,(byte)0x77,(byte)0x05,(byte)0xB9,(byte)0xDA,(byte)0x49,(byte)0xF9,(byte)0xD7,(byte)0x8E,(byte)0x03,(byte)0x1D };   +            System.arraycopy(bla, 0, _chunk, posInChunk-2, bla.length);   +            return posInChunk-2+bla.length;   +        }   +                    int ciLen = (doFinal)                ? _cipher.doFinal(_chunk, 0, posInChunk, _chunk)                : _cipher.update(_chunk, 0, posInChunk, _chunk);          --- src/ooxml/java/org/apache/poi/poifs/crypt/agile/AgileDecryptor.java (revision 1766745)        +++ src/ooxml/java/org/apache/poi/poifs/crypt/agile/AgileDecryptor.java (working copy)                @@ -300,7 +297,7 @@        protected static Cipher initCipherForBlock(Cipher existing, int block, boolean lastChunk, EncryptionInfo encryptionInfo, SecretKey skey, int encryptionMode)        throws GeneralSecurityException {            EncryptionHeader header = encryptionInfo.getHeader();   -        String padding = (lastChunk ? "PKCS5Padding" : "NoPadding");   +        String padding = "NoPadding"; // (lastChunk ? "PKCS5Padding" : "NoPadding"); 
//  trigger bug with CArray handling 
//  Should be yymmddhhmmssZ 
//  Now look at another message 
//  In first set, we get a CharFlagsTextProp and a font.size 
//  The username gets stored twice, once as US 
//  First paragraph is simple 
//  rawSheetName == "Sheet1" gets this far. 
/*  ******************* fetching methods follow *********************  */
//  create a sheet with 300 rows (0-299) 
// set data and extraData to empty values to avoid  downstream NPE in case someone calls getEntries on RevisionMarkAuthorTable 
// 			// TODO - add proof spreadsheet and compare  			InputStream proofStream = HSSFTestDataSamples.openSampleFileStream("TestDataValidation.xls");  			isSame = compareStreams(proofStream, generatedContent);  		} 
//  Add some new text 
//  OLE2 - Stream 
/*  Write first word.  */
//  This is multiple consecutive number cells in one record   Exand this out into multiple regular number cells 
//  Now check the iterator 
//  A 32-bit unsigned integer that specifies the way to use the region. 
//  "=SUMIFS(A2:A9, B2:B9, "<>Bananas", C2:C9, 1)" 
//  marshal XAdES-X 
//  Simply chain the call to the overloaded convertExcelToCSV(String,   String, String, int) method, pass the default separator and ensure   that certain embedded characters are escaped in accordance with   Excel's formatting conventions 
//  else looks like a number 
// Test a compressed small string that has rich text and extended text 
//  merged regions will be copied after all the rows have been copied 
//  allow empty cells 
//  270: BETADIST   271: GAMMALN   272: BETAINV   273: BINOMDIST   274: CHIDIST 
//  Various Stats formulas on ranges of numbers 
//  Condition 1: Cell Value Is   greater than  70   (Blue Fill) 
//  Building xml 
//  we have no separator 
//  Normal cases 
// add a picture shape 
//  get the ending fc   CHPX lastRun = _textRuns.get(_textRuns.size() - 1);   int endingFc = lastRun.getEnd(); 
//  Build the attribute 
//  char flags 0x060000 
// test reading/serializing of a PICT metafile 
//  field len, char data len 
// row greater than 0x100000 
//  Now we have 3 cases:   (a) the first part couldn't be displayed,   (b) only part of the text run could be displayed   (c) or all chars can be displayed (default) 
//  populate enum maps 
//  Write out our header, less the size 
//  Change again, without notifying 
//  125: CELL 
//  there will be 2 or 3 extra tAttr tokens according to whether the false param is present 
//  Check these stubs have the right stuff on them 
//  Verify 
//  Evaluate 
//  Betweeen __SRP_0 and __SRP_1 just sort as normal 
//  Write out the styles 
//  Read the properties in once more 
// Create relationship between pivotcacherecord and pivotcachedefinition 
//  Without currency symbols 
//  length 
//  aptg is part of a formula in a cell that was just copied to another column   aptg column references should be updated by the difference in columns that the cell was copied   No other references besides the cells that were involved in the copy need to be updated   this makes the column copy significantly different from the column shift, where all references   in the workbook need to track the column shift 
//  bug triggers on row index 59 
//  only count pairs if both elements are numbers 
//  files with XML entities 
// noinspection ResultOfMethodCallIgnored 
//  plain string 
//  Core properties case-- use first CoreProperties part we come across   and ignore any subsequent ones 
//  only the root Entry has no parent ... 
//  Docs "official" 
//  Findbugs: URF_UNREAD_FIELD . Do not delete without understanding how this class works.  this.sheet = sheet; 
//  0x464D4520 (LE) 
//  Now convert the byte offsets back into record offsets 
//  See if we can find it 
//  A 32-bit signed integer that defines the horizontal resolution, 
//  is then instantiated. 
//  get the size of the existing storage 
//  -2147483648; 
//  case CellType.BLANK 
//  line color was not found, check if it is defined in the theme 
//  Create some content. 
//  Now properties. 
//  marshal XAdES-C 
//  the alternate font 
//  Third is size 24, alt font 
//  store the zip content in memory   let s assume it is not Go ;-) 
/*  The following declarations are shortcuts for accessing the             * "event" object.  */
//  else string has been spilled into next continue record 
//  or compare the hashes of the attachment data 
/*         final Class<? super T> clazz;        final T instance;        final Class<R> fieldType;        final String fieldName;        final R expected;        final R actual = POITestCase.getFieldValue(clazz, instance, fieldType, fieldName);        assertEquals(expected, actual);         */
/*  @see <a href="http://msdn.microsoft.com/en-us/library/dd906097(v=office.12).aspx">2.3.4.5 \EncryptionInfo Stream (Standard Encryption)</a>  */
//  Fetch the property value directly 
//  An array of CompoundLineDataSize floating-point values that specify the compound line of a pen. 
//  dark magenta 
//  escape literal characters that would have special meaning in regex 
//  Delete logically this part 
//  155 -> 160 is the next 
//  Write the summary information stream and the document summary 
// pap.fNumRMIns 
//  Write a 5 block file  
//  PageSettingBlock in this file contains PLS (sid=x004D) record   followed by ContinueRecord (sid=x003C) 
//  check reading of formulas which are shared (two cells from a 1R x 8C range) 
//  Accounting -> 0 decimal places, US currency symbol 
//   quoting and scientific notation 
//             out.close();          } 
//  and finally ensure that exporting to XML works 
//  Grab interesting records as they come past 
//  Reserve block 0 for the start of the Properties Table   Create a single empty BAT, at pop that at offset 1 
//  aka arrow in native 
//  values above 90 are mapped to the correct values for compatibility between HSSF and XSSF 
//  none of the following properties are set in the shapes and fetched from the master shape 
//  make sure the added header / footer records are empty 
//  here we can only verify that setting some zoom values works, range-checking is different between the implementations 
// the maximum number of arguments depends on the Excel version 
//  appended to the StringBuffer. 
//  TODO - parse 
//  This file has two embeded excel files, an embeded powerpoint     file and an embeded word file, in that order 
//  sprmPFInnerTtp -- 0x244c 
//  only flush, don't close! 
//  compensate for missing tAttrVolatile, which belongs in any formula    involving OFFSET() et al. POI currently does not insert where required 
//  DeletedAreaRef 
//  4th is underlined 
//  OPC handler works / XSSF handler fails 
//  MB   MB 
//  end public class POIFSReaderEvent 
//  Write out, but only the common streams 
//  Green (1 byte): An 8-bit unsigned integer that defines the green intensity value for the palette entry. 
//  NOSOLAR 
//  an area ref can work as a scalar value if it is 1x1 
//  usual case 
// initialize drawing group id 
//  TODO - ensure 2 sub-records (ftCmo 15h, and ftEnd 00h) are always created 
// integer, always 2 
// the correct order of entries in the test file 
//  Check at our level 
//  go 
//  minus zero can be produced as a result of underflow 
//  in pixels-per-meter, of the target device for the DIB. 
//  Check we find a few string-literal dates in there 
//  center of rotation relative to origin of parent 
//  fills and borders are not set 
//  How about xlsb? 
// Set relationships id for pivotCacheDefinition to pivotCacheRecords 
//  Check core details came through 
//  otherwise, remove the fraction 
//  cell appear as a bulleted item. 
// using the findFirstXXXX methods 
//  - build a fake styles.xml file with just this built-in 
//  Now try to read 
//  Can not yet set table or cell width properly, tables default to 
//  we need to let the model re-calculate the Range before we use it 
// by default hyperlinks are blue and underlined 
//  Workbook based name 
//  7-6 - reserved bits must be 0 
//  If this row doesn't exist, nothing needs to    be done for the now empty destination row 
//  The x-coordinate of a spline's second control point. 
//  Sine ArcTan Formula: "sat2 x y z" = (x*sin(arctan(z / y))) = value of this guide 
//  Remove the _ too 
//  expected data is stored in UTF-8 in a text-file 
//  "You may not use unions, intersections or array constants in Conditional Formatting criteria" 
//  Reset the text on a shared paragraph 
//   Calculate the Saturation 
//  Based on the amount of text and whitespace used, and the default font   assume that the cell with whitespace should be at least 20% wider than   the cell without whitespace. This number is arbitrary, but should be large   enough to guarantee that the whitespace cell isn't wider due to chance.   Experimentally, I calculated the ratio as 1.2478181, though this ratio may change   if the default font or margins change. 
//  tx.storeText(); 
//  Data Bars - Column E 
//  simple formula worked 
//  repeated additions of same share package relationship 
// revert 
//  What's the relationship between bytes and characters? 
//  close but no cigar 
//  0 -> 1 -> 2 -> end 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#setErrorStyle(int)      */
//  sprmPDyaLine 
/*      * parses the metro bytes to a XSLF shape      */
//  Icons : 3 symbols 2 (no background) - Column N 
//  2 shorts + 1 byte 
// read the image using javax.imageio.* 
//  discard result 
//  Create a new table with 6 rows and 3 columns 
/*                  * Blip stored in delay stream, which in a word doc, is the main                 * stream                  */
//  330 == 0x014A; 334 == 0x014E 
//  optional field 
//  ignore padding block 
// cache the relId to hyperlink url from the sheet's .rels 
//  row "2" is now empty 
//  pass 
// try the general case, where module.offset is accurate 
//  retrieve the cell at the named range and test its contents 
//  Note the formula, as stored in the file, has the external name index not filename 
//  check for version 2 ... otherwise we don't read any further 
//  storing the ops in reverse order since they are popping   whether one of the operands is an area 
// size of the record header  size of the picture header 
//  Text values are returned unmodified 
//  column IDs start at 1, and increase in the order columns are added (see bug #62740) 
// let's create a table for the test 
// get name of the record by type 
//  In the interest of our sanity, now sort the text pieces 
//  Note - named ranges formulas have not been updated 
//  always activate subsetting 
// Add 1 to obtained number 
//  YK: how to compare the original path1 and the value returned by XSLFFreeformShape.getPath() ? 
//  Decide where we're going to put it 
//  Try various ways of changing the formulas   If it stays a formula, chain entry should remain   Otherwise should go 
//  tExp and tTbl are always 5 bytes long, and the only ptg in the formula 
//  No mini stream, and no xbats 
//  assertEquals(530, pLast.getEnd()); 
//  And check some chinese bits 
//  We need to work on a File for in-place changes, so create a temp one 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#getFormula2()	  */
//  Setup our header block   We are a container record 
//  Add same border to another cell, should not create another style 
//  halfway between the beginning and ending vertices of the arc. 
//  Finish up with all the footers 
//  Grab the bit to be shifted 
//  So far, mini stream will work, keep going 
//  default will be taken from master 
//  Write the output to a file 
//  Delete content type 
//  We've already figured out their new location, and   told them that 
//  column F:  date / time 
/*  Register the listener for all POI files.  */
//  data taken from bugzilla 48339 
// A B C D E F G H 
//  Values array. It MUST be in the range 0 to 16, inclusive. 
//  the value of -1.0 resets to the defaults (not any more ...) 
//  this value axis crosses its category axis at max value 
// 49  99  490  495  499  995  999   990 
//  Check paragraph contents 
// nominally 100 
//  Find it now 
// Sheet s = wb.createSheet("sheetname"); 
//  create a numeric cell 
//  The docs don't explain why Excel set the formula to #REF! 
//  External 
// Can't use ctRow.getTcList because that only gets table cells  Can't use ctRow.getSdtList because that only gets sdts that are at cell level 
//  Must be an external function 
//  We're onto a new row 
//  This one has lots... 
//  (1 -> 2, 2 -> 3) 
//  A 32-bit unsigned integer that specifies EMF metafile interoperability. This SHOULD be 0x00010000. 
//  is grpprl huge? 
//  pageref run 
//  if oldIndex < newIndex then this sheet moved right and sheets between oldIndex and newIndex moved left 
//  Pointers to the most recent versions of the core records 
// don't care, structured references not allowed in conditional formatting 
//  Check now set as it should be 
//  Fetch the right logger for them, creating 
//  Create two paragraphs for insertion into the footer. 
//  Quoting is very awkward.  In the Java classes, quoting is done   between ' chars, with '' meaning a single ' char. The problem is that   in Excel, it is legal to have two adjacent escaped strings.  For   example, consider the Excel format "\a\b#".  The naive (and easy)   translation into Java DecimalFormat is "'a''b'#".  For the number 17,   in Excel you would get "ab17", but in Java it would be "a'b17" -- the   '' is in the middle of the quoted string in Java.  So the trick we   use is this: When we encounter a ' char in the Excel format, we   output a \u0000 char into the string.  Now we know that any '' in the   output is the result of two adjacent escaped strings.  So after the   main loop, we have to do two passes: One to eliminate any ''   sequences, to make "'a''b'" become "'ab'", and another to replace any   \u0000 with '' to mean a quote char.  Oy.     For formats that don't use "'" we don't do any of this 
//  assertFalse(run._isUnicode); 
//  Check things had the right row numbers 
//  Check the table sheet 
//  If we get here, check it's only made up, in any case, of:    y m d h s - \ / , . : [ ] T   optionally followed by AM/PM 
// for now, if formatString is null, silently punt  and use "General".  Not the best behavior,  but we're doing it now in the streaming and non-streaming  extractors for xlsx.  See BUG-61053 
//  sequence of META_ESCAPE_ENHANCED_METAFILE records. 
//  Must be at least 8 bytes long 
//  A 32-bit signed integer that specifies the size in bytes of the BoundaryPathData field. 
//  Build up the character runs 
/*  Read 8 bytes.  */
//  Get each style record, so we can do deletes 
//  Get a list of the rows in the table 
//  Try first with 512 block sizes, which can hold 128 entries 
//   elapsed time patterns: [h],[m] and [s] 
//  level 4: default text properties in the shape itself 
//  Write in two blocks 
//  sprmPFLocked 
//  formula 1: "=B3=1" (formula is relative to B4) 
//  All sheets should have one row 
//  create ellipse 
//  found end of functions list 
//  records greater then 0xF000 belong to with Microsoft Office Drawing format also known as Escher 
//  -2 bytes for sprm - 2 for size short - 2 to correct offsets being 0 based 
// the first hyperlink now belongs to A5 
// reference name is optional! 
//  BLACK_PEN - A black, solid-color pen   PenStyle: PS_COSMETIC + PS_SOLID   ColorRef: 0x00000000 
//  create picture shape, which need to be minimal modified for oleshapes 
//   may be shared by multiple RichTextStrings! 
// assertEquals(3, notes.length); // When we do slide masters 
//  Jan 1 2010 
//  Get wrong cell by row 8 & column 7 
//  optimization to speed up the search for col infos 
//  from extractMessageBody   from extractAttachments 
//  changing shared formula cell to blank 
//  V6 never has separators 
//  bug 56295: handle missing applyFill attribute as "true" because Excel does as well 
//  test changing a table value, to see if the caches are properly cleared   Issue 59814 
//  Check we can't add one with invalid date 
//                 	logger.log( POILogger.ERROR, "Mismatch in tail byte [" + i + "]"                      		+ "expected " + (expectedTail[i] & 0xFF) + " but got " + (result[i] & 0xFF));                  }              }      	} 
//  The last knot of a spline. 
//  if dialog is returned we can't run the test properly. 
//  This test makes sure that if any caching is done that getTable never uses a stale cache 
//  "/" is escaped for no reason in: mm"/"dd"/"yyyy   replace Excel quoting with Java style quoting   Quote the T is iso8601 style dates 
//  Add some cells so we can test that the anchoring works when we   sort them. 
//             return;          } 
//  Visio's coordinate system is flipped, so flip the image vertically 
// non numeric value 
//  undefined cells never match a VALUE_IS condition 
//  if we're short one add another.. 
//  A 32-bit unsigned integer that specifies the number of indexes in the   color table used by the DIB 
/*          * Signature context construction.          */
//  font size 24 
//  test Zip+4 format 
//  Now process it through eventusermodel, and 
//  196: DVARP 
// modify the link 
//  Now do the transfer 
//  ability to specify that a clear 'border' be placed around the image. 
//  Try to get it without extending the stream 
//  If there is one, does it have a EscherDggRecord? 
//  Do the move 
//  Determine buffer size 
//  Allocate and write 
//  save memory by just using the cell itself as the identity key   Note - this assumes XSSFCell has not overridden hashCode and equals 
//  step underlying RecordInputStream to the next record 
//  signatureConfig.getNamespacePrefixes().get(XML_DIGSIG_NS)); 
//  2 shorts and 4 bytes reserved 
//  no PAPX reconstruction   assertEquals(36, pDefs.size()); 
/*          * Construct the ds:KeyInfo element using JSR 105.          */
//  offset = offset*2;   }   FC = FC+offset;   return FC;   } 
//  ( -Dorg.apache.poi.util.POILogger=org.apache.poi.util.SystemOutLogger) 
//  username in unicode 
/* oneCell     */
//  And the third sheet 
// 3.3	0.8	5.5	5.5 
//  round 
//  Set up a new SlidePersistAtom for this slide 
//  notes 
//  no notes on master 
//  slide 4 
//  delete starting pos in original coordinates 
//  sprmPIstd  
// too large 
//  password is abc 
//  -270 to -360 
//  Check that, in the absence of locale support, we handle 
//  get data as doubles 
//  handled that condition much earlier 
//  PointAtom, assume 1st 4 bytes = X   PointAtom, assume 2nd 4 bytes = Y   PointAtom, assume 1st 4 bytes = X   PointAtom, assume 2nd 4 bytes = Y   RatioAtom, assume 1st 4 bytes = from   RatioAtom, assume 2nd 4 bytes = to 
//   A1 should be R in the FALSE route 
//  use y-scaling for both, reposition x accordingly 
//  moved sheet was below before and is above now => active is one less 
/* pass negative value for left shift */
//  don't write 0x03, stringLen, flag, text 
//  cached formula result calculated by Excel   should agree within 0.01% 
//  Create references 
//  adding the formatting makes it available 
//  draw COLS after we know max column number 
//  Workbook Factory gives helpful error on file 
//  see Bugzilla 47920 
//  string converted to boolean OK 
//  the function's arguments are pushed onto the stack from left-to-right as OperandPtgs 
// Header row 
//  args = new String[] { "--out", "", }; 
//  try setting the same formula in a cell 
//  null test-- null cell should result in empty String 
//  mask is 0x070004 
//  Note - it is more usual to propagate error codes straight to the result like this:   but logical functions behave a little differently   return e.getErrorEval(); 
/* tenthColumn */
//  serialize, read back and check that all images are there 
//  some files are corrupted 
//  NOTE: Creating the endnote does not automatically         create a first paragraph. 
//  Source of this relationship 
//  Document should start with:     0F 00 E8 03 ## ## ## ##       (type 1000 = document, info 00 0f is normal, rest is document length)     01 00 E9 03 28 00 00 00       (type 1001 = document atom, info 00 01 normal, 28 bytes long)     80 16 00 00 E0 10 00 00 xx xx xx xx xx xx xx xx     05 00 00 00 0A 00 00 00 xx xx xx       (the contents of the document atom, not sure what it means yet)     (records then follow) 
//   POIFS any more 
//  write and read again 
//  First 4 bytes - no idea, normally 0   Second 4 bytes - the id of the link (from 1 onwards)   Third 4 bytes - no idea, normally 4   Fourth 4 bytes - no idea, normally 8 
//  4. new index is higher than old one => sheets get moved down 
//  Each attachment should have 6 attributes 
//  but it is still part of the group 
//  NO-BREAK SPACE 
//   to ourselves 
// we can calculate the preferred size only for JPEG, PNG and BMP  other formats like WMF, EMF and PICT are not supported in Java 
//  Now try to build the property set 
//  Write and read 
//  XAdES-X Type 1 timestamp 
//  lookup and result column are different 
//  padding byte 
//  Mini Stream FAT   Mini Stream data   Properties gone 
//  Broken properties? 
//  setting cap to null unsets the Cap attribute 
//  Message MAPI 
//  Grab the 4 byte value that tells us what properties follow 
//  Save and reload 
//  if 
//  Probably incorrect - comparing Object[] arrays with Arrays.equals 
//  TestWordToConverterSuite.class, 
//  Still to go:    (0x03)Internal    Objects 
//  Try to add before a mid-record 
//  why was this column group added? 
//  OEM_FIXED_FONT - A fixed-width, OEM character set   Charset: OEM_CHARSET   PitchAndFamily: FF_DONTCARE + FIXED_PITCH 
//  Try to use the value as a formattable number 
//  forth picture 
//  just in case - not a typical possibility 
//  First we have a 8 byte atom header 
//  colfield should be added for the second one. 
//  key size for rc4: 0x00000028 - 0x00000080 (inclusive) with 8-bit increments 
//  Do a lookup for a match in UCS_RANGES 
//  created 
//  comments on frompart/topart taken from pkgVisio 
//  http://asserttrue.blogspot.de/2010/01/how-to-iimplement-custom-paint-in-50.html 
// 			} 
//  Need to trim off the alpha 
//  index 
// +1 for 1-based, +1 for next row 
//  Grab the text and tabs of the text run   Do so in a way that preserves the ordering 
//  Currently, we don't need to do anything special once   all the chunks have been located 
//  Grab the data block 
//  Now add a formula that refers to yet another (different) workbook 
//  Slightly irregular logic for bounds checking errors 
//  "TEST" 
//  even row 
//      cell will have no borders. 
// end column of the break 
//  All 
//  landscape mode 
//  x.xx% 
//  fetch the first merged region...EXCEPTION OCCURS HERE 
//  Some files have crazy ordering of their continue records   Check that we don't break on them (bug #42844) 
//  We can't find it, so add it as a new one 
//  Save and check 
//  Reset things 
// length of the label 
//  Step through the ArrayList of MultilLevelListItem instances. 
//  avoid tracking dependencies to cells that have constant definition 
//  Check the duplicate 
/* no instances for static classes */
//  "E"   0 
//  Mock up a spreadsheet to match the critical details of the sample 
/*  Compare the property set stream with the corresponding one         * from the origin file and check whether they are equal.  */
//  is sheet dialog sheet   whether to apply automatic styles to outlines   whether summary rows will appear below detail in outlines   whether summary rows will appear right of the detail in outlines   whether to fit stuff to the page 
//  circle div 8: 360 / 8 = 45 
//  Header isn't FAT addressed 
//  Java RegExps are unhelpful, and won't do multiple group captures 
//  At the end of a row, handle any comments for "missing" rows before us 
//  and the adjustable arrow cap object has a height of 3, the actual arrow cap is drawn 15 pixels high. 
//  skip bottom frames (part of junit framework) 
//  If only name2 is __XXX then this will be placed after name1 
//  An array of RegionNodeCount+1 EmfPlusRegionNode objects. Regions are specified as a binary tree of   region nodes, and each node MUST either be a terminal node or specify one or two child nodes. 
//  Now, parse all our QC Bits 
//  First child should be the atom 
//  SmallRectStruct 
//  Add a sheet and re-order 
//  Setup our child records 
//  this should now fail to insert 
//  invoking from cell A4 
// setting border to none removes the <left> element 
//  And now make it bold 
//  no need for an accessible constructor 
// must handle sheets with quotas, see Bugzilla #47294 
//  write out the FileInformationBlock. 
//  marshal the XAdES-T extension 
//  restore file order of PAPX 
//  Create or Update the Property Set stream in the POIFS 
//  And passed it 
//  message bodies, saved as plain text (PtypString)   The first short (0x1000, 0x0047, 0x0037) refer to the Property ID (see [MS-OXPROPS].pdf)   the second short (0x001e, 0x001f, 0x0102) refer to the type of data stored in this entry   https://msdn.microsoft.com/endatatypes.Ex-us/library/cc433490(v=exchg.80).aspx   @see org.apache.poi.hsmf.Types.MAPIType  PidTagBody ASCII  PidTagBody Unicode  PidTagMessageSubmissionId ASCII  PidTagMessageSubmissionId Unicode  PidTagSubject ASCII  PidTagSubject Unicode 
//  Save content type part. 
//  check the rest; 
//  Check it took those 
//  reset setting to not affect other tests 
//  18 @ 122 
/*          *  SET Intermediate3 TO Intermediate1 BITWISE OR Intermediate2          */
/*  Yes, the current document is a property set stream.                         * Let's create a PropertySet instance from it.  */
/* XSSFFont font = */
//  cloning again and removing the conditional formatting makes it good again 
//  Setup as a copy of a known-good file 
//  System.err.println("Section " + x + " was " + sepx.getStart() + 
//  Extract and check 
//  Work out what version we're dealing with 
// getting a sheet by invalid index or non-existing name 
// Need to clear the current formatting between the startIndex and endIndex 
//  At what point are records continued?    - Often from within the char data of long strings (caller is within readStringCommon()).    - From UnicodeString construction (many different points - call via checkRecordPosition)    - During TextObjectRecord construction (just before the text, perhaps within the text,      and before the formatting run data) 
//  discard master if same as base 
//  this will only save the very last record of each type 
/*  @see <a href="https://msdn.microsoft.com/en-us/library/dd907599(v=office.12).aspx">XOR Obfuscation</a>  */
//  Do the auto-size 
//  Digits at the end of a function might be due to a left-over footnote marker.   except in these cases 
//  check for emf+ embedded pdf (poor mans style :( )   Mac Excel 2011 embeds pdf files with this method. 
//  Now check the IF formulas 
//  To determine size of aggregate record we have to know size of each DrawingRecord because if DrawingRecord   is split into several continue records we have to add header size to total EscherAggregate size 
//  same results in leap years 
// continue to dump child records 
// from a real file 
//  Save in-place, close, re-open and check 
//  else source rows include none of the rows of the area ref   check for clashes with destination 
//  Currently has a Macros stream 
//  An 8-bit unsigned integer that specifies the output quality. The output quality defines how closely   to attempt to match the logical-font attributes to those of an actual physical font. 
// check changes in the underlying xml bean 
//  Gets the core properties 
//  Create a test font and style, and use them 
//             nvp.setHidden(true); 
//  Starting with a multiple selection, and different active sheet 
/*  char 11  */
//  Type: 1f  Addr: 01540004  Offset: 347f  Len: 8e8  Format: 46  From: 4312 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getErrorStyle()      */
//  -90 to -270 
/*      * Open <em>doc2</em> for reading and check summary information and     * document summary information. All properties written before must be     * found in the property streams of <em>doc2</em> and have the correct     * values.      */
// Can we make this shorter? 
//  only one that ends in '?' 
//  Get the slide size type 
//  The y-coordinate of an arc's control point relative to the shape's width. 
//  get the only row 
//  current implementation can't return null 
//  for row 
//  the evaluation did not encounter errors 
//  And it should be of something interesting 
//  It is a series of date parts 
// we are still an array formula 
//  an attempt to register an existing format returns its index 
// two level 
//  Find the children of 0x4312 
//  value changing 
//  If we're now at 8 codes, output 
//  The polyline formula 
//  includes special non-name control characters like ! $ : , ( ) [ ] and space 
//  To get the attachments, use ExtractorFactory 
//  Dump 
// to the Height field in the LogFont object in the LogFont field. 
//  If it's clearly junk, bail out 
//  row-level policies 
//  the number of columns that have AutoFilter enabled. 
//  confirm formula parsing is case-insensitive 
//  it after we write everything else. 
// c = r.getCell((short)1);  assertTrue("expected: A!A1+A!B1 got: "+c.getCellFormula(), ("A!A1+A!B1").equals(c.getCellFormula())); 
// assertFalse("column absolute/relative is undefined", ref.isColAbsolute()); 
//  Size the initial cell list such that a read only case won't waste    lots of memory, and a create/read followed by adding new cells can 
//  specified by this rectangle is scaled to fit the destination rectangle specified by the RectData field. 
//  A 16-bit signed integer that defines the height/width, in logical units, of the region frame. 
// Test 2D and 3D Area Ptgs (Pxg for OOXML Workbooks)   Note: absolute row changes from last cell to first cell in order 
/*          * not fully conform to specification, but the fastest way to make it         * work. Shall be rewritten if any errors would be found -- vlsergey          */
//  and assert that POI reads them equally: 
//  size=0x0006   unused 
//  Process each record as they come in 
//  From DXA to DXA: (value should be unchanged) 
//  Note - the expected result row coordinates here were determined/verified   in Excel 2007 by manually testing. 
//  do nothing 
//  Fetch all the problems 
// TestCellRangeAddress.class, //converted to junit4  TestCellReference.class, //converted to junit4 
//  Add a cell, things move off -1 
//  Working with new StyleTextPropAtom 
/*  The Word spec has a much smaller list of "valid" values             * to what the large CommonCrawl corpus contains!              */
//  skip over the decimal point itself 
//  Loop over child records, looking for interesting ones 
//  cache for performance: ~30% speedup due to caching 
//  Insets are already applied on DrawTextShape.drawContent 
//  Write out, re-load 
//  a previous rule matched and wants no more evaluations 
//  Grab the children's data 
//  when dates are equal, result is zero 
//  leave fields un-set 
//  sRGB has a gamma of 2.2 
//  Icons : 3 stars (ext) - Column Q   TODO Support EXT formattings 
//  Normal 
// create sheet 
//  Styles exist in the test document in this order, EmptyCellLayoutStyle   is missing a StyleId 
//  Change one on each 
//  Xor-Password: abc   2.5.343 XORObfuscation   key = 20810   verifier = 52250 
//  caused NPE prior to fix of Bugzilla #48916 
//  With a simple 512 block file 
//  See comment in writeScientific -- exponent handling is complex.   (1) When parsing the format, remove the sign from after the 'e' and   put it before the first digit of the exponent. 
//  The default case is to sort names ignoring case 
/*  Write second word.  */
// &P == current page number 
//  keep first 
//  Because $, :, and ! are disallowed characters, A1-style references become just a letter-number combination 
//  A string of 64 Unicode characters that contains the font's full name.   Ifthe length of this string is less than 64 characters, a terminating 
//  And another, things change 
//  reset strategy to re-create the directory 
//  wind up and find the root master sheet which must be slide master 
//  And the drawing bit 
//  Try with a few less usual ones: 
//  Other file 
//  fix ordering in the low-level xml 
//  Re-check 
//  also try metadata 
//  Create the slideshow object, for normal working with 
//   the parent ones 
//  Note - zero sid is somewhat unusual (compared to plain Records) 
//  Try to figure out the type 
//  can hold 
//  Do not try to read encrypted files 
/*  this field MUST be 0x0001 for add-in referencing  */
//  need to wrap checked exception, because of LittleEndianInput interface :( 
/*  End OPC Compliance  */
//  re-order for sheet "third" 
//  Check we're adding row and cell aggregates 
//  portrait orientation 
//  add the section descriptor bytes to the PlexOfCps. 
//  error handling is as if the x is fully evaluated before y 
//  Matched for so long, but no more 
//  https://stackoverflow.com/questions/21855842   https://stackoverflow.com/questions/39636138 
//  Do NOT return before done reading all the structured reference tokens from the input stream. 
//  Set to 0 
//  NOSONAR   NOSONAR 
//  No children, wind on our real length 
// JMH: Why +1, hell why not. I guess it made some sense to someone at the time. Doesnt  to me now.... But experience has shown that when the fore is set to AUTOMATIC then the  background needs to be incremented...... 
//     {        tabMap.remove(Integer.valueOf(LittleEndian.getInt(grpprl, offset)));        offset += LittleEndian.INT_SIZE;;      }        int addSize = grpprl[offset++]; 
//  when there's a dual storage entry, use it, as the outer document can't be read quite probably ... 
//  setting sheet name later 
//  Add a formula that refers to one of the existing external workbooks 
//  5th Feb 2012 = 40944   1st Feb 2012 = 40940   5th Jan 2012 = 40913   5th Dec 2011 = 40882   5th Feb 2011 = 40579 
//  Is it on our Workbook? 
//  To prevent an exception being thrown when the required width of 
//  ignore duplicates 
//  The magic for EMF parts, i.e. the byte sequence for "WMFC" 
//  commented out the cells overlap implementation, it caused endless loops, see Bug 55380   disabled for now, the algorithm will not detect some border cases this way currently!  return resolveRangeOverlap(range1, range2); 
//  Don't close re-used test resources here 
//  Read the properties in there 
//  Now grab the trailer 
//  Normally will never been invoked with the previous   implementation rule [M1.9] 
//  Cell show "12月8日" 
//  Check after save 
//    RtfCompressed -> {\rtf1... 
//  we style the second cell as a date (and time).  It is important to create a new cell style from the workbook 
//  see bug 55982, quite a number of documents do not have a TabIdRecord and   thus there is no way to do the fixup here,   we use the same check on Tabpos as done in other places 
//  Now make the 4th bold, italic and not underlined 
//  note - the compressed flag may change on the fly 
// set column widths, the width is measured in units of 1/256th of a character width 
//  Should have 6 relations:     1 external hyperlink (skipped from list)     4 internal hyperlinks 
//  then also do the same for some valid date formats 
//  then do the actual moving and also adjust comments/rowHeight   we need to sort it in a way so the shifting does not mess up the structures, 
//  left aligned   line spacing 80 
//  New file 
//  Font color is handled with the other colors 
//  Tweak existing one again, to ensure really worked 
//  TODO: use EmfPlusHatchBrushData 
//  is this font in italics 
//  when a bit further apart - normal results 
// private final byte mask1;  private final byte mask2; 
//  No column found, it's again a special column that accepts formulas. 
//  Go looking for our interesting child    streams 
//  Check if the part name URI is empty [M1.1] 
//  Cosine ArcTan Formula: "cat2 x y z" = (x * cos(arctan(z / y) )) = value of this guide 
// Trying to find reference to this sheet 
//  Get the IDs of the master and notes 
//  clear all the logging from the above initialisation 
//  first char run is 21 long 
//  an alternative would have been to for non-base Ptgs to set their operand class   from their default, but this would require the call in many subclasses because   the default OC is not known until the end of the constructor 
//  character run is 25 long   char flags 0x060000 
//  Has one author 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getPromptBoxText()	  */
//  delete end point in original 
//  B1:INDEX(B1:B3,2) evaluates to B1:B2 
//  formula is a StringEval if the validation is by a fixed list.  Use the explicit list later. 
//  A 32-bit field that is not used and MUST be ignored. 
//  Add multiple border properties to cell should create a single new style 
//  Alter 
//  sprmCPicLocation -- 0x6A03 
//  negative length 
//  Level one, id 36870, type 8 
//  Swap it over 
//  1979 is one year before our pivot year (so this is an expected "failure") 
//  only for far east  always 0 in US 
//  additional to avoid 2 
// ref (6 bytes) not used... 
// if there was a problem with the guessed charset and the length of the  textpiece, back off to win1252. This is effectively what we used to do. 
// now the span is splitted into 5 individual columns 
//  = 2007-06-20T20:59:00-13:00 
//  Has 8 number formats 
//  Does need preserving on the 2nd part 
//  Findbugs: URF_UNREAD_FIELD . Do not delete without understanding how this class works.  private HSSFSheet sheet; 
//  new records don't need a mapping, as they aren't in a relation yet 
// left edge of the chart  25% of chart's height from top edge of the chart 
//  Now the cell is all black 
//  Freeze the columns and rows (forget about scrolling position of the lower right quadrant). 
//  Now check in detail 
//  see bug 62839 
//  Will always show up 
//  it's important to create the referenced sheet first 
// test file based on http://oss.sheetjs.com/test_files/RkNumber.xlsb 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getErrorStyle()	  */
// YK:  failed until Bugzilla 53414 was fixed 
//  continue record 
// return a "singulariry" if ImageIO failed to read the image 
// need for dotted borders to show up east 
//  short, byte, byte 
//  always use the first sheet 
//  Might be caused by some tokens like AttrPtg and Mem*Ptg, which really shouldn't   put anything on the stack 
//  If one or more functions fail, a single AssertionFailedError is thrown at the end 
//  The column in the DB to apply the condition to. 
//  field to store the hotspot diagnostic MBean 
//  series index   series number 
//  and/or distinguishing between tExp and tTbl. 
/*      * Returns true if the shape has a drawable geometry associated with it      */
//  First up, a simple file with string    based formulas in it 
//  Is it already there? 
//  calculate radii of ellipse 
//  fill is not set 
//  Excel counts column A as the 1st column, we    treat it as the 0th one 
//  Convert to little endian unicode 
//  None found, and not allowed to add in 
//  EmfPlusPathGradientBrushData object. 
// check range bounds against grid max 
/*              * while MAX_ID is Long.MAX_VALUE, this check is pointless. But if             * someone subclasses / tweaks the limits, this check is fine.              */
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationHelper#createDecimalConstraint(int, java.lang.String, java.lang.String)	  */
//  place comment in B2, according to Bug 54920 this removes the comment in A1! 
//  marks the start of a list of area expressions which will be naturally combined   by their trailing operators (e.g. UnionPtg) 
//  No header is set (yet) 
//  a completely different type of file 
//  convert 2-d to 1-d array (row by row according to getValueIndex()) 
//  A 32-bit unsigned integer that specifies the number of bytes in the EMF stream that remain to be   processed after this record. Those additional EMF bytes MUST follow in the EnhancedMetafileData 
//  store everything from end of last match to start of this match 
//  This unit test assumes that the user's locale isn't ja-JP and timezone isn't Asia/Tokyo   If this is the case, change the values to something else 
//  paragprah is 28 long   paragraph reserved field 
// could make sure this is larger than currentRow, according to spec? 
//  1-based index of a line style within the style matrix 
//  bug 33160 
/*  Read all documents from the original POI file system and compare them         * with the equivalent document from the copy.  */
//  don't copy default style (style index 0) 
//  By byte 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#setEmptyCellAllowed(boolean)	  */
//  This value MUST be composed of CustomLineCapData flags 
//  Open the package 
//  Figure out the number we hold 
//  assert that the calculated value agrees with   the cached formula result calculated by Excel 
//  Fonts are theme-based in their colours 
// the check below failed prior to fix of Bug #47862 
//  remove stroke 
//  paragraph is 25 long 
//  Biff 2 / Excel 2, pre-OLE2   Biff 3 / Excel 3, pre-OLE2   Biff 4 / Excel 4, pre-OLE2   Biff 5 / Excel 5   Biff 5 / Excel 5   Biff 5 / Excel 95   HSSFWorkbook cannot open it as well 
//  for the streaming-variant we need to enable autosize-tracking to make it work 
//  Try to add a formula for a new external workbook, won't be allowed to start 
//  Range 
//  test phone number format 
//  We don't know all we need to about this font   Since we don't know its sizes, we can't work with it 
//  changing from plain cell to formula cell 
//   sprmCFUsePgsuSettings 
// create a combobox control for each column 
//  A y-coordinate of a point on an infinite line; paired with x-coordinate 
//  E1, MID is used in the FALSE route, so:    A1 should be V in the IF check 
//  set HH:MM:SS fields of cal to 00:00:00:000 
//  Test Comment.equals and Comment.hashCode 
//  Note - don't change built in fonts (those before 5) 
// Strings are equal, and there are no formatting runs. -> 0  Strings are equal, but one or the other has formatting runs -> 1 
//  lookup and result row are the same 
//    Moving many to a later point in the array   
// Make sure that we now say that we are a rich string 
// test various date formats 
//  From [MS-XLS].pdf 2.5.147 FtLbsData: 
//  Update with the new end 
//  Hypothetical setup of PSB records which should cause POI to crash 
//  create date-formatted cell 
//  verify limits-check 
//  It's been overriden, use that value 
// main part 
//  check for an existing cluster, which has space available   see 2.2.46 OfficeArtIDCL (cspidCur) for the 1024 limitation   multiple clusters can belong to the same drawing group 
//  One without, from the top 
// the third slide uses per-slide headers / footers 
//  ignore adding a comma after a deleted char (which was a '#') 
//  4 shorts 
//  3 short fields + array of shorts 
//  must be present, see Bug 51481 
//  field_8_adtl_palette_options bit map 
//  99 is our FAT block 
//  an unknown record with 0 length   a continuation record with 3 bytes of data 
// test our maximum values 
//  Grab the bytes of the file 
//  Rows moved were originally *completely* within the area ref 
//  For now, set the anchor type to do not move or resize the   image as the size of the row/column is adjusted. This could easily   become another parameter passed to the method. Please read the note 
// count of bytes in the address including the tail 
// Add the new sheet to the tabbed pane 
//  first set the TabStops in the Master sheet 
//  now ( '%' HEXDIGIT HEXDIGIT) 
//  Must be for a real slide 
//  map some files without extension 
//  one special case of ScalarConstantPtg 
//  1-based IDs 
//  Which big block is this? 
//  encoded as a SMTP destination in there. 
// far from Excel's calculations 
//  wrap around in converting a VERY large long to an int 
//  TODO: read the content type from CombObj stream 
//  TODO: throw appropriate exception 
//  all other Ptgs are immutable and can be shared 
//   should terminate if the type isn't 0xf007 or 0xf018->0xf117 
//  _fib.getLcbPlcspaMom(), getTextTable().getTextPieces()); 
//  We don't currently process the glossary itself   Until we do, we do need to load the glossary child parts of it 
//  Now with a simple 4096 block file 
//  If we have a mutable output stream, take advantage of that 
//  standard property flags, defined in the spec 
//  row, col, xfIndex   #DIV/0!, isError 
//  all expanded 
//  hash > sha1 doesn't work in excel viewer ... 
//  sprmPShd  -- 0xc64d  
//  double; incorrect format 
//  Now without, will have text 
//  map from patterns for mimetypes to the FileHandlers that should be able to   work with that file   use a Set<Pair> to have a defined order of applying the matches 
//  Complex data follows 
//  first copy the source xml 
//  shortcut evaluation if reference is outside the bounds of existing data 
//  we partially matched the pattern before encountering a non matching byte   we need to serve up the buffered bytes before we go back to NOT_MATCHED 
//  For some reason, we have to remove the hyperlinks one by one from the CTHyperlinks array   before unsetting the hyperlink array.   Resetting the hyperlink array seems to break some XML nodes.  worksheet.getHyperlinks().setHyperlinkArray(new CTHyperlink[0]); 
//  Check to see whether the image should occupy an exact number of   rows. If so, build the ClientAnchorDetail record to point   to those rows and with an inset of the total number of co-ordinate   position in the row.     To overcome problems that can occur with comparing double values for   equality, cast both to int(s) to truncate the value; VERY crude and 
//  paragraph is 54 long   (paragraph reserved field) 
//  Is it either Multi-Valued or Variable-Length? 
//  Lots of paragraphs with only a few lines in them 
//  valid number formats 
//  We can see 2 by type 
//  Check the evaluated result 
//  whitespace gets deleted because formula is parsed and re-rendered 
//  set the remaining active/selected sheet 
//  Sheet 1 A5 is to another sheet 
//  Open from a Stream 
//  by default no such actions needed 
//  References to try 
//  Ensure this is one of ours 
//  First page footer is optional, only return 
//  _rows.getLastKey() (O(logN)) or caching last row (O(1))?   A test with 1_000_000 rows shows that querying getLastRowNum with lastKey() implementation takes ~40 ms,   and ~1.2 ms with cached implementation. 40 ms is negligible compared to the time of evaluation a million   cells, and the lastKey implementation is much more elegant and less error prone than caching. 
//  bitfields for border options 
// left  top 
// fcMin = _fib.getFcMin() 
// the number of merged regions remains the same 
//  line end length 
//  The resoultion of an image can be expressed as a specific number   of pixels per inch. Displays and printers differ but 96 pixels per   inch is an acceptable standard to beging with. 
//  Get row that already exists 
//  note however that the cached formula result (2) has not been updated. (POI differs from Excel here) 
//  If any ExternalBookBlock present, there is always 1 of ExternSheetRecord 
//  The only other formatting convention this class obeys is the UNIX one   where any occurrence of the field separator or EOL character will 
//  dest columns overlap bottom of area   - truncate the bottom 
//  need to throw away all evaluations, since we don't know how value changes may have affected format formulas 
//  sum of all values in the 1st column: 1 + 4 + 7 = 12 
//  An empty SlideShow 
//  protected int verifierHashSize; 
// noinspection UnusedDeclaration 
// do Ole stuff 
//  Check we got another BAT 
//  What the next mask byte to output will be 
//  Non-required hyphens to zero-width space 
// try adding empty rows in an existing worksheet 
//  How many do we have? 
/*  documents with multiple edits need to be normalized for encryption  */
//  we assume the cell has been evaluated, and the current formula value stored 
//  Shift rows 6 - 11 on the spreadsheet to the top (rows 0 - 5) 
//  unset any existing text 
//  These two format calls return the same thing, as expected: 
//  0.5" 
//  Once the line is built, write it away to the CSV file. 
// stub object to throw off list INDEX operations 
//  Skip the header row 
//  $B$1:$B$8 
//  With the password, is properly processed 
// update formulas on other sheets 
//  +2 for INDEX and DBCELL 
//  (At least, not unit we fix bug #56752 that is) 
//  http://en.wikipedia.org/wiki/Internal_rate_of_return#Example 
//  But not from the others 
//  http://arachnoid.com/lutusp/finance.html 
//  (the fields as they appear in the raw record:) 
//  Change 2nd to different size and font 
//  See bug 59958: Add cells on the fly to the evaluation sheet cache on cache miss 
//  A 32-bit unsigned integer that specifies the number of focus scales. This value MUST be 2. 
//  A1:E1 should be moved to A2:E2 
//  Data 
// collect cells holding shared formulas 
//  the added font is the last in the list 
// or compare the hashes of the attachment data 
// unset highest bit  unset highest bit (if it exists?) 
//  Excel 2010 gives 0.775280898876405 
//  Rows are 1 to 713 
//  Check it  
//  Skip to the right place in it   (It should be positioned already at the start of the block, 
//  And allocate the XBAT in the BAT 
//  Now start on cells 
//  Must be at least 16 bytes long 
//  second arg converts to int by truncating toward zero 
//  slightly more complex one failed 
//  "0.060000000000000005" 
//  fails as of POI 3.1 
//  setup the stroke for this line 
// Test 2D and 3D Ref Ptgs with absolute row 
//  Now onto the cells 
//  Using streaming XSSFWorkbook makes the output file invalid 
// num lines  selected 
//  And check a few low level bits too 
//  salt size 
//  Move this sheet at the first position 
//  This rectangle is applied to the text output performed by the containing record. 
//  mask is 0x1800   right aligned 
//  first scan the slide relations 
//  Check x, y, width, height 
//  Initialize _txtrun object.   (We can't do it in the constructor because the sheet    is not assigned then, it's only built once we have    all the records) 
// Set the third column as filter 
//  correct behaviour 
// Need to sort the font runs to ensure that the font runs appear in  character order 
//  Extractor primed on the 1 page but text-box'd test data 
//  314: STEYX 
//  Do we read or map (for read/write)? 
//  The value MUST be in the XHeight enumeration table. 
//  1d shapes are interesting, they create connections 
//  Dummy content again 
// {--------------------------------------------------------------}  { Parse and Translate an Assignment Statement } 
//  First slideId is always 256 
//  Reset the text on a shared paragraph+character 
//  Turn the list into an array 
/*              * This is a seriously sick fix for the fact that some .xlsx files contain raw bits             * of HTML, without being escaped or properly turned into XML.             * The result is that they contain things like &gt;br&lt;, which breaks the XML parsing.             * This very sick InputStream wrapper attempts to spot these go past, and fix them.              */
//  Each mapping in this Map has a key consisting of a   DocumentDescriptor and a value consisting of a Set of   POIFSReaderListeners for the document matching that   DocumentDescriptor; used when a document is found, to quickly 
//  just the TXO record 
//  General container record handling code 
//  An 8-bit unsigned integer that specifies an italic font if set to 0x01; 
//  this sometimes caused exceptions 
//  FILEPASS 
//  similar to tAttrSpace - RPN is violated 
//  this is a new error. ok to throw 
//  Again with Java style 
//  Date 
// 0x20, 0x40, 0x60   0x21, 0x41, 0x61  0x22, 0x42, 0x62   0x23, 0x43, 0x63   0x24, 0x44, 0x64   0x25, 0x45, 0x65   0x26, 0x46, 0x66   0x27, 0x47, 0x67   0x29, 0x49, 0x69   0x2a, 0x4a, 0x6a   0x2b, 0x4b, 0x6b   0x2c, 0x4c, 0x6c   0x2d, 0x4d, 0x6d 
// id of the created border 
//  Then the mask field 
//  x   y   width   height 
//  Do the normal format 
//  For zero, should be Space + currency symbol + spaces + Minus + spaces 
// set proxy info if any 
//  carry up due to rounding   For clarity these tests choose values that don't round in java,   but will round in excel. In some cases there is almost no difference 
//  _row.cArray and _cells.getCTCell might be out of sync after adding/removing cells,   thus we need to re-order it here to make the resulting file correct 
/*              * Custom properties enable users to define custom metadata properties.              */
//  Intentionally ignore the last column (tika-1132), for now 
//  Create a cell and put a date value in it.  The first cell is not styled as a date. 
//  For logging 
/*  high ansi  */
//  Merge hyperlink - since srcCell doesn't have a hyperlink, destCell's hyperlink is not overwritten (cleared). 
//  If it's a FILEPASS, track it specifically 
//  Check there's still data left to read 
//  Then we need to clone the format string, 
//  Copy directories 
// multiply by 128^i 
//  Page 54 of public specification begins 
//  Adding / changing 
//  "B"   "C"   "F"   "L"   "N" 
// YK: Excel 2007 leaves this field unset 
//  Keep going if not yet at end 
// EscherDgg is a document-level record which keeps track of the drawing groups 
//  21.17 cm / 2.54 cm/inch * 72dpi * 20 = 12000   15.88 cm / 2.54 cm/inch * 72dpi * 20 = 9000 
//  else - bottom area column has been replaced - both area top and bottom may move now 
//  or PNG image buffer, respectively. 
//  Now try with a few sample files 
//  Fake from the 8 bit version 
//  boundaries. 
//  first remove encryption 
//  Now the file versions, 2+1+1 
//  if the attribute does not exist, the slide is shown 
//  currently for testing only - needs review 
/*  Create a mutable property set and write it to a POIFS:  */
//  represented by the Y cell. 
//  column C: $#,##0.00 
//  and, naturally, produces a NUM_ERROR 
//  positons there are per millimetre 
// !! Handle fractions: The previous set of digits before that is the numerator, so we should stop short of that 
// 		XWPFDocument document = createDocumentFromSampleFile("test-data/document/documentProtection_no_protection.docx"); 
//  set localeIsAdapting so subsequent checks perform correctly   (whether a specific locale was provided to this DataFormatter or DataFormatter should 
//  following wont work properly 
//  0 as a fraction is reported by excel as 0/1 
//  Tick bullets 
//  test all possible characters 
//  this data seems to have 2 extra bytes of padding more than usual 
//  no instances of this static class 
// It _should_ be 0x00010000 
//  Free it 
//  font.color only   red 
//  wait for all threads 
//  right 
//  Make sure other rows are blank (off-by-one errors) 
//  percent of a text quantity 
// Voila! we created a workbook from the embedded OLE data 
//  Ignore the next 24, for now at least 
//         {   
//  need preceding Text[Chars|Bytes]Atom to initialize the data structure 
//  create cells with good date patterns 
//  Normal bullet points 
//  This slide lacks notes   Not all have them, sorry... 
//   add a bit without needing a resize 
//  note - Character.isJavaIdentifierPart() would allow dollars '$' 
//  Try adding a format beyond the upper limit 
//  the bug is that the following relation is gone 
// macro comes from Common Crawl: HRLOXHGMGLFIJQQU27RIWXOARRHAAAAS 
//  Check we got bits from the main message 
//  And should have lots of children 
//  data written after the all tokens:   column, row 
//  Gathers characters as they are seen. 
//  Used to blow up with an IllegalArgumentException    when creating a FileSharingRecord 
//  text-extraction is not possible currently for these types of files 
/*  govdocs1 064213.doc-0.emf contains an example of extextouta  */
//  create a new file input stream with the input file specified   at the command line 
//  we used to process the data via a PushbackInputStream, but user code could provide a too small one   so we use a BufferedInputStream instead now 
//  Check they're still there 
//  getVerticalAlignment should return either an XWPFVertAlign enum or null if not set 
//  An 8-bit unsigned integer that specifies the serif style. 
//  Note - SharedFormulaRecords are currently not re-serialized by POI (each is extracted 
//  single quotes (') are encoded as ('') 
//  cat axis 2 (lines) 
// now try turning them off 
//  deliberately over-size   16 chars 
//  Now set it to not bold 
//  Figure out the Hyperlink type and destination 
//  As per the constructor contract, always close the stream 
//  The x-coordinate of the ending vertex on an arc relative to the width of 
//  Somewhat user facing getters 
//  TODO: initialize headers 
//  this will be done, when the paragraph is saved 
//       _pap = new ParagraphProperties();        _chp = new CharacterProperties(); 
//  Validate 
// sort found records by offset.  (it is not necessary but SlideShow.findMostRecentCoreRecords() expects them sorted)   offset -> record   offset -> persistId 
//  Check if the specified part name already exists 
//  move keyinfo into the right place 
//  Embedded objects stored in storage records in the document stream, lazily populated. 
//  Unprotected, no password given, opens normally 
// 		System.err.println("'"+text.substring(text.length() - 40) + "'"); 
// arbitrarily set, may need to increase 
//  expected here because create() in this case expects an object of type "OPCPackage" 
//  document summary stream   from test1-excel.doc attached to Bugzilla 52337 
//  shifted rows 
//  followed by the grpprl 
//  Use the default logger if none specified, 
//  Now check we can turn all the numeric 
// red is the index to the color scheme 
//               existing = getCipher(skey, header.getCipherAlgorithm(), header.getChainingMode(), header.getKeySalt(), encryptionMode, padding);            } 
//  make sure POI properly truncates the ObjRecord data 
//  Happens only as a result of a call to FormulaParser.parse(), with a non-built-in function name 
//  A 32-bit unsigned integer that defines the vertical coordinate value of the rendering origin. 
//  Check a couple at random 
//     throw new IllegalArgumentException("srcRows must contain continuously increasing row numbers. " +              "Got srcRows[" + (index-1) + "]=Row " + prevRow.getRowNum() + ", srcRows[" + index + "]=Row " + curRow.getRowNum() + ".");   FIXME: assumes row objects belong to non-null sheets and sheets belong to non-null workbooks. 
//  Can't go off the end 
//  Set up some data and the formula 
//  resize the shape to fit text 
//  adjust all the affected comment-structures now   the Map is sorted and thus provides them in the order that we need here,  
//  Turn the vector into an array, and return 
//  ... group shapes have their own getXfrm() 
// 			stream.close();  		}  	} 
//  PowerPoint seems to store files with \r as the line break 
//  OLE Name hasn't been specified, pass the input through 
//  ii-CN, ja-JP, ko-KR, zh-CN,zh-HK, zh-MO, zh-SG, zh-TW 
// Mock value 
//  Two sheets -> two notes   Note: there are also notes on the slide master 
//         // If there's no PlcfHdd, nothing to do 
// check if template's merged regions are OK 
//  Has two children 
//  bits 4-5 reserved 
//  Send the POIFSFileSystem object out to the underlying stream 
//  scale window bounds to output bounds 
//  Past the end 
// COPIED FROM https://svn.apache.org/repos/asf/poi/trunk/src/ooxml/java/org/apache/poi/xssf/usermodel/XSSFCell.java since the functions are declared private there 
//  if all crop values are zero (the default) then no crop rectangle is set, return null 
//  A 32-bit signed integer that specifies the width in pixels of the area occupied by the bitmap. 
//  2010/06/17 23:52:19 GMT 
// unused (2 bytes as we're using double-byte chars) 
//  A 32-bit signed integer that specifies the height of the horizontal brush stroke, in logical units. 
//  v2 version opcode   version number of new picture 
//  not sure if 'equals()' works when url has a directory 
//  32767 is okay 
//  for formula cells we compute the cell width for the cached formula result 
//  string startPos 
//  The stream at 0x347f has strings   The stream at 0x4312 has a pointer to 0x347f   The stream at 0x44d3 has a pointer to 0x4312    (it's the 2nd one of 3, and the block is compressed) 
//  set the sheet name to HSSF Test 
//  anything but column A 
// this is necessary to prevent overflow in the maxDenom calculation 
//  \u2122 is the encoding of the trademark symbol ... 
//  some scrap left over, if nAvailable > 0?   ex45582-22397.xls has one extra byte after the last record   Excel reads that file OK 
//  check the upper edge of the IntPtg range: 
//  Now check the real ranges 
//  Create a file with a 2gb entry 
//  Should be 26bc bytes un-compressed 
// This test forces the loading of CTMoveBookmark and  CTMoveBookmarkImpl into ooxml-lite. 
/*  unsignedSigProps =  */
//  non-even division of _workbook_size, also non-even division of   any block size 
//  Have it setup, with suitable defaults 
//  plain cell ref, col is in range 
//  No notes for this slide 
//  A 32-bit signed integer that defines the height of the DIB, in pixels.   This value MUST NOT be zero.   - If this value is positive, the DIB is a bottom-up bitmap,     and its origin is the lower-left corner.     This field SHOULD specify the height of the decompressed image file,     if the Compression value specifies JPEG or PNG format.   - If this value is negative, the DIB is a top-down bitmap, 
//  Default drawingNumber = #drawings.size() + 1 
//  The commented out ones haven't been tested yet or aren't supported   by HSSFSimpleShape. 
//  Build and decompress the Chp if required 
//  Simple case - single link from wbA to wbB 
//  We have one BAT at block 99 
//  sprmCIcoBi 
//  sprmTCellPaddingDefault -- (0xd634)   TODO: extract into CSSA structure 
/*          * plcfbteChpx (bin table for CHP FKPs) Written immediately after the         * previously recorded table. This is recorded in all Word documents.         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 24 of 210          */
//  nothing to do 
//  y basis   height basis 
//  BrcXXX1 is older Version. Brc is used   case 0x1c:   newPAP.setBrcTop1((short)param);   break;   case 0x1d:   newPAP.setBrcLeft1((short)param);   break;   case 0x1e:   newPAP.setBrcBottom1((short)param);   break;   case 0x1f:   newPAP.setBrcRight1((short)param);   break;   case 0x20:   newPAP.setBrcBetween1((short)param);   break;   case 0x21:   newPAP.setBrcBar1((byte)param);   break; 
//  match one or more occurrences of any character 
// parts can go missing; Excel ignores them silently -- TIKA-2134 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationHelper#createTimeConstraint(int, java.lang.String, java.lang.String, java.lang.String)	  */
//  as getShapes() 
//  Rule M4.2 
//  We've been writing to the stream as we've gone along   Update the details on the property now 
//  14 @ 4082 
//  Because the 3 first rows are missing, should have last-of-row records first 
//  An optional 32-bit signed integer that specifies the shape for the start of a line in the   CustomStartCapData field. This field MUST be present if the PenDataStartCap flag is set in the   PenDataFlags field of the EmfPlusPenData object, and the value MUST be defined in the LineCapType enumeration 
//   length is the last 4 bits) 
//  To: 'Ashutosh Dandavate' <ashutosh.dandavate@alfresco.com>,     'Paul Holmes-Higgin' <paul.hh@alfresco.com>,     'Mike Farman' <mikef@alfresco.com>   Cc: nickb@alfresco.com, nick.burch@alfresco.com,     'Roy Wetherall' <roy.wetherall@alfresco.com>   Bcc: 'David Caruana' <dave.caruana@alfresco.com>,     'Vonka Jan' <roy.wetherall@alfresco.com> 
//  0 -> 1 -> 2 -> END 
//  Last one is always one larger 
//  The 'Match' column will contain 'OK' if the metadata (from NumberToTextConversionExamples) 
//  Two sheets - master sheet is separate 
//  no flags set   row inp row 4 
//  record to the DIB bits, if the record contains a DIB. 
//  can do it properly 
//  Check we got the sheet names (new formats only) 
//  Finally we need an EoF record 
//  Has data 
// check we can correctly read column widths from a reference workbook 
//  END OF 
//  A1-style notation 
//  Rule M4.3 
/*         Iterator<XSSFSheet> it = wb.iterator();        XSSFSheet sh = it.next();        sh.createRow(0);         */
//  Spot corrupt records 
//  register the SupBookRecord in the ExternSheetRecord 
//  Continues   Ends   Free 
//  1 Jan 1900 is 1 day after 31 Dec 1899 
//  might depend on empty parts being saved, e.g. some unit tests verify this currently. 
//  set left and right margins to 200pt. This leaves 200pt for wrapping text 
//  column not found 
//  Set Cell Color : AQUA 
// noinspection SimplifiableIfStatement 
//  shall not be NPE 
//  when anchor is initialized without parameters, the comment anchor attributes default to   "1, 15, 0, 2, 3, 15, 3, 16" ... see XSSFVMLDrawing.newCommentShape() 
//  ----------- 
//  finished with concat expression 
//  roll to last when curIdx == 0 
//  X=shift, Y=ok 
// length of the label  label 
//  no extractor in classpath 
//  see if we couldn't fit some 
//  https://stackoverflow.com/questions/24676460 
/*  mainly to escape row failures on MDETERM which only returns a scalar  */
//  A 32-bit unsigned integer that specifies a raster operation code.   These codes define how the color data of the source rectangle is to be combined with the color data   of the destination rectangle and optionally a brush pattern, to achieve the final color. 
//  the sheet's drawing is not aggregated 
//  Bug 58648: FormulaParser throws exception in parseSimpleFactor() when getCellFormula()   is called on a cell and the formula contains spaces between closing parentheses ") )" 
//  Target converted in URI 
//  270 to 360 
//  and therefore need to change the cipher too 
/*  Now create the target directory:  */
//    Moving many to an earlier point in the array   
//  Check we have enough data, and tweak the header size 
//  Copy CellStyle 
// case 3: 
//  Now ensure that the header size is correct 
// Sheet newSheet = wb.createSheet(sheetName); 
//  Ensure the JCE policies files allow for this sized key 
//  estimate pow2&pow10 first, perform optional mulShift, then normalize 
//  Doesn't have a directory 
//  Fourth is 96 long, underlined and different+bigger font 
//  Draws a set of line segments and Bezier curves. 
//  copied from org.apache.poi.sl.TestHeadersFooters because of scratchpad.ignore option 
//  bug 46206 alludes to files which skip the DIMENSION record   when there are no row/cell records.   Not clear which application wrote these files. 
//  org.apache.poi.hwpf.sprm 
//  First command 
//  gradient paint on the same point throws an exception ... and doesn't make sense   also having less than two fractions will not work 
//  Check we can get the shapes count 
//  For some reason, a date of 0 in Excel gets shown 
//  Given as explicit sheet id 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#createPromptBox(java.lang.String, java.lang.String)	  */
//  changed original data: ... 0x41 and 0x06 don't match   the bitmask text properties will sanitize the bytes and thus the bytes differ 
//  this matches JPG, but is not long enough, previously this caused an Exception 
/*  The class has a renderer.  */
//  print additional information for drawings and atoms 
//  One of which is Text 
/*      * initialize a smaller piece of the array and use the System.arraycopy      * call to fill in the rest of the array in an expanding binary fashion      */
//  Option A: 
//  has exponent 
//  save memory by just using the cell itself as the identity key   Note - this assumes HSSFCell has not overridden hashCode and equals 
//                biggest, tenthColumn, tenthRow, box10x10, box9x9, box10to20c, oneCell 
//   won't know to clear the cache 
//  Rule M4.4 
//  properties documents are read lazily, so we have to access them to verify they parse properly 
/*      * Test apply(Object value) with a number as parameter      */
//  Call should modify the contents 
/*  east asia  */
//  check if there is anything to save for some parts. We don't do this for all parts as some code 
//  4 shorts + 1 long + 2 spurious 'nul's 
//  Reference to a workbook scoped named range 
//  A 16-bit signed integer that defines the width of the bitmap in pixels. 
//  from row 3  
//  Build up how long the code sequence is, and    what position of the code to start at   (The position is the usually the first 12 bits,  
//  If we get here, it isn't an encrypted PPTX file 
//  A currency symbol / string, in a specific locale 
//  Checks whether 5 equals 4 (0)   Checks whether 5 equals 5 (1) 
//  fake SID   first rec len 18 (15 + next 3 bytes)   total chars 18   this bit compressed 
// DIB data is the header + dib bytes 
//  looking for "Stacked Bar Chart"? uncomment the following line   bar.setBarGrouping(BarGrouping.STACKED); 
//  Rule M4.5 
//  render it 
//  Now, update the byte level locations with their latest values 
//  run some method on the font to verify if it is "disconnected" already 
//  Match up the records and the SlideAtomSets 
//  An EmfPlusRectF object that defines a portion of the image to be rendered. 
//  Check properties are still there 
// newly created drawing 
//  value type is changing 
/* 		 * token = 1*<any CHAR except CTLs or separators>		 *		 * separators = "(" | ")" | "<" | ">" | "@" | "," | ";" | ":" | "\" |		 * <"> | "/" | "[" | "]" | "?" | "=" | "{" | "}" | SP | HT		 *		 * CTL = <any US-ASCII control character (octets 0 - 31) and DEL (127)>		 *		 * CHAR = <any US-ASCII character (octets 0 - 127)>		  */
//  This used to complain about lacking guts records 
//  create the XAdES-T time-stamp 
//  add mapping a second time, in case of initial caller hasn't done so 
//  example will be re-used 
//  The bits in RefNPtg indicate offset, not relative/absolute values! 
//  [MS-DOC], v20140721, 2.6.4, sprmSRncEdn         
//  Record the structure 
//  Create them 
//  remove range2 
//  Best hope it's OLE2.... 
//  the path described by this document 
//  2nd SBAT    2nd SBAT   3rd SBAT   3rd SBAT 
//  Need to add on the style to the font name 
//  To make bug occur, rowIndex needs to be >= ValueRecordsAggregate.records.length 
//  Which is the 72nd command 
//  Only make cell references as needed. Memory is an issue 
//  if the font group specific font wasn't defined, fallback to LATIN 
//  corrupt/invalid 
//  Group our children together into SlideAtomsSets   That way, model layer code can just grab the sets to use, 
//  Strings are equal, and there are not formatting runs. 
//  landscape orientation 
//  false, true   true, true   false, true 
//  Different char styles 
//  Read part of a block 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getPromptBoxTitle()	  */
//  B1 
//  a very simple file 
//  Write out our fields 
//  only asserting accuracy to 4 fractional digits 
//  Onto row 4 (=3) 
//  cbExtra 
//  Create some test data 
// else step == 0 => nothing to shift 
//  byteLength depends on whether we are using single- or double-byte chars. 
// now remove the formula, the cached formula result remains 
// this is what we'd expect  swallow 
//  Can get the size of zip parts 
// 5 properties found 
// Clone the sheet multiple times 
//  could do a check here to make sure none of the ranges overlap 
//  Validate input 
//  Should also check the placeholder IDs at some point 
//  styles we did not intend to (the ones that _were_ duplicated and not the duplicates) 
//  Grab any records that interest us 
// Ensure that the SharedFormulaRecord has been converted 
//  feed the corrupted zip file to OPCPackage 
//  The ratio of an arc's major axis to its minor axis. Despite the usual   meaning of these words, the "major" axis does not have to be greater than   the "minor" axis, so this ratio does not have to be greater than 1.   Setting this cell to a value less than or equal to 0 or greater than 1000 
//  The raw length of a code is limited to 4 bits + 2 
//  Aqua background 
//  Latin Hand Written 
//  Change existing 
//  ignore frame bounds 
// the third sheet is of type 'chartsheet' 
//  Passing either null or an empty ArrayList will signal that   there are no lower level items associated with the top level 
//  nothing to skip - true param follows 
//  100% scaling, that is, no change. See 17.3.2.43 w (Expanded/Compressed Text) 
// coefficient to translate from WMF dpi to 72dpi 
//  convert to zero-based 
//  First 2 Mini blocks will be used 
// For each drawing group PPT allocates clusters with size=1024  if the number of shapes is greater that 1024 a new cluster is allocated 
//  On slide three, we should have:   TR:     You are an important supplier of various items that I need     .   TR:     Source: Internal focus groups   TR:     Illustrative Example     . 
//  3rd read works 
//  B3 
/*         DecimalFormat format = new DecimalFormat("#.##########", new DecimalFormatSymbols(Locale.getDefault()));        double d = 3.0E-104;        assertEquals("3.0E-104", format.format(d));          */
/* PKIFailureInfo.unacceptedPolicy */
//  SP 21 
//  Garbage collection may happen here 
// binary 
//  bug #62513 
//  Inline Strings 
//  String is in shared strings   String is inline in cell 
//  If we have a comment record too, update that as well 
//  But after guessing goes to the correct one, cp950 (Windows Traditional Chinese) 
// GUIDs of HeaderFooterRecord and UserSViewBegin must be the same 
// another border was added to the styles table 
//  Without caching, evaluating cell 'A9' takes 21845 evaluations which consumes   much time (~3 sec on Core 2 Duo 2.2GHz)   short-circuit-if optimisation cuts this down to 255 evaluations which is still too high   System.err.println("Cell A9 took " + evalCount + " intermediate evaluations"); 
//  SYMBOL is missing 
//  What we're based on 
/*  Print a single section:  */
//  for simplicity just check for object identity 
//  If the POSITION bit is clear and the COMPRESSED bit is set in the Flags field, the points   specify absolute locations with integer values. 
//  CellAddress=Other!A1, will be unaffected 
//  negative, and exponents differ by more than 1 
// CTFont ctFont = createDefaultFont(); 
//  B2 
//  for the ClientAnchorDetail object. 
//  picture list was updated 
//  A 16-bit unsigned integer that defines the width of the DIB, in pixels. 
//  Verify the style really does belong to our workbook 
//  B5 
//  First free one at 181 
//  Put 3 in place of 1 
//  also update StyleRecord and Parent-link 
//  An 8-bit unsigned integer that specifies a strikeout font if set to 0x01; 
//  Now some short ones 
//  end public interface POIFSWriterListener 
//  Check the start of the compressed version 
//  read nameData 
//  2) attempt to create a new row IN PLACE of a removed row by a negative shift causes corrupted   xlsx file with  unreadable data in the negative shifted row. 
//  ByteArrayOutputStream doesn't throw IOException 
//  create header/footer functions insert an empty paragraph 
//  add a new text box 
/*  Write the custom properties back to the document summary             * information.  */
//  see http://msdn.microsoft.com/en-us/library/windows/desktop/bb931357(v=vs.85).aspx for a full list   setCspName("Microsoft Enhanced RSA and AES Cryptographic Provider"); 
//  It MUST be one of the values in the WMF FontQuality enumeration 
//  create the directories to the document 
/*              * if the object that has been found is a) not a paragraph or b) is             * the paragraph that has just been inserted, as the cursor in the             * while loop above was not moved as there were no other siblings,             * then the paragraph that was just inserted is the first paragraph             * in the body. Otherwise, take the previous paragraph and calculate             * the new index for the new paragraph.              */
//   time, so we won't get stuck) 
//  first perform the normal write actions for the row 
//  check new location where the ref is located 
/*  * Cell-level policies   */
/*  Read a test document <em>doc</em> into a POI filesystem.  */
//  has to be percentage 
//  no next found 
//  only makes sense if the line is not solid 
//  expand:   collapsed must be unset   hidden bit gets unset _if_ surrounding groups are expanded you can   determine   this by looking at the hidden bit of the enclosing group. You will   have   to look at the start and the end of the current group to determine   which   is the enclosing group   hidden bit only is altered for this outline level. ie. don't 
//   10 (page sheet) and an 18 
//   thankfully don't overlap! 
//  CURRENTLY FAILS: result: "SSUnd"+scharfes   LibreOffice 5.0.3.2 behavior: "Sund"+scharfes 
//  In case _firstRow > _lastRow or _firstCol > _lastCol 
//  I hate using numbers in method names so I wont! 
//  75 percent magnification 
//  read sec formula data condition 
//  respect to the width of the EmfPlusPen object that is used to draw the lines. 
// make it bold 
//  all ok 
//  y (2 bytes): A 16-bit signed integer that defines the vertical (y) coordinate of the point. 
// check that the rich text is set in the comment 
//  adjust row column style 
//  Check it serialised it back to the same data 
//  A 32-bit floating-point value that specifies the number of pixels between the outline of the arrow 
//  low-order bit says divide by 100, and so we do. Why?   'cause that's what the algorithm says. Can't fight city   hall, especially if it's the city of Redmond 
// try to read image data using javax.imageio.* (JDK 1.4+) 
//  ignore anchor elements 
// check that the default date system is set to 1900 
//  indent 
//  first with normal Text Extractor 
//  include stencil content, but try to elide stencil interiors 
/*          * Next certificate factory trick is needed to make sure that the         * certificate delivered to the caller is provided by the default         * security provider instead of BouncyCastle. If we don't do this trick         * we might run into trouble when trying to use the CertPath validator.          */
//  First up, check that TRUE and ISLOGICAL both behave 
//  date value for July 8 1901 11:23 AM 
//  the unusual case ... 
//  Slide ID 
//  The last weight of the NURBS. 
//  Vary the buffer size, so that we can end up with the br in the    overflow or only part in the buffer 
//  Set the the repeating rows and columns on the second sheet. 
//  Swap from RGBA to ARGB 
/*          * 2.3.4.14 DataIntegrity Generation (Agile Encryption)         *          * The DataIntegrity element contained within an Encryption element MUST be generated by using         * the following steps:         * 1. Obtain the intermediate key by decrypting the encryptedKeyValue from a KeyEncryptor         *    contained within the KeyEncryptors sequence. Use this key for encryption operations in the         *    remaining steps of this section.         * 2. Generate a random array of bytes, known as Salt, of the same length as the value of the         *    KeyData.hashSize attribute.         * 3. Encrypt the random array of bytes generated in step 2 by using the binary form of the         *    KeyData.saltValue attribute and a blockKey byte array consisting of the following bytes:         *    0x5f, 0xb2, 0xad, 0x01, 0x0c, 0xb9, 0xe1, and 0xf6 used to form an initialization vector as         *    specified in section 2.3.4.12. If the array of bytes is not an integral multiple of blockSize         *    bytes, pad the array with 0x00 to the next integral multiple of blockSize bytes.         * 4. Assign the encryptedHmacKey attribute to the base64-encoded form of the result of step 3.         * 5. Generate an HMAC, as specified in [RFC2104], of the encrypted form of the data (message),         *    which the DataIntegrity element will verify by using the Salt generated in step 2 as the key.         *    Note that the entire EncryptedPackage stream (1), including the StreamSize field, MUST be         *    used as the message.         * 6. Encrypt the HMAC as in step 3 by using a blockKey byte array consisting of the following bytes:         *    0xa0, 0x67, 0x7f, 0x02, 0xb2, 0x2c, 0x84, and 0x33.         * 7.  Assign the encryptedHmacValue attribute to the base64-encoded form of the result of step 6.           */
//  does nothing 
//  all other record types are not part of the PageSettingsBlock 
// Test the cell string value 
//  Ignored   Reserved 
//  remove row from worksheet.getSheetData row array   Performance optimization: explicit boxing is slightly faster than auto-unboxing, though may use more memory 
//  logical units, of the point where drawing is to start. 
//  Display attachment names 
//         assertEquals(".",        dfUS.formatRawCellContents(0,       -1, "# #/#;# ##/#;#.#;xxx")); // Currently shows as 0. not . 
//  url GUID 
//  Change some text 
//  Find the start of the group. 
//  Sort out the hpsf properties 
//  CF1 has two rules: values less than -3 are bold-italic red, values greater than 3 are green 
//  create a new sheet 
//  with Date: 
//  the recordsize ended before the image data 
//  Add a run to the first paragraph:     
//  cs1 -> 21 
/*  retrieves 1D array from 2D array after calculations  */
//  helper method to keep it in one place 
//  18 @ 70   18 @ 88 
//  if parsing for intersection fails we assume that we actually had an arbitrary   whitespace and thus should simply skip this whitespace 
//  read panose and fs so we can write them back out. 
// -1 means the name applies to the entire workbook 
//  XAdES-C: complete certificate refs 
//  error ref like MySheet!#REF! 
//  Grab the type as hex 
// serialize and read again 
// Expected 
/*  not failing, but requires more memory  */
//  Check OPC compliance M4.1 rule 
//  page numbers links to Word97-2007BinaryFileFormat(doc)Specification.pdf, accessible from microsoft.com  
//  Ensure changes were taken 
//  a formula that returns '10' 
//  Set empty lists, ready for when they call setParentTextSize 
// There can actually be OBJ records mixed between the continues. 
// cached formula value 
//  remove merged region that are replaced by the shifting,   i.e. where the area includes something in the overwritten area 
//  Setting up the table 
// add spns to the row 
//  299: PERMUT 
//  Potentially breaking the file here since we don't know exactly where to write these records 
//  Return the result of the algorithm. 
//  try slide layout 
//  Found </sheetData> 
//  Note - this is really rather nasty... 
//  don't run this test when we are using older Xerces as it triggers an XML Parser backwards compatibility issue  
//  create the formatter to test 
//  create some data 
//  Change text via normal 
//  fails with   org.apache.poi.ss.formula.FormulaParseException: Parse error near char ... ')'   in specified formula '((1 + 1) )'. Expected cell ref or constant literal 
//  Should never happen in production as all data are fixed
// write ouput to a file 
//  Try another with comments 
// this is the sheet state #2.5.142  noinspection ResultOfMethodCallIgnored 
//  collect pairs of ranges and criteria 
//  then check for sprmPHugePapx 
//  Since we haven't created this object yet we'll just put in the raw   form for the moment. 
// undocumented what is contained in these 8 bytes.  for the non-beta xlsb files, this would be 4, not 8. 
/* -------------- Abstract methods -------------  */
//  Table1 stream will be used 
//  From DXA to PCT: 
//  Fonts 
/*          * In case two objects ARE equal, but its not the same instance, this         * implementation will always run through the whole         * byte-array-comparison before returning true. If this will turn into a         * performance issue, two possible approaches are available:<br>         * a) Use the checksum only and take the risk that two images might have         * the same CRC32 sum, although they are not the same.<br>         * b) Use a second (or third) checksum algorithm to minimise the chance         * that two images have the same checksums but are not equal (e.g.         * CRC32, MD5 and SHA-1 checksums, additionally compare the         * data-byte-array lengths).          */
//  if either arg is an error, that error propagates 
// flip horizontal 
//  <Override PartName="/_xmlsignatures/sig1.xml" ContentType="application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml"/> 
//  This is abstract in nature, so we'll use a    concrete instance to test the set methods. 
// ************ SXSSF-specific methods ***************// 
//  Use the system default encoding when sending to System Out 
//  {   inline.setAttribute( "opacity",   getOpacity( characterRun.getIco24() ) );   } 
//  comment length   disk number where file starts   internal file attributes (unused)   external file attributes (unused)   LFH offset 
//  Adding default types 
//  The groups in the pattern are the parts of the number 
//  0x19   0x1c   0x1d   0x1e   0x1f 
//  90 -> 96 is another stream 
// A1:A2 
/*  * Created on May 30, 2005 *  */
//  java.util.Date uses UTC 
// see 2.5.122 
//  Check that each cell exists and that the formula text is set correctly on the first cell 
//  Check the text, and its embeded images 
//  Add some stuff into it 
//  read back as XSSF and check that xml:spaces="preserve" is set 
//  Save the resulting OLE2 document, and re-open it 
//  we cannot check for UNKNOWN as we might hit valid byte-patterns here as well 
//  Bug #62740, the logic was just re-using the existing max ID, not incrementing beyond it. 
/*              * We need at least 2 certificates for the XAdES-C complete certificate             * refs construction.              */
// only add the aggregate once 
//  Set the date 
//  still null 
/*  **********  END  extension of Property **********  */
//  Look for bits we're interested in 
//  Simple data follows 
//  check to see if we can just get the resources from the classpath 
// assertArrayEquals(expected, actual); 
//  data validation's number types 
//  Everything's happy, so save the name 
//  SlideShow<?,?> ppt = new XMLSlideShow(); 
//  test adding a row to a table, issue 59814 
//  sum only if all of the corresponding criteria specified are true for that cell. 
//  don't copy font index on copy constructor - it depends on the FontCollection this record is in 
//  With sheet names too 
//  "=SUMIFS(B2:E2, B3:E3, ">=40", B4:E4, "<10")" 
//  other things 
//  write out the Complex table, includes text. 
//  Check it has the usual bits 
//                 start--;                        // reverse order 
//  ??? 
//  RK: Invalid dates are 255 #s. 
//  OpenXML4J files 
// these test newlines and tabs in paragraphs/body elements 
//  ref to NotesMaster, 0 if none   ref to HandoutMaster, 0 if none 
//  default 100 iterations 
//  result of multiplying the current x-extent by the value of the xNum member. 
//  placeholder for first skip attr 
// names cannot be blank or contain any of /\*?[] 
//  YK: formatIndex can be -1, for example, for cell in column Y in test-data/spreadsheet/45322.xls   return null for those 
//  only main range 
//  Set the complex flag - POI doesn't usually manipulate this flag 
//  try with an invalid startBlock to trigger an exception   to validate that file-handles are closed properly 
// 				// YK: The original version asserted expected values against File#getAbsolutePath():  				assertTrue(expectedValue.get(filename).equalsIgnoreCase(f2.getAbsolutePath()));  				// This comparison is platform dependent. A better approach is below  			} 
//  Check it still has 1 slide 
//  Check we can read it 
//  Basic (non rich) test file 
//  y coordinate of second point on ellipse 
/*  first test the defaults  */
//  A 16-bit unsigned integer that defines the height of the DIB, in pixels. 
// bottom  inch 
//  It can be one or more of the WMF ClipPrecision Flags 
//  apparently bit 25 is unused 
//  non-error cases 
//  Second is a PDF 
//  Rich test file C - has paragraph styles that run out before 
//  set it to the thick black border style 
//  A 32-bit floating-point value that specifies the height of the arrow cap.   The height of the arrow cap is scaled by the width of the EmfPlusPen object that is used to draw the   line being capped. For example, when drawing a capped line with a pen that has a width of 5 pixels, 
//  BuiltInGuide throws IllegalArgumentException if key is not defined 
//  Workbook scoped name, not actually external after all 
//  this formula is inspired by the offending formula of the attachment for bug 45376   IF(DATE(YEAR(A1),MONTH(A1)+1,1)<=$D$3,DATE(YEAR(A1),MONTH(A1)+1,1),NA()) etc 
//  Check the two groups too 
//  All done 
//  check pass 
//  broken files 
//  The first certificate is presumably the signer. 
//  Should not be able to write a document that has been closed 
//  Do XWPF charts need similar treatment? 
// JMH: Do this ridiculous conversion, and let HSSFCellStyle  internally migrate back and forth 
// PPT doen't increment the number of saved shapes for group descriptor and background 
//  that cell. 
//  All the others 
//  with PAP reconstructon 
//  left margin 
//  METAVERSION100 = 0x0100, METAVERSION300 = 0x0300 
//  ===========================================================    Start of style related getters and setters   =========================================================== 
/*  Check whether this directory has already been created.  */
//  Find the spot 
//  Look for the DrawingGroup record 
// noinspection ConstantConditions 
//  Sheet 2 has a footer, but it's empty 
//  Make sure cells on other sheets are not affected 
//  with 1900 windowing, excelDate is Jan. 1, 2000   with 1904 windowing, excelDate is Jan. 2, 2004 
//  loop over the tracked columns, because there are fewer tracked columns than cells in this row 
//  Retrieves PackagePart object from the package 
//  appears after last cell value record and before WINDOW2 
//  Finish and tidy 
//  skip 4 frames of reflection invocation 
//  for format which start with "[DBNum1]" or "[DBNum2]" or "[DBNum3]" could be a Chinese date 
//  index of cell style in style table   row height in twips (1/20 point)   row zero-height (this is somehow different than being hidden)   Outlining level of the row, when outlining is on   use Boolean to have a tri-state for on/off/undefined 
//  Size=0, *2 
// cloned sheet is a deep copy, adding rows or merged regions in the original does not affect the clone 
//   formula cells, so we can see it updates properly 
//  only store cells in the base, not rows -- because rows are handled   specially for geometry sections 
//  taken from a msdn blog:   http://blogs.msdn.com/b/openspecification/archive/2009/05/08/dominic-salemno.aspx 
//  Check the comments 
//  The value MUST be in the ArmStyle enumeration table. 
// Test the sheetname 
//  create a sheet with a text box 
//  An 8-bit unsigned integer that specifies the family type. 
// change the name of the 3rd sheet 
//  Pesky XmlBeans bug - see Bugzilla #49934 
// the bean holding the reference to the formula to be deleted 
//  Last view type 
//  normalize signed zero 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationHelper#createValidation(org.apache.poi.ss.usermodel.DataValidationConstraint, org.apache.poi.ss.util.CellRangeAddressList)	  */
// access to a arbitrary row 
// update id of the drawing in the cloned sheet 
// comment1 and  comment2 are different objects 
//  Can not be reached. 
//  assert something more interesting 
// TestCellReference.class, //converted to junit4 
//  runs intersecting startIndex and endIndex remain 
//  TODO: DIB, PICT 
//  Finally read the Small Stream FAT (SBAT) blocks 
//  If our sheet has hyperlinks, have them add    any relationships that they might need 
//  Create a cell and put a value in it.   first row are column titles 
// CTHdrFtr hdr = buildHdrFtr(pStyle, pars);				// MB 24 May 2010   MB 24 May 2010 
//  No theme set, nothing to do 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#setShowErrorBox(boolean)	  */
//  And check it's as expected 
//  Add an ignored doc, no notice is taken 
//  add a third picture 
//  account for cell value records after those 
//  Off the end 
//  For array references it is handled in other evaluation steps, but we need to handle this here for references to subtotal-functions 
//  Get the embeddings for the workbook 
// assertContains(txt, "We are able to");//not sure if we can get this easily? 
//  An EmfPlusARGB object that specifies the color at the starting/ending boundary point of the linear gradient brush. 
//  Check the named range definitions 
//  Start to load up our standard structures. 
//  TSP response parsing and validation 
//  Rule [M4.1]: The format designer shall specify and the format producer   shall create at most one core properties relationship for a package.   A format consumer shall consider more than one core properties   relationship for a package to be an error. If present, the   relationship shall target the Core Properties part.   Note - POI will read files with more than one Core Properties, which 
//             evaluator.clearAllCachedResultValues(); 
//  cross check with fv 
//             "54541_cropped_bitmap2.ppt", 
//  But not the attached message 
//  first PSB record encountered - read all of them: 
//  Read the File ID 
/*  Removing the custom property must return the remove property and         * reduce the size to 0.  */
//  else rules for adjusting area may also depend on the destination of the moved columns 
// XSSFCreationHelper helper = workbook.getCreationHelper();  cell.setHyperlink(helper.createHyperlink(0)); 
//  everything else (including string and boolean values) counts as zero 
//  Copy the format 
//  found in the dictionary, so output that compressed 
// Copy the worksheet data to "out". 
//  Write out to a byte array 
// copy rgdxaCenter 
//  For each element in the ArrayList, get the text for the high 
//  #3 pass - update merge info 
//  destination rows enclose the area (possibly exactly) 
//  Test methods common with HSSF are in superclass   Local methods here test XSSF-specific details of updating array formulas 
//  min axis value   max axis value 
//  the relationship element 
//             rightMargin = 0d;          } 
//  Grab the first 512 bytes   (For 4096 sized blocks, the remaining 3584 bytes are zero)   Then, process the contents 
//  may need to grow - fill intervening palette entries with black 
//  positive value means percentage spacing of the height of the last line, e.g.   the higher the last line, the bigger the space after the paragraph 
//  from this 'row' ArrayList one at a time and to write the Strings   away to a StringBuffer thus assembling a single line for inclusion   in the CSV file. If a row was empty or if it was short, then   the ArrayList that contains it's data will also be shorter than   some of the others. Therefore, it is necessary to check within   the for loop to ensure that the ArrayList contains data to be   processed. If it does, then an element will be recovered and 
//  First test that setting RR&C for same sheet more than once only creates a 
//  process the first sheet 
//  Check the search chunk, see if it's 
//   it's a newly created one 
//  Grab the info field 
//  note the call to the "unwrapped" version, which returns a single value 
//  non-Javadoc: This abstract class exists to consolidate duplicated code between   {@link org.apache.poi.hssf.usermodel.helpers.HSSFRowShifter} and   {@link org.apache.poi.xssf.usermodel.helpers.XSSFRowShifter}   (currently methods sprinkled throughout HSSFSheet) 
//  https://stackoverflow.com/questions/32010765 
/* nil */
//  ftLbs 
//  ensure that a memory based package part does not have lingering data from previous commit() calls 
/*      A     B    C      D   E         * 1 LONG  LONG        LONGMERGE         * 2       SHORT SHORT     SHORT          */
//  start watermark paragraph 
//  Add this new SlidePersistAtom to the SlideListWithText 
// Zero or more characters 
//  this will usually cause a 'FALSE' result except for ISNONTEXT() 
//  First is a link to poi 
/*  **********  END  implementation of POIFSWriterListener **********  */
//  Version (2 bytes):  A 16-bit unsigned integer that defines the metafile version. 
//  20 pt from the previous paragraph   3 lines after the paragraph 
//           {              short[] brcTop = rgtc[x].getBrcTop (); 
//  of the identifier field in an EMR_COMMENT_PUBLIC record. The offset MUST be 32-bit aligned. 
//  reducing this metric 8. 
//  Sheet 2 has comments 
//  0x19 Unused 
//  bitfields 
//  The simple operators consider all zeros to be the same 
//  sprmPDxaLeft180  
//  If we get here, then the rawCode + this byte weren't   found in the dictionary 
/*  **********  END  implementation of DocumentEntry **********  */
//  Friendly objects for people to deal with 
//  no change because range would be turned inside out   dest truncates top (even though src is from inside range)   complex: src encloses bottom, dest encloses top 
// 00000000 15 00 12 00 01 00 01 00 11 60 00 00 00 00 00 0D .........`......  00000010 26 01 00 00 00 00 00 00 00 00                   &......... 
//  the other is matched with a CustomViewSettingsRecordAggregate having UserSViewBegin with the same GUID 
/*  ======= Name pointing to 1st sheet ======  */
//  Image type + 0xF018 
//  anything else is not valid argument 
//  Is it the one that defines the shared, or uses it? 
//  Set for the appropriate text sizes 
//  Add another mini stream 
// bullet offset  text offset (should be greater than bullet offset)  bullet character 
//    the character ones do 
//  re-hash 
// test all the regions were indeed added 
//  starts from decimal point 
//  Now pass on to our child 
//  Now make sense of those properties 
//  Peek inside the underlying record 
//  Check for the attribute value => 'dcterms:W3CDTF' 
//  An empty picture record (length 0) will take up 8 bytes 
//  Dk2, lighter 40% (tint is about 0.39998)   31 * (1.0 - 0.39998) + (255 - 255 * (1.0 - 0.39998)) = 120.59552 => 120 (byte)   73 * (1.0 - 0.39998) + (255 - 255 * (1.0 - 0.39998)) = 145.79636 => -111 (byte) 
//  columns and the inset. 
//  NOSONAR   ensure file-handle release 
//   how to tie that together. 
//  when criteria is an expression (starting with a comparison operator) 
//  C1 
//  Create the Property Set 
//  named range list 
//  check rules list for null, although current implementation will return an empty list, not null, then do what you want with results 
//  known result in excel 
//  An escape we can let it handle because it can't have a '%' 
//  sprmCRsidRMDel 
// add expected failures here: 
//  Now zap the empty 4th row - won't do anything 
//  now check a file with 1904 Date Windowing 
//  then calculate min/max cell-numbers for the worksheet-dimension 
//  A 16-bit signed integer that defines the height/width, in logical coordinates,   of the ellipse used to draw the rounded corners. 
//  what other similar functions 
//  An ExternalBlock for Add-In functions was not found. Create a new one. 
// DBCells are serialized before row records. 
//  some old documents have "WORKBOOK" or "BOOK" 
//  allow function definitions to change only if both previous and the new items have footnotes 
//  Relationship ID 
// _book can be omitted by test cases   just use BIFF8 
//  SharedFormulaRecord occurs after the first FormulaRecord of the cell range.   There are probably (but not always) more cell records after this   - so don't fire off the LastCellOfRowDummyRecord yet 
//  unable to parse file -- not ExcelToFoConverter fault 
//  the file. 
//         FileOutputStream fileOut = new FileOutputStream("/tmp/55640.xlsx"); 
// 18 
//  Read it 
//   group shape on slide3 
//  assume match 
//  Create a >2gb file 
//  Check the same 
//  private static POILogger log = POILogFactory.getLogger(HSSFPatriarch.class); 
//  https://stackoverflow.com/questions/21855842   https://stackoverflow.com/questions/29014848   https://stackoverflow.com/questions/39636138 
//  rId2 is file 
/*  Create an input stream containing the bytes the property set             * stream consists of.  */
//  #59743 - disable Threshold handling for SXSSF copy   as users tend to put too much repetitive data in when using SXSSF :) 
//  STEditAs.ABSOLUTE corresponds to ClientAnchor.DONT_MOVE_AND_RESIZE 
//  Remaining 12 bits = offset count 
//  Replace with one still big enough for a main stream, but one block smaller 
//  colored major grid lines 
//  Are we the first SBAT? 
//  And none of them are continue ones 
//  For the text coming in from the SlideAtomsSet:   Build up TextRuns from pairs of TextHeaderAtom and    one of TextBytesAtom or TextCharsAtom 
//  A NumberOfPolygons array of 16-bit unsigned integers that define the number of points for 
//  Loop over the wrappers, showing what they contain 
//  Out flag has the normal meaning   Length wise, we're 2 longer than we say, so the max len is 18   Endian wise, we're big endian, so 0x1234 is pos 0x123 
//  Get the colum's width in millimetres 
//  make it obvious 
//  Grab the version number, 0x1a -> 0x1b 
//  Reorder CTSheets 
//  the xor key for method 1 is part of the verifier for method 2   so we simply chop it from there 
/*      * Cells that cannot be formatted, e.g. cells that have a date or time     * format and have an invalid date or time value, are displayed as 255     * pound signs ("#").      */
//  Print out any missing commas if needed 
//  Add paragraphs to the cells 
//  s.setCodepage(CodePageUtil.CP_UNICODE); 
//  try slide master 
//  Reserved (4 bytes): A value that MUST be 0x00000040 
//  normal case: compute slope/intercept 
/*      * Getters and setters      */
//  Check sheet names 
//  Create a style and use it 
// now remove the created breaks 
//  preserve the fSpec setting from the original CHP 
//  SigningTime 
// //// Case 16: Evaluate "Table1[[#Headers],[#Data],[col]]" //////// 
// out of borders  out of borders 
//  Check all comes out right 
//  Verify we only got one SBAT block 
//  this only really counts when writing because FILEPASS is read early 
//  expected sheet-id not found   EXPECTED_ADDITIONAL_FAILURES.add("spreadsheet/52348.xlsx");   EXPECTED_ADDITIONAL_FAILURES.add("spreadsheet/59021.xlsx");   zip-bomb 
//  All rows should have one column 
//  Loop over the codes, outputting what they correspond to 
//  Check we can decrypt it 
//  Messages may have their bodies saved as plain text, html, and/or rtf. 
//  newline 
//  /O=..../CN=em@ail 
// make sure we do the maximum value of the Int operator 
//  overrides 
//  Various CountAs on Strings 
//  Then we have a whole bunch of stuff, which grows    with the number of hyperlinks 
//  ... I don't know, why commit is protected ... 
//  Re-check ref one 
/*          * Saved drawings must have the following namespaces set: <xdr:wsDr         * xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"         * xmlns:xdr=         * "http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing">          */
//  Attr   Ref - A3 
//  there seems to be currently no generic way to check the setting... 
//  light grey 
//  Note the lack of - sign! 
// 				POIFSFileSystem fs = new POIFSFileSystem(new ByteArrayInputStream(baos.toByteArray()));  				erf.processRecords(fs.createDocumentInputStream("Workbook")); 
//  x coordinate of second point on ellipse 
// fix for stupid ol Windows 
//  Check it evaluates correctly 
//  Step 1. Create a template file. Setup sheets and workbook-level objects such as   cell styles, number formats, etc. 
//  convert to canonical file, to make any subsequent error messages 
//  weird Excel behaviour on second arg 
//  #3) these cells will all be medium weight with different colors for the       outside, inside horizontal, and inside vertical borders. The center 
//  some specific whitespace chars below 0x21: 
// search the referenced drawing in the list of the sheet's relations 
//  167 -> 172 is the next 
//  Attr   Ref - A4 
//  See SHAREDFEATURES_   Should always be one 
//  FFN structure containing strings of font names 
//  Finally look for the notes master 
//  offset dummy - filled later 
//  Where each font has ended up, and if we need to 
//  Now grab the children's data 
/*  Get the directory entry for the target stream.  */
//  we keep the cached data in ThreadLocal members in order to   avoid multi-threading issues when different workbooks are accessed in  
// title has center alignment 
//  bug 56295: ensure that the fills is available and set correctly 
// YK: files produced by OO violate the condition below 
//  cyan 
//  inset the left hand or bottom edge of the image. 
//  sample XLSX with the same text-contents as the text-file above 
//  Apply the styles 
//  Create main document part 
//  Check if cell belongs to workbook   (checked in setCellStyleProperty) 
//  12th digit of integer -> scientific 
//  now the color should be equal for those two columns and rows 
//  the actual thread-safe temp-file strategy 
//  same workbook re-saved in Excel 2010, the R attribute is updated for every cell with the right value. 
//  Can be multiple of these - add to list(s) 
//  Find PPDrawings at any second level position 
//  In third set, it's just a font.size and a font.color 
//  section.clear(); 
//     Image transformImage(Image image, Rectangle rectangle, Rectangle rectangle1, ImageObserver imageobserver, Color color1)      {          logger.log(POILogger.WARN,"transformImage() not supported");          return null;      }        Image transformImage(Image image, int ai[], Rectangle rectangle, ImageObserver imageobserver, Color color1)      {          logger.log(POILogger.WARN,"transformImage() not supported");          return null;      } 
//  change [wbB]BSheet1!B3 (from 50 to 60) 
//  all OK 
//  [D4:E5] 
//  If we haven't already identified out font metrics file, 
//  test signing with single opened package 
//  This value MUST be 0x00000001. 
//  Now find it on our sheet 
//  bug 60845   Do not compare the representing strings but the properties   Reason:     The strings are different if the XMLObject is a fragment (e.g. the ones from cloneStyle)     even if they are in fact representing the same style 
//  arg0 is evaluated to text first 
//  as per "MICROSOFT OFFICE EXCEL 97-2007 BINARY FILE FORMAT SPECIFICATION" pdf 
//  desx is not supported. Not sure, if it can be simulated by des3 somehow 
//   "+mj-lt".equals(typeface) || "+mn-lt".equals(typeface) 
//  2049 - existing shape id 
//  Try each password in turn, reporting progress 
//  All chunks are now processed, have the ChunkGroup 
//  Good, we can't fit 5 in starting at 7 
//  degenerate case: nothing to join   degenerate case: one thing to join, no trailing comma 
//  Check there really is a record at this number 
//  rather than allowing users to continue updating rows that are no longer part of the sheet 
//   but not of their anchors 
//  Good, valid combination 
//  Cell show "12/8" 
//  Check critical things in the Ptg array encoding. 
//  Check text all matches up properly 
//  false parameter not present   1 less than distance to end of if FuncVar(size=4). 
//  RETURN_NULL_AND_BLANK - same as default 
//  The 16-bit signed integers that defines the corners of the bounding rectangle. 
//  then storing the String into the csvLine ArrayList. 
//  To it 
//  Using a HashSet instead of a TreeSet because we don't care about order. 
//  no need to round because we have at least 8 bits of extra precision 
//  CellFormat requires callers to identify date vs not, so do so 
/*  ********************* getter/setter follows ***********************  */
//  Check for the 'xsi:type' attribute 
//  a formula that returns true 
//  zero terminated string that records name of font, cuurently not 
//  Check that the text sizes are as expected 
//  automatic index 
//  smallest non-zero number (subnormal) 
//  is the end of the second file also. 
//  Let's iterate over the test setup. 
//  The argument is structured reference 
//  cloning the conditional formatting manually makes it bad again 
/*    */
//  Open the workbook 
//  No marker symbol on the chart line. 
//  comples path consisting of a rectangle and an ellipse inside it 
//  not enough occurrences found - leave unchanged 
//  the grpprl size byte and the grpprl. 
/*          * plcfBkmkl (table recording limit CPs of bookmarks) Written         * immediately after the plcfBkmkf, if the document contains bookmarks.         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 24 of 210          */
// @NotNull 
//  Handle extra 1 char styles at the end 
//  verify TSP signer certificate 
//  upper-left corner of the rectangle. 
//  per Excel, a blank value for a numeric validation constraint formula validates true 
// nothing 
//  explicit list was provided 
//  Write out destination file          FileOutputStream fileOut = new FileOutputStream("/tmp/46515.xls");          wb.write(fileOut);          fileOut.close(); 
//  Problem 1: See TestUnfixedBugs#test49612()   Problem 2: TestUnfixedBugs#test49612() 
//  field 
//  YK: Excel doesn't write NaN but instead converts the cell type into {@link CellType#ERROR}. 
// set cached formula value 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getShowPromptBox()      */
//  Use this to read in the properties 
//  Truncate to header + flag + data for flag 
//  link to a URL 
// 				((DrawingRecord) _lastRecord).appendContinueRecord(contRec.getData()); 
//  please contribute a real sample file, which is binary rc4 encrypted   ... at least the output can be opened in Excel Viewer  
//  private static float DEFAULT_COLUMN_WIDTH = 9.140625f; 
/*      * Sets the default font on ctStyles DocDefaults parameter     * TODO Replace this with specific setters for each type, possibly     * on XWPFDefaultRunStyle      */
//  print mono/b&w, colorless 
//  check max entry size ouf of bounds 
//  Check the 0(.00)% ones 
// an, add, remove, get(0) would null pointer 
// "com.sun.org.apache.xerces.internal.util.SecurityManager", 
//  null the remaining bytes 
//  A valid BorderStyle constant, as a Short 
//  It's escaped, don't worry 
//  We need to get hold of the text that makes up the 
//  First page header is optional, only return 
//  PieceDescriptor objects 
//  Can be null 
//  lower-right corner of the rectangle. 
//  3073 - existing shape id 
//  weren't obtained from the print consider them 
//  In second set, we get a CharFlagsTextProp and a font.size and a font.color 
// Create 
// last column PLUS ONE 
//  Now check the style names 
//  Check it now has empty core properties 
//  blocksize   blocksize   blocksize   keysize   hashsize 
//  4 -> 11 then end 
//  A 32-bit unsigned integer that specifies the size of the DIB bits, if the record 
//  #61881 - for now we only check the first char 
//  Read initial file in 
//  First, try to find it as a User Defined Function 
// long startTime = System.currentTimeMillis(); 
/*      * Microsoft Office Word 97-2007 Binary File Format (.doc) Specification;     * Page 60 of 210      */
// if there's no relationship id, silently skip the sheet 
/*  * READ ONLY ACCESS... THIS IS FOR COMPATIBILITY ONLY...USE LABELSST! public  */
//  Should have 3 root relationships 
//  translate the result to the canvas coordinates in points 
//  string to error code 
//  delete format runs that fit between startIndex and endIndex 
//  version 
// type of the text 
//  write out the list tables 
//  loop until either only one item is left or we did not merge anything any more 
// get default font, then change 2 values and check against different values (height changes) 
//  TODO - seems like the sign bit of this field might be used for some other purpose   see example file for test case "TestBugs.test19599()" 
/*  Width is an integer number of 20ths of a point (twips)  */
//  LTGRAY_BRUSH - A light gray, solid-color brush   BrushStyle: BS_SOLID   Color: 0x00C0C0C0 
//  Moving to a later point in the array   Grab everything from after the toMove block, to the new point 
//  process module, skip __SRP and _VBA_PROJECT since these do not contain macros 
//  ******************************* 
//  Check the formulas 
//  If offsets are omitted, it is assumed to be 0. 
//  search for unicode characters 
//  Replace ever "%" with a "%%" so we can use printf 
//  if srcCell doesn't have a hyperlink and destCell has a hyperlink, don't clear destCell's hyperlink 
//  Save in the escher layer 
//  Make longer, take 1 block at the end 
//  Try writing 5, should extend 
//  Starts with no header 
//  This value MUST be defined in the BitmapDataType enumeration 
//  Even more trickiness:   Note - even if the StringEval represents a number value (for example "1"), 
//  Workbook Factory gives helpful error on package 
//  YK: width of not-evaluated formulas that return data is not determined   POI seems to conevert '0' to Excel date which is the beginng of the Excel's date system 
//  Refer to a different area 
//  mask is 0x1000 
//  default copy policy 
//  this ID value seems to have significance to Excel >= 2010; see https://issues.apache.org/bugzilla/show_bug.cgi?id=55409 
//   records we happen across 
//  The ratio of an arc's major axis to its minor axis. Despite the usual   meaning of these words, the "major" axis does not have to be greater than 
//  Check reading the formula 
//  try various forms of corruption 
// A1:B2 
//  single row range 
// default behavior: include phonetic runs 
//  Special cases for vertically aligned text 
// Creating another new Named Range 
//  We now have 109 BATs, but no XBATs 
//  DataFormat is not copied unless policy.isCopyCellStyle is true 
// calcChain should be gone 
//  Copy the spearator character and formatting convention into local 
//  Approximative threshold to decide whether test is PASS or FAIL:    shortCellValue ends up with approx column width 1_000 (on my machine),    longCellValue ends up with approx. column width 10_000 (on my machine)    so shortCellValue can be expected to be < 5000 for all fonts    and longCellValue can be expected to be > 5000 for all fonts 
//  Notes of master - unchanged 
//  Claim one of them and return it 
// single-cell array formulas behave just like normal cells 
//  Flag:  UccUUccU   5     c2a: offset 6 / 0x006    c2b: length 4+2  -> \ansi\a    c3a: offset 7 / 0x007    c3b: length 2+2  -> nsi   c    p    c6a: offset 221 / 0x0dd    c6b: length 0+2  -> g1    c7a: offset 224 / 0x0e0    c7b: length 0+2  -> 25   2 
//  Type is 104, or 0x68 
//  A 32-bit unsigned integer that specifies the size in bytes of the 
//  test again with including formulas and cell-comments as this caused some bugs 
//  Write out, and check 
//  This field MUST be set to zero. 
//  5.38.2 'Internal References' 
//  Figure out where they are now 
//  And check correct sheet settings found 
//  else not 'External References' 
/*  Initialize the sections. Since property set must have at least         * one section it is added right here.  */
//  The count of items in the array is specified by count. 
//  Formula is a String result not a Numeric one 
// 			return true;  		}  		System.err.println("Diff from proof: "); 
//  Use the current CTAbstractNum if it exists 
//  Give a special string, based on ~, to make clear this isn't a standard Excel error 
//  structured reference is trying to reference a row above or below the table with [#This Row] or [@] 
//  result is correct 
//  Now look higher up 
//  Verify that the changes are non-volatile 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getShowPromptBox()	  */
//  Save and re-check 
//  Have the header processed 
//  Will have been padded though 
//  C1 is a string, with different text 
//  provide ZipEntrySource to poi which decrypts on the fly 
//  prepare each property for writing 
// //// Case 12: Evaluate "Table1[[#All],[col1]:[col2]]" //////// 
//  If this part is a zip package part (read only by design) we convert   this part into a MemoryPackagePart instance for write purpose. 
//  }   int FC = TP.getPieceDescriptor().getFilePosition();   int offset = CP - TP.getCP(); 
// Set the uncompressed bit 
//  Check that protection block is together, and before DIMENSION 
//  Two charts, three sheets 
//  probably not happening with write access - not sure how to handle the default read-write access ... 
//  5 is the active / selected sheet 
/*  Part doesn't exist, create a new one  */
//  Now check on the sheet 
//  4-7 reserved   end bitfields 
// &C == centered 
//  Merged across multiple rows   Microsoft Excel 2013 does not copy a merged region unless all rows of   the source merged region are selected 
//   then it could be a date 
/*  * Created on May 23, 2005 *  */
//  Write them out 
//  Finally, add it to the string 
//  [wbA]ASheet1!A2 references (among other things) [wbB]BSheet1!B2 
// preserve URI fragments 
//  We should have 21 BATs in the XBAT 
//  Add it in at the end 
// srcCell is null 
//         {            permuteIstd (newPAP, varParam, opSize);          } 
//  old top row of area has moved deep within the area, and exposed a new top row 
//  in this array 
//  there are choice and fallback OleObject ... we prefer the one having the objectPr element, 
//  sprmCIstd (0x4A30) 
//  Decode the stream to bytes 
// none is not the same as "not set", therefore the following doesn't work any more  assertFalse(ctBorder.isSetTop()); 
// OK lets do this in stages to return a quickly, first check the actual string 
//  Set the values for the table 
// verify our settings 
//  add XAdES ds:Object 
//  apply rotation and flipping 
//  Build the property for it 
//  Read them back in again 
//  Check Basics 
//  output to console 
//  Even page footer is optional, only return 
// this.tpt = tpt; 
//  size without crop 
//  Copy cell value (cell type is updated implicitly) 
//  Border from a theme, brown 
//  see https://support.office.com/en-us/article/COUNTBLANK-function-6a92d772-675c-4bee-b346-24af6bd3ac22   "Cells with formulas that return "" (empty text) are also counted." 
//  RTR 2 had f3 (unchanged), f5 (=f2) and f6 (moved down) 
//  comment exists 
//  assertEquals("Checking hour = " + hour, date.getTime().getTime(),                DateUtil.getJavaDate(excelDate).getTime()); 
//  Write out and read back, should still be valid 
//  ftEnd 
/*              * Without revocation data service we cannot construct the XAdES-C             * extension.              */
//  enforce singleton 
//  nothing to check 
//  Build the PictureData object from the data 
//         decRef(); 
/*  converts 1D array to 2D array for calculations  */
//  cryptoapi 
//  junit is only using hamcrest-core, so instead of adding hamcrest-beans, we provide the throwable   search with the basics...   see https://stackoverflow.com/a/47703937/2066598 
//  Fetch the level 
//  And output the byte 
//  sheet-level policies 
//  formula in the follower cell is rebuilt 
//  Check the dates 
//  Copy over 
//  test signing with separate opened packages 
//  the amount of vertical white space before the paragraph 
//  Neither defined nor reserved 
//  Indent level is not written for master styles 
//  whether to display outline symbols (in the gutters) 
//  Verification 
//  translate all of the points to the same angle as the ellipse 
// the temp file will be deleted when JVM terminates 
//  DCTerms namespace only use with 'created' and 'modified' elements 
//  Three attributes 
// register a picture 
//  output all full lines in the middle 
// run.setText("xxx",14);  fail("Position wrong"); 
//  y coordinate of center point 
//  check what happens if the file is passed as "Object" 
//  transparent 
//  should never happen in practice 
//  index to first row   index to last row 
//  Finally check on message 
//  De-crement by one the last column value. 
/*  char 4   */
//  Workbook has drawing stuff, but this sheet doesn't 
//  =sum(C:C) -> 6 
//  Overlaps with 13 - 16750 (before, overlap and after replacements required) 
//  Save, load, check 
//  when shifting down, sort higher row-values first 
//  First up is the size, in 4 bytes, which is fixed   Then is the header 
//  It's not an int. 
//  recursively walk group-shapes 
//  mask is 0x030004   char flags 0x0004 = underlined 
//   without getting confused 
//  SP 10 
//  this file has incorrect default content-types which caused problems in Apache POI   we now handle this broken file more gracefully 
//  read the original sheet header order 
//  Now with an existing file 
//  name of the symbol that this was derived from 
//  Have we done this string already? 
//  Write it back out, and re-read 
//  sprmPFInnerTableCell -- 0x244b 
//  end of the group so reset the count for this level 
//  Test cleaning cols 
//  Any other type of embedded object. 
/* 	 * (non-Javadoc)	 * 	 * @see	 * org.apache.poi.ss.usermodel.DataValidationHelper#createTimeConstraint	 * (int, java.lang.String, java.lang.String, java.lang.String)	  */
// //// Case 4: Evaluate "Table1[#All]" //////// 
//  event based extractor does not have a document 
//  options   recordid   remaining bytes 
// //////////////// Powerpoint 
//  Hyperlinks should all be to #_ftn1 or #ftnref1 
//  sub-normal numbers 
//  else - usual case   delete single element (without re-hashing) 
//  Add some more 
//  Just copy over 
//  visible size 
// link length 
//  Grab the start and end, which are in characters 
//  3% in the MSFT example 
//  sid=x236, 16 bytes long 
//  [sum ] 
//  Create 2 comments for A1 and A" cells 
//  we have a xml file 
//  label frequency   tick mark frequency 
//  and add a row to summary 
//   to format the cells to the same value as the one next to it 
//  some other error ?? 
//  This used to break, until bug #43116 was fixed 
//  *** sun.misc.Cleaner unmapping (Java 8) *** 
//  re-create the sub-range so we can delete it 
// provided in bug-44886 
//  gracefully handle missing CellRef here in a similar way as XSSFCell does 
//  The different kinds of geometry 
//  First up, fetch the number of characters this applies to 
//  Create the record 
//  The overt symptom of the bug   DBCELL record pos is calculated wrong if VRA comes before RRA 
// 	private static boolean compareStreams(InputStream isA, byte[] generatedContent) {    		InputStream isB = new ByteArrayInputStream(generatedContent);    		// The allowable regions where the generated file can differ from the   		// proof should be small (i.e. much less than 1K)  		int[] allowableDifferenceRegions = {   				0x0228, 16,  // a region of the file containing the OS username  				0x506C, 8,   // See RootProperty (super fields _seconds_2 and _days_2)  		};  		int[] diffs = StreamUtility.diffStreams(isA, isB, allowableDifferenceRegions); 
// ??        textFormatter[0x29] = new DecimalFormat("_(*#,##0_);_(*(#,##0);_(* \"-\"_);_(@_)");  ??        textFormatter[0x2A] = new DecimalFormat("_($*#,##0_);_($*(#,##0);_($* \"-\"_);_(@_)");  ??        textFormatter[0x2B] = new DecimalFormat("_(*#,##0.00_);_(*(#,##0.00);_(*\"-\"??_);_(@_)"); 
//  YK: Formula data can span into continue records, for example,   when containing a large array of strings. See Bugzilla 50244 
// cell style for hyperlinks 
// selectPath("declare namespace r='http://schemas.openxmlformats.org/officeDocument/2006/relationships' $this//[@embed]"); 
//  SP 15 
// Gracefully handle records that we don't know about,  that happen to be continued 
// try to assign an invalid name to the 2nd sheet 
//  horizontal center 
//  copy from source copy, original source might be overridden in process! 
//  make method visible for this package 
//  see https://issues.apache.org/bugzilla/show_bug.cgi?id=55611 
//  SUM over a range 
//  this length does not include any extra array data 
//  stream pointer to the SST record   don't really understand this yet. 
//  Check our BAT knows it's free 
//  Get without recursing 
// Create cachefield/s and empty SharedItems - must be after creating references 
//  Boolean 
//  We use 12 bit codes:   * 0-255 are real bytes   * 256-4095 are the substring codes   Java handily initialises our buffer / dictionary 
//  With a cell elsewhere in the merged region, get top-left 
//  Build the sheet that will hold the data for the validations. This   must be done first as it will create names that are referenced 
//  Enable, shows up 
//  $C1+C$2 
//  properties specific to shapes 
//  12:45 on 27th April 2012 
//  If none, do a thread-safe creation 
//  bug occurs if the formula record has been associated   with the first shared formula group 
//  A 32-bit unsigned integer that specifies the PenStyle.   The value MUST be defined from the PenStyle enumeration table 
//  Should always give us a string  
//  Java months are 0 based! 
//  This time is typically ~800ms, versus ~7800ms to iterate getMergedRegion(int). 
//  information stream to the POI filesystem. 
//  plus 3 bytes minus 2 for the length 
//  Compare each field in ctColor.   Cannot compare ctColor's XML string representation because equivalent   colors may have different relation namespace URI's 
//  another CONTINUE 
//  Mow many co-ordinate positions are there per millimetre? 
//  Should never be 
//  unwrapped single value 
//  create the masters 
//  compute radius 
//  An 8-bit unsigned integer that specifies the stroke variation for the font. 
//  ignore these here for now 
//  fields uninitialised 
//   people in To + CC + BCC. 
//  copy Grpprl from dataStream 
//  360: PHONETIC 
//  Not actually sheet based at all - is workbook scoped 
//  Simple reference to a name in another file 
//  Indices used for built-in formats may be overridden with   custom formats, such as locale-specific currency.   See org.apache.poi.xssf.usermodel.TestXSSFDataFormat#test49928()    or bug 49928 for an example.   This is why we need to check stylesSource first and only fall back to   BuiltinFormats if the format hasn't been overridden. 
//  -90 to 90 
//  D2 
/* 		 * Change the category to "POI example". Any former category value will		 * be lost. If there has been no category yet, it will be created.		  */
// The pictstream can be truncated halfway through a picture.  This is not a problem if the pictstream contains extra pictures  that are not used in any slide -- BUG-60305 
//  empty (happens on the right hand side when there is an odd number of functions) 
//  Check no style is there 
//  shape's height. 
//  test samples: 45538_classic_Footer.xls, 45538_classic_Header.xls 
// 				throw new RuntimeException(e); 
//  SP @ 26 
//  D5 
//  Check is was stored correctly 
//  paragraph is 97 long 
//  Check to see if the sourceFolder variable holds a reference to 
//  first add 20 images to the slide 
//  read from the file input stream 
//  there are actually TextBoxRecords without extra data - see #54722 
//         CertificateFactory certificateFactory = CertificateFactory.getInstance("X.509");          certificate = (X509Certificate) certificateFactory                  .generateCertificate(new ByteArrayInputStream(certificate                          .getEncoded())); 
//  else some unexpected error 
/*  Create an empty property.  */
//  =CHOOSE(2,A2,A3,A4) 
//  Now try writing through to 192, check that the SBAT and blocks are there 
//  Starts out with 5 entries:    _VBA_PROJECT_CUR    SummaryInformation <(0x05)SummaryInformation>    DocumentSummaryInformation <(0x05)DocumentSummaryInformation>    Workbook    CompObj <(0x01)CompObj> 
// Not more than one until more created 
//  There is an empty byte between each top-level record in a Word doc 
//  read internal and external coordinates from spgrContainer 
//  Append the email address in <>, assuming    the name wasn't already the email address 
//  what happens with level below 1 
//  create hyperlink pointing to a page, which isn't available at the time of importing the content 
//  We use the getInputStream() method from java.util.zip.ZipFile   class which return an InputStream to this part zip entry. 
//  Update the start position if needed 
//  numeric criteria 
// none is not the same as "not set", therefore the following doesn't work any more  assertFalse(ctBorder.isSetBottom()); 
//  There are 19 images in the picture, but some are 
//  Check that this too added empty properties without error 
//  Start walking the file, looking for the records 
//  Existing file 
// the value is not set and cell's type='N' which means blank 
//  title slide 
//  One with, from the top 
//  If no such record has been set, the default alignment is TA_LEFT,TA_TOP. 
//  Remove sheet1, we should only have sheet2Name now 
//  Look up the sheet, if present 
// 			// bug report mentions 'Editing the formula in excel "fixes" the problem.' 
//  a FileInputStream does not support "marking" 
//   cells into strings without error 
//  If in doubt, go for the default 
//  If table name is modified after getTable is called, the table can only be found by its new name 
//  cast to long to preserve bit 31   (sign bit for ints) 
/* int reserved = */
//  B is 2006-01-24 (2nd day of week) 21:25:03.725 
//  sprmPDyaFromText 
/*          * plcfbtePapx (bin table for PAP FKPs) Written immediately after the         * plcfbteChpx. This is recorded in all Word documents.         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 24 of 210          */
// header with month titles 
//  always overwrite the font info properties when a font data given   as the font info properties are assigned generically when only a typeface is given 
//  Embedded Object 
//  No comments there yet 
/* CTP p = */
// once you create a multi-cell array formula, you cannot change the type of its cells 
// then we'll decrement instead of increment. 
//  chooseOffset   Ref - A2 
// parse these at some point. 
//  It is this outline of the outline that will be filled in 
//  loop through HeaderFooterRecord records having not-empty GUID and match them with 
//  evaluate twice to confirm caching looks OK 
// shouldn't do 1-row merge 
//  An array of WMF PointL objects that specifies the points for all polygons in logical units.   The number of points is specified by the Count field value. 
//  Rows are moving down 
//  convert to list of object-arrays for @Parameterized 
/* 	 * get the font family (TODO)	 *	 * @return family	  */
//  Could it be a visio one? 
/*      * Returns a human-readable representation of the Class ID in standard      * format {@code "{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}"}.     *      * @return String representation of the Class ID represented by this object.      */
//  no cells to check 
//  Crazy special case   Length is in bytes, from the start   Hyperlink appears to be empty 
//  Red (1 byte): An 8-bit unsigned integer that defines the red intensity value for the palette entry. 
//  keep aspect ratio for height 
//  322: KURT   323: SKEW 
//  The x-coordinate of a control point. 
//  internally values below zero are stored differently 
//  color index 
//  Rows and cells 
//  iterate over shapes and re-generate shapeId 
/*  ********** START implementation of FixedField **********  */
//  TRUE > FALSE 
//  fails at formula "=MEHRFACH.OPERATIONEN(E$3;$B$5;$D4)" 
//  A condition specification 
//  now go through all the textruns and check for hyperlinks 
//  replace '/' to make test work equally on Windows and Linux 
//  Our test value 
//  creates a new Paragraph, cursor is positioned inside the new   element 
//  For var-arg (and other?) functions, the metadata does not list all the parameter   operand classes.  In these cases, all extra parameters are assumed to have the   same operand class as the last one specified. 
//  Placeholder EMFs for clients that don't support the OLE components. 
//  WordToFoUtils.setBorder(regionBody, sep.getBrcTop(), "top");   WordToFoUtils.setBorder(regionBody, sep.getBrcBottom(), "bottom");   WordToFoUtils.setBorder(regionBody, sep.getBrcLeft(), "left");   WordToFoUtils.setBorder(regionBody, sep.getBrcRight(), "right"); 
//  FILE_TAIL - unknown byte sequence 
//  Easy, normal v text tag 
//  Check it now has two SLWTs 
//  =====================================================================   Case 1: Existing code uses XSSFSheet for-each loop   =====================================================================   Original code (no longer valid) 
//  Now the number of Placeholder Texts 
//  international format   international format   international format 
//  Something else, oh dear... 
//  bubble series type   num bubble values 
//  correct saltHash for default password (and docId/saltHash) 
//  Have it processed 
//  Now overall 
//  indexed color 
// remove the sheet that needs to be reordered and place it in the spot we want 
//                 a1 = true;              } 
//  For some reason, there are two types that don't have a    separator despite the flags that indicate they do 
//  last knot 
//  Looks to be a truncated block   This isn't allowed, but some third party created files    sometimes do this, and we can normally read anyway 
//  "Time" validation type 
//  Check the current element 
//  Create a header and a footer 
//  lazily populated. This should only be accessed through getTableCache   keys are lower-case to make this a quasi-case-insensitive map 
//  special case for MMMMM = 1st letter of month name 
//  Every one of these component records is optional   (The whole PageSettingsBlock may not be present) 
/*  char 1   */
//  category data type   values data type 
//  add second slide with different order in object creation 
//  this method seems safer on Android than getFactory() 
//  expected during successful test   no negative index in the range message 
//  2nd is centre aligned (default) + normal line spacing 
//  this code is based on the libre office implementation.   The MS-OFFCRYPTO misses some infos about the various rotation sizes  
//  decrease the shape width from 300 pt to 100 pt 
//  Try it can be opened 
//  Add back, returns 
// options: HyperlinkRecord.HLINK_URL | HyperlinkRecord.HLINK_ABS | HyperlinkRecord.HLINK_LABEL 
//  This value MUST be composed of BrushData flags 
//  This is some odd Outlook 2002 thing, skip 
//  dvEmpty.xls is a simple one sheet workbook.  With a DataValidations header record but no    DataValidations.  It's important that the example has one SHEETPROTECTION record.   Such a workbook can be created in Excel (2007) by adding datavalidation for one cell 
//  Row '11' 
/*  */
//  row "2" 
//  single  Print_Titles built-in record 
//  check if the next char is garbage and limit the len if necessary 
//  8 byte 'not used' field 
//  Seems POI accepts longer numbers than Excel does, excel trims the   number to 15 digits and removes the "9" in the formula itself.   Not the fault of FIXED though. 
//  Return, without the leading = 
//  cs4 --> 24 -> 23 
//  Record this as the last row we saw 
//  end package scope class POIFSReaderRegistry 
//  Add some more tables, and check 
//  TargetMode (default value "Internal") 
//  The custom number format should be entirely removed from the workbook 
//  test conversion of cell from text to boolean 
//  SP @ 20 
//  They are intended for specifying a font when the specified typeface is not available. 
//  rewriting changes the size 
//  Theme color references are NOT positional indices into the color scheme,   i.e. these keys are NOT the same as the order in which theme colors appear   in theme1.xml. They are keys to a mapped color. 
// noinspection SuspiciousMethodCalls 
//  not xml, may be an image or other binary format 
// column greater than XFD 
//  Check case where both inputs are of wrong type 
//  Process each record in turn, looking for interesting ones 
//  fetch the unsafe instance and bind it to the virtual MH: 
//  http://doc.optadata.com/en/dokumentation/application/expression/functions/financial.html 
//  Remove all hyperlinks from a saved workbook 
//  Image one 
// 16-byte GUID. Seems to be always the same. Does not depend on the hyperlink type 
// there should be a relation to this drawing in the worksheet 
//  Aggregates don't have a sid   We could step into them, but for these needs we don't care 
//  In this case, the image will overlap part of another column and it is   necessary to calculate just how much - this will become the inset 
//  The default Style is already "none"   Therefore the new style already exists as Id=0  assertTrue(borderId > 0); 
// This will ensure that a run does not split a continue 
//  Maximum number of persist objects written 
//  Re-fetch the mini store, and add it a second time 
//  simple expansion of top   rows containing area top being shifted down: 
//  do a quick check if there is work to do to not incur the overhead if not necessary anyway 
//  in pixel 
//  target line   line of a scatter chart from 0 (min) to 1 (max) having value of target 
//  If this doesn't apply, no color change is expected 
//  Now grab their underling object 
//  Find how many SlideListWithTexts we have   Also, grab the Environment and PPDrawing records 
//  Custom name was stored 
//  Check drawing width 
//  Will it fit in a 8 bit atom? 
//  Last slide is 257 / 6 
//  font size 20   colour red 
// the point of this is to trigger the addition of  some common visio classes -- ConnectsType 
//  Get the target URI, excluding any relative fragments 
// commentTextAtom is missing 
//  Handle any "missing" cells which had comments attached 
//  Spaces muck things up a bit.  It would be clearer why the following cases are   reasonable if POI encoded tAttrSpace in the right places. 
//       } 
//  TODO - this seems to occur when IntersectionPtg is present   This example file "IntersectionPtg.xls"   used by test: TestIntersectionPtg.testReading()   has 10 bytes unused at the end of the formula   10 extra bytes are just 0x01 and 0x00   LittleEndianByteArrayInputStream in = new LittleEndianByteArrayInputStream(byteEncoding);   Ptg.readTokens(encodedTokenLen, in);   int nUnusedBytes = _byteEncoding.length - in.getReadIndex(); 
//  Get an element from the ArrayList that contains the data for   the workbook. This element will itself be an ArrayList   containing Strings and each String will hold the data recovered 
//  Color is a tint of white or black 
//  Now, have them moved to the right place 
//  Find where the next SlidePersistAtom is 
//  300 - 10 - 10   first line is NOT indented   other lines are indented by leftMargin (the value of indent is not used) 
//  in an earlier release the hashMagic (aka DigestAlgorithmIdentifier) contained only   an object identifier, but to conform with the header generated by the   javax-signature API, the empty <associated parameters> are also included 
//  missing, we add it 
//  Remove the 2nd 
//  ensure that this works for SUM 
//   the column counter 
//  If an array is square or is taller than it is wide (more rows than columns), LOOKUP searches in the first column. 
//  reserved 
// index of cell in row 
//  the opc spec allows case-insensitive filename matching (see #49609) 
//  Where +ve has a fraction, but -ve doesn't, we currently show both 
//  defined names may begin with a letter or underscore or backslash 
//  not necessary for HeapByteBuffer, avoid lots of log-output on this class 
//  MergedCellsTable usually here 
//  list delimiter is the nul char 
//  Aggregate drawing records 
//  Text Box. Print out first 8 bytes of data, then 8 4 later 
// drawing = ((XSSFSheet)sheet).createDrawingPatriarch(); 
//  short xf index   str len + flag 
//  Check they have what we expect in them 
//  Two fonts 
//  bug 55668: don't try to store null-string when formula   results in empty/null value 
//  If we get here, then there aren't any    free sectors in any of the SBATs   So, we need to extend the chain and add another 
//   2^200% -> 2 not 1.6E58 
//  Don't swap them around 
//   the same regular image 
// Set autoformat properties 
//  If array covers an area that is wider than it is tall (more columns than rows), LOOKUP searches for the value of lookup_value in the first row. 
//  any date format will do 
//  too few arguments 
//  From real files 
//  first run properties 
//  indentation before text 
//  horizontal position   vertical position 
//  center of text relative to text block 
//  Now the ppt un-encrypted header token (4 bytes) 
//  This isn't all that consistent, but it's the best we can really manage... 
//  move table without resizing, shouldn't change row or column count 
//  destination rows are within area ref (possibly exact on top or bottom, but not both)   - no change to area 
//  /p:sldMaster/p:cSld/p:spTree/p:sp/p:nvPr/p:ph[@type="title"] 
// 	} 
//  Next up, grab the data that makes up the 
//  encryption info doesn't exist anymore   SoftMaker Freeoffice produces such invalid files - check for "SMNativeObjData" ole stream 
// This also happens when you save this document as text from MSWord. 
//  check the cache first 
//  Read back in as-is 
//  Generate a single Text Piece Table, with a single Text Piece    which covers all the (8 bit only) text in the file 
//  How odd. RecordTypes normally substitutes in    a default handler class if it has heard of the record    type but there's no support for it. Explicitly request    that now 
//  The second print titles name record has getSheetNumber()==4 
//  Now ask for a free one, will need to extend the file 
//  Name that looks similar to a cell reference but is outside the cell reference row and column limits 
/*  There is no document summary information yet. We have to create a                 * new one.  */
//  First child should be the ExVideoContainer 
//  Check it now has three slides 
//  assume sheets are accessible via case-insensitive name 
//  First is 30 long, bold and font size 
//  use a NullOutputStream to not write the bytes anywhere for best runtime 
// 256 is because the width is in 256ths of a character 
// tmp.delete(); 
//   processing each bit of the flag byte in turn 
// stFile starts here: 
//  Has chart on 1st sheet?? 
//  Initialise the masks list 
// //////////////// Publisher 
//  If we're overwriting, free any remaining blocks 
//  old top column of area has moved deep within the area, and exposed a new top column 
//  skip rows before the start of this group 
//  check for empty text - only output a bullet if there is text, 
//  reset replace counter 
// noinspection deprecation - for performance reasons! 
// A1:C3 
//  print over then down 
//  18 @ 106   17 @ 11 
// Now its not shared! 
//  do we need to shift this part? 
/*  Fill the property with appropriate settings so that it specifies the         * document's title.  */
//  If workbook does not contain any data tables matching the provided name, getTable should return null 
/* OPCPackage p = */
// 			// make sure that RRA and VRA are in the right place  			// (Aug 2008) since the VRA is now part of the RRA, there is much less chance that  			// they could get out of order. Still, one could write serialize the sheet here,  			// and read back with EventRecordFactory to make sure... 
//  Should only ever be one of each of these 
//  is applied to an image being drawn. This value MUST be one of the values defined in the following table. 
//  typically file name 
// Set the value that is rendered for the cell  also applies the format 
//  high bounds check fail gives #REF! if arg was explicitly passed 
//  Assign it for easy lookup, as best we can 
//  btWin32   btMacOS   rgbUid   tag   size   cRef   foDelay   unused1   cbName (@ index 33)   unused2   unused3 
//  The distance from the arc's midpoint to the midpoint of its chord. 
//  Setup the fields to read and write the counts and starts 
//  0xc 
// Comment comment = null; 
//  options: UNC_PATH | LABEL | TEXT_MARK | ABS | FILE_OR_URL   label: "My Label" 
//  Save, re-load and re-check 
//  Data Consolidation Information 
//  this means the cell reference in the test is bad. 
//  is square. 
//  all other combinations of value types are silently ignored 
//  invoke TSP service 
//  public static int RESERVED1_BIT       = 1 << 1;   public static int RESERVED2_BIT       = 1 << 3;   public static int RESERVED3_BIT       = 1 << 5;   public static int RESERVED4_BIT       = 1 << 7;   public static int RESERVED5_BIT       = 1 << 9;   public static int RESERVED6_BIT       = 1 << 11;   public static int RESERVED7_BIT       = 1 << 13 | 1 << 14 | 1 << 15; 
//  end alignment options bitfields 
//  Test directly with the .000 style 
//  and still have them be the same 
//  Copy this into a temp file, so we can play with it 
//  Make sure we don't put in any extra new lines 
//  Check master text is there 
//  across subnormal threshold (some mistakes when close) 
//  pad to next 2-byte boundary (requires 0 or 1 bytes)   6 for 3 shorts: sid, dataSize, idOffset 
//  adding blank to 1.0 gives 1.0 
/*  Create a array for the current entry  */
//  Set the color to black (no theme). 
//  Certain file format writers skip the row number   Assume no gaps, and give this the next row number 
//  two HeaderFooterRecord records, the first one has zero GUID (16 bytes at offset 12) and belongs to the PSB, 
/*  if connecting is not possible this will throw a connection refused exception  */
//  and the other way around, use HWPF instead of XWPF and so forth 
//  Now check the contents are as expected 
//  A 32-bit unsigned integer that specifies the region type. This SHOULD be RDH_RECTANGLES (0x00000001) 
//  Should always be zero 
//  Notes record were corrupt, so don't expect any 
//  A 32-bit unsigned integer that specifies the format of the pixels that make up the bitmap image. 
//  Grab out our data 
//  check that invalid formula does throw exception 
//  Fallback exception 
//  Check the values went in 
//  save and recreate the workbook from the saved file 
//  there is a @  The rowNum is 0 based 
//  process cells backwards, because of shifting 
//  is this comment part of the current row? 
//  get property table from the document 
// Complex escher record 
//  Check the text is as we'd expect 
//  chunkSize is irrelevant 
//  18 @ 4078   18 @ 70 
//  currently linux and mac return quite different values 
// make sure it is so 
// filter covers two columns 
//  The default style shouldn't be added back to the styles source because it's built-in 
//  Should have 5 attachments 
// Test an uncompressed rich text string  Note that we can only ever get to a maximum size of 8227 since an uncompressed 
//  else - top area column has been replaced - both area top and bottom may move now 
//  note - cannot use IntPtg for negatives 
/*  Read the document summary information.  */
//  Presence / absence checks 
//  then it could be a Chinese date 
//  The y-coordinate of the ending vertex of a cubic Bezier curve relative to 
//  write the header data with the properties declaration 
//  area is moved down => overwritten area is [endColumn + n - movedColumns, endColumn + n] 
//  if the file after closing is different, then re-set    the file to the state before in order to not have a dirty SCM    working tree when running this test 
//  Icons : 5 ratings - Column S 
//  Capture the text, as long as it isn't    simply an empty string 
//  m12 (translateY) = eDy (The vertical translation component, in logical units.) 
//  from protected POIFS 
//  Shift end 1 forward 
//  so we need to use setRule() explicitly! 
//  Multiply Divide Formula 
//  the underlying writer is SheetDataWriter 
//  Should be 7th one 
//  FALSE   "FG" 
//  Eliminate any post-translation 
//  to maintain topLeft:bottomRight order 
/*  Print the number of properties in this section.  */
//  no change because no overlap: 
//  Ditto for our PersistPtr 
//  else - find smallest greater than or equal to 
//  check over max record size 
//  created without got none 
//  You don't get tinted indexed colours, sorry... 
//  For 'm' after 'h', output minutes ('m') not month ('M') 
//  'View Settings' (4 records) 
//  for formulas, we want to keep the type and only have an ERROR as formula value 
//  Check for the sheet index match, if requested 
//  Shift 1 to front 
//  something doesn't match so stop 
//  index to font table 
// replacement: 
//  Return this uncompressed one, or null if that isn't their either 
//  One rich block of text in that - text is all the same style 
//  Number of bytes the data part uses 
//  this is called by EscherPropertyFactory which happens to call it with empty parts   if a part is initial empty, don't allow it to contain something again 
/*  no-op  */
// //////////////// Mail/TNEF 
// don't check if it's not within the shifted area 
//  Nothing definitive was found, so we figure out it deductively 
//  Has a theme, which has the colours on it 
//  remove quotes and back slashes 
// noinspection deprecation 
//  A 32-bit unsigned integer that specifies the data in the OptionalData field. 
//  Check the text lengths are still right 
//  case CellType.NUMERIC 
//  If the table is the first body element of the footnote then   a paragraph with the footnote reference should have been   added automatically. 
//  Exports elements and attributes mapped with simpleXmlCell 
//  A 16-bit signed integer that defines the vertical (y) coordinate of the point. 
// actually found in document 
//  CryptoAPI 
//  returns this object as a line that extends between the boundaries of 
//  we have to handle a few cases here 
//  Create a pivot table on this sheet, with H5 as the top-left cell.. 
//  B7   B8   B68   B69 
//  A 32-bit unsigned integer that specifies the PenStyle. 
//  Grok the flags, stored as bits 
//  ConditionalFormattingTable goes here 
//  test WARNING 
// 								afp.setClass(Ptg.CLASS_ARRAY); 
/*              * "A Shd80 structure that specifies the background shading for the text. By default, text is not shaded."             *              * Word (.doc) Binary File Format. Copyright (c) 2011 Microsoft             * Corporation. Release: Tuesday, March 15, 2011              */
/*  Not 0.0 because POI sees date "0" minus one month as invalid date, which is -1!  */
// the name array is smaller so searching through it should be faster than 
//  Which contains our text 
//  Mini stream should be at big block zero 
//  bug 45565: text within TextBoxes is extracted by ExcelExtractor and WordExtractor 
//  Excel displays fraction: 51/512 
//  We have rows 0, 1, 2, 20 and 21   Row 0 has 1 entry   Row 1 has 4 entries   Row 2 has 6 entries   Row 20 has 5 entries   Row 21 has 7 entries   Row 22 has 12 entries 
//  Solid (continuous) pen   PS_DASH system   dash style   PS_DOT system   dash style   PS_DASHDOT system dash style   PS_DASHDOTDOT system dash style   square dot style   dash style   long dash style   dash short dash   long dash short dash   long dash short dash short dash 
//  in "e" formats,% and trailing commas have no scaling effect 
//  The row height and cell width are set here to ensure that the 
//  None set 
//  don't add a sprm if we're looking at an ico = Auto 
//  A 32-bit unsigned integer that defines the horizontal coordinate value of the rendering origin. 
//  Won't contain unknown 
//  alignment: 1 does have, 2 doesn't 
// A 16-bit signed integer that defines the number of points in the array. 
//  the original file contains a following value: 2009-07-20T13:12:00Z 
//  fib.setCcpFtn(fib.getCcpFtn() + adjustment);   } 
//   Calculate the Luminance 
//  access some more content (we had cases where writing corrupts the data in memory) 
//  add a marshaller that will throw an exception on save 
//  special case for the field_1_position_of_BOF (=lbPlyPos) field of   the BoundSheet8 record which must be unencrypted 
/*          * HWmf (2 bytes):  The resource handle to the metafile, when the metafile is in memory. When         * the metafile is on disk, this field MUST contain 0x0000. This attribute of the metafile is         * specified in the Type field of the META_HEADER record.          */
//  represented by the A cell. 
//  When formatting 'value', double to text to BigDecimal produces more   accurate results than double to Double in JDK8 (as compared to   previous versions). However, if the value contains E notation, this   would expand the values, which we do not want, so revert to 
//  The could below should catch "archive is not a ZIP archive" 
//  Trailing ' 
//  (Remember that excel row (n) is poi row (n-1) 
//  GenericPropertyNode property = new GenericPropertyNode(   tpt.getCharIndex( sepx.getStartBytes() ),   tpt.getCharIndex( sepx.getEndBytes() ), sed.toByteArray() ); 
//  Length 24 
//  width   height 
//  Work back until we find it 
//  If the source cannot be acquired, abort (no resources to free at this level) 
//  Hide all the columns until the end of the group 
//  cell does not fit on end of current row 
//  the file at test-data/spreadsheet/49219.xls has ExternalNameRecords without actual data,    we did handle this during reading, but failed during serializing this out, ensure it works now 
//  only handle non-null properties  
//  delete additional target line series legend entry 
//  If it starts with something like [Black] or [Yellow], 
//  records that contain the embedded EMF metafile. 
//  the data sources 
//  anything else is false, such as text 
//  last line can't be current, can it? 
// valid date formats -- all should have "Jul" in output 
//  from protected stream 
//  outlineLevel 
//  41484.999994200 = 23:59:59,499   41484.9999942129 = 23:59:59,500  (but sub-milliseconds are below 0.5 (0.49999453965575), XLS-second results in 59)   41484.9999942130 = 23:59:59,500  (sub-milliseconds are 0.50000334065408, XLS-second results in 00) 
//  wrongData has the ObjRecord data as would have been written by v3.1  
//  =index(C:C,2,1) -> 2 
// 				throw new AssertionFailedError("Identified bug 46312");  			}  		} 
// adjust indices of names ranges 
// try a numeric cell 
//  Check we get valid data for the two 
//  Save and re-load it 
//  application/vnd.ms-powerpoint 
//  powerpoint generates AlternateContent elements which cNvPr elements aren't recognized   ignore them for now 
//  verify proper behavior with null stream 
//  JDK 8 adds an empty locale-string, see also https://issues.apache.org/jira/browse/LANG-941 
// document-level container which stores info about all links in a presentation 
//  Extract the text from the file as a vector 
//  clear all cells in the range 
//  Check defaults 
//  a merged region already in this sheet 
//    General codepage fallback: Charset on a content type header. 
/*  Getters and setters  */
//  Master 
//  clear the offsets and sizes in our FileInformationBlock. 
// date 
//  Close the whole filesystem, and open it once more 
//  A 32-bit floating-point value that specifies the limit of the thickness of the join on a mitered 
//                 CTP p0 = body.getPArray(0); 
//  in CN=... format 
//  The POI Documents to work on 
//  cell does not have a comment 
//  SP @ 14 
//  Only last row should move 
//  this is necessary in Excel to actually make Workbook.setActiveCell() take effect 
//  Create a pivot table on this sheet, with H1 as the top-left cell.. 
//  Grab the de-compressed contents for later 
//  Within NameRecords, it's ok to have the formula    part point at deleted sheets. It's also ok to    have the ExternSheetNumber point at deleted    sheets.   However, the sheet index must be adjusted, or    excel will break. (Sheet index is either 0 for    global, or 1 based index to sheet) 
//  String msg = "Row[rownum="+mrow.getRowNum()+"] contains cell(s) included in a multi-cell array formula. You cannot change part of an array.";   assertEquals(msg, e.getMessage()); 
//  Create a new Xf with the same contents 
//  CalcChain has lots of entries 
//  fields in BOTH style and Cell XF records 
//  6 + 1 for Ptg 
//  Not mergeable      A B    1 x     A1,B2 --> A1,B2 
//  is it correct? 
//  size of header and color table, for start of image data calculation 
//  start with the assumption that the font is able to display the chars 
//  Note - backward iteration 
//  add overhead of SST record 
//  Excel seems write values 2, 10, and 260, even though spec says "must be zero" 
//  Find the versions of the core records we'll want to use 
//  Mid way through 
//  enforcing singleton 
//  spaces around sheet name (with or without quotes makes no difference) 
//  should be 1.0055, but has IEEE rounding 
//  darker 25% 
//  Good, it was detected 
// Relative path notation - for alternative EXCEL.exe - fallback 
// Test simple subtotal over one area 
//         bytesRemaining -= size;          remainingData  =  new byte[bytesRemaining];          System.arraycopy( data, pos + size, remainingData, 0, bytesRemaining ); 
//  would really love to know what goes in here. 
//  Repeat as many times as you have data 
//  "𝝊𝝋𝝌𝝍𝝎𝝏𝝐𝝑𝝒𝝓𝝔𝝕𝝖𝝗𝝘𝝙𝝚𝝛𝝜𝝝𝝞𝝟𝝠𝝡𝝢𝝣𝝤𝝥𝝦𝝧𝝨𝝩𝝪𝝫𝝬𝝭𝝮𝝯𝝰𝝱𝝲𝝳𝝴𝝵𝝶𝝷𝝸𝝹𝝺"; 
//  Format, using the nice new 
// directory can be null when creating new documents 
//  increase insets, the wrapping width should get smaller 
//  Keep just the first 6 bytes.  The rest is no good to us anyway. 
//  keep searching to return the last persistent object with that refId 
//  This is now the new end 
//  The message should have 4 attributes  
//  but we can read the conditional formatting itself 
//  end bitfields for additional palette options   fill palette options 
//  current value matches next value, add one 
//  now check for the password 
//  remove all conditional formatting for comparing BIFF output 
//  link slide and notes slide with each other 
//  should be ignored?!?, see MS-PPT ExOleObjAtom, but Libre Office sets it ... 
//  Update the Document+Properties streams in the file 
/*          * http://www.codecomments.com/archive281-2004-3-158083.html         *          * Algorithm proposed by Patrick TJ McPhee:         *          * read 2 bytes make sure they are 'ffd8'x repeatedly: read 2 bytes make         * sure the first one is 'ff'x if the second one is 'd9'x stop else if         * the second one is c0 or c2 (or possibly other values ...) skip 2         * bytes read one byte into depth read two bytes into height read two         * bytes into width else read two bytes into length skip forward         * length-2 bytes         *          * Also used Ruby code snippet from:         * http://www.bigbold.com/snippets/posts/show/805 for reference          */
//  skip this if the current value matches the next one, or is the last one and matches the previous one 
//  In case A, there is a single styling of the characters 
//  3 int fields 
/*  char 6   */
//  CTHyperlinks is regenerated from scratch when writing out the spreadsheet   so don't worry about maintaining hyperlinks and CTHyperlinks in parallel.   only maintain hyperlinks 
//  Just return if so and reset 'look' to something to keep   SkipWhitespace from spinning 
//  the relationship Target 
// Set CellStyle and RowStyle and ColumnStyle 
//  else - No intersection and no shared border: do nothing  
//  Prevent instantiation 
//  m$ doc calls this fWantAdvise 
//  sprmPNumRM 
//  this is from an open bug/discussion over handling localization for number formats 
//  clone needed? 
//  to report errors and loose data while reading the workbook 
//  see if this piece uses unicode.  From the documentation: If the second most significant bit  is clear, then this indicates the actual file offset of the Unicode character (two bytes). If the  second most significant bit is set, then the actual address of the codepage-1252  compressed version of the Unicode character (one byte), is actually at the offset indicated  by clearing this bit and dividing by two. 
//  You can add multiple spans for one row 
//  Save with leading = 
// the first item in the calculation chain is the former second one 
//  Allocate it, then ask again 
//  start with value blank, but expect construction to be immediately   followed by a proper call to setValue() 
//  compute angle of ellipse 
//  The y-coordinate of the last control point of a NURBS. 
//  get number of rows where row index < rownum   --> this tells us where our row should go 
//  not supported -> remove 
// wb.getAllPictures() should return the same instance across multiple calls 
//  skew the angles for AWT output 
// setting border to none removes the <bottom> element 
//  And the rest until the end of the big block is zeros 
//  Now reset, and try on a small bit 
//  Check if a segment ends with a dot ('.') character. [M1.9] 
//   preceded by a SupBookRecord 
//  Update our header with the size   Don't forget to knock 8 more off, since we don't include the 
//  Row '23' 
//  Check the core 
//  And that's it! 
//  First goes the number of characters we affect   MasterStyles don't have this field 
// sanity check 
//  Try to evaluate them 
//  A 32-bit unsigned integer that defines this record as a WMF Comment record. 
//   2 x  
//  This value MUST be greater than zero. 
//  data taken from bugzilla 44774 att 21790 
//  Ensure we can change them with other timezones and still read back OK 
//  Nothing to do 
//  Sanity check 
//  sometimes the wmfsize is smaller than the amount of already successfully read bytes   in this case we take the lastLen as-is, otherwise we truncate it to the given size 
//  png,gif,jpg or null for test 
// add it again! 
//  Check we can get the formula without breaking 
//  so read what's left of the current record 
//  only move 3D refs that refer to the sheet with cells being moved 
//  to match Excel's E-notation 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#setFormula2(java.lang.String)	  */
//  Should just be a single core document, complain if not 
//  write the second excel file 
//  B1   input row 1 
//  scRGB has a linear gamma of 1.0, scale the AWT-Color which is in sRGB to linear RGB   see https://en.wikipedia.org/wiki/SRGB (the reverse transformation) 
//  just an annotation, no code needed 
//  TODO Rounding 
//  Have everything recomputed 
// BitFields: (last row relative, last col relative, last column number) 
//  provide ExcelExtractor also in OOXML module, because scratchpad is not necessary for it 
//  Switch to newStyle, style is now un-used 
//  records to be aggregated 
// extract all pictures contained in the presentation 
//  for some combinations we expected exceptions 
//  add 6 more than they need for use the next iteration     commented - buffer shall not contain any additional bytes --   sergey   byte[] newBuf = new byte[_offset + addition + 6]; 
//   in read-write mode, not read-only mode 
//  With the finalised uri, should be fine 
//  csD -> cs1 -> 21 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#setOperator(int)	  */
//  Condition 4: Row divides by 3, grey background 
//  This re-assignment to the XSSFNames is not necessary if wb.write is not called. 
//  Remaining 15 bits of field 2 
// for a single-cell reference return A1 instead of A1:A1  for full-column ranges or full-row ranges return A:A instead of A,  and 1:1 instead of 1          
//  set the cell's string value to "TEST" 
//  A 16-bit signed integer that defines the vertical (y-axis) coordinate, in logical 
//  The ministore itself is made up of 23 big blocks 
//  String header looks wrong (probably missing)   OOO doc says this is optional anyway.   reconstruct data 
//  update sheet index of sheet-scoped named ranges 
// Create a unicode sheet name (euro symbol) 
// 45  95  450  950  995 
//  table(....)[][] 
//  should be empty 
//  currentOffset is now the location of the DBCELL record for this row-block 
//  we don't evaluate HSSF filters yet 
//  If there's no author, may be double padded 
/*  For writing the property set into a POI file system it has to be             * handed over to the POIFS.createDocument() method as an input stream             * which produces the bytes making out the property set stream.  */
//  ... so because being a stack, we will remove all entries having a greater index than the stackIndex 
//  third char run is 16 long   font.color only 
//  link to another slide 
//  Pick off the last one 
//  not modified 
/*  Change the author to "Rainer Klute". Any former author value will             * be lost. If there has been no author yet, it will be created.  */
//  Find all the embedded directories 
/*          * Allow signature facets to inject their own stuff.          */
//  Applying flip second time restores the original not-flipped transform 
//  Check the data is unchanged and the right length 
//  Remember - there is no 4! 
//  setting standalone doesn't work with xmlbeans-2.3 & 2.6   ed.documentProperties().setStandalone(true); 
//  Check our formula records 
//  ... 
//  TODO Last seen data 
//  Replicates record order from Excel 2007, though this is not critical 
//  Reals 
//  implemented both by a cfRule "text" attribute and a formula.  Use the text. 
//  Only care about the first few really though 
// both substring and length rely on char, not codepoints.  This test confirms that the substring calls in HwmfText  will not truncate even beyond-bmp data.  The last character (Deseret AY U+1040C) is comprised of 2 utf16 surrogates/codepoints 
//  currently (Oct 2008) POI handles this by exploding the whole shared formula group 
// colon in tz 
//  as per BIFF8 spec   Typically from third party programs   Typically odd Crystal Reports exports   Another third party program special 
//  As a workaround, have a few extra 0 bytes on the end! 
//  Some bug in StyleTextPropAtom rewriting means this will fail   We need to identify and fix that first  assertSlideShowWritesOutTheSame(hssB, pfsB); 
/*  int headerLength =  */
//  the exact example from the bugzilla description: 
//  otherwise try at least to perform extracting tests on these old files 
//  some files like equations don't have a valid filename,   but somehow encode the formula right away in the ole10 header 
//  Now, load via Usermodel and re-check 
//  Find and EscherTextboxRecord's, and wrap them up 
//  Might be in the name field, check there 
//  Remove the override definition for the specified part. 
//  but A1 still uses D1, so if it changes... 
//  the image is very close indeed to the column size. 
//  check that we can still create a tempfile 
//  application/vnd.openxmlformats-officedocument.drawingml.chart+xml   ?!MIME_TYPES.put(Pattern.compile(".*drawingml.*"), ".dwg"); 
//  the following two lines turn off writing CDATA   see Bugzilla 48936 
// JMH Look at when this method is called. Should it return a HSSFCell? 
//  Set empty paragraph and character styles 
//  clear cells 
//  no password given, no encryption record exits -> done 
//  do something with this at some point 
// assume that the doc is in that codepage. 
//  HSSFWorkbooks fail when writing out workbook 
//  dest columns overlap top of area   - truncate the top 
//  V6 stores it a 32 bit number at the offset 
//  301: TDIST 
// this works recursively to pull embedded tables from tables 
//  TODO: deep copy of certList 
//  fall through and look for other construction methods 
//  {   TP = _text.get(i);   
//  Save the byte into the dictionary 
//  externalSheetIndex 0 -> AnotherSheet 
//  HSSF returns one sheet higher than normal, and various bits 
//  ideally assertSame, but XSSFCell creates a new XSSFCellComment wrapping the same bean for every call to getCellComment. 
//  Standard formats 
//  default rendering options 
//  with PAPX reconstruction 
//  Check they're all available 
//  Slide 
//  A value that SHOULD be set to zero and MUST be ignored upon receipt. 
//  Write and re-load once more, to check that's ok 
//  Find the record 
//  Array Formula 
//  JDK xmlsec 
//  Values 
//  Set cal to now ... only set to fixed date for debugging ... 
// expand - 3 
/*          * Completion of undigested ds:References.          */
//   fail("not implemented"); 
//  Check the document styles 
//  header and verifier have to have the same cipher algorithm 
//  and that the other name is unaffected 
//  continue without log, this is expected in some setups   NOSONAR - also catch things like NoClassDefError here 
//  metafile. This value MUST be a multiple of 4 bytes. 
//  The default maximum size of extracted text 
//  Ignore empty strings 
//  Assume it has children, rather than being corrupted 
//  array sizes must match 
//  increment reference count for pictures 
//  application/x-mspublisher 
//  detect if this ppt was saved in Office2007 
//  A!C6   A!C7   A!C67   A!C68 
//  Create a ByteArrayOutputStream to hold everything in 
//  POI saves images as image1.png, image2.png, etc.   added images have indexes 0,1,2....19 
//  Grab our aggregate record, and wire it up 
//  Built in formats 
// expand - 2 
//  but the problem is observable in rows 2,3,4 
/*  Node found in map, just return it.  */
//  Applies to one cell only 
/* 		 * Read the custom properties. If there are no custom properties yet,		 * the application has to create a new CustomProperties object. It will		 * serve as a container for custom properties.		  */
//  A 16-bit signed integer that defines the bitmap type. 
//  Reset, and check the available goes back to being the 
//  MaxRecord (4 bytes):  A 32-bit unsigned integer that specifies the size of the 
//  a class to record a list of temporary files that are written to disk   afterwards, a test function can check whether these files were encrypted or not 
//  0x17 - 0x24 reserved for international and undocumented 0x25, "(#,##0_);(#,##0)"  start at 0x26  jmh need to do colour 
//  Shift 3 back 
//  draw text 
//  EncryptedVerifierHash: An array of bytes that contains the encrypted form of the hash of   the randomly generated Verifier value. The length of the array MUST be the size of the   encryption block size multiplied by the number of blocks needed to encrypt the hash of the   Verifier. If the encryption algorithm is RC4, the length MUST be 20 bytes. If the encryption   algorithm is AES, the length MUST be 32 bytes. After decrypting the EncryptedVerifierHash 
//  rectangular bounding box of picture, at 72 dpi 
// create the cell that will have the validation applied 
/*  Format         */
//  We now know how many unique special records we have, so init 
/*          * Try to find PictureData with this checksum. Create new, if none         * exists.          */
//  XBats 
//  see http://stackoverflow.com/questions/5637650/overriding-protected-methods-in-java 
//  iteration's result as the input for the next iteration). 
//  We can't find the date, sorry... 
//  Add the new picture in 
//  1904 windowing (LocalDateTime) 
//   all zero running from 24 bytes in to the end 
//  empirically tested in Excel - 0=false, any other number = true/valid 
//  rounding issues); use UTC here to prevent daylight saving issues for HOUR 
/*          * [M2.4] : The package implementer shall require that the Content Types         * stream contain one of the following for every part in the package:         * One matching Default element, One matching Override element, Both a         * matching Default element and a matching Override element, in which         * case the Override element takes precedence.          */
//  All done and added 
/*              * refer to the section on PAPX in the spec. Places a size on the             * front of the PAPX. Has to do with how the grpprl stays on word             * boundaries.              */
//  And check the values - blank 
/* lastRowToShift */
// Titles shown at the top of each page when printed 
//  assertArrayEquals(aehOrig.getEncryptedHmacValue(), aehReload.getEncryptedHmacValue()); 
//  Character is uppercase letter, find relative value to A 
//  see https://stackoverflow.com/questions/36063375 
//  test formula format 
// bar chart data. The first value is the bar color, the second is the width 
//  guess this is OK if the string length is zero 
//  End of normal5124 
//  Last cell should have one paragraph 
//  data 
//  Dump the contents of scher to screen. 
//  Core Workbook records go first 
//  optionally occurs if there are  references in the document. (4.10.3) 
/*          * in this mode we preserving PAPX/CHPX structure from file, so text may         * miss from output, and text order may be corrupted          */
//  So far we've been in sector counts, turn into bytes 
//  Update 
//  generated in Word 
// TestFormulaShifter.class, //converted to junit4 
//  Set the width of the column by converting the required image 
//  A 32-bit unsigned integer that specifies an index in the EMF+ Object Table for an EmfPlusPen object   to use for drawing the EmfPlusPath. The value MUST be zero to 63, inclusive. 
//  Now at high level 
// a new border has been added 
// ///////////////  Output the XML 
//  the POIFSFileSystem we belong to 
/*  (non-Javadoc)     * @see org.apache.poi.hssf.usermodel.PictureData#getData()      */
//  calling createCell on a non-existing cell should create a cell and set the cell value and style. 
//  rethrow to report errors correctly (we need to catch it here,   as we also catch RuntimeException below!): 
//    HTML and text body encoding: Internet CPID property.   UTF-8 is ignored for text body. This seems to be a special Outlook behavior. 
//  reset to not affect other tests 
//  Header row should be copied 
//  END OF CLASS 
//  Create columns in reverse order 
//  Make sure it is possible to create a conditional formatting rule   with every type of Border Style 
//  Grab all the remaining data, and ignore it 
//  untrackedColumns stores columns have been explicitly untracked so they aren't implicitly re-tracked by trackAllColumns 
//  org.apache.poi.hwpf.usermodel 
//  Handle matching things if we cross workbooks 
//  reserved1   reserved2 
//  handle both cases correctly. There is surely a better way to do this, though... 
//  Will go one place higher as XBAT added in 
//  Check they're as expected 
//  The cell wanted is in this merged range   Return the primary (top-left) cell for the range 
//  mailto:ebgans@mail.ru?subject=Hello,%20Ebgans! 
//  The angle of an arc's major axis relative to the x-axis of its parent. 
//  missing media type and subtype 
//  Ensure the destination is free 
//  Firstly by byte 
//  options: TARGET_FRAME | ABS | FILE_OR_URL   targetFrame: "_blank" 
//  serialize to byte array 
//  Should be a reasonable guess. 
// set print area from column a to column c (on first row) 
//  Need to process the argument of SUM with transformFunctionNode below 
//  Figure out how big it is 
//  Happy day flow 
//  Now parse the first 512 bytes, and produce 
//  short side 
/*  Check whether we have exactly two command-line arguments.  */
//  Going to have to do it a slower way, because we have   to update the length come the end 
//  For now, pretend to be an atom 
//  Icons : 3 traffic lights 2 - Column J 
//  (Also need to tell it where it is) 
//  check for corrupted user edit atom and try to repair it 
//  be setting the overlapMM value to zero. 
//  link to slide - relative reference 
//   to itself 
//  bug 60260: shift rows or rename a sheet containing a named range 
//  ... -1 is a rounding error 
//  don't know why this record doesn't seem to get encrypted 
//  record length not yet known ... 
//  then fill the shape interior 
//  destination columns are completely outside area ref 
//  Make sure placeholder text does not come out 
//  limit wrong calculated ole entries - (bug #57080)   standard encryption always uses aes encoding, so blockSize is always 16    http://stackoverflow.com/questions/3283787/size-of-data-after-aes-encryption 
//  Grab the record data 
//  field_7_palette_options bit map 
//  284: FISHERINV 
//  Set Cell Color : GREEN 
// swallow what's left 
//  if the frame references a chart, associate the chart with this instance 
//  No really. Someone clearly forgot to read 
//  find ExternalBlock for Add-In functions and remember its index 
//  Save and re-open, both still there 
//  handle (b) and (c) 
//  and to the specified directory. 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getPromptBoxTitle()      */
//  finish with 0x04 (int) ??? 
//  Excel re-writes these to point to no sheet 
//  Copy a test file over to our temp location 
//  Array header 
// re-creating a row does NOT add extra data to the parent 
//  where does this 4 come from??? 
//  Check that the filesystem can give us back the same bytes 
//  remove the formula cells in C4:C6 
//  Check the stream as-is 
// if the text is already set, it should be overridden, not added twice! 
//  C5:D7 will be shifted down with same size 
//  This is the one class that's directly using printf, so it can't use   the default handling for quoted strings and special characters.  The   only special character for this is '%', so we have to handle all the   quoting in this method ourselves. 
//  Implementation detail: POI natively prefers <w:b w:val="false"/>,   but should correctly read val="0" and val="off" 
//  Do a full evaluate, as per our docs 
//  And escher pictures 
//  currently throws NPE because unknown function "currentcell" causes name lookup  
//  CREATE_NULL_AS_BLANK - creates as needed 
//  bug 52063: LOOKUP(2-arg) and LOOKUP(3-arg) 
//  bug 59983:  Wrong update of shared formulas after shiftRow 
/*                  * if it just empty fo:inline without "id" attribute doesn't                 * making sense to add it to DOM                  */
//  Open the newly created file to check core properties saved values. 
//  Actually move 
//  The value MUST be in the WMF Ternary Raster Operation enumeration 
// unmodified 
//  map file extensions to the actual mappers 
//  Allocate a few 
/*  Byte order     */
//  no instance data 
//  Serialise the bulk of the String   The writeString handles tricky continue stuff for us 
//  Ensure thaat the folder the user has chosen to save the CSV files   away into firstly exists and secondly is a folder rather than, for 
//  Now, build records based on the PowerPoint stream 
//  above regarding the behaviour of image resizing. 
//  remember file base, which needs to be closed too 
//  5 shorts + 6 bytes 
// long 
// 			File dir = new File("c:/temp");  			File effDocFile = new File(dir, SOURCE_DOC_FILE_NAME);  			processFile(effDocFile, outFile);  			return;  		} 
// padding bytes 
// a span of columns [1,5] 
//  append a forward slash to avoid parse exception 
//  These formula contents are a guess... 
//  300 - 10 - 10 - 36 
//  check for internet, no error means it works 
/*  Read a custom property.  */
//  The x-coordinate of the curve's control point relative to the shape's   width; a point on the arc. The control point is best located about 
//  password protected files without password   ... currently none ... 
//  create basic XML container structure 
//  Get all the data into a single array 
//  Add the offset to the first cell for the row into the   DBCellRecord. 
//  skip reserved. 
//  cell-level policies 
// however in LittleEndian order, this is the first encountered. 
//  find chart in the slide 
//  3 @ 4093   8 @ 28 
//  Should have 1 master 
// should be original picture width and height expressed in EMUs 
// set font 1 to 12 point type 
//                 wb.write(fileOut); 
//  xls file is 
//  All collapsed  
// 16-byte link moniker: HyperlinkRecord.FILE_MONIKER 
//  Create the drawing entry for it 
//  even an empty string is not equal the empty cell, only another empty cell is, handled higher up 
//  The x-coordinate of the arc's control point; a point on the arc. The   control point is best located about halfway between the beginning and   ending vertices of the arc. Otherwise, the arc may grow to an extreme   size in order to pass through the control point, with unpredictable 
//  And some near a few of them 
//  no notes on slide 
//  Found one 
//  don't include the text if reviewing is enabled and this is a deleted run 
/*  char 9   */
//  Multiple calls to autoSizeColumn need to look up the best-fit width   of rows already flushed to disk plus re-calculate the best-fit width   of rows in the current window. It isn't safe to update the column   widths before flushing to disk because columns in the random access   window rows may change in best-fit width. The best-fit width of a cell   is only fixed when it becomes inaccessible for modification.   Changes to the shared strings table, styles table, or formulas might   be able to invalidate the auto-size width without the opportunity   to recalculate the best-fit width for the flushed rows. This is an   inherent limitation of SXSSF. If having correct auto-sizing is   critical, the flushed rows would need to be re-read by the read-only 
/*  Compare the property set stream with the corresponding one             * from the origin file and check whether they are equal.  */
//  comodoca request fails, if default policy is set ... 
//  2nd read works 
//  see constants above 
//  Self-referential external reference 
//  "Offset=0x0008BB19(572185) recno=159 sid=0x00FF size=0x201A(8218)\n" + 
//  CellAddress=A1, shifted to A4 
//  StreamSize (8 bytes): An unsigned integer that specifies the number of bytes used by data    encrypted within the EncryptedData field, not including the size of the StreamSize field.    Note that the actual size of the \EncryptedPackage stream (1) can be larger than this    value, depending on the block size of the chosen encryption algorithm 
//  Note - Excel does not strictly require -1 and +1 
// assertNotNull(new CellFormatPart("_-* \"\"??_-;_-@_-")); 
//  initialise PSB with some records, but not the header / footer 
//  Fetch the rest of the block if needed 
//  then compare magnitudes (IEEE 754 has exponent bias specifically to allow this) 
//  These two format calls should return the same thing but don't: 
/*  handle case where MMULT is operating on an array that is not completely filled */
//  Note: documentation does not define a default, return ListAutoNumber.ARABIC_PLAIN (1,2,3...) 
//  Store it for lookup 
//  Error 
// Range of cells which the shared formula applies to 
//  should agree within 0.01% 
//  Some fonts support plain/bold/italic/bolditalic variants   Others have different font instances for bold etc 
//  Check if the specified part is not a relationship part 
/*              * Check if the argument is a function. Certain names can be either a cell reference or a function name             * depending on the contenxt. Compare the following examples in Excel 2007:             * (a) LOG10(100) + 1             * (b) LOG10 + 1             * In (a) LOG10 is a name of a built-in function. In (b) LOG10 is a cell reference              */
// create 50 cells 
//  lots of notes before us 
/*  Read first word.  */
//  Internal picture, nothing to return 
//  setting an evaluation of function arguments with the intersect operator (space) 
//  overwrite range1 with first result 
// all slides use the first master slide 
//  Make sure copyRowFrom actually copied row (this is tested elsewhere) 
//  To update the iruns, find where we're going 
//  0xf0a0 not defined / euro symbol   0xf0a1 upsilon1 (upper)   0xf0a2 minute   0xf0a3 lessequal   0xf0a4 fraction   0xf0a5 infinity   0xf0a6 florin   0xf0a7 club   0xf0a8 diamond   0xf0a9 heart   0xf0aa spade   0xf0ab arrowboth   0xf0ac arrowleft   0xf0ad arrowup   0xf0ae arrowright   0xf0af arrowdown   0xf0b0 degree   0xf0b1 plusminus   0xf0b2 second   0xf0b3 greaterequal   0xf0b4 multiply   0xf0b5 proportional   0xf0b6 partialdiff   0xf0b7 bullet   0xf0b8 divide   0xf0b9 notequal   0xf0ba equivalence   0xf0bb approxequal   0xf0bc ellipsis   0xf0bd arrowvertex   0xf0be arrowhorizex   0xf0bf carriagereturn   0xf0c0 aleph   0xf0c1 Ifraktur   0xf0c2 Rfraktur   0xf0c3 weierstrass   0xf0c4 circlemultiply   0xf0c5 circleplus   0xf0c6 emptyset   0xf0c7 intersection   0xf0c8 union   0xf0c9 propersuperset   0xf0ca reflexsuperset   0xf0cb notsubset   0xf0cc propersubset   0xf0cd reflexsubset   0xf0ce element   0xf0cf notelement   0xf0d0 angle   0xf0d1 gradient   0xf0d2 registerserif   0xf0d3 copyrightserif   0xf0d4 trademarkserif   0xf0d5 product   0xf0d6 radical   0xf0d7 dotmath   0xf0d8 logicalnot   0xf0d9 logicaland   0xf0da logicalor   0xf0db arrowdblboth   0xf0dc arrowdblleft   0xf0dd arrowdblup   0xf0de arrowdblright   0xf0df arrowdbldown   0xf0e0 lozenge   0xf0e1 angleleft   0xf0e2 registersans   0xf0e3 copyrightsans   0xf0e4 trademarksans   0xf0e5 summation   0xf0e6 parenlefttp   0xf0e7 parenleftex   0xf0e8 parenleftbt   0xf0e9 bracketlefttp   0xf0ea bracketleftex   0xf0eb bracketleftbt   0xf0ec bracelefttp   0xf0ed braceleftmid   0xf0ee braceleftbt   0xf0ef braceex   0xf0f0 not defined   0xf0f1 angleright   0xf0f2 integral   0xf0f3 integraltp   0xf0f4 integralex   0xf0f5 integralbt   0xf0f6 parenrighttp   0xf0f7 parenrightex   0xf0f8 parenrightbt   0xf0f9 bracketrighttp   0xf0fa bracketrightex   0xf0fb bracketrightbt   0xf0fc bracerighttp   0xf0fd bracerightmid   0xf0fe bracerightbt   0xf0ff not defined 
//  there are some WMF implementation using this record as a MFCOMMENT or similar   if the commentIdentifier doesn't match, then return immediately 
//  Condition 3: Row divides by 5, bold 
//  EXCLUDED.put("44958_1.xls", RecordInputStream.LeftoverDataException.class); 
// style name and aliases string 
//  lazy getter 
//  common case   field_2_n16 seems to be 5 here   The formula almost looks like tTbl but the row/column values seem like garbage. 
//  Underscores not the right place, something's wrong 
//  reset stream (not only) in case we were interrupted by plain stream parts   this also needs to be set to prevent an endless loop 
//  only validate first part 
//  Check the script one 
//  msg files with non-standard encodings 
//  Check its children too 
// read the reference sound file 
// Create cell style 
//  If this record is ever implemented, change to one that isn't!   This is checking the "unhandled default" stuff works 
/*  (non-JavaDoc) Created directory path is <JAVA_IO_TMPDIR>/poifiles/prefix0123456789  */
/*  char 10  */
//  Ensure the text is what we should now have 
//  draw a thick black border on the row at the bottom using BLANKS 
//  don't bother about files we cannot read - they are different bugs 
//  Sheet 1 doesn't (yet) 
// @Test 
//  In some cases, the salt value of the EncryptionVerifier is the next chunk of data 
// check that EscherDggRecord is updated 
//  SET Verifier TO Intermediate3 BITWISE XOR PasswordByte 
//  An optional EmfPlusFocusScaleData object that specifies focus scales for the path gradient brush.   This field MUST be present if the BrushDataFocusScales flag is set in the BrushDataFlags field of the 
//  mar 
//  password protected files 
//  confirm the evaluation result too 
//  Turn data_a into data_b 
//  [MS-DOC], v20140721, 2.6.4, sprmSNFtnRef 
//  Reserved 
// add 3 row breaks 
//  range [6-4] is illegal 
// percentile has to be between 0 and 1 - here we test more than 1 
//  Check we can get the english text out of that 
//  Formulas on rows that weren't shifted: 
//  See bug 59719 
//  sometimes there are missing bytes after the imageData which will be 0-filled 
//  into order, if they're not already 
//  initialize with default value; msonfcLCRoman 
//  with Calendar: 
//  formula 1 length 
// get chart number 
//  Should always be zero   Should always be zero 
//  Keep in sync with {@link RowShifter#removalNeeded} 
//  Paragraph style should be sum of text length 
/*  Test an empty custom properties set.  */
//  author not found -> add new author 
//  cached formula result calculated by Excel 
/*              * there is an effect on Bug45743.doc actually. writeoutreadback             * changes byte offset of chars (but preserve string offsets).             * Changing back to original lines - sergey              */
//  bar space   category space 
//  tick mark frequency   options 
//  Do we need to store as a mini stream or a full one? 
//  always OK to set functions to return 'value' 
//  Non-breaking hyphens are stored as ASCII 30 
//  Test row creation with non consecutive index 
//  Set when cell start element is seen; 
//  make sure the resulting number of executions is correct 
//  log forging escape 
//  we know it is a number in the proper range, now check if it is an int   can't get here without a valid numeric value 
//  cell containing a formula with COUNTIF 
//         FileOutputStream out = new FileOutputStream("/tmp/51451.xlsx");          wb.write(out);          out.close(); 
// If this argument contains a decimal value, this function ignores the numbers to the right side of the decimal point. 
//  some convenience factory methods 
//  but setting a precalculated STRING value fails totally in SXSSF 
//  The first knot of a spline. 
//  index of color value   options 2       -- strange upper bits supposed to be 0'd 
//  Borders 
//  Field Codes (w:instrText, defined in spec sec. 17.16.23)    come up as instances of CTText, but we don't want them    in the normal text output 
//  newer duplicate user defined styles 
// CustomViewSettingsRecordAggregate 
//  Grab the document stream 
// <-- works 
//  A10:C12 
//  A signed integer that defines the vertical extent of the window in logical units. 
//   that that is now used if no policy given 
//  Return the comment, or null if not known 
//  Check the encryption details 
//  The focus scale MUST be a value between 0.0 and 1.0, exclusive. 
//  CHOOSE 
//  CT* classes don't handle "mc:AlternateContent" elements, so get the Dxf instances manually 
//  spaces are used to simulate that character. 
//  Serialize 
//  Check bytes weren't the same 
//  was plain cell before - no change of type 
//  not implemented yet: case SxNamePtg.sid:       return new SxNamePtg(in);       // 0x18 
//  If they give a date in 1900 in Jan/Feb, with the days 
//  Check still right 
//  skew 
// 			System.err.println(result);  		} 
//  Ensure they are the right (latest) version of each 
//  first copy unchanged 
//  8 bytes of reserved zeros 
//  extract text from a powerpoint that has a footer in the master-slide 
//  Is it a different Zip-based format? 
// end of interface implementation 
//  rlen = (int)LittleEndian.getUInt(pictstream, offset+4); 
//  Performance issue. If we encapsulated management of min/max in this   class then we could keep trackedCols as state,   making this log(N) rather than Nlog(N). We do this for the initial   read above. 
//  start and end cell references 
//  UserSViewEnd 
//  Otherwise children must match 
//  End 
// Well the format runs are equal as well!, better check the ExtRst data 
//  all these operations are on an area ref spanning columns 20 to 25 
//  For now, we think these are shorts 
//  This used to throw an error before 
//  NB: If a table cell does not include at least one block-level element, then this document shall be considered corrupt. 
//  Read several blocks work 
// Creating new Named Range 
//  Basic 2 page example 
//  ignore event 
//  sprmPFInTable -- 0x2416 
// now load the hyperlinks from the bottom of the sheet 
//  read first formula data condition 
//  don't alert for small expanded size 
// serialize and read again. 
//  Add a link, check it does 
//  get the Workbook (excel part) stream in a InputStream 
//  Has 2 fills 
//  tell _workbookRecordList about the 2 new records 
//  Extra field:   ZIP64 field signature   size of extra field (below)   uncompressed size 
//  Raw XML - File 
//  all others are plain BIFF records 
//   last block is at 89 
// don't care? 
//  -2 to skip EOF record 
//  234 == 0x00EA; 238 == 0x00EE 
//  produces #N/A 
//  m02 (translateX) = eDx (The horizontal translation component, in logical units.) 
//  we'll need multiple editions for the different formats 
//  Get the ExObjList 
//   of CTSheet elements in the workbook 
//  startPos with fractional digits 
/*  ********** START implementation of DirectoryEntry **********  */
// BitFields: (first row relative, first col relative, first column number) 
//  may 
//  Bug 57456: some Excel Sheets send 0 as field=1, but have some random number in field_2, 
/* ... */
//  this updates FontPos for us 
// char type = unicode 
//  String  wb = new XSSFWorkbook(file.getPath());  assertCloseDoesNotModifyFile(filename, wb); 
//  Wrap and return (non-cachable - CellFormat does that) 
//  Buffer underrun - requested 512 bytes but 192 was available 
//  fix up firstCol and lastCol indexes 
//  Check the length was as expected 
//  also remove any hyperlinks associated with this row 
//  invalid level 
//  date formatted as 'm'   'mmm' is wider than 'm'   date formatted as 'mmm'   'mmm/dd/yyyy' is wider than 'mmm'   date formatted as 'mmm/dd/yyyy' 
/* String oldVal = */
//  back slashed have been replaced with forward 
//  . is a special regexp char 
//  Check basics 
//  is not compressed unicode 
//  Init the arrays that we can 
//  re-calculate cell references 
//  Series Text 
//  Check for unreserved character like define in RFC3986 
//  Do our best with some edge cases 
//  Numbers 
//  If only name1 is __XXX then this will be placed after name2 
//             wb.write(out); 
//  A 32-bit unsigned integer that specifies the size of the buffer of rectangles in bytes. 
//  aes has always a block size of 128 - only its keysize may vary 
// sheet Id of a sheet the cell belongs to 
//  Our data is always 512 big no matter what 
//  Test IF-Equals Formula Evaluation (bug 58591) 
//  this should be 4 as XSSFSimpleShape creates a default paragraph (no text), and then we added 3 paragraphs 
//  What colours they should show up as 
//  References to a range (area) of cells: 
//  New list starting at 10 
/*  Try do handle this document as a property set. We receive         * an exception if is no property set and handle it as a         * document of some other format. We are not concerned about         * that document's details.  */
// containsRow  containsColumn 
//  odd row 
//  additionally, you can adjust the axes 
//  Save as our custom properties 
// never null 
// 51519 
/*         assertEquals("321 / ?/?",   dfUS.formatRawCellContents(321.321, -1, "# #/# ?/?"));        assertEquals("321 / /",     dfUS.formatRawCellContents(321.321, -1, "# #/# #/#"));        assertEquals("321 ?/? ?/?",   dfUS.formatRawCellContents(321.321, -1, "# ?/? ?/?"));        assertEquals("321 ?/? / /",   dfUS.formatRawCellContents(321.321, -1, "# ?/? #/# #/#")); */
//  Now add in on 2, should go to the front 
//  no PAP reconstruction   assertEquals( 7, r.numParagraphs() ); 
//  Check the contents too 
//  test growth 
//  all three of the following attributes are palette options 
//  Will need to be in the main stream 
//  only close the filesystem, if we are based on the root node.   embedded documents/slideshows shouldn't close the parent container 
//  Check the mini stream was added, then the main stream 
//  test conversion of cell from boolean to text 
//  a bit trickier 
//  we should have the same color for the row styles 
//  Continue sid   rec size 7 (1+6)   this bit uncompressed   3 uncompressed unicode chars 
// if all else fails 
//  specified in page 25 
// columns A-C have default width 
//  See Bugzilla 53984   see Bugzilla 50426 
//  in unicode 
//  the destination rectangle, having the same dimension as the source rectangle 
//  object with respect to the width of the graphics pen that is used to draw the lines. 
/*      * Write all properties supported by HPSF to the summary information     * (e.g. author, edit date, application name) and to the document     * summary information (e.g. company, manager).      */
//  Check the header was written properly 
//  currently EMF is better supported than EMF+ ... so if there's a complete set of EMF records available,   disable EMF+ rendering for now 
//  hyperlink ends before end of current textrun 
// should still match defaults; 
/*                  * if cell style is defined (like borders, etc.) but cell text                 * is empty, add "&nbsp;" to output, so browser won't collapse                 * and ignore cell                  */
//  sum of all values in the 2nd row: 4 + 5 + 6 = 15 
// <cols>    <col min="1" max="1" customWidth="true" width="10.0" />    <col min="2" max="2" customWidth="true" width="15.0" />    <col min="3" max="3" customWidth="true" width="20.0" />    <col min="4" max="4" customWidth="true" width="25.0" />    <col min="5" max="5" customWidth="true" width="30.0" />  </cols> 
//  might as well evaluate the sucker... 
//  should actually be 0.6   should actually be -0.6 
//  this updates XfPos for us 
//  Apply additional horizontal/vertical offset after alignment.   Values are as percentages. 
/*  (non-Javadoc)     * @see org.apache.poi.ss.formula.EvaluationSheet#isRowHidden(int)     * @since POI 4.1.0      */
/*  Add a custom property.  */
//  This value MUST be in the ModifyWorldTransformMode enumeration 
// Maximum length of the password is 15 chars. 
//  This value is not an integer index into the dash pattern array. 
// Cell A1 = getCell(sheet, 2, 2); 
//  Check the new headers still have their text 
//  An 8-bit unsigned integer that specifies the midline of the font. 
//  Apply 
//  Cell Formula with Reference spanning multiple rows 
//  Turn on 
//  These are inconsistent settings, so ditch 'em 
// this doesn't test the exact code path for this issue, but  it does test for a related issue, and the fix fixes both.  We should try to add the actual triggering document  to our test suite. 
//  check for icon set 
//  boundary color to the center color as it moves from the boundary to the center point. 
//  Icons : 4 ratings - Column R 
//  Not evaluated yet 
// handle sdtbody without an sdtpr 
//  New list 
//  dummy url 
//  Move on to the next one, if we're not at the end yet 
// numFmtId in xml terms  the second byte is ignored 
//  Section / line? 
//  fill 
// noinspection EmptyTryBlock,unused 
//  Check the formatting 
//  modified 
//  see 18.8.19 fgColor (Foreground Color) 
/*  transfer series to record list  */
//  Create a workbook, row and cell to test with 
//  first try to find the factory over the rendering hint 
/*          * The following error is thrown when shifting the 3rd row on top of the 0th row         * If the rows are not created, the error does not occur        org.apache.xmlbeans.impl.values.XmlValueDisconnectedException            at org.apache.xmlbeans.impl.values.XmlObjectBase.check_orphaned(XmlObjectBase.java:1258)            at org.openxmlformats.schemas.spreadsheetml.x2006.main.impl.CTRowImpl.getR(Unknown Source)            at org.apache.poi.xssf.usermodel.XSSFRow.getRowNum(XSSFRow.java:363)            at org.apache.poi.xssf.usermodel.TestXSSFSheetShiftRows.bug59733(TestXSSFSheetShiftRows.java:393)          */
//  Biggr block size, back to real BATs 
// cut off the record header 
//   it if that's required 
//  check all rows in case of merged rows 
/* 		ex45978-extraLinkTableSheets.xls is a cut-down version of attachment 22561.		The original file produces the same error.		This bug was caused by a combination of invalid sheet indexes in the EXTERNSHEET		record, and eager initialisation of the extern sheet references. Note - the workbook		has 2 sheets, but the EXTERNSHEET record refers to sheet indexes 0, 1 and 2.		Offset 0x3954 (14676)		recordid = 0x17, size = 32		[EXTERNSHEET]		   numOfRefs	 = 5		refrec		 #0: extBook=0 firstSheet=0 lastSheet=0		refrec		 #1: extBook=1 firstSheet=2 lastSheet=2		refrec		 #2: extBook=2 firstSheet=1 lastSheet=1		refrec		 #3: extBook=0 firstSheet=-1 lastSheet=-1		refrec		 #4: extBook=0 firstSheet=1 lastSheet=1		[/EXTERNSHEET]		As it turns out, the formula in question doesn't even use externSheetIndex #1 - it		uses #4, which resolves to sheetIndex 1 -> 'Data'.		It is not clear exactly what externSheetIndex #4 would refer to.  Excel seems to		display such a formula as "''!$A2", but then complains of broken link errors.		 */
//  [1,2,0,1,2,0,...,0,1]   Changes first element to 2   [1,2,3,4,...,99,100] 
//  area is moved down => overwritten area is [endRow + n - movedRows, endRow + n] 
//  bounds or deleting them 
//  undocumented attribute to research functions!~ 
// b) first 2 subtotals don't consider the value of nested subtotal in A3 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getErrorBoxTitle()	  */
//  Open a writer onto the CSV file. 
//  some values in column E 
//  search for non-printable characters 
//  Formatted numbers   TODO            assertContains(text, "100.00%");            assertContains(text, "155.00%");            assertContains(text, "1,125");            assertContains(text, "189,945");            assertContains(text, "1,234,500");            assertContains(text, "$169.00");            assertContains(text, "$1,253.82"); 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getPromptBoxText()      */
//  find an unused part name 
//  another switch: the fWantAdvise bit specifies whether the body describes   an external defined name or a DDE data item 
//  if the merged-region and the overwritten area intersect, we need to remove it 
//  0x30 is supported by uncompressCHP(...) 
//  usermodel needs to set this 
//  remove thousands separators 
// multi-cell array formula 
//  single column ColumnInfoRecord 
//  identical up to the 32nd char 
// Set the value that is rendered for the cell 
//  the next 4 bytes are unused 
//  some values in column D 
//  { // grpprl.length-2 because we don't store the istd   throw new UnsupportedOperationException(   "This Paragraph's dataStream storage is too small." );   } 
//  Set to the start of the file 
//  Java is 0 based 
// default font 
//  A 32-bit signed integer that defines the vertical resolution, 
// collapsed 
//  Finally we need to clone the font, 
//  change [wbA]ASheet1!A3 (from 100 to 80) 
//  most simple operators convert -0.0 to +0.0 
//  The package open is instantaneous, as it should be. 
//  Create the trailer and separator, if required 
//  Row 5 has string, formula of string, number, formula of string 
//  If the link was not found, rebuild the list (maybe a new link was added into the document) and check again. 
//  If not, check with the font style added 
//  it doesn't have any styles   first char run is 21 long 
//  They can come in any order, which is just nasty   Work backwards from the end, picking the last    on off each time as we go 
// goto isn't a real formula element should not show up 
//  Now test the default strip flag 
//  We certainly found an encoded character, check for length 
//  remove any remaining illegal references in _rows.cArray 
//  note - these (non-combinable) enum values are sparse. 
//  create a new workbook 
//  adjust active sheet if necessary 
//  Create a new textbox, and give it lots of properties 
//  we need to add null-records, otherwise the index references to other existing don't work anymore 
//  encoded length 
//  Make it easy when debugging to see what isn't the doc 
//  FileOutputStream out = new FileOutputStream("/tmp/test48877.xlsx");   wb.write(out);   out.close(); 
// b) the maximum denominator can be calculated from the formatString 
//  Found in CommonCrawl corpus but not in the docs... 
// test file with gaps in the sheetId sequence 
//  second pass: compute summary statistics 
//  Is it XSLF? 
//  validated 
//  A 32-bit unsigned integer that specifies the point size at which font  hinting is performed. If set to zero, font hinting is performed at the point size corresponding 
//  cell C10 
//  pivot table records 
// read again 
//  store test from TestSheetUtil here as it uses XSSF 
//  ... therefore falling back to classloading attempts 
//  Neither defined nor reserved   Neither defined nor reserved   Neither defined nor reserved 
//  Find records of interest 
//  Demonstrate bug 44525:   Well... not quite, since isActive + isSelected were also added in the same bug fix 
//  Found <sheetData/ 
//  get inside vertical border components 
/*  Register name and ID in the dictionary. Mapping in both directions is possible. If there is already a   */
//  Build the first data validation to occupy cell A1. Note   that it retrieves it's data from the named area or region called   CHOICES. Further information about this can be found in the 
//  Check they are as expected for the test doc 
//  https://en.wikipedia.org/wiki/BMP_file_format #  Bitmap file header 
//  Find the interesting ones in there 
// slide 3 
//  changed level 
//  Extractor primed on the test data 
//  Reference to just one sheet 
//  Try to treat it as a local sheet 
//  Check that properties table was given block 0 
//  since we don't know how to handle these yet :( 
// have to remove/add it back 
//  no data fields 
//  A 32-bit unsigned integer that specifies the stretch mode and MAY be   in the StretchMode enumeration. 
//  1981 is one year after our pivot year (so this starts working) 
//  set foreground fill to red 
// slide 2 
//  They are slides 1+2 
//  but only when "newMid == highIx-1"? slightly weird.   It would seem more efficient to always do this. 
//  Comes out as NaN if treated as a number   And as XYZ if treated as a string 
//  fake sid 
//  trailing white spaces must be url-encoded, see Bugzilla 53282 
//  serialize the PSB to see what records come out 
//  Get the type 
/* biggest     */
// level 
// contains a reference to the cell where the hyperlink is anchored, getRef()  what the hyperlink refers to 
//  when the arg is an area, choose the top left cell 
//  Currently still sees the Master Sheet, but might not in the future 
// slide 1 
// length of the path ) 
//  Write collapse flag (stored in a single col info record after this outline group) 
//  Now alter a few of them 
//  helper method to break a recursion loop introduced because of an IBMJCE bug, i.e. not resetting on Cipher.doFinal() 
//  Handle missing column 
//  line ends, a line join makes the connection look more continuous. 
//  m00 (scaleX) = eM11 (Horizontal scaling component) 
//  Optimise, should remove the two un-used ones and the one duplicate 
//  Check it has what we'd expect 
//  Check byte level with b 
//  options   index number format record 
//  Protected, correct password, opens fine 
// according to #2.4.304 
//  Might not have all formatting it should do! 
// getRows(); 
//  construct out HSSFRequest object 
//  Levels taken from http://msdn.microsoft.com/en-us/library/microsoft.exchange.data.contenttypes.tnef.tnefattributelevel%28v=EXCHG.140%29.aspx 
//  pick the first non-default, non-symbol charset 
//  put the starting offset of the property into the plcf. 
//  verify behavior of getEntryCount 
//  calculate the correct pos as our run/irun list contains   hyperlinks 
//  Shifting all but first line down to test comments shifting 
//  Find the location of the PersistPtrIncrementalBlocks and 
//  otherwise, it MUST be set to 0x00. 
//  needs clone() inside this getter?   needs clone() inside this getter? 
// Who says that this can only ever be compressed unicode??? 
//  Write the placeholder IDs 
//  Sheet 3 starts with a drawing 
//  check for 'free ref' functions first 
//  Copy properties from properties stream. 
//   2nd block is at 1 
//  calls to user-defined functions within the workbook   get a Name token which points to a defined name record 
//  maximum number of iterations is exceeded 
//  Make the selection 
//  The following is taken from the Libre Office implementation   It seems that the encrypt and decrypt method is mixed up   in the MS-OFFCRYPTO docs 
//  We already have it! 
//  Calculate the group numbers of important groups.  (They shift around   when the pattern is changed; this way we figure out the numbers by   experimentation.) 
//  move EncryptionRecord to last slide position 
//   new locations of the fonts 
//  Remove all relationship parts associated 
//  all the rest are "reserved" 
//  how many strings are included in the string table   size in bytes of the extra data 
//  This used to fail with an OutOfMemory 
//  col inp col 0 
//  not affected 
//  49928.xlsx has been saved with a poundFmt that overrides the default value (dollar) 
//  Save and re-open 
//  An 8-bit unsigned integer that specifies an underlined font if set to 0x01; 
//  1%	1.3%	2.1%	2% 
//  All coordinates need to be converted to Master units (576 dpi) 
//  corrupt file, negative image size 
//  get the ending fc   int endingFc = _paragraphs.get(_paragraphs.size() - 1).getEnd(); 
/* 	 * Layout must have reasonable default values and must not throw	 * any exceptions.	  */
//  else - bottom area row has been replaced - both area top and bottom may move now 
//  rebuild document paragraphs structure 
//  catch all exceptions here as we are only interested in file-handle leaks 
// Special info mask of this run; 
//    1 slide layout 
//  Overriden content types 
//  Write out our children 
//  UserEditAtoms 
// First create value based validation; 
//  sprmPDyaBefore 
//  sprmPRsid 
//  OK to return this because immutable 
//  Our first BAT block has spares 
//  Ensure none of the paragraphs refer to one that isn't there, 
//  Date is prior to 3/1/1900, so adjust because Excel thinks 2/29/1900 exists   If Excel date == 2/29/1900, will become 3/1/1900 in Java representation 
//  Ones that are odd and we won't change 
//   as the non existant 1900-01-00 
//  ref is outside source rows   check for clashes with destination 
//  integrityHMAC needs to be updated before the encryption document is created 
//  removes leading and trailing quotes from a quoted string 
//  Tangent Formula: "tan x y" = (x * tan( y )) = value of this guide 
//  Put in some dummy content 
//  NOSONAR - also catch things like NoClassDefError here   throttle the log somewhat as it can spam the log otherwise 
/*  assert shape properties when reading shapes from a existing workbook  */
//   read it 
//  PT_CLOSEFIGURE   A PT_LINETO or PT_BEZIERTO type can be combined with this value by using the bitwise operator OR   to indicate that the corresponding point is the last point in a figure and the figure is closed. 
//  Move the cell to the new position 
//  numeric quantities follow standard boolean conversion rules   for strings, only "TRUE" and "FALSE" (case insensitive) are valid 
//  add list data on another sheet 
//  from https://stackoverflow.com/questions/51530552/   customize the chart 
//  also verify general POIFS-stuff 
//  Should've found one 
//  else - numeric value parses OK 
//  One using the only-recently-documented encryption header type 4, 
//  SlideShow primed on the test data 
//  Save, load and re-check 
//  A 32-bit unsigned integer that specifies the width of the line drawn by the pen.   If the pen type in the PenStyle field is PS_GEOMETRIC, this value is the width in logical   units; otherwise, the width is specified in device units. If the pen type in the PenStyle field is 
//  Based on regular expression defined in JavaDoc at {@link java.lang.Double#valueOf}   modified to remove support for NaN, Infinity, Hexadecimal support and floating type suffixes 
//  Find the child records in the escher data 
//  Get the row's height in millimetres and add to the running total. 
//  Produce an overall summary 
//             b.append("w"); 
/*          *  m  = merged region         *  f  = array formula         *  fm = cell belongs to a merged region and an array formula (illegal, that's what this tests for)         *           *   A  B  C         * 1    f  f         * 2    fm fm         * 3    f  f          */
//  Check it's the right length 
//  sprmPAnld80  
//  Now Add a mini stream 
//  byte 
//  Add a bigger Normal Stream 
//   the correct values 
//  File Moniker 
//  To make the image occupy the full width of the column, convert   the required width of the image into co-ordinates. This value   will become the inset for the ClientAnchorDetail class that 
//   the destination row 
// add the same entry again 
//  Update the size (header bytes 5-8) 
//  8 bytes unused: 
// Strings are equal, so now compare formatting runs. 
//  Strings get interned... 
//  And should have 54 MAPI attributes on it 
//  https://bz.apache.org/bugzilla/show_bug.cgi?id=60980 
//  now check text properties 
//  shape 
//  Now check the compressed intermediate version 
//  for each interface 
//  Create one big buffer 
//  'assignment-style formula in a macro sheet' 
//  Excel and DataValidationConstraint parser ignore (strip) whitespace; quotes should still be intact 
//  char flags 0x0001 = bold   font size 20 
//  pack.originalPackagePath = file.getAbsolutePath(); 
//  Check text on first slide 
//  String does not resolve to a number. Raise #REF! error. 
//  be sure to blank cell, in case it is currently a formula 
//  y = mx + c 
//  comment is now in row 1 
/*          * bytelength is the length of the string in bytes, which depends on whether the string is         * made of single- or double-byte chars. This is given by charType, which equals 0 if         * single-byte, 1 if double-byte.          */
//  Formula referencing one cell in a different sheet 
//  ignore me 
//  based on https://gist.github.com/EmmanuelOga/48df70b27ead4d80234b 
/*          * Saved chart space must have the following namespaces set:         * <c:chartSpace         * xmlns:c="http://schemas.openxmlformats.org/drawingml/2006/chart"         * xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"         * xmlns:r=         * "http://schemas.openxmlformats.org/officeDocument/2006/relationships">          */
//  the value of -1.0 resets to the defaults 
//  calls System.exit(): SLWTListing.main(new String[0]); 
//  Now check on a rich text run 
//  the same style prior to modifying the style 
//  If font is not set we must set the default one 
//  Do we need to change the grouping character?   eg for a format like #'##0 which wants 12'345 not 12,345 
//  10 + 1 for Ptg 
//  Excel probably wouldn't mind, but there is much logic in this class   that assumes the column info records are kept in order 
//  Clean columns and test a clean worksheet 
//  special handling for SlideShow-Theme-files,  
/*          * Read the header fields of the stream. They must always be         * there.          */
//  Adding Comment to new created Sheet 2 
//  Read from temp file and check the number of cells in each 
//  destination columns are within area ref (possibly exact on top or bottom, but not both)   - no change to area 
//  First we need to clone the extended format    record 
//  TODO - test the type 12s 
// create drawing 
//  Wind on the position marker 
//  The string is always 112 characters (padded with spaces), therefore   this record can not be continued. 
//  make sense of the part data 
// refers to A1 but on Sheet2. Should stay unaffected. 
//  Add them in 
// @Override 
//  Performance optimization for bug 57840: explicit boxing is slightly faster than auto-unboxing, though may use more memory 
//   (1 / 2) - (3 * 4) 
//  Took approx. 600ms on a decent Laptop in July 2016 
//  level 2: title placeholder on the master slide 
//  test number formats 
//  some corrupted documents currently can cause this excpetion 
//  didn't find it 
//  we need to do it now separately ... 
//  The degree of a spline (an integer from 1 to 25). 
//  Normal charset 
//  no instances of this class 
/*     The records below are records that would appear in a simple bar chart    The first record links to the series title (linkType = 0).   It's    reference type is 1 which means that it links directly to data entered    into the forumula bar.  There seems to be no reference to any data    however.  The formulaOfLink field contains two 0 bytes.  This probably    means that there is no particular heading set.============================================Offset 0xf9c (3996)rectype = 0x1051, recsize = 0x8-BEGIN DUMP---------------------------------00000000 00 01 00 00 00 00 00 00                         ........-END DUMP-----------------------------------recordid = 0x1051, size =8[AI].linkType             = 0x00 (0 ).referenceType        = 0x01 (1 ).options              = 0x0000 (0 )    .customNumberFormat       = false.indexNumberFmtRecord = 0x0000 (0 ).formulaOfLink        =  (org.apache.poi.hssf.record.LinkedDataFormulaField@95fd19 )[/AI]    The second record links to the series data (linkType=1).  The    referenceType = 2 which means it's linked to the worksheet.    It links using a formula.  The formula value is    0B 00 3B 00 00 00 00 1E 00 01 00 01 00.    0B 00   11 bytes length    3B (tArea3d) Rectangular area        00 00 index to REF entry in extern sheet        00 00 index to first row        1E 00 index to last row        01 00 index to first column and relative flags        01 00 index to last column and relative flags============================================Offset 0xfa8 (4008)rectype = 0x1051, recsize = 0x13-BEGIN DUMP---------------------------------00000000 01 02 00 00 00 00 0B 00 3B 00 00 00 00 1E 00 01 ........;.......00000010 00 01 00                                        ...-END DUMP-----------------------------------recordid = 0x1051, size =19[AI].linkType             = 0x01 (1 ).referenceType        = 0x02 (2 ).options              = 0x0000 (0 )    .customNumberFormat       = false.indexNumberFmtRecord = 0x0000 (0 ).formulaOfLink        =  (org.apache.poi.hssf.record.LinkedDataFormulaField@11b9fb1 )[/AI]    The third record links to the series categories (linkType=2).  The    reference type of 2 means that it's linked to the worksheet.    It links using a formula.  The formula value is    0B 00 3B 00 00 00 00 1E 00 01 00 01 00    0B 00   11 bytes in length        3B (tArea3d) Rectangular area        00 00 index to REF entry in extern sheet        00 00  index to first row        00 1F  index to last row        00 00 index to first column and relative flags        00 00 index to last column and relative flags============================================Offset 0xfbf (4031)rectype = 0x1051, recsize = 0x13-BEGIN DUMP---------------------------------00000000 02 02 00 00 69 01 0B 00 3B 00 00 00 00 1F 00 00 ....i...;.......00000010 00 00 00                                        ...-END DUMP-----------------------------------recordid = 0x1051, size =19[AI].linkType             = 0x02 (2 ).referenceType        = 0x02 (2 ).options              = 0x0000 (0 )    .customNumberFormat       = false.indexNumberFmtRecord = 0x0169 (361 ).formulaOfLink        =  (org.apache.poi.hssf.record.LinkedDataFormulaField@913fe2 )[/AI]This third link type does not seem to be documented and does not appear tocontain any useful information anyway.============================================Offset 0xfd6 (4054)rectype = 0x1051, recsize = 0x8-BEGIN DUMP---------------------------------00000000 03 01 00 00 00 00 00 00                         ........-END DUMP-----------------------------------recordid = 0x1051, size =8[AI].linkType             = 0x03 (3 ).referenceType        = 0x01 (1 ).options              = 0x0000 (0 )    .customNumberFormat       = false.indexNumberFmtRecord = 0x0000 (0 ).formulaOfLink        =  (org.apache.poi.hssf.record.LinkedDataFormulaField@1f934ad )[/AI] */
//   duplicate floating ones 
// sheet1.setRowGroupCollapsed(7,false); 
//  Error values also returned unmodified 
//  make sure we start at 0 
// "IV" for .xls and  "XFD" for .xlsx 
//  duplicate slide and chart before applying "destructive" tests to it 
//  For now, we don't support localised currencies, so simplify if there 
// show that LocaleUtil has no effect on these tests 
//  unused 
//  outlook30 has chunks for all 3 body formats 
//  Check we get the right font name for the indicies 
//  Bits (4 bytes): This field MUST be ignored. 
//  Strip off the locale information, we use an instance-wide locale for everything 
//  Or do it on one line. 
//  restore the coordinate system 
//  try at the end 
// Windows notation for drive letters 
// 						"value D4 #BLANK#", "value E4 #BLANK#", 
//  XML is 1 based, POI is 0 based 
//  A 32-bit unsigned integer that specifies number of glyphs in the string. 
//  test with just long enough file 
//  Find our FontCollection record 
//  don't close underlying ZipOutputStream 
//  need to compare it again, in case a run has been added after 
//  ClaimedRole 
//  New filesystem and store to use 
//  Now, look at the one we changed, wrote out, and read back in 
//  If this attribute is omitted, then a value of 0.05 inches is implied 
//  put some values in the cells to make the evaluation more interesting 
//  TextDirection.STACKED is not supported 
// write data rows 
//  A 16-bit unsigned integer that defines the format of each pixel, and the 
//  Set the rows to repeat from row 0 to 2 on the second sheet. 
//  A 16-bit unsigned integer that defines the number of polygons in the object. 
//  Found <sheetData> 
//  index should equal number of CHPXs that will be in this fkp now. 
// subsequent call of Picture#resize() will operate relative to it 
//  special case, empty trailing text run 
//  a signed integer that defines the x/y-coordinate, in logical units. 
//  same wb   across workbooks 
//  sort lower-row values first when shifting up 
//  Smallest double 
//  reserved   reserved   reserved   reserved 
//  or new HSSFWorkbook() 
//  remove "fake" cell 
//  special characters from the ooo document 
//  JaCoCo Code Coverage adds it's own field, don't look at this one here 
//  first row on the sheet   last row   supposed to be zero   array of offsets to DBCELL records 
//  this '==' matches +0.0 and -0.0   Excel converts -0.0 to +0.0 for '*', '/', '%', '+' and '^' 
/*  The variant type is not supported yet. However, if the value         * is a byte array we can write it nevertheless.  */
// here we test where there are errors as part of inputs 
//  Add a few pictures 
//  Can't represent 0.0 or -0.0 with NormalisedDecimal 
//  Change cs1, hash will alter 
//  +1 to include delimiter 
//  the coordinate system of this group of shape 
//  Set initial values 
// end deleted sheet 
//  inside 
//  to iterations. 
// XSSFTestDataSamples.writeOut(wb, "bug 54084 for manual review"); 
//  Make the header no longer repeating 
//  may specify no special formatting for that value partition, but that's display logic 
// 45  95  450  950  995  490  495  990  99  49  49  99  490  495  499  995  999   990  495  499   995  999  499  999 
//  Either an EmfPlusRect or EmfPlusRectF object that defines the bounding box of the image. The portion of 
//  <a:sysClr val="window" lastClr="FFFFFF"/> 
//  Create it 
//  Check that the SBAT is empty 
//  CellAddress=D21, will be unaffected 
//  Now read the XFAT blocks, and the FATs within them 
//  Row 16 has a single string in B16 
//  2 * Area3DPtg.SIZE + UnionPtg.SIZE 
//  corner of the source rectangle. 
//  remove just the first picture 
//  add any extra results beyond the first 
//  A 128-bit WMF RectL object, which specifies bounding rectangle, in device units 
//  if there are borders on the west or east then   the second line shouldn't cross them 
//  no-op, expected to throw but we need to assert something more 
//  The value MUST be defined from the PenStyle enumeration table 
//  border type   options 
/*  ===============================================================	 *                   Internal Move Helpers	 * ===============================================================	  */
//  split, but keep delimiter 
//  shall we discard cbLSD and mpstilsd? 
//  some sheets do not have rowNum set in the XML, Excel can read them so we should try to read them as well 
// The scope of this one is Sheet2. Should stay unaffected. 
//  the simple approach via _sh does not work as it creates rows in the XSSFSheet and thus causes   corrupted .xlsx files as rows appear multiple times in the resulting sheetX.xml files   return _sh.removeArrayFormula(cell); 
//  Try writing 1, should truncate 
//  Write, read, check 
// contains 6 HemfCommentEMFPlus records within it 
//  colour 
//  Read them in 
// create CTRow attached to the parent object 
//  picture data 
//  +1 -> for one past the last index 
//  Attr   jumpTable 
//  attempt to overwrite a existing row in the input template 
//  return true; 
//  This sample data was created by setting the 'user name' field in the 'Personalize'    section of Excel's options to \u30A2\u30D1\u30C3\u30C1\u65CF, and then    creating a cell comment. 
/*  Check OPC Compliance  */
//  return empty path if either GEOMETRY__VERTICES or GEOMETRY__SEGMENTINFO is missing, see Bugzilla 54188 
//  SUM(sheet1!B3:C3) 
//  This fails in Java 10 because our reflection injection of the ThresholdInputStream causes a   ClassCastException in ZipFile now   The relevant change in the JDK is http://hg.openjdk.java.net/jdk/jdk10/rev/85ea7e83af30#l5.66 
//  Note: we expect that all the complex types are defined at root level 
//  Second is size 20, default font 
//  identity   contains 
//  Print the record's details 
//  Icons : 3 flags - Column M2 Only 
//  Performance optimization: explicit boxing is slightly faster than auto-unboxing, though may use more memory   NOSONAR 
// this relies on readChunk's readFully to skipFully 
//  With Slides, Notes and Master Text 
//  excess decimals are simply rounded away 
// Set source for the pivot table 
// cells are now sorted 
//  create the Formula-Cell 
//  verify can delete empty directory 
//  our variable names stolen from old TV sets. 
//  cross over   options 
//  define two custom user-defined functions 
//  This should work fine 
//  non-colored sheets do not have a color 
//  SP @ 8   SP @ 14 
//  DC_PEN   The solid-color pen that is currently selected in the playback device context. 
//  5.38.3 'Add-In Functions' 
//  (Document, Notes, Slide etc) 
// HeaderRecord  FooterRecord   DimensionsRecord   WindowTwoRecord 
//  By r:id 
//  If it's a position aware record, tell it where it is 
//  true type font and no font substitution 
//  A 32-bit unsigned integer that specifies the number of child nodes in the RegionNode field. 
//  Nexts and counts 
//  things that parse OK but would *evaluate* to an error 
//  expect consuming formula cached result to get cleared 
//  get B3 and evaluate it in the cell 
/*  **********  END  extension of Entry **********  */
//  <-works 
//  Delete some part to have a valid document 
//  keep searching - sometimes there's another record 
//  --------------- Friendly getters / setters on rich text properties ------- 
//  Is it a single local sheet, or a range? 
//  overlap that cannot be merged 
//  instantiate the following classes so they'll get picked up by   the XmlBean process and added to the jar file. they are required   for the following XWPFTableCell methods. 
//  can lead to unpredictable results. 
// Test 2D and 3D Ref Ptgs (Pxg for OOXML Workbooks) 
//  Allocate almost all the blocks 
//  github-43   https://github.com/apache/poi/pull/43 
//  add between B and D 
//  level 5: text properties are defined in the text run 
//  Reset and try changing an intermediate value 
//  -- CHANGE the shift to positive once the behaviour of 
//  Get the sizes and zoom ratios 
//  7-11 
//  mask is 0x070004   char flags 0x0004 = underlined 
//  Check the reading of blocks 
//  for password '5ecret'   for password '5ecret' 
// sheet index  start column  end column  start row  end row 
//  Paste styles only 
//  The first row will hold the data for the first validation. 
//  The Source File/Folder, Destination Folder, Separator and   Formatting Convnetion were passed to the main method. 
//  Check all the colours 
//  quotes not allowed like that   spaces not allowed   characters above ASCII are not allowed 
//  First is for master  assertEquals(-2147483648, notes.get(0)._getSheetNumber());  // When we do slide masters 
//  grow with 50% extra 
//   PersistPtrFullBlock or PersistPtrIncrementalBlock starts 
//  Zap from rows 1 and 3 
// assert the correct month form, as in the original Excel format 
//  set the text piece position to the current docStream offset. 
//  Remove the run from the low-level XML 
//  sign & validate 
//  POIFS 
/* 	 * (non-Javadoc)	 * 	 * @see	 * org.apache.poi.ss.usermodel.DataValidationHelper#createFormulaListConstraint	 * (java.lang.String)	  */
//  Set the 'pre-evaluated result' for the formula   note - formulas do not preserve text formatting. 
//  also test longer string 
//  do to keep the algorithm homogeneous...you can't 
//  Now another file, expect multiple headers    and multiple footers 
//  surely shorter than an int... 
//  The x-coordinate of the ending vertex of a polyline. 
//   hyperlink, then the end point of the text. 
//  in the normal runs, and go in there 
/* 		 * Data taken from two example files		 * ex42564-21435.xls		 * bug_42794.xls (from bug 42794 attachment 20429)		 * In both cases, this data is found at offset 0x0C1C.		  */
// MSODRAWING 
//  plus julian leap days in prior years   minus prior century years   plus years divisible by 400   leap days in previous 1900 years 
//  http://bugs.java.com/view_bug.do?bug_id=4724038 for related discussions 
//  ignore exceptions from old parsers that don't support this API (https://bz.apache.org/bugzilla/show_bug.cgi?id=62692) 
//  edge-case when the pattern length is 1 we go straight to replacing 
//    are two) 
//  copy sheet's relations 
// if any format has '?', then replace the fraction with spaces 
//  operate 
// fos.close(); 
//  test what happens if we close the Workbook before we write it out 
//  do this to reuse the out-of-bounds logic and message from XSSFWorkbook 
//  anchor.setCol1(2); 
//  disjunct 
//  The version of operating system graphics. This value MUST be defined in the GraphicsVersion enumeration 
//  Seems to be: 
//  Create two cells, will return one higher 
//  character run 
//  Jump our little way along, creating records as we go 
//  Our first one should be a document atom 
//  Copy properties from MSG file system. 
//  or output warning to stderr 
//  need to convert the short to unsigned short as the indexes can be up to 64k   ideally we would use int for this index, but that would need changes to some more    APIs 
//  must only be used to create empty documents, do not use it for parsing! 
//  Add new properties 
//  A 32-bit unsigned integer that specifies the size, in bytes, of the source bitmap header. 
//  Applies to us 
//  A problem could occur if the image is sized to fit into one or   more columns. If that occurs, the value in the toColumn variable   will be in error. To overcome this, there are two options, to   ibcrement the toColumn variable's value by one or to pass the   total number of co-ordinate positions to the third paramater   of the ClientAnchorDetail constructor. For no sepcific reason,   the latter option is used below. 
//  unset percentage if points is now set 
//  simplification 
//  small optimization: don't go via StringBuilder if not necessary,    the encodings are very rare, so we should almost always go via this shortcut.  
//  Grab interesting bits 
// remove the columns part 
//  Something about continues... 
// options: HyperlinkRecord.HLINK_URL | HyperlinkRecord.HLINK_LABEL 
//  Check the formats are as expected 
//  Fetch the stream ID 
//  Add it into the list + records 
//  Date - try two ways to find it 
//  Now check what sheet looks like after move 
//   re-start its HSSFFontCache 
//  in the state that it was in prior to the invocation 
//  NOTE: XWPFDocument.removeFootnote() delegates directly to          XWPFFootnotes. 
//  <Default Extension="sigs" ContentType="application/vnd.openxmlformats-package.digital-signature-origin"/> 
//  verify: signature 
// setting border to none removes the <top> element 
// let's check also that returns the correct paragraph 
//  Should have WordDocument and 1Table 
//  default 
//  in EMF the index must > 0 
//  but SubtractEval does not convert -0.0, so '-' and '+' work like java 
// Array to hold Key Values 
//  and the adjustable arrow cap object has a width of 3, the actual arrow cap is drawn 15 pixels wide. 
//  shall not fail with assertions on 
//  AttrPtg.class, // [volatile ] // POI doesn't do this yet (Apr 2009)   len 57   [A1]   [0]   [0]   [OFFSET nArgs=3]   [B2:C3] 
//  backcolor index 
//  XSSFWorkbooks fail when creating and setting the cell address of the comment 
// Only open this file with Excel 2013 to keep binary specific to that version 
//  Simulating cell formula of "= 4" (note space)   The same Ptg array can be observed if an excel file is saved with that exact formula 
//  Try to write-out and read again, should only work 
//  A 32-bit unsigned integer that specifies the size of the DIB header. 
//  Both A and B close to threshold - weird results 
// set default properties for a picture 
//  GRAY_BRUSH - A gray, solid-color brush   BrushStyle: BS_SOLID   Color: 0x00808080 
//  sprmCHpsMul -- 0x4A4D 
//  Add another 
//  329: PERCENTRANK 
//  SansSerif is a better choice than Dialog 
// YK: should return Collections.unmodifiableList(pictures); 
//  Add a new duplicate, and two that aren't used 
// Set the text alignment of the cell 
// not sure what the byte after the _chs does 
//  We should be 3 characters bigger, as 
//  anchor is set in constructor based on numRows/numCols 
//  sprmPOutLvl  
//  document link anchored on a shifted cell should be moved   Note that hyperlinks do not track what they point to, so this 
//  The next block of data to be written out, minus 
//  the test file contains a wrong ole entry size, produced by extenxls   the fix limits the available size and tries to read all entries 
// set the cell format see HSSFDataFormat for a full list 
//  Can only decode properly later when you know the codepage 
// numeric value 
//  actual msg reported in bugzilla 47229 is different   because that seems to be using a version from before svn r646666 
//   length as based of 0, not 8 (including header size based) 
//  this shouldn't happen, since we are Cloneable 
//  func is last RPN token in all these formulas 
//  "-scale", "1.333333333", 
//  PowerPoint Document - binary file format 
//  write out, read back, and test refrain... 
//  check that default is true 
//  sanity check our row 
//  tRefNA 
//  The line segments SHOULD be drawn using the current pen. 
// dump the structure of the powerpoint document 
//  Block 184 should exist 
//  First cell of array formula, OK 
//  We need to decompress it below 
//  although sunjc2 supports md2, hmac-md2 is only supported by bouncycastle 
//  Build a formatter for this simplified string 
//  Root property tells us about the Mini Stream 
//  This value MUST be composed of PenData flags 
//  Note that text pieces don't have to be stored in order! 
// Arbitrarily set.  May need to increase. 
// total number of shapes in the ppt  max number of shapeId 
//  Smart Tags can be nested many times.   This implementation does not preserve the tagging information 
//  loop until we find a null-terminated end 
//  String schemaFilename = Configuration.getPathForXmlSchema()+   File.separator + "opc-relationships.xsd"; 
//  if we are based on an outline, there are no further records to be parsed from the wrapper 
//  Chars -> Chars 
//  "=SUMIFS(B2:E2, B3:E3, ">3%", B4:E4, ">=2%")" 
//  Look up an External Link Table for this name 
//  Release one 
// 1_000; 
//  'would be' error msg changed at svn r703620   "Illegal length - asked for -126 but only 130 left!"   "Bad requested string length (-126)" 
/* Cell a5 = */
//  else - must be plain function 
//  shape factory methods 
//  cache entry doesn't exist. nothing to do 
//  Get the index for the right most cell on the row and then   step along the row from left to right recovering the contents   of each cell, converting that into a formatted String and 
//  The boundary of the path gradient brush, which is specified by either a path or a closed cardinal spline.   If the BrushDataPath flag is set in the BrushDataFlags field, this field MUST contain an 
//  in the mostRecentCoreRecords array 
//  to be performed, and about the structure of the record. 
//  A 32-bit floating-point value that specifies the scale factor to apply along   the axis to convert from page space units to .01mm units.   This SHOULD be used only if the graphics mode specified by iGraphicsMode is GM_COMPATIBLE. 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationHelper#createFormulaListConstraint(java.lang.String)	  */
//  Has +ve, -ve and zero rules 
//  Ask getFontAt() to build it for us, 
//  create a string cell (see why += 2 in the 
//  circle div 2: 360 / 2 = 180 
//   the output stream 
//  RegionNode MUST contain at least one element. 
//  throws NumberFormatException if rowRef is not convertible to an int   -1 to convert 1-based to zero-based 
//  ArrayList 
//  Flush the package 
//  If we've already seen any of the "slide" IDs for this   PersistPtr, remove their old positions 
//  See http://xmlgraphics.apache.org/fop/0.95/metadata.html 
//  FAILS before fix for #63292 
//   starts, or 0 if this is the first one 
//  This field MUST exist if and only if the containing Obj?s cmo.ot is equal to 0x14. 
//  First match, just set the value. 
//      // x is text that is not a boolean       return false;   }   testValue = boolToInt(val.booleanValue()); 
// UNC paths have \u0003 chars as path separators. 
//  paragraph is 30 long 
//  Merged 
//  Comment is rId6 
//  This used to be an error but now parses.  Union has the same behaviour. 
// arbitrary limit on size of strings to read, etc. 
//  It doesn't have any core properties yet 
// Setting its reference 
//  helper methods to adjust list of presets for other tests 
/*  int length =  */
//  Could it be an OOXML-Strict one? 
//  A single FAT block can address 128/1024 blocks 
//  xadesv141::TimeStampValidationData 
//  expected during successful test 
//  ADTL Palette 0   Fill Palette 20c0 
//  add TargetMode attribute (as it is external link external) 
//  Write out the record data 
// //// Case 1: Evaluate "Table1[col]" //////// 
// out.format("<link href=\"excelStyle.css\" rel=\"stylesheet\" type=\"text/css\">%n"); 
/*              * [MS-DOC]             *              * Page 104 of 622             *              * A signed 32-bit integer that specifies either the position in the             * Data Stream of a picture or binary data or the name of an OLE             * object storage.              */
//  to create this object. 
//  A WMF PitchAndFamily object that specifies the pitch and family of the font.   Font families describe the look of a font in a general way. 
//  create the PropertyTable 
//  shape doesn't support CTApplicationNonVisualDrawingProps 
//  Look for bits associated with the runs 
//  Encrypted is normally BOF then FILEPASS   May sometimes be BOF, WRITEPROTECT, FILEPASS 
// now ref is CellRangeAddress(1, 2, 10, 4) 
//  rotation of key values is application dependent - Excel = 2 / Word = 7  
//  not a sign, so it's a digit, and therefore a positive exponent 
//  Truncate to header + flag + data for flag + flag + data 
//  Excel 2010 gives -1.23152709359606 
//  Act 
//  None or more than four parameters were passed so display  a Usage message. 
//  xmlbeans adds line-breaks depending on the system setting, so we get different   test results on Unix/Mac/Windows   if the xml documents eventually change, this test needs to be run with the   separator set to the various system configurations 
//  test createCell(row, column, value) (no CellStyle) 
//  This bit used to crash 
//  An unsigned integer specifies the count of items in rgSmartTagIndex. 
//  compare signs 
// there are two options:  a) an exact denominator is specified in the formatString 
// First record in drawing layer MUST be DrawingRecord 
//  options 1   index of color value 
//  0 means DEFLATE compression   0xFE means no compression 
//   that reference slides after the PersistPtrHolder) 
//   to all zeros 
//  Open 
//  update the widths   for-loop over the shorter of the number of cells in the row and the number of tracked columns 
// assertTrue(sheet.getAutobreaks()); 
//  if empty, return not allowed flag 
//  docId   saltData 
//  use cached formula result if it's the right type: 
//  Now with 
/* Font b = */
//  BinaryRC4 
//  Check we can call getText without error 
//  Abort if first record is of type 0000 and length FFFF, 
/*  Evaluation is not supported  */
//  Xfs 
/* 	 * According to ECMA-376 default position is RIGHT.	  */
// YK: PPT reports a slightly different color: r=189,g=239,b=87 
// we must set location for internal hyperlinks 
//  Oh dear, this isn't allowed...   The word file seems to be corrupted   Switch to using the nil style so that    there's a chance we can read it 
/*  Register a listener for *all* documents.  */
//  An unsigned 32-bit integer that specifies the number of colors specified in the SurroundingColor field. 
//  Cnstants that defines how many pixels and points there are in a   millimetre. These values are required for the conversion algorithm. 
//  The y-coordinate of the ending vertex on an arc relative to the height of 
//  drawing2 is a clone of drawing1 
//  the name was not found in the list of external names   check if the Workbook's UDFFinder is aware about it and register the name if it is 
//  Now look at a non-empty one 
//  The current offset stores us, but the next one is free 
//  so they don't get this far 
//  check if we expect failure for this file 
//  we are going to add text by paragraphs. Clear the default placehoder text before that 
//  extra header/footer settings supported by Excel 2007 
// first bit only. 
//  Wind on by the atom length, and check we're not at the end 
//  generate session key 
//  Now, do the same thing for our slides 
//  Loop over all the slides we know about   Find where they used to live, and where they now live 
//  run with the file provided in the Bug-Report 
//  Input processing and error checks. 
/*      * TODO      */
//  some broken Workbooks miss this... 
/* package */
//                 fileOut.close();              } 
//  this is called by user code, if the complexData is empty/null, allocate a space for a valid header   be aware, that there are complex data areas with less than 6 bytes 
//  x.x% 
//  Type: 0d  Addr: 014ff644  Offset: 4312  Len: 48  Format: 54  From: 44d3 
//  Remove the last 
//  includes column header 
//  And check again. 
//  Look for SlidePersistAtoms, and report what they have to 
//  A 32-bit unsigned integer that specifies the number of rectangles in the RectData member. 
//  below are shape types only found in native 
//  One slide 
//  Remove thrown.* when bug 58779 is resolved   In the mean time, this function will modify SampleShow.pptx on disk. 
//  also sets method to POST. 
//  Add at the place of the supplied record 
//  Tidy and return (null if no match) 
//  These should be the properties for the message itself 
//  always present 
// //// Case 18: Evaluate "Table1[[col]:[col2]]" //////// 
//  root spContainer + 2 spContainers for shapes 
//  ignore metafileDataSize, which might ignore a (placeable) header in front 
//  Check it has 0x347f 
//  Now read in the value(s) 
//  no need to log a NullPointerException here 
//  agg.escherRecords = new ArrayList(); 
//  Has 1 border 
//  NOTE: XWPFDocument.removeEndnote() delegates directly to          XWPFEndnotes. 
//  numeric cell with a custom style 
//  Outlook30 has some 
//  make it ready for reading 
//  Condition 1: Formula Is   =ISERROR(C2)   (White Font) 
//  user code reported in Bugzilla #49529 
//  crossing point 
/*  **************************************************************************  */
//  DocumentSummaryInformation 
//  Check the header details - will have the sbat near the start, 
//  Note for area SUMPRODUCTs, string values are interpreted as zero   even if they would parse as valid numeric values 
//  assertTrue(wb.dispose()); 
//  20-24 
//  skip fibRgFcLcbBlob (read later at fillVariableFields) 
//  ignored here 
//  Try to retrieve the part inputstream from the URI 
//  Theme file doesn't have any textual content 
//  Check it has key parts 
//  if source and target are the same they should be resolved to the last segment,   Example: if a slide references itself, e.g. the source URI is   "/ppt/slides/slide1.xml" and the targetURI is "slide1.xml" then   this it should be relativized as "slide1.xml", i.e. the last segment. 
//  Retrieves relationship part, if one exists 
//  E: Explicit Background, Foreground all Black 
//  Ref - A4   Attr 
// count = 30 
//  shall not appear without FIELD_BEGIN_MARK 
//  Change it 
// 16-bit GUID. Seems to be always the same. Does not depend on the hyperlink type 
//  If we're not asked to do anything, return now 
//  Write out and read once more, just to be sure 
//  Excel also supports "m before h is month" 
//  this line caused XmlValueOutOfRangeException , see Bugzilla 3965 
//  EOF 
// //////////////////////////////////////// 
//  Set the color 
//  no need to rotate back and forth, just apply scaling inverted 
//  by default DONT save backups of files...just loose data 
//  Now the next pass for quoted characters: Remove '' chars, making "'a''b'" into "'ab'" 
//  plain area ref   note - area ref is normalised 
//  Link and re-try 
//  Simple text 
//  since arrays are 0-based 
//  start x coordinate, relative to parent 
//  8 bytes header + 20 bytes to flags + 2 bytes flags = 30 bytes 
//  collect zero or more DEFINEDNAMEs id=0x18, 
//  Unicode string format. 
//  open an empty document 
//  brushes, pens, and the other objects 
//  Create a new named range for worksheet 'sheet2' 
//  Set CellStyle and RowStyle and ColumnStyle 
//  Good, they're not the same 
//  The stored data size in the simple block excludes the header size 
//  Special Value to indicate an uninitialized Cell 
//  Evaluate what we have 
//  false param present 
//  Remember - POI column 0 == OOXML column 1 
//  Otherwise, our tests wouldn't work! 
//  both low and high indexes point to values assumed too low and too high. 
//  BUG 60845 
//  need to set class id 
// ascii -> unicode mapping for module names  preserve insertion order 
// Test high cell bound 
//  Some custom formats 
//   delete the record for it. Start off with no change 
//  Embedded OPC documents relation name 
//  Do we need to re-compute the free? 
//  Pesky XmlBeans bug - see Bugzilla #49934   it never happens when using the full ooxml-schemas jar but may happen with the abridged poi-ooxml-schemas 
//  Write out 
//  can have the "poifiles" subdir 
// copy rgtc 
//  Don't tolerate unusual boolean encoded values (unless it becomes evident that they occur) 
//         assertEquals("D 67.10", cell.getStringCellValue()); 
//  we use ImageIO in one of the tests here so we should ensure that the temporary directory is created correctly 
//  Now the stream 
// B1 uses VBA in the formula 
//  multiple of 16 bytes 
//  False values: "false", "0", "off" 
//  an EmfPlusBlendColors object, or an EmfPlusBlendFactors object, but it MUST NOT contain both. 
// multiple calls of createDrawingPatriarch should return the same instance of XSSFDrawing 
//  30 chars 
//  Check we found our formats 
//  Check the charts on the 2nd sheet 
//  usual shape? 
//  Entries gone 
//  Decide where to get the formula string from 
//  Add another slide, goes in at the end 
//  special case for files saved in Office 2007 
//  YK: Mimic Excel and silently truncate sheet names longer than 31 characters 
//  Create the thumbnail part name 
//  179 chars, 30 + 28 + 25 
//  wb is usually an SXSSFWorkbook, but must also work on an XSSFWorkbook   since workbooks must be able to be written out and read back   several times in succession 
//  sprmPItap -- 0x6649 
//  Cell show  
//  X=ok, Y=ok 
//  Rows moved include the last row of the area ref, but not the first   btw: (aFirstRow < _firstMovedIndex) 
//  Owing to the way the loop above works, the rowNumber will have been 
// red  bold  italic 
// Version of the application which "updated the spreadsheet last" 
//  rgbUid 1/2 
// default column width is measured in characters  multiply 
//  Decide on what to do, based on how the lengths match up 
//  paragraph is 30 long   paragraph reserved field 
//  recurse into the new level group 
//  Unicode 
//  Only set these if you know what you're doing! 
//   for the theme-applied cells in Column A are correct 
//  "PK\001\002"   version made by: 4.5   version required: 4.5   flags: 8 = data descriptor used   compression method: 8 = deflate   file modification time & date   CRC-32   compressed size   uncompressed size   filename length 
//  An Empty Properties part has been added in the save/load 
// The act of adding the string to the SST record may have meant that  an existing string was returned for the index, so update our local version 
//  Check the new footers have their new text too 
//  finished with predicate expression 
//  all other values are rounded up to the next integer 
//  Check upper limit 
//  else z = value of this guide 
//  Tell HSSFWorkbook that it needs to 
// Selecting cols 
//  Excel displays fraction: 461/512 
//  0x17 
//  now we use a newly generated salt/verifier and check   if the file content is still the same 
//  assert the table is empty 
//  verify cannot delete non-empty directory 
//  reapply style and local PAPX properties 
//  "Buffer overrun" 
// read so it doesn't get shifted again 
//  A 32-bit unsigned integer that specifies the size of region data in bytes 
//  use a simple state machine to figure out what we are doing 
//  Get an InputStream from the package part and pass that   to the create method of the WorkbookFactory class. Update   the resulting Workbook and then stream that out again   using an OutputStream obtained from the same PackagePart. 
//  And these are ones we probably shouldn't allow, 
// styles table 
//  When parsing a document, look to see if you know about that type    of the current record. If you know it's a type that has children,    process the record's data area looking for more records   If you know about the type and it doesn't have children, either do    something with the data (eg TextRun) or skip over it   Otherwise, check the first byte. If you do a BINARY_AND on it with    0x0f (15) and get back 0x0f, you know it has children. Otherwise    it doesn't 
//  corner by setting the maximum allowed ratio of miter length to line width. 
//  A 32-bit signed integer from the WrapMode enumeration that specifies how to repeat the texture image 
//  ok, we have the start, and all knots... do something with this 
//  find referenced CTColor in the theme 
/*          * It's possible to set up repeating rows and columns in your printouts by using the setRepeatingRowsAndColumns() function in the Workbook object.         *         * This function Contains 5 parameters:         * The first parameter is the index to the sheet (0 = first sheet).         * The second and third parameters specify the range for the columns to repreat.         * To stop the columns from repeating pass in -1 as the start and end column.         * The fourth and fifth parameters specify the range for the rows to repeat.         * To stop the columns from repeating pass in -1 as the start and end rows.          */
//  update row height in the table properties 
//  see TestXSSFBugs.bug54764()   see TestXSSFBugs.bug54764()   POIFS properties corrupted   No actual contents   contains xml-entity-expansion   contains xml-entity-expansion   contains shared-string-entity-expansion 
//  UsrExcl(0x0194)   FileLock   RRDInfo(0x0196)   RRDHead(0x0138) 
//  See https://support.office.com/en-us/article/SUBTOTAL-function-7b027003-f060-4ade-9040-e478765b9939   "If there are other subtotals within ref1, ref2,... (or nested subtotals), these nested subtotals are ignored to avoid double counting." 
// create sheets with cells having (different) numbers 
//  from testing, Excel only operates on numbers and dates (which are stored as numbers) in the range.   numbers stored as text are ignored, but numbers formatted as text are treated as numbers. 
//     public final static short       OBJECT_TYPE_GROUP_BOX          = 19; 
//  increment the number of persistent objects 
//  Copy file data to the newly created part 
//  should builder be replaced with CellCopyPolicy setters that return the object   to allow setters to be chained together? 
//  currently we only identify TextShapes as placeholders 
//  Strip leading and trailing quotes if needed 
//  Only replace the grouping character if it is not the default   grouping character for the US locale (',') in order to enable   correct grouping for non-US locales. 
//   arrays are properly supported 
//  draw stuff 
//  first row is for title 
//  sprmPFTtp 
//  register for all 
//  zeros for row/col/offsets          this.cell1 = calcCell(sheet, EMPTY_MARKER, position.getCx(), position.getCy());          this.cell2 = calcCell(sheet, cell1, size.getCx(), size.getCy()); 
/*      <ExControl info="15" type="4078" size="218" offset="76" header="0F 00 EE 0F DA 00 00 00 ">       <ExControlAtom info="0" type="4091" size="4" offset="84" header="00 00 FB 0F 04 00 00 00 ">         00 01 00 00       </ExControlAtom>       <ExOleObjAtom info="1" type="4035" size="24" offset="96" header="01 00 C3 0F 18 00 00 00 ">         01 00 00 00 02 00 00 00 01 00 00 00 00 00 00 00 02 00 00 00 00 96 13 00       </ExOleObjAtom>       <CString info="16" type="4026" size="44" offset="128" header="10 00 BA 0F 2C 00 00 00 ">         53 00 68 00 6F 00 63 00 6B 00 77 00 61 00 76 00 65 00 20 00 46 00 6C 00 61         00 73 00 68 00 20 00 4F 00 62 00 6A 00 65 00 63 00 74 00       </CString>       <CString info="32" type="4026" size="62" offset="180" header="20 00 BA 0F 3E 00 00 00 ">         53 00 68 00 6F 00 63 00 6B 00 77 00 61 00 76 00 65 00 46 00 6C 00 61 00 73         00 68 00 2E 00 53 00 68 00 6F 00 63 00 6B 00 77 00 61 00 76 00 65 00 46 00         6C 00 61 00 73 00 68 00 2E 00 39 00       </CString>       <CString info="48" type="4026" size="44" offset="250" header="30 00 BA 0F 2C 00 00 00 ">         53 00 68 00 6F 00 63 00 6B 00 77 00 61 00 76 00 65 00 20 00 46 00 6C 00 61         00 73 00 68 00 20 00 4F 00 62 00 6A 00 65 00 63 00 74 00       </CString>     </ExControl>      */
//  The surrounding colors are colors specified for discrete points on the boundary of the brush. 
//  One XBAT block holds 127/1023 individual BAT blocks, so they can address    a fairly hefty amount of space themselves 
//  Check if this part is a relationship part 
//  Remove thrown.* when unit test for XSLF SlideShowFactory.create(OPCPackage) is implemented 
//  Remove the run from our high level lists 
//  [MS-DOC], v20140721, 2.6.4, sprmSNEdnRef 
/*  See documentation for sprmPIlfo (0x460B)  */
//  No change, SBAT remains empty 
//  get/set alignment modifies the cell's style 
//  sid=0x0409 
// do what Graphics does by maintaining the stack, etc.! 
//  reset the user locale and time zone so that tests do not interfere with each other   the other and better way would be to run each test in its own thread since   LocaleUtil uses per-thread settings.   Helpful, but not ASL 2.0 licensed:   http://www.codeaffine.com/2014/07/21/a-junit-rule-to-run-a-test-in-its-own-thread/ 
//  Errors 
//  save the worksheet as-is using SXSSF 
//  complex 
//  The same colour 
//  Check under max record size 
/* 	 * Accessor methods are not trivial. They use lazy underlying bean	 * initialization so there can be some errors (NPE, for example).	  */
//  <- annotation is necessary to override expected exception 
//  For compressed stores, we require all of the data 
//  Save part in zip 
//  Cell content 2016-12-8 as an example   Cell show "12/8/2016" 
//  short side div 16 
//  As number and string 
//  otherwise use general format 
//  shrink 50% 
//  Need to have different counters for cell rows and    row rows, as you sometimes get a RowRecord in the    middle of some cells, and that'd break everything 
//  can't compare row heights because of variable test heights 
//  copy drawing contents 
//  gradient is repeated. 
//  Compare the original and newly saved document 
//  If there's only one, it's easy 
//  destination columns are completely outside ref 
//  B1 was used to evaluate A1 
//  The backing array should work out fine for us 
//  copy a hyperlink via the copy constructor 
//  If possible, do first 4 and last 4 bytes 
//  HyperlinkTable (not aggregated by POI yet)   DataValidityTable 
//  Now look for the interesting records in there 
//  the 15 
//  Check main 
//  Now add some text to one group, and some more 
//  but the escape is not present in the column definition 
//  ensure that temp-dir exists because ImageIO requires it 
//  And add us to the buffer + dictionary 
//  mask is 0x020001 
//   on our way past 
// arbitrarily selected; may need to increase 
//  Pivot Table Extensions 
// default color for comments 
//  PowerPoint seems to store files with \r as the line break   The messes things up on everything but a Mac, so translate   them to \n 
//  Round trip 
// other columns but C and G are not hidden 
// Range of cells which the formula applies to. 
//  end public class DirectoryNode 
// unset highest 2 bits 
//  sign bit is in the same place for long and double 
//  sprmPDxaFromText 
// formula referring all sheets created below 
//  indent appropriately for the level 
//  doesn't happen yet because formulas cannot be modified from the master workbook 
//  Note - formula size is not immediately before encoded formula, and does not include any array constant data 
//  Ensure it does contain our original modifications 
//  Nice and easy 
/*  ---------------------------------------------------------------------  */
//  remove all but first paragraph 
//  An optional EmfPlusTransformMatrix object that specifies a world space to device space transform for   the pen. This field MUST be present if the PenDataTransform flag is set in the PenDataFlags field of   the EmfPlusPenData object. 
//  getIndex() returns short, which is not sufficient for > 32767   we should really change the API to be "int" for getIndex() but   that needs API changes 
//  A1:B2 
//  Core type doesn't have any params 
//  Another builtin fun one 
//  And Excel style 
//  of this record to the source bitmap header. 
//  Ensure we have what we expect on the root 
//  Typically odd Crystal Reports exports 
//  Return the created record 
//  Re-process the named ranges 
//  A 32-bit unsigned integer that is reserved and MUST be ignored. 
//  one less now   check that nearby cell of the same group still has the same formula 
//  Remove when SXSSFRow.shiftCellsRight() is implemented. 
//  Now add in on 3, should go to front 
/*  Read a test document <em>doc1</em> into a POI filesystem.  */
//  Empty text 
// note, if subject contains white spaces, make sure they are url-encoded 
// assertContains(content, "Attribute TestMacro.VB_Description = \"This is a test macro\""); 
//  Make a POIFSFileSystem from the contents, and close the stream 
//  non-Javadoc: When possible, code should be implemented in the RowShifter abstract class to avoid duplication with   {@link org.apache.poi.hssf.usermodel.helpers.HSSFRowShifter} 
//  Mark our position, and read another whole buffer 
// 	                  assertEquals(msg, expValue.getErrorCellValue(), actValue.getErrorValue());  	              } 
//  We only digest a part once. 
//  Sheet 1 A2 is on same sheet 
// 				File tempFile = TempFile.createTempFile("testExtFunc", ".xls");  				FileOutputStream fout = new FileOutputStream(tempFile);  				wb.write(fout);  				fout.close(); 
//  restore byte value 
//  transitions around the E98,E99,E100 boundaries 
//  clone for chart-sheets is not supported 
// this should be the case because of the constructor 
//  Check a few core things are present 
//  Set the text to be as it is now 
//  A valid BorderStyle constant, as an Enum 
//  A 32-bit unsigned integer that specifies whether a transform matrix is present in the 
//  update header data 
//  300 - 10 - 10 - 36 - 6.4   first line is indented   other lines are not indented 
//  Check if chart was shallow copied or deep copied 
//  use revert to not re-write the input file 
//  It should be light green 
//  only create a header, if we need to, i.e. the placeholder type is eligible 
/*         setCellFormula(sheet, 0, 0, "B1*C1");        sheet.getRow(0).createCell(1).setCellValue("A");        setCellFormula(sheet, 1, 0, "B1*C1");        sheet.getRow(1).createCell(1).setCellValue("A");        setCellFormula(sheet, 0, 3, "SUMIFS(A:A,A:A,A2)");  */
//  Write out the same for the supplied slideshow 
//  Special characters 
// hmf  left 
// first short should == length! 
//  If the partlist is null, then we parse the package. 
// check 
//  old word format 
//  confirm next key change 
//  Grab the offsets for each of the sheets 
//  Do an in-place replace via an InputStream 
//  Note: this behavior deviates from Microsoft Excel,   which will not overwrite a cell in destination row if merged region extends beyond the copied row.   The Excel way would require:  assertEquals("[Merged across multiple rows] R7:S8 merged region", "Should NOT be overwritten", cell.getStringCellValue());  assertFalse("[Merged across multiple rows] R7:S8 merged region",          sheet.getMergedRegions().contains(CellRangeAddress.valueOf("R7:S8"))); 
// Test low row bound 
//  Compare each bit in our flag byte in turn: 
/*  * This acceptor only allows traversal to shapes that have useful data * associated with them, and tries to elide details that aren't useful when * analyzing the content of a document. * * Useful is subjective of course, and is defined as any of: * * - Has non-empty text - Is a 1d shape, such as a line - User specified shapes * - The outline of stencil objects - TODO  */
//  Cell show "8-Dec-16" 
//  Build an input stream of it, and read back as a POIFS from the stream 
//  make sure the formula parses OK first 
//  Notes - added later but not changed 
//  the only supported so far 
//  sprmPDxaRight80   
//  Check that things that aren't in aren't in 
//  increment the object ID seed 
//  table size increased -   clear all cells below the table that are inside the new area 
//  simple expansion of top   columns containing area top being shifted down: 
//  unsupported; 
//  lets hope no one uses this anymore 
//  Check what we have now 
// the first slide uses per-slide headers / footers 
//   without having to try to match the children together 
//  add columns 
//  now the first sheet is at index 1 
//  reverse iteration because args were pushed in-order 
//  A 32-bit unsigned integer that specifies the number of characters in the string. 
//  2000 version 
//  all other chars OK 
//  Font 0   Format 0 
//  create comments and vmlDrawing parts if they don't exist 
//  Write the geometry 
// wildcard values 
// there can be multiple HeaderFooterRecord records belonging to different sheet views 
//  Move backward 
//  not defined 
// construct a new ArrayRecord with the same contents as r1 
//        
//  Wrap the OutputSteam as a channel 
//  2 colors 
//  Relationship type 
//  Ensure there's a spot in the file for it 
//  iterate across the row for all the evaluation cases 
//  Complex type evaluation (currently only for extraction of check boxes) 
//  This value MUST be composed of BrushData flags. 
//  Finally row 3 
//  for example, the string "apples" and the string "APPLES" will match the same cells. 
//  Finally delete its relationship part if one exists 
//  6.5	19.5	6	6.5 
//  =====================================================================   Case 2: Existing code creates an iterator variable   =====================================================================   Original code (no longer valid) 
//  removing the whole protection structure 
//  one or more PSB records found after some intervening non-PSB records 
//  Some apps generate multiple ExternSheetRecords (see bug 45698). 
//  else biasedExponentB is 1 
//  read in the data stream. 
//  Note - must create distinct instances because they are assumed to be mutable. 
//  Must be at least 4 bytes long 
//  If the part is a relationship part, we don't save it, it's   the source part that will do the job. 
//  Get the document's embedded files. 
//  when the MergedCellsTable is found in the right place, we expect those records to be contiguous 
//  key found 
//             ser_output[11000] = 'X';          } 
//  InputStream -> either 
// First column of the hyperlink  Last column of the hyperlink 
//  From this figure, determine how many co-ordinat positions to 
// Getting Sheet Name for the reference 
//  layout   tblpro.addNewTblLayout().setType(STTblLayoutType.AUTOFIT); 
//  We have no children to start with 
//  This override is used only in order to test failing for HSSF. Please remove method after code is fixed on hssf,    so that original method from BaseTestSheetShiftColumns can be executed.    After removing, you can re-add 'final' keyword to specification of original method.  
//  layout can be null if the entire word at the current position   does not fit within the wrapping width. Try with requireNextWord=false. 
//  make sure continuing PLS is still OK 
// not quite sure 
//  Setup the default rgb values 
// super(documentStream, tableStream, offset, size, fcMin, charset); 
//  Confirm user style name 
//  We need predictable dates for testing! 
//  Verify comments are in the position expected after the shift 
//  also close the POIFSFileSystem here as we read all the data   while decrypting 
//  srcCellRow and srcCellColumn are ignored by SUMPRODUCT 
//  each plane. 
//  only care about elements 
//  Note - no range simplification here. An expr like "A1:B2:C3:D4:E5" should be   grouped into area ref pairs like: "(A1:B2):(C3:D4):E5"   Furthermore, Excel doesn't seem to simplify   expressions like "Sheet1!A1:Sheet1:B2" into "Sheet1!A1:B2" 
//  text len   010672AT0 MUNI,[RTG_MOODY_UNDERLYING,RTG_SP_UNDERLYING] 
//  Rows are moving up 
//  field_2_numIdClusters = LittleEndian.getInt( data, pos + size ); 
//  link to slide . absolute reference   this is kind of a hack, as we might link to pages not yet imported,   but the underlying implementation is based only on package part names,   so this actually works ... 
//  breaks files with slash in their name on Linux:   file = file.replace('\\', '/'); // ... failures/handlers lookup doesn't work on windows otherwise 
//  write out the saved-by table. 
//  Verify that the changes were made 
//  go through all formula cells 
// //// Case 8: Evaluate "Table1[#This Row]" //////// 
//  must always be string   even if match str is wild, but contains only digits   e.g. '4*7', NumberEval(4567) does not match 
//  add notes slide to presentation 
// TestHSSFComment.class, //converted to junit4 
//  part is not related with this POIXMLDocumentPart 
//  application/vnd.ms-visio.drawing 
//  Claiming an existing block, ensure there's no loop 
//  PAPXs can contain table sprms if the paragraph marks the end of a   table row 
//  ... failures/handlers lookup doesn't work on windows otherwise 
//  verify whitespaces in different places 
//  How far through the output we've got   (This is normally used &4095, so it nicely wraps) 
//  the DocumentProperty backing this object 
//  the rest is unused 
//  adapt to the current user locale as the locale changes) 
//  easy to see this cannot be a valid date 
//  the conditional formatting is not automatically added when it is created... 
//  short side div 4 
//  for example PSGraphics2D or PDFGraphics2D would call gsave() / grestore 
//  rows 
//  is first character valid? 
//  We'll also want to be able to turn the slide IDs into a position 
//  More trickiness:   Empty string is not the same as BlankEval.  It causes #VALUE! error 
/*  ******************* adding methods follow *********************  */
// check it is not in built-in formats 
// remove a third from the beginning 
//  active cell behavior is undefined if not set.   HSSFSheet defaults to A1 active cell, while XSSFSheet defaults to null. 
//  Handle new row 
//  setup: key material, signature value 
// make private in 4.2 
//  End of normal4096 
//  A 32-bit signed integer that specifies the object clamping behavior. It is not used until this object 
//  current x-extent. 
//  1-row/1-column intersection   2x2 corner intersection 
/*              * Line using Ryan's FCtoCP() conversion method - unable to observe             * any effect on our testcases when using this code - piers              */
//  Formulas _never_ evaluate to blank.  If a formula appears to have evaluated to   blank, the actual value is empty string. This can be verified with ISBLANK(). 
//   but would need a better regexp 
//  $B$65536 
//  Assumptions 
//  short side div 6 
//  either a null name was given, or there is no such name 
//  was formula cell before - now a plain value 
//  POIFSFileSystem always closes the stream 
//  Value Operator Ptgs and Control are base tokens, so token will be unchanged   but any child nodes are processed according to desiredOperandClass and callerForceArrayFlag 
//  Ask it to get block 184 with creating, it will do 
//  scale output bounds to image bounds 
//  2 bytes reserved 
//  green 
//  unknown 33 
//  0 -> 51 is one stream 
// cchFile (2 bytes)  char type = ansi 
//  Delete a mini stream, add one more 
//  is this font has a line through the center   some weird macintosh thing....but who understands those mac people anyhow   some weird macintosh thing....but who understands those mac people anyhow 
//  _rels type doesn't have any params 
//  read all remaining bytes and wrap into a LittleEndianInput 
// //// Case 10: Evaluate "Table1[[#Headers],[col]]" //////// 
//  first check dimensions 
//  minParams same as max since these are not var-arg funcs 
//  Should have stopped at the SXVIEW record 
//  Configure the document 
//  Serialize a block of rows.   Hold onto the position of the first row in the block 
//  Initially has Properties + BAT but not SBAT 
//  Normally claims a size of 8 
//  Test via DataFormatter 
//  else - another sheet substream starting here 
//  without PAPX reconstruction   assertEquals( 12, r.numParagraphs() ); 
// pointer to native ruby VALUE 
/*  Set the codepage. If both custom properties and section have a         * codepage, the codepage from the custom properties wins, else take the         * one that is defined. If none is defined, take ISO-8859-1.  */
// This name is not visible in Word anywhere. 
//  Check raw details on the one with 
//  PS_COSMETIC, this value MUST be 0x00000001. 
//  Store us in the header 
//  Check that the column's width will accommodate the image at the   required dimension. If the width of the column is LESS than the   required width of the image, decide how the application should   respond - resize the column or overlay the image across one or more 
//  short side div 8 
//  Join as c, l, r 
//  Do a raw set, no adjusting at the XSSFColor layer either 
//  RTF 
//  Create the Freeze Pane 
//  Copy hyperlink 
//  start replacing 
//  not bit-mapped   not bit-mapped 
//  fib.setCcpHdrTxtBx(fib.getCcpHdrTxtBx() + adjustment);   } 
//  need to recalculate image size 
//  Look for EscherTextboxWrapper's 
//  -- OR --   open an existing empty document with styles already defined  XWPFDocument doc = new XWPFDocument(new FileInputStream("base_document.docx")); 
/*  Check rule M1.6  */
//  determine gridSpan / rowSpan 
//  And three in rich text 
//  first one wins (priority order, per Excel help) 
//  Shift 1 forward 
//             // MM/DD/YYYY is probably a good guess, if the in the US              return makeDate(f2, f0, f1);          } 
//  Never dismantle the EMPTY environment 
//  Verify the print areas were set correctly 
//  42: DAVERAGE 
//  making sure ID used once 
//  Manually flush for this cell, and check 
/*  duplicate record of the template series  */
//  Top Level 
//  Note that the basic method is identical to the listInCell() method 
//  we will never match more than the pattern length 
//  1 based results, 0 = current workbook 
//  using default time-zone 
//  MetafileData field. This value MUST be defined in the MetafileDataType enumeration 
// Test an uncompressed string  Note that we can only ever get to a maximim size of 8227 since an uncompressed 
//  removing the sheet makes it good again 
//  fill it in 
//  fall-back 
//  Some external tools don't generate all of    the remaining fields 
//  Generate the relation 
// Greetings! 
//  In three bits, split every 512 bytes 
//  currently don't use FileCacheImageInputStream,   because of the risk of filling the file handles (see #59166) 
//  only change valid chars 
//  Not actually needed - can be found from day of month 
//  Add the image 
//  Our 2nd SBAT block has spares 
//  Is it one of the special built in types, General or @? 
//  Month is a special case due to C semantics 
//  no need to wrap this type of Exception 
//  blank 
//  If we got a duplicate, mark it as such 
//  in EMF+ the index must be between 0 and 63 
//  convert offsets from emus to pixels since we get a   DrawingML-anchor   but create a VML Drawing 
//  Note: we are using String.toUpperCase() here on purpose as it handles certain things   better than Character.toUpperCase(), e.g. German "scharfes s" is translated   to "SS" (i.e. two characters), if uppercased properly! 
/*  CTCell[] cArray = ((XSSFRow)row).getCTRow().getCArray();            assertEquals(1, cArray.length); */
//  A string of no more than 32 Unicode characters that specifies the typeface name of the font.   If the length of this string is less than 32 characters, a terminating NULL MUST be present, 
//  A 32-bit unsigned integer that specifies the measuring units for the pen. 
//  Create the top level drawing patriarch. 
//  Check we can open the file via usermodel 
//  Is it a named range? 
//  one last real row 
//  this can happen when a dynamic connector overrides its master's geometry   .. probably can happen elsewhere too, I imagine.  throw XDGFException.error("Mismatched geometry section '" + entry.getKey() + "' in master", this, e); 
//  create a run to contain the content 
//  name of a VBA module     
//  all three should be there 
//  request  create a nonce to avoid replay attack 
//  one way is to create another XSLFFreeformShape from path2 and compare the resulting xml 
//  but it was easier to implement it this way to avoid confusion 
//  validate password with an actual office file (Excel 2010) 
//  If the fields contents should be formatted to confrom with Excel's   convention.... 
//  Create a new named range for worksheet 'sheet1' 
// remove merged regions from clone 
//  Cells outside window will fail, whether referenced or not 
//  sprmCFSpec -- 0x0855 
//  A 128-bit WMF RectL object, which specifies the bounds of the region. 
//  don't use MAX_ENTRY_SIZE here! 
//  Check with the bigger block size too 
//  Check to ensure no other names have the same case-insensitive name 
//  An optional 32-bit signed integer that specifies the style used for lines drawn with this pen object.   This field MUST be present if the PenDataLineStyle flag is set in the PenDataFlags field of the   EmfPlusPenData object, and the value MUST be defined in the LineStyle enumeration 
//  Check we can get bits out by id   Hyperlinks are rId1, rId2 and rId3 
//  xf type 
/*  complex symbol  */
//  now add Cell 0,1 
//  plain data in D1:F3 
//  do not implement! -> recursion   public int read(byte[] b) throws IOException; 
// end draw thick black border 
//  subsequent calls to createCellFromRecord() will update the colIx boundaries properly 
//  9th one should have children 
//  application/vnd.openxmlformats-officedocument.presentationml.presentation 
//  in XSLF the fonts default to the theme fonts (Calibri), if the font group is not overridden   see XSLFTextRun.XSLFTextInfo.getCTTextFont 
//  Latin Symbol 
//  find referenced CTColor in the theme and convert it to java.awt.Color via a recursive call 
// the module name map names should be in exactly the same order  as the module names here. See 2.3.3 PROJECTwm Stream.  At some point, we might want to enforce that. 
//  Type of an unsupported type! Skipping...  
//  assert that the comments are created properly before writing 
//  dot is OK   underscore is OK 
//  14-18 
//  instantiate the following class so it'll get picked up by   the XmlBean process and added to the jar file. it's required   for the following XWPFTable methods. 
//  Commented MB 23 May 2010  CTP ctP2 = CTP.Factory.newInstance();  CTR ctR2 = ctP2.addNewR();  CTText t2 = ctR2.addNewT();  t2.setStringValue("Second paragraph.. for footer"); 
//  If spaceBefore >= 0, then space is a percentage of normal line height.   If spaceBefore < 0, the absolute value of linespacing is the spacing in points 
//  msotxflBtoT 
// bug 61045. File is govdocs1 626534 
//  externalSheetIndex 1 -> BSheet1 
//  srcRow is blank. Overwrite cells with blank values, blank styles, etc per cell copy policy 
//  Style one 
//  NOFILLHITTEST can be in the normal escher opt record but also in the tertiary record   the extended bit fields seem to be in the second 
// Check created print areas 
//  Complex slideshow, record order doesn't match slide order 
//  Make sure the array formula has been removed properly 
//  --> start option flags 
//  If the POSITION flag is set in the Flags, the points specify relative locations. 
//  Claims not to be text, but really is 
//  Clone the sheet 
// Need to setup thickness of 2 
//  Override it, check it's taken 
//  Output 
//  Now locate the data block for it 
//  Should have 4 attributes on the message 
//  bad quote escaping   unknown external workbook   unknown sheet 
//  Changing an intermediate formula 
//  perhaps this could be optimised by consulting the (somewhat unreliable) isShared flag 
//  if size is uneven we will have to add one so the first grpprl   falls 
//  rows from within being moved: 
//  create a table 
//  On slide seven, we have:   TR:    (text)   TR:    <ps>(text a)</ps><ps>(text a)(text b)</ps>   TR: 
//  Open as a proper zip file 
//  Check we find a few words we expect in there 
//  set margins 
//  need to use reflection to avoid depending on the sun.nio internal API   unfortunately this might break silently with newer/other Java implementations,  
// derive this from the font or frame/bounds information 
//  see PolyBezier about limits 
//  5 circles div 8: 5 x 360 / 8 = 225 
//  PersistPtrFullBlock 
//  draw background boxes 
//  A WMF PointL object that specifies the coordinates of the reference point used to position the string.   The reference point is defined by the last EMR_SETTEXTALIGN record. 
//  character run is 28 long   mask is 0x060002 
/* 	 * (non-Javadoc)	 * 	 * @see	 * org.apache.poi.ss.usermodel.DataValidationHelper#createExplicitListConstraint	 * (java.lang.String[])	  */
//  int startAt = CPtoFC(node.getStart());   int endAt = CPtoFC(node.getEnd()); 
//  if we haven't found the wrapper in the sheet runs, create a new paragraph list from its record 
//  We have 4 bytes, then the start point of each 
//  first auto-number paragraph so initialise to 1 or the bullets startAt   if present 
//  PPT95 has 4 byte size, then data 
//  (Except French, which is mostly reversed...) 
//  1 chart sheet -> data on 1st, chart on 2nd 
// this len should == fontDescriptionLength 
//         OutputStream out = new FileOutputStream("/tmp/56959.xls"); 
//  The ID of the first slide 
//  apparently bits 15 and 14 are unused 
//  ordering is not important when row is equal, but don't return zero to still   get multiple comments per row into the map 
// to enable newlines you need set a cell styles with wrap=true 
//  org.apache.poi.hwpf 
//  thousands separator 
//  sprmPWHeightAbs 
//  column group collapsing is a different concept 
//  all other characters are illegal 
//  the value of the function (NPV) and its derivate can be calculated in the same loop 
// make sure header starts at 0 
//  Sanity check data 
//  modify text 
//  for debugging 
//  "right" is the default 
// includes sid+recordlength 
//  The y-coordinate of a spline's second control point. 
//  If nothing was found, try some of the other OOXML-based core types 
//  Check this one 
//  Put everything within a new directory 
/*  Write the property set's header.  */
//  MIN to one cell over 3 workbooks, absolute reference 
//  TODO+ proofFile.getAbsolutePath() + "'."); 
//  Note Excel behaviour here. A blank final final value is converted to zero. 
/* 	 * (non-Javadoc)	 * 	 * @see	 * org.apache.poi.ss.usermodel.DataValidationHelper#createValidation(org	 * .apache.poi.ss.usermodel.DataValidationConstraint,	 * org.apache.poi.ss.util.CellRangeAddressList)	  */
//  A 32-bit unsigned integer that specifies the offset to the data from the start 
//  An 8-bit unsigned integer that specifies the output precision.   The output precision defines how closely the font is required to match the requested height, width,   character orientation, escapement, pitch, and font type.   It MUST be a value from the WMF OutPrecision enumeration.   Applications can use the output precision to control how the font mapper chooses a font when the   operating system contains more than one font with a specified name. For example, if an operating   system contains a font named Symbol in rasterized and TrueType forms, an output precision value   of OUT_TT_PRECIS forces the font mapper to choose the TrueType version.   A value of OUT_TT_ONLY_PRECIS forces the font mapper to choose a TrueType font, even if it is 
//  data size 
//  Custom Properties (in DocumentSummaryInformation 
//  but we can delete it if we remove the document 
//  First row 
//  Try to evaluate, without giving a way to get at the other file 
// first four bytes is the length of the raw data 
//  Excel has bugs around leap years in 1900, handle them 
//         verticalPixelsPerPoint = (float)Math.abs(group.getY2() - group.getY1()) / a.getAnchorHeightInPoints(sheet); 
//  The 0th block is the first data block 
//  Helper methods for {@link #equals(Object)} 
//  How to create hyperlinks 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getErrorBoxTitle()      */
//  Both PowerPoint and OOo draw zero-length lines as 0.25pt 
//  constant array { { "#N/A N.A.", "#N/A N.A.", }, } 
//  calling clearText or setting to a new Array leads to a   XmlValueDisconnectedException 
//  when criteria is a boolean value 
//  Now go for one with multiple BAT blocks 
//  at least trigger some of the setters to ensure classes are included in   the poi-ooxml-schemas 
//  With caching, the evaluationCount is 8 which is exactly the 
//  sheet names with spaces must be quoted 
//  Handle records that seem to lie 
//  this test may fails in newer JDKs because of disallowed access if   properties are missing, make this visible 
//  end deleted sheet 
//  Load back the XSSFWorkbook 
//  And copy the shifted block to the shifted location 
//  the extern sheets are set through references 
//  declare a row object reference 
//  create the HTTP POST request 
// Moved from XSSFRow.shift(). Not sure what is purpose. 
//  And test with ones that need the style appending 
//  Refetch to get the new order 
//  end public interface DirectoryEntry 
//  Now set it back again 
//  there should be a relationship for each URL 
//  no idea if I have a master in this space. go figure. 
//  DEFAULT_GUI_FONT   The default font that is used for user interface objects such as menus and dialog boxes. 
//  (last row is -1 === 65535) 
//  Note: Removal doesn't currently reset the last column.  It probably should but it doesn't. 
//  verify that output is correct 
//  errors in the 64th bit happen from time to time   this is well below the 53 bits of precision required 
//  do not copy the drawing relationship, it will be re-created 
// link to a file in the current directory: link1.xls 
// Ensures that pivotCaches is initiated 
//  contains   1x1 corner intersection 
//  Check the relations from this 
/*  Write the whole POI file system to a disk file.  */
//  New we check to see if we should remove the integer part 
//  Check it gives text without error 
//  Set us as now initialised 
//  oo COLINFO 
//  on every other row 
//  current offset, initialized to start 
//  If it's a container, step into it and return 
//     	Offset 0x3bd9 (15321)      	recordid = 0x236, size = 16      	[TABLE]      	    .row from      = 3      	    .row to        = 8      	    .column from   = 4      	    .column to     = 6      	    .flags         = 0      	        .always calc     =false      	    .reserved      = 0      	    .row input row = 4      	    .col input row = 1      	    .row input col = 4076      	    .col input col = 0      	[/TABLE] 
//  Rule M4.2, M4.3, M4.4 and M4.5/ 
//  sheet name is unicode Russian for 'minor page' 
//  no longer required for successful test 
//  KY: SUM(B1: IZ1) 
//  If cache is stale, update cache with this one cell   This is a compromise between rebuilding the entire cache   (which would quickly defeat the benefit of the cache)   and not caching at all. 
//  read sample file 
//  offset += StdfPost2000.getSize(); 
//  If we are the first block to be allocated, initialise the stream 
//  \n\n\n" 
//  add a sheet, and put some values into it 
//  Can't work for InputStream opened files 
//  copy original istd into huge Grpprl 
//  No more! 
// 			// In case you fancy checking in excel 
// support elapsed time [h],[m],[s] 
//  original method. 
//  columns containing area bottom being shifted up: 
/*  int skip =  */
//  the relationship ID 
//  seems to occur in just one junit on "OddStyleRecord.xls" (file created by CrystalReports)   Excel tolerates the funny ObjRecord, and replaces it with a corrected version   The exact logic/reasoning is not yet understood 
//  let some file handlers do additional stuff 
//  Starts with one 
//  check for checksum to be uptodate 
//  don't add empty properties, as they can't be recognized while reading 
//  [MS-DOC], v20140721, 2.6.4, sprmSNEdn 
//  get/set alignment doesn't affect the style of cells with 
/* Sheet sh2 = */
//  int start = startingProp.getStart() + fcMin; 
//  Now zap all the cells in the source row 
//  Has been wrapped with cell details, but we know those 
//  Double.compare() considers them different 
//  Save the target as-is - we don't need to validate it,    alter it etc 
//  SP @ 8 
//  calculate top/left corner 
// cut off the bitmap file-header 
//  uses evaluateInCell() 
// create a region over the 2nd row and auto size the first column 
//  All ascii, so stored in one big lump 
//  If the destination of the columns overlaps either the top 
//  transition from normal time to daylight savings adjusted   transition from daylight savings adjusted to normal time   Unexpected since we are using UTC_TIME_ZONE 
//  Look inside another 
//  char flags 0x0004 = underlined   font index is 1 
/*          * Check rule 2.4: The package implementer shall require that the         * Content Types stream contain one of the following for every part in         * the package: One matching Default element One matching Override         * element Both a matching Default element and a matching Override         * element, in which case the Override element takes precedence.          */
/*          * Used PNG file format description from         * http://www.wotsit.org/download.asp?f=png          */
//  will later replace with XDDFShapeProperties 
//  row "1"   the problem is not observable in the first row of the shared formula 
//  Defaults to CP1251 
//  (paragraph reserved field)   it doesn't have any styles 
//  in case the (first) parsing throws an exception, we can provide the   records up to that point 
//  (N)POIFS only returns 384 bytes here, instead of 512 
//  If the condition is empty it matches. 
//  condition goes first 
//  these are special and not copied by default 
/*      * assuming this wants the number of bytes returned by {@link serialize(LittleEndianOutput)},     * that is, (length - 4).      */
//  Save and close 
// outline level 2: the line under ==> collapsed==True 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationHelper#createExplicitListConstraint(java.lang.String[])	  */
//  Neither defined nor reserved   Neither defined nor reserved   Neither defined nor reserved   Neither defined nor reserved 
//  don't change cell type for formulas 
//  TODO proper clone 
//  check row height for 'default' flag 
// auto-size picture 
//  2nd is italic 
//  Links to the three sheets, shared, styles and themes 
//  start of this record to the source bitmap bits in the BitmapBuffer field. 
//  Make a columns aggregate if one hasn't ready been created. 
//  Check the array fetch 
//  magic number, run tests after changes 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationHelper#createTextLengthConstraint(int, java.lang.String, java.lang.String)	  */
//  [F6]   [1]   [1]   [OFFSET nArgs=3] 
// Sheet#setColumnWidth accepts the width in units of 1/256th of a character width 
//  References to a single cell: 
//   ConversationTopic -> This is a test message 
/*  Create a mutable property set. Initially it contains a single section         * with no properties.  */
//  test if the file is empty, otherwise parse it 
//  Ref - A2 
// millis 
//  Start 
//  It should be core.xml not the older core1.xml 
//  Check the keys went in 
// the sheet has one relationship and it is XSSFDrawing 
//  1 --> 3 
//   its mask byte 
//  Loop over each style, seeing if it is the same    as an earlier one. If it is, point users of the    later duplicate copy to the earlier one, and    mark the later one as needing deleting 
//  Save package relationships part. 
//  Type/subtype 
//  Excel 2010 gives -24516534.3990583 
//  am/pm marker 
//  Mini Stream FAT   Mini Stream data   Properties #2 
//  358: GETPIVOTDATA 
//  from Russia with love ;) 
//  leap years are always divisible by 4 
// save the template 
//  verify proper behavior with index that is too large 
//  Load our two test workbooks 
//  Create a new Slide 
//  expand:   colapsed bit must be unset   hidden bit gets unset _if_ surrounding groups are expanded you can   determine   this by looking at the hidden bit of the enclosing group. You will   have   to look at the start and the end of the current group to determine   which   is the enclosing group   hidden bit only is altered for this outline level. ie. don't 
//  Only need to worry about user fonts 
//  write out the file 
// allocateShapeId increments the number of shapes. roll back to the previous value 
//  The y-coordinate of a curve's control point relative to the shape's 
//  intermediate sub-classes (one-arg, two-arg and multi-arg) 
//  3 @ 5   *mask bit* 2,3,4,7   14 @ 4082 
//  document link anchored on a shifted cell should be moved 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#getSuppressDropDownArrow()	  */
//  binary rc4 
//  works as expected 
//  the Cells in an existing row are invalidated on-purpose, in order to clean up correctly, we   need to call the remove, so things like ArrayFormulas and CalculationChain updates are done    correctly.    We remove the cell this way as the internal cell-list is changed by the remove call and    thus would cause ConcurrentModificationException otherwise 
//  Extract exactly the count of strings from the SST record. 
//  Force a synchronization between CTTable and XSSFTable 
//  A 32-bit unsigned integer that specifies the format of the image data. 
// TODO: parse phonetic strings. 
//  textMark: "Sheet1!B6" 
//  from now on we can only be dealing with non-quoted identifiers   which will either be named ranges or functions 
//  Excel does not support positive/negative infinities,   rather, it gives a #DIV/0! error in these cases. 
//  A signed integer that defines the amount by which to divide the 
// assertEquals(2, lst.size()); 
// 222: VBD 
// cchFile (2 bytes)  char type 
//  A 32-bit unsigned integer that specifies the size, in bytes, of the CommentIdentifier and   CommentRecordParm fields in the RecordBuffer field that follows. 
// right  bottom 
//  Type field, this value is undefined and MUST be ignored. 
//  we should not try to read the strings in this case. 
//  cchData 
//  Some older escher formats skip this last record 
//  YK: stdout can contain lots of other stuff if logging is sent to console 
//  The delete was before us 
//  character run is 28 long 
//  last font record position 
//  Check the embedded parts 
//  Associate the object records with the shapes 
//  The default header is an odd header 
//  Raw XML - Stream 
//  use a separate tempdir for the tests to be able to check for leftover files 
//  This means the format has a ".", but that output should have no decimals after it.   We just stop treating it specially 
//  Won't work without the workbook being linked 
//  An EmfPlusRectF object that defines the rectangle to use in the CombineMode operation. 
//  looks like left-over cached result from before change to B1 
//  Have them write themselves in-place with no changes, as an OutputStream 
//  WHITE_PEN - A white, solid-color pen   PenStyle: PS_COSMETIC + PS_SOLID   ColorRef: 0x00FFFFFF 
//  MAPI Properties for an attachment 
//  Should be text, then three STSHs 
//  A 32-bit floating-point value that specifies the em size of the font in units specified by the SizeUnit field. 
//  Hopefully there's a supported one after this! 
//  2 for idOffset short field itself 
//  now just do 1 
//  succeeds if the formula record has been associated   with the second shared formula group 
//  header 
//  Turn the RTF data into a more useful string 
//  Level 2 collapsed, others expanded: 
//  This used to break 
//  Calculate how many columns the image will have to 
//  Recurse into pointer containing streams 
//  write out the PAPBinTable. 
// Any single character 
//  Ensure that the ooxml compiler finds everything we need 
//  Wrong offset values have been passed in the call to setSheetBof() above.   For books with more than one sheet, this discrepancy would cause excel 
//  17 @ 11   10 @ 4086 
//  Not working just yet 
//  A signed integer that defines the horizontal extent of the window in logical units. 
//  We're done - array will now have everything moved as required 
//  used to resolve a value but now we ignore DTD entities for security reasons 
//  make sure the value contains the old sheet and not a similar sheet   (ex: Valid: 'Sheet1'! or Sheet1! ; NotValid: 'Sheet1Test'! or Sheet1Test!) 
//  should return null since alignment isn't set 
//  an unknown record with 0 length 
//  mask is 0x1800   left aligned 
//  Ref - A4 
// assertEquals(3, patriarch.countOfAllChildren());  
//  The x-coordinate of the arc's control point relative to the shape's 
//  The built-in name for auto-filter must consist of a single Area3d Ptg. 
//  Set formatting block flags to 0 (no formatting blocks) 
//  Since arrays and tables cannot be sparse (all cells in range participate)   The first cell will be the top left in the range.  So we can match the   ARRAY/TABLE record directly. 
//  addMergedRegion should not re-validate previously-added merged regions 
// Test Functions SUM, COUNT and COUNTA calculation of SUBTOTAL  a) areas A and B are used 
// private List<ICell> cells = new ArrayList<ICell>(). 
//  never null 
// 214: ASC 
//                     byte[] rsidr = p0.getRsidR();                      byte[] rsidrdefault = p0.getRsidRDefault();                      p.setRsidP(rsidr);                      p.setRsidRDefault(rsidrdefault);                  }              }              CTPPr pPr = p.addNewPPr();              pPr.addNewPStyle().setVal(pStyle); 
//  calculate the inverse angle - taken from the (reversed) preset definition 
//  Ref - A3 
//  try a second time 
//  as per bug report 
// Random rnd = new Random(4352345); 
//  These choices are not well justified. 
/*          * ds:Signature Marshalling.          */
//  we should not perform the shifting right here as we would then find   already shifted comments and would shift them again... 
//  Should never occur 
//  else the other variation of this function takes an array as the first argument 
//  append the newly added data 
//  The only kinds that CFRuleRecord handles 
//  uncollapse contained groups 
// gives me FC in doc stream 
//  Good, detected and warned 
//  X=ok, Y=shift 
//  The file name should be shown too, see bug #56742 
//  BAT is now full, but there's only the one 
//  And back 
//  Add the new SlidePersistAtom at the end 
//  Try to write a large amount, should fail on the write 
//             XSSFRow row = (XSSFRow) it.next();              boolean collapsed = row.getCTRow().getCollapsed();              boolean hidden = row.getCTRow().getHidden();              short level = row.getCTRow().getOutlineLevel();               
//  Spreadsheet has a good mix of alternate file types 
//  verify cannot rename the root directory 
//  Make it small, will trigger the SBAT stream and free lots up 
/*          * Insert signature value into the ds:SignatureValue element          */
//  we're done, undo the transforms 
//  make sure 'unshared' formula is actually available 
//  If we've just written the first block on a  
/*  Reading data is not supported  */
//         incRef(); 
//  check if we can delegate to master for the property 
//  should be assertSame, but a new HSSFCellStyle is returned for each getCellStyle() call.   HSSFCellStyle wraps an underlying style record, and the underlying   style record is the same between multiple getCellStyle() calls. 
//  see 2.4.5 MSOTXFL 
//  SSN format 
//  The number of bytes used by the decrypted Verifier hash is given by 
//  PivotTable View Extended Information 
//  Long way passed 
//  without PAPX reconstruction   assertEquals(page_break + "\r", r.getParagraph(10).text());   assertEquals(p2_parts[0] + "\r", r.getParagraph(11).text()); 
// standard 24-byte tail of a URL link 
// set POIFS properties before constructing HSSFWorkbook 
//  Get with recursing into chunks 
/*  Variables use to validate OPC Compliance  */
//  if the marL attribute is omitted, then a value of 347663 is implied 
//  comment in column 0 is gone 
//  Add in the record 
//  index of current element in tableCellEdges[] 
//  create an SSTRecord and write a certain pattern of strings 
//  HSSFWorkbook/EXCEL97-specific side-effects user-defined function names must be added to Workbook's defined names in order to be saved. 
//  Different ways of retrieving 
//  Check the styles assigned to them 
//  File  wb = new XSSFWorkbook(file);  assertCloseDoesNotModifyFile(filename, wb); 
//  disallow non-sequential enum instance creation 
//  no longer fail on compliance error  fail("expected OPC compliance exception was not thrown"); 
//  Ensure that all parent directories exist 
//  print the notes 
//  create cells with time patterns 
//  name to be created 
//  otherwise recreate the shapes from scratch 
//  Assume that it must be a file handle - although there are other   options the code should perhaps check - and store the reference   into the filesList variable. 
//  The polygon SHOULD be outlined using the current pen and filled using the current brush and   polygon fill mode. The polygon SHOULD be closed automatically by drawing a line from the last   vertex to the first. 
//  Convert BufferedImage to byte[] 
/*  Read the summary information.  */
//  'false' text to bool and back 
//  POIFS primed on the test data 
//  final ellipsis is optional, and ignored   (all unspecified params are assumed to be the same as the last) 
//  B3   frequency returns a vertical array of bins+1 
//  can concatenate idens with dots 
//  check if name is unique and calculate unique column id  
//  Not even text extraction is supported for these: handler.handleExtracting(inputFile); 
/* tenthRow    */
//  start evaluation on another cell 
// Test low row bound exception 
//  This is a byte as looked up in the dictionary   It needs to be signed, as it'll get passed on to 
//  String for formula 
//  However, the BATs continue as before 
//  Test Lowercase case 
//  Register and process 
//  check edges 
// defaults 
//  Check the CTColor is as expected 
//  circle div 4: 360 / 4 = 90 
//  Fill in the values 
//  If there are no fields, all easy 
// external relations don't have associated package parts 
//    C tAttrSkip 
//  There was a previous match. Only one non-blank result is allowed. #NUM! on multiple values. 
//  An array of BoundaryPointCount EmfPlusPointF objects that specify the boundary of the brush. 
// three level 
//  Set when F start element is seen 
//  if a rectangular area reference was passed in as arg1, lookupVector and resultVector should be the same size 
//  truncate the bottom of the area by the moved rows 
//  revert the package to not re-write the file, which is very likely not wanted for a TextExtractor! 
//  existing behavior - create a new XSSFEvaluationWorkbook for every call 
//     assertEquals(10, sheet.getTopRow());      assertEquals(10, sheet.getLeftCol()); 
//  They've gone missing... 
//  (If it's a container, option byte 1 BINARY_AND 0x0f will be 0x0f) 
//  skip the 62 ignored bytes 
//  adjust the size so it is always on a word boundary 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#setShowErrorBox(boolean)      */
//  name is probably the name of an unregistered User-Defined Function 
//  width div 10 
//  Change some existing streams 
/*          * even if there is no ExtractorFactory in classpath, still support         * included Word's objects          */
// p3.setAlignment(ParagraphAlignment.DISTRIBUTE); 
//  Find the end of the group. 
//  Word first 
// and construct an iterator 
//               double delta = Math.abs(expected.getNumericCellValue()-actual.getNumberValue());                double pctExpected = Math.abs(0.00001*expected.getNumericCellValue());                assertTrue(msg, delta <= pctExpected); 
//  Grab the base contents 
//  A 32-bit unsigned integer that specifies the offset to an intercharacter spacing array, in bytes, 
//  The current position is set to the ending point of the closing line. 
//  now that this is done, add it to the path 
//  Latin Decorative 
//  simple contraction at bottom   simple contraction at bottom   top calculated differently here 
//  Check properties, all have zero length, no blocks 
//  end of style palette options   additional palette options 
//  A 32-bit unsigned integer that specifies the offset from the start of this 
//  Should be able to handle whitespace between unary minus and digits (Excel   accepts this formula after presenting the user with a confirmation dialog). 
//  Optimise fonts 
//  added extra facilitator members 
//  First up, check the round tripping 
//  "You cannot change text of a line break, it is always '\\n'" 
//  don't need to remember because we don't need to do anything with these 
// preliminary bytes 
//  initial height of the text box is 100 pt but 
//  SP @ 20   SP @ 26 
//  Will be sized fairly small 
//  optional link formula 
//  1 byte + 4 shorts 
//  tabstops size is variable! 
//  A 32-bit floating-point that defines the ... coordinate 
//  Take a copy to loop over, so we can update the real one 
//  get free MBD-Node 
// center text over B4, C4, D4 
//  Save, re-load, and re-check 
// windows excel example: Sheet1!$C$3:$E$4 
//  Check for defaults 
//  invocation of sheet.removeArrayFormula on any of them throws IllegalArgumentException 
//  Should have dates in 2nd column   All of them are the 10th of August   2 US dates, 3 UK dates 
/*  CTGraphicalObject graphic =  */
//  If there are any, they're in    ProgTags -> ProgBinaryTag -> BinaryTagData 
//  the text is splitted into two lines 
//  WORKS 
//  Numbers which come from formulas 
//  null if security restricted 
//  Create a fake pointer 
//  Performance optimization for bug 57840: explicit boxing is slightly faster than auto-unboxing, though may use more memory   NOSONAR 
//  From PCT to DXA: 
//  V5 stores it as a 16 bit number at the offset 
//  we need to let the model re-calculate the Range before we evaluate it 
// length of the label including the trailing '\0' 
//  Set seed 
//   that aren't already there 
//  end of 'Row Block'.  Should only occur after cell records   ignore DBCELL records because POI generates them upon re-serialization 
//  not [204, 255, 255] 
//  A 32-bit signed integer from the WrapMode enumeration that specifies whether to paint the area outside   the boundary of the brush. When painting outside the boundary, the wrap mode specifies how the color 
//  In PowerPont RGB bytes are swapped, as BGR 
//  Add object with format start_coll:end_coll. For example 1:3 will span from   cell 1 to cell 3, where the column index starts with 0   
//  Check the text has the 
// //// Evaluate "Table1[@]" when rowIndex is outside Table //////// 
// Selecting rows 
//  not [0, 51, 102] 
//  range extremities 
//  Check for the , as a sign of non-coniguous 
//  Create our FIB, and check for the doc being encrypted 
//  forecolor   backcolor 
//  Retrieve the un-compressed code 
/*  Initialize the "format" field.  */
//  loop over the cells in this row, because there are fewer cells in this row than tracked columns 
//  alter the length, as specified in page 25 
//  when set to true, will tell Excel that it needs to recalculate all formulas   in the workbook the next time the file is opened. 
//  1) corrupted xlsx (unreadable data in the first row of a shifted group) already comes about   
//  original bug may have thrown exception here, 
// Sets the pivotCacheDefinition tag 
//  check sheet runs first, so we get exactly the same paragraph list 
//  Insert a numbered multi-level list into cell A6. Note that the   same ArrayList as constructed for the above plain multi-level 
//  sprmPDcs  
//  Delete a couple of streams 
//  Invalid in a normal workbook stream.   However, some test cases work on sub-sections of   the workbook stream that do not begin with BOF 
// see below -- need to extract hyperlinks 
/* 		 * Note: no short-circuit boolean loop exit because any ErrorEvals will override the result		  */
//  whether to use alternate expression eval   whether to use alternate formula entry 
//  NOTE: XWPFDocument.createEndnote() delegates directly         to XWPFFootnotes.createEndnote() so this tests         both creation of new XWPFFootnotes in document         and XWPFFootnotes.createEndnote(); 
/*  ************************************************************************  */
//  Outlook 
//  A 32-bit unsigned integer that specifies the raster operation mode and   MUST be in the WMF Binary Raster Op enumeration 
//  ignore the first arg, this is the function-type, we check for the length above 
//  test reading zero length buffer 
//  20 bytes of whatever at the front. 
//  Complex file 
// total length of FFN - 1. 
//  put the struct into the plcf 
//  scientific notation 
//  num bubble values 
//  truncate the top of the area by the moved rows 
//  do not warn about a few detected file types 
//    2007-06-20T20:59:00.123-13:00 
//  re-read and make sure string value is the same 
//  user defined styles are always "used" 
//  The x-coordinate of the ending vertex of a cubic Bezier curve relative to 
//  V6 stores it as the first value in the stream 
//  start with a reasonable big size 
//  First 20 bits = offset number 
//  Remove the default content type, no other part use this content type. 
//  incremented one row too far. Undo that here. 
//  Check it now has a slide 
//  Open the workbook, not preserving nodes 
//  Add two more character styles 
//  Insert a plain, multi-level list into cell A5. Note that   the major difference here is that the list items are passed as   an ArrayList of MultiLevelListItems. Note that an ArrayList   of instances of an inner class was used here in preference to   a Hashtable or HashMap as the ArrayList will preserve the   ordering of the items added to it; the first item added will   be the first item recovered and the last item added, the last   item recovered. Alternatively, a LinkedHashMap could be used 
//  Some dummy pictures 
//  bits 1 to 3 unused 
//  Should have one slide 
// 30 characters wide 
/* Font c = */
//  Column A is the raw values   Column B is the ##/#K/#M values   Column C is strings of what they should look like   Column D is the #.##/#.#K/#.#M values   Column E is strings of what they should look like 
//  found piece with exact start 
// noinspection UnusedAssignment 
//  4 bytes - fixed, horizontal resolution (dpi) of source data 
//   The supported pixel formats are specified in the PixelFormat enumeration 
//  now Jan. 1, 2004   now Jan. 2, 2004 
//  makes our life much easier 
//  msonfcLCRoman   rncCont 
//  SBAT   Mini 
//  'Sheet View Settings' 
//  B is number 5 
//  And a few bits off a more complex header 
// Test the dataformat 
//  clear row height 
//  grab the iterator for both 
//  InternalWorkbook currently behaves slightly different   than HSSFWorkbook, but it should not have effect in normal usage   as checked limits are more strict in HSSFWorkbook 
//  Make part name from previous URI 
//  it's necessary to explicitly set the mdssi namespace, but the sign() method has no 
//         assertEquals("12.34", dfUS.formatRawCellContents(12.343, -1, p2dp_n1dpTSP));          assertEquals("(12.3)", dfUS.formatRawCellContents(-12.343, -1, p2dp_n1dpTSP)); 
//  Re-compute the first and last rows of the sheet as needed 
//  setup fonts (especially needed, when run under *nix systems) 
//  Check parameter 
//  set vertical alignment to "center" 
// character attributes 
//  Should have the preserve set 
//  27349-vlookupAcrossSheets.xls is bugzilla/attachment.cgi?id=10622 
//   they end up as they did before, even with a save and re-load 
//  sprmCShd 
//  old top/left edge is now bottom/left or top/right - as we operate on the already   rotated drawing context, both verticals can be moved in the same direction 
/* 	 * set the font family (TODO)	 *	 * @param f family	  */
//  First try with a new file 
//  The value MUST be in the MidLine enumeration table. 
//  run with some other flie to see 
//  update the FIB.CCPText + friends field 
//  Check each bit in turn 
/* # Picture lnkPicture;  */
//  Check we found the contents of it 
//  A SlideShow with two slides 
//  output (possibly incomplete) first line 
//         Double rightMargin = paragraph.getRightMargin(); 
//  Excel expression might look like this "INDEX( (A1:B4, C3:D6, D2:E5 ), 1, 2, 3)   In this example, the 3rd area would be used i.e. D2:E5, and the overall result would be E2   Token array might be encoded like this: MemAreaPtg, AreaPtg, AreaPtg, UnionPtg, UnionPtg, ParenthesesPtg   The formula parser doesn't seem to support this yet. Not sure if the evaluator does either 
//  No rows, everything is 0 
//  then do the actual moving and also adjust comments/rowHeight   we need to sort it in a way so the shifting does not mess up the structures,  
//  char flags 0x0002 = italic   font size 20 
//  msotxflTtoBA   msotxflTtoBN   msotxflVertN 
//  45: DSTDEV 
//  Onto row #2 
//  Need to read the length, as it varies 
//  test weird variants 
//  Verify we only got two SBAT blocks 
//  could log an info message here since this is a fairly unusual occurrence. 
//  now with a formula evaluator 
//  The angle of an arc's major axis relative to the x-axis of its parent 
//  We don't know what this property normally is, but it   has come   through with a valid type, so use that 
//  0xB acts like cariage return in page titles and like blank in the others 
//  = 0;   = 0; 
//  Pass the match to the algorithm and conditionally abort the search. 
//  sprmCFWebHidden 
//  The letter A is at 65 
//  rgb color   x 
//  These are in ObjectPool -> _... under the root 
//  end public class DocumentDescriptor 
//  need to override all methods to omit calls to UTF-handling methods  
//  316: TTEST 
// Test a rich text string 
// keep track of the following,  and add "\n" only before the start of a body  element if it is not the first body element. 
//  51: LOGEST   52: GROWTH 
// The pivot version which created the pivot cache set to default value 
// reset the row height 
//  num/K/M   with decimals   two-part international format   three-part international format   four-part international format 
//  the simple approach via _sh does not work as it creates rows in the XSSFSheet and thus causes   corrupted .xlsx files as rows appear multiple times in the resulting sheetX.xml files   return _sh.setArrayFormula(formula, range); 
//  References to a .xls file 
/*  ******************** record stuff follows **********************  */
//  bitfields for indention options 
//  It doesn't matter if eval is a 2D or 3D ref, because that detail is never asked of AreaEval. 
//  could be an SXSSFCell 
//  Both should have two sheets 
//  these rules apply to all cells in a region. Specific condition criteria 
//  $C:$IV 
//  Calculate Offset from the start of a DBCellRecord to the first Row 
//  calls System.exit(): UserEditAndPersistListing.main(new String[0]); 
//  Nope, nothing fancy to do 
//  most folks won't listen for too many of these 
//  add a new cell to the sheet 
//  353: NUMBERSTRING 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#setFormula1(java.lang.String)	  */
/*  Read the name of the POI filesystem to modify from the command line.         * For brevity to boundary check is performed on the command-line         * arguments.  */
//  Ref - A3   Attr 
//  Create a new version 
//  Word 
// expected flag  expected # of sheets 
/*  Cubic Bezier curves are defined using the endpoints and control points             * specified by the points field. The first curve is drawn from the first             * point to the fourth point, using the second and third points as control             * points. Each subsequent curve in the sequence needs exactly three more points:             * the ending point of the previous curve is used as the starting point,             * the next two points in the sequence are control points,             * and the third is the ending point.             * The cubic Bezier curves SHOULD be drawn using the current pen.              */
//  Prepare test model 
//  1 for US 
//  Used to blow up with an ArrayIndexOutOfBounds    when creating a StyleRecord 
//  A 32-bit unsigned integer that identifies the type of comment in this record. 
//  satisfy compiler ... 
//  create the image data and leave the parsing to the ImageIO api 
//  Note that the order of the output array elements does not matter   And that there may be more than one valid outputs for a given input. Any valid output is accepted.   POI should use a strategy that is consistent and predictable (it currently is not). 
//  does not work 
//  IntPtg(0) 
//  Now go from here on down 
//  Position ourselves, and take a slice  
//  handle ref counter correct, if the parent document is the same as this 
//  Start out with all headers 
//  the relationship Type 
//    Apply encoding 
//  "lin"   "k" 
//  percent to the power of 
//  Initially not there 
//  4 bytes - fixed, vertical resolution (dpi) of source data 
//  row 3 does not yet exist 
//  Inactive sheets will fail 
//  "A1=1" should return true 
//  font height = xc8   attrs = 0 
// group rows for each phase, row numbers are 0-based 
//  we need to undo adding the CTCell in _row if something fails here, e.g.   cell-limits are exceeded 
//  Check that the document was open in write mode 
//  style 
//  the number of lines to be displayed in the dropdown 
//  Check we can round-trip - try to set a new one to a new single cell 
//  Other cases convert to false 
//  x (4 bytes): A 32-bit signed integer that defines the horizontal (x) coordinate of the point. 
/*          * "If this level uses bullets (see lvlf.nfc), the cch field of this Xst         * MUST be equal to 0x0001, and this MUST NOT contain any placeholders."         * -- page 389 of 621 -- [MS-DOC] -- v20110315 Word (.doc) Binary File         * Format          */
//  names 
//  An 8-bit unsigned integer that specifies the letterform of the font. 
//  And update the count 
// get past the size 
//  has 'target frame'   has UNC path 
//  End of picture marker for PICT is 0x00 0xFF 
//  this is the XML format, so tell the reference that. 
//  end class Listener 
//  Relativize the source URI against the target URI.   First up, figure out how many steps along we can go 
// test data for the first table 
//  else - sign and exponents equal 
//  Two real sheets, plus the master sheet 
//                             wr.get 
// Check to ensure no other names have the same case-insensitive name 
//  Freeze just one column 
// index to non-existing picture data 
//  seems to be the most common value 
// removeRow(destRowNum); //this probably clears all external formula references to destRow, causing unwanted #REF! errors 
//  spaces OK 
//  Ensure that we have a WORKBOOK entry and a summary 
//  Identify and create our temp dir, if needed   The directory is not deleted, even if it was created by this TempFileCreationStrategy 
//  1 page example with text boxes 
//  322 == 0x0142; 326 == 0x0146 
//  simple expansion at bottom 
//  Adjust the pointer as needed 
//  bug 51233 and 55075: correctly size image if added to a row with a custom height 
//  A 32-bit signed integer that specifies the angle, in tenths of degrees, 
//  not all master style atoms are set - index 3 is typically null 
//  line spacing 80   paragraph is 25 long 
//  Process the sheets as best we can 
//  Potential place for ending the workbook stream   Check that the next record is not BOFRecord(0x0809)   Normally the input stream contains only zero padding after the last EOFRecord,   but bug 46987 and 48068 suggests that the padding may be garbage. 
//  localeIsAdapting must be true prior to this first checkForLocaleChange call. 
//  metafile data in the MetafileData field. 
//  add the size for recordId/flags/recordSize/dataSize = 12 bytes 
//  This is done twice -- rgba is new with CSS 3, and browser that don't   support it will ignore the rgba specification and stick with the   solid color, which is declared first 
//  RTR 1 had f1 and f2, unchanged 
//  check computing size up to a large size          StringBuilder b = new StringBuilder(); 
//  Skip over anything already deleted 
// check for two 0x00 that mark end of record 
//  as the file is written to, we make a copy before actually working on it 
//  add past end 
//  log( task.getClass().getName(), Project.MSG_INFO ); 
//  append rest of strText and skip to end of loop 
//  Report sheet by sheet 
//  Text from 0x200 onwards until we get 
//  Now change the cell policy on the workbook, check 
//  There is no such thing as 00/01/1900... 
//  XAdES-C: complete revocation refs 
//  A2:C2 will be removed 
//  The x-coordinate of the last control point of a NURBS. 
// "document/bug53475-password-is-pass.docx", 
//  check sheet-index with one more will work and add the sheet 
//  else - just sheet name 
//  char flags 0x060000   font size 20 
//    API   
//  as per BIFF8 spec 
//  attributes bitfields 
//  end public class POIFSWriterEvent 
//  Mac 
//  now the replaced versions ... 
//  call column infos after k are for later columns   exit now so k will be the correct insert pos 
//  natural order 
//  odd case: criteria '=' behaves differently to criteria '' 
//  column 1 should be sized as '1' 
// make sure byte array ends at EOF\n 
//  Wrap properties we don't know about as custom ones 
//  Modified to support EMU - English Metric Units - used within the OOXML   workbooks, this multoplier is used to convert between measurements in 
//  add a cell comment 
//  last column is 10pt Courier 
//  Last 2 bytes from the outputstream 
//  not an RGB color 
//  remove the rest one at a time and test 
//  summary information has been already written via writeProperties and might go in a 
//  call the actual test-code 
//  Can't work for new files 
//  sprmPHugePapx2 
//  In fourth set, we get a CharFlagsTextProp and a font.index and a font.size 
//  String javaType = RecordUtil.getType(size, type, 0); 
// title row 
//   with their comments if present 
//  add textboxes 
//  write properties without variable length properties 
//  Stop once one can be setup without error 
/*  End OPC compliance  */
// reset the default column width, columns A-C change, D-F still have custom width 
//  The y-coordinate of the ending vertex of a quadratic Bezier curve 
//  UserSViewBegin   SelectionRecord   HeaderFooterRecord   UserSViewEnd 
//  http://www.w3.org/TR/REC-html40/types.html#h-6.5 
//  LHS and RHS of ':' must be compatible 
//  CTWorksheet.getTableParts defines in which sheet the table is 
//  last knots/weights/control point 
//  map aggregate info by sheet index 
//  dark yellow 
//  else fall through 
//  picture index must increment across write-read 
// BORDERS 
//  extract the contents for both 
//  Check if this can be continued, if so then the 
//  as a comment record. This value MUST be 0x00000046. 
//  Turn that into a name, and fetch 
//  Row 10 has a string in D10 
//  +4 for tFuncFar(CHOOSE) 
//         record.setDataLabelPlacement( (short)0x2b50 ); 
//  don't append ',' 
//  Create a new instance of the escher dumper 
//  NOTE: This is currently based on current behavior of POI, somehow   what POI returns in the calls to collapsed/hidden is not fully matching   the examples in the spec or I did not fully understand how POI stores the data internally... 
// protected List<String> styleIDs; 
//  Insert it after the window record 
//  immutable 
//  Should fail during the freeing set 
//  Round number to respective places. 
/* for 56-bit */
// six rows, two columns 
//  completely fresh evaluation 
//  not-equals comparison of a number to boolean always returnes false 
//  Now a column only freezepane 
//  Write test 
//  handle dx before string and other way round 
//  Slide starts with just layout relation 
//  else biasedExponentA is 1 
//  end public class POIFSDocumentPath 
//  test indexed-colored sheet 
//  The value MUST be in the Proportion enumeration table. 
//  This hex data was produced by changing the 'Custom Name' property,    available under 'Field Settings' from the 'PivotTable Field List' (Excel 2007) 
//  within range. 
// if highest bit == 1 
//  Flags 
/*  Print a single property:  */
//  Finally you have typically 4 or 8 bytes of reserved fields, 
//  Negative days are handled by the Java Calendar 
//  Serialize it 
//  Check that we don't have any MulBlankRecords, but do    have lots of BlankRecords 
//  Setting namespace context to XPath   Assuming that the namespace prefix in the mapping xpath is the   same as the one used in the document 
//  Only one row must match to accept the input, so rows are ORed.   Each row is made up of cells where each cell is a condition,   all have to match, so they are ANDed. 
// String p2dp_n1dpTSP = "00.00_x;(00.0)_x"; 
// not set yet 
//  Next up look for the slide master 
//  7 bytes 'not used' 
//  A 32-bit unsigned integer that specifies the total number of points in all polygons. 
//  these two for-loops should do the same thing 
//  if column is not tracked, implicitly track the column if trackAllColumns is True and column has not been explicitly untracked 
//  also try BiffViewer on the saved file 
//  axis font 
//  next 6 bytes are unused 
//  what colour is this? 
// can return null! 
// scrapes sheet reference info and order from workbook.xml 
//  support of cell range in the form of integer:integer 
// Test escaping of Unicode control characters 
//  Check the text, to see we got them in order 
//  non-Javadoc: When possible, code should be implemented in the RowShifter abstract class to avoid duplication with   {@link org.apache.poi.xssf.usermodel.helpers.XSSFRowShifter} 
// assert they have been deleted 
//    Useful public API goes here   
//  Style the cell with borders all around. 
//  B1:B3 will be A1:A3 
//  Ensure the type is correct 
/*  * DateUtil.java * * Created on January 19, 2002, 9:30 AM  */
//  is an empty table: I add one row and one column as default 
//  Check we have the right number of sheets 
//  Third char style is coloured, FF 33 00 FE, and 16 long 
// cached EscherDgRecord 
//  and the result of atan2 need to be justified 
//  Localised currency 
/*          * Extract from MSDN:         *         * There is a special case when the placeholder does not have a position in the layout.         * This occurs when the user has moved the placeholder from its original position.         * In this case the placeholder ID is -1.          */
//  ignore 
//  Read the next part 
//  populate the second, or linked, drop down list. 
//  Decode the shapes 
/*                  * Calculate the paragraphs index in the list of all body                 * elements                  */
//  Change 4 
//  truncate the top of the area by the moved columns 
//  static buildDataSheet() method below. 
//  optional arguments 
//  TODO: another approx. ... 
//  options 2       -- strange upper bits supposed to be 0'd   text rotation 
//  Use a test file with the named ranges in place 
//  read in the pictures stream 
/* Ptg[] ptgs = */
//  open bracket indicates that the argument is a function,   the returning value should be false, i.e. "not a valid cell reference" 
//  final dummy end-of-row record 
//  Create the empty array 
//  no 6b ?! 
//   for where text really begin 
//  Read the contents and check that we could read some data 
//  And in rich text 
//  the image specified by the SrcRect field is scaled to fit this rectangle. 
//  remember this buffer for cleanup 
//  check for an encrypted .xlsx file - they get OLE2 wrapped 
//  The x-coordinate of the curve's beginning control point relative to the   shape's width; a point on the arc. The control point is best located 
//  Check that the timezone aware getter works correctly 
//  sprmPJc  
//  Sync with the File on disk 
//  Create a spreadsheet with some TRUE/FALSE boolean values in it 
//  Checks whether 0.5 equals 0 (0) 
// pkg.close(); 
//  First up, try the default one 
//  Must always start on a word boundary. 
//  bit 3 reserved 
//  Image to document is up a directory 
// byte[] std = new byte[stdSize]; 
//  a bit cheaper than the default impl 
//  stepping forward 
//  Page 50 of public specification begins 
//  byte, short 
//  we did not find any difference, so we can skip the work 
//             CTP p = ftr.addNewP();              CTBody body = doc.getDocument().getBody(); 
//  okay so there ISN'T a column info record that covers this column so lets create one! 
//  *mask bit* 
//  setup 
//  Too old for the default 
//  NULL_BRUSH - A null brush   BrushStyle: BS_NULL 
//  Evaluate it, without a link to that workbook 
// we'll have to remove the workaround in HSLFExtractor's extractGroupText(...) 
//  int charStartAt = translator.getCharIndex( bytesStartAt );   int charEndAt = translator.getCharIndex( bytesEndAt, charStartAt   );   PAPX papx = new PAPX( charStartAt, charEndAt, getGrpprl( x ),   getParagraphHeight( x ), dataStream );   _papxList.add( papx ); 
//  pivot table 
//  variables for performance optimization:   avoid re-checking DataUtil.isADateFormat(int, String) if a given format   string represents a date format if the same string is passed multiple times. 
//  cross check with pv 
//  (0x8000 | ('N' << 8) | 'K') 
// special shorthand  special shorthand   A1-style cell reference   R1C1-style cell reference 
//  Try to move to somewhere else that's used 
/*  Check array size:  */
//  in emus 
//  Offset=0x00002636(9782) recno=72 sid=0x003C size=0x0151(337) 
//  Check we can still parse valid files after all that 
//  Will now have dummy props 
//  col inp row 1   row inp col 0x4076 (!) 
//  Zap the un-needed user font records 
//  1900 windowing 
//  remove the number format from the workbook 
//  First without fonts 
//  First up, try a simple file 
//  sprmPDxaAbs 
//  create it manually 
//  A 32-bit unsigned integer that specifies the polygon fill mode and   MUST be in the PolygonFillMode enumeration. 
//  default cached formula result is numeric zero 
//  Try the other summary information 
//  0 Runs 
// test file is "609751.xls" in govdocs1 
//  TODO -instantiable superclass 
//  3) once a negative shift has been made any attempt to shift another group of rows   (note: outside of previously negative shifted rows) by a POSITIVE amount causes POI exception:   org.apache.xmlbeans.impl.values.XmlValueDisconnectedException.   NOTE: another negative shift on another group of rows is successful, provided no new rows in   place of previously shifted rows were attempted to be created as explained above. 
//  Named ranges 
//  common logic for all bases 
// handleExtracting(file); 
// part.getTargetPart(null); 
//  just one array record 
// TODO: All the PCDI and PCDIA 
//  if we don't have enough knots, duplicate the last knot until we do 
//  An array of SurroundingColorCount EmfPlusARGB objects that specify the colors for discrete points on the 
//  new rows inherit default height from the sheet 
// A full implementation would grab the icells  that a content cell can contain.  This would require  significant changes, including changing the notion that the  parent of a cell can be not just a row, but an sdt.  For now we are just grabbing the text out of the text tokentypes. 
// TODO eventually here return a WildcardStringLookupComparer 
// shouldn't do 2-row merge 
// larger font results in a wider column width 
// ref (6 bytes) not used...  cchFile (2 bytes) 
//  Wrong type 
//  restore pos - only streaming chunks will be reset 
//  re-parsing the formula text also works, but is a waste of time   return HSSFFormulaParser.parse(cell.getCellFormula(), _uBook, FormulaType.CELL, _uBook.getSheetIndex(cell.getSheet()));   It is useful within the tests to make sure that all formulas POI can evaluate can also be parsed.   see HSSFFileHandler.handleFile instead 
//  A 16-bit unsigned integer that specifies the size, in bytes, of the EscapeData field. 
//  seems necessary for outlining 
//  Check some data 
// divide by 4/shift bits coz 30 bit int, not 32 
//  and then add next 20 images to a group 
/*  char 0-127  */
//  lighter 40% 
//  level 3: body placeholder on the slide layout 
//  Now check we can get style records for  
//  test with short name, small file 
//  189: DPRODUCT 
//  Check for the english text line 
//  collect drawing records into a byte buffer. 
//  Indexed parts: 
//  Check the relationships 
//  The original bug was due to different logic for collecting records for sizing and   serialization. The code has since been refactored into a single method for visiting   all contained records.  Now this test is much less interesting 
//  Create a moderate number of columns, which use 
//  some sheets do not have rowNums, Excel can read them so we should try to handle them correctly as well 
//  international three-part   turkish international three-part   custom international three-part   custom international four-part 
// one level 
//  persist ID is UserEditAtom.maxPersistWritten + 1 
//  double the count, and include the null at the end 
//  SBAT are now full, but there's only the two 
//  Figure out if the value is an index in the SST 
//  subnormal numbers compare without rounding for some reason 
// space in the leftmost cell 
/*          * Read at most this many bytes.          */
/*  Write the POI filesystem to a (temporary) file <em>doc2</em>         * and close the latter.  */
//  Figure out the cp of the earliest text piece 
//  Comments should be in C5 and C7 
/*  (non-JavaDoc), inherit JavaDoc from EvaluationWorkbook     * @since POI 3.15 beta 3      */
//  Creates a new package 
//  OPCPackage  wb = new SXSSFWorkbook(new XSSFWorkbook(OPCPackage.open(file)));  assertCloseDoesNotModifyFile(filename, wb); 
//  If both colSplit and rowSplit are zero then the existing freeze pane is removed 
// finally check that the serialized data is the same 
//  A 32-bit unsigned integer that identifies the type of public comment record. 
//  write, read back and verify that our pictures are there 
//  select oleObj potentially under AlternateContent   usually the mc:Choice element will be selected first 
//  Write out the bytes 
//  If we get here, then the cell isn't defined, and doesn't 
//  only one byte left, so this should fail 
//  put merged cells table in the right place (regardless of where the first MergedCellsRecord was found */ 
//  sizes of various numbers in this environment 
//  Get the colour, via the theme 
//  A 32-bit unsigned integer that specifies the size of the data in bytes. 
//  A 32-bit unsigned integer that specifies how to use the rectangle specified in the Rectangle field.   This field can be a combination of more than one ExtTextOutOptions enumeration 
//  Using the ss.usermodel allows this class to support both binary   and xml based workbooks. The choice of which one to create is   made by checking the file extension. 
//  but (outer) anchor need to be adjusted 
//  Write out and re-load 
//   of the code assume that. So, make us match that behaviour! 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#getExplicitListValues()	  */
//  truncate x : as per excel function def 
//  this better succeed or the document is invalid 
//  Set when an Inline String "is" is seen 
//  sprmPFBiDi  
//  a file that exists, but is a different format 
/*  write bytes to new part  */
//  Can't open as HWPFDocument 
//  colour blue 
//  A 32-bit unsigned integer that specifies the metafileType of data in the BitmapData field. 
//  Starts off empty 
//  Not removing the integer part -- print it out 
//  make sure that the table, doc and data streams use big blocks. 
//  third run properties 
//  Grab the data that makes up the piece 
//  Latin Text 
/*  see "MICROSOFT OFFICE EXCEL 97-2007  BINARY FILE FORMAT SPECIFICATION"  */
//  truncate day values 
// The atom instance value is the text type 
//  Will be empty 
//  Check if name is an external names table 
/*  Loop over the two property sets.  */
//  colour palette = x7fff   bold weight = x190 
//  sprmPPropRMark 
//  And via calls 
//  nothing to do: already set 
//  This convenience method should be implemented via setAnchor in subclasses   see HSLFGroupShape.setAnchor() for a reference 
//  columns from within being moved: 
//  The value MUST be in the SerifType enumeration table. 
//  For each pointer, generate the Stream it points to 
//  The y-coordinate of an arc's control point. 
//  Now check the newly added reference 
/*  xxxxx - A 45-degree crosshatch.  */
//  Write out, and read back in 
//  check that height and width match 
// TestXSSFPivotTable.class, //converted to junit4 
//  And make us be empty 
//  Save and re-load once more 
//  NOSONAR - we do not want to close this here   Main part 
//  A 32-bit unsigned integer that specifies the offset from the start of this record to the DIB bits. 
//  Will need to update this once we allow updates to _slideLocations 
//  Find the documents, and then their SLWT 
//  Nothing to do for this row 
//  Update our local cache to the un-formatted version 
// System.err.println("drawing south"); 
//  RETURN_BLANK_AS_NULL - nearly the same 
// 				throw new RuntimeException(e);  			}  		} 
//  Jump over header, and think about going on more 
//   the paragraph itself 
//  END OF  
// intentionally fuzzed -- used to cause infinite loop 
//  if column is not tracked, implicitly track the column if trackAllColumns is True and column has not been explicitly untracked  
//  register the add-in 
//  jun 
//  Check the numbers of the last seen columns 
//  end public class ReaderWriter 
//  let's assume the data is already in the sheet 
//  Drawing records have a very strange continue behaviour. 
//  verify correct number of blocks get created for document 
/*  Check OPC compliance  */
//  A 32-bit unsigned integer that specifies either the index of a graphics object in the   EMF Object Table or the index of a stock object from the StockObject enumeration. 
//  relative to the width of the shape. 
//  this is the normal case. There should be just one ExternSheetRecord 
//  check if content-type and extension do match in both directions   some applications create broken files, e.g. extension "jpg" instead of "jpeg" 
//  represented by the X cell. 
//  largest record used in the metafile (in 16-bit elements). 
//  create a pivot table on the same sheet, case insensitive 
// 		evaluators.add( evaluator ); 
//  No supported styling applies to this cell 
//  an instance of all SXSSFWorkbooks opened by this TestDataProvider, 
//  this will throw an Exception "RuntimeException: Can't read negative number of bytes" 
//  not a named range, check for a table. 
/*  id was not reserved, return false  */
//  check for 16-bit signed/unsigned error: 
//  Add to the main stream 
//  A 32-bit signed integer that specifies the logical height of the source rectangle. 
//  iterate get knots/weights 
// Test existence of the second area 
//  no fill 
//  set properties again, in case we are based on a different   template 
//  mask is 0x060002   char flags 0x0002 = italic 
// BrtWbProp(153), //Workbook prop contains 1904/1900-date based bit 
//  wrong order => will format 0-6 
//  514 == 0x0202; 518 == 0x0206 
//  An optional 32-bit signed integer that specifies the shape for the end of a line in the   CustomEndCapData field. This field MUST be present if the PenDataEndCap flag is set in the   PenDataFlags field of the EmfPlusPenData object, and the value MUST be defined in the LineCapType enumeration. 
//  move the cursor to the START token to the paragraph just created 
//  Turn it into a DataSource 
//  set a column width so that XSSF and SXSSF have the same width (default widths may be different otherwise) 
//  Check the two groups and the text   Result of patriarch.countOfAllChildren() makes no sense:    Returns 4 for 2 empty groups + 1 TextBox. 
//  is a single column ref, the row arg seems to get used as the column index 
//  this is the end of the delimited name 
//  125 * (1.0 - 0.39998) + (255 - 255 * (1.0 - 0.39998)) = 176.99740 => -80 (byte) 
// validate through the FormulaParser 
//  Create 
//  POI 3.15-beta 2 (2016-06-15): getSheetName throws IllegalArgumentException: Invalid CellReference: TableName[#All] 
//  note that in other onDocumentRead(), relations/etc may not have   loaded yet, so it's not quite safe 
//  All evaluators will need to share the same cache.   but the cache takes an optional evaluation listener. 
//  Check case where bottom input is of the wrong type 
// If the sheet name is unique, then set it otherwise move on to the next number. 
//  They're writing, and have had new blocks requested    for the write to proceed. That means they're into    blocks we've allocated for them, so are safe 
//  Style xfs 
//  plus 1 
//  Fetch the workbook this refers to, and the name as defined with that 
//  options: LABEL | PLACE | FILE_OR_URL   label: "My Label" 
//  Because of daylight time saving we cannot use       date.getTime() - calStart.getTimeInMillis()   as the difference in milliseconds between 00:00 and 04:00   can be 3, 4 or 5 hours but Excel expects it to always   be 4 hours.   E.g. 2004-03-28 04:00 CEST - 2004-03-28 00:00 CET is 3 hours   and 2004-10-31 04:00 CET - 2004-10-31 00:00 CEST is 5 hours 
//  Choose cell A9 instead of A10, so that the failing test case doesn't take too long to execute. 
// used for testCopyCellFrom_CellCopyPolicy 
//  https://support.microsoft.com/en-us/kb/65903 
// We haven't found reference to this sheet 
//  Custom properties 
// assertTrue(p.removeRun(0)); 
//  ignore it. 
// don't care 
//  Add an optional UncalcedRecord. However, we should add    it in only the once, after the sheet's own BOFRecord.   If there are diagrams, they have their own BOFRecords, 
//  this should always be available 
//  pred '<>' matches empty string but not blank cell   pred '<>ABC'  matches blank and 'not ABC' 
//  Create an algorithm runner. 
// bounds 
//  There is no DirectoryEntry   Recover the object's data from the HSSFObjectData instance. 
/*  This name is not visible in Word 2010 anywhere.  */
//  Add a full stream, delete a full stream 
//  remove the 2nd row merged region and check that the 2nd row value is used to the autoSizeColumn width 
//  check the setting 
//  Highlight 10-30 - Column D 
//  already add child to context, so other children can reference it 
//  Check bytes are now the same 
//  Check we got the records 
//  Peer into just one formula, and check that 
//  BarDirection.COL then X axis is from 0 to 1 and Y axis is target axis 
//  Instead, it is a floating-point value that specifies a linear distance. 
// obsolete 
//  Mark the end of the stream, if we have any data 
//   with old ones unset, new one set 
// after the slide show is assigned collect all available style records 
//  As of POI 3.15 beta 2, LibreOffice does not display the diagonal border while it does display the bottom border 
//  short and int  size is byte, not short  
//  Runs from the start of the data section in 64 byte chungs 
//  Escher property types. 
//  not a real sid - dummy value 
//  Finally, bring it all together 
//  twips 
//  Links to our more interesting children 
// 		records.add(createBeginRecord());   unknown 
//  Save, re-load, and check 
//  http://timestamping.edelweb.fr/service/tsp   http://tsa.belgium.be/connect   http://timestamp.comodoca.com/authenticode   http://timestamp.comodoca.com/rfc3161 
//  move highIx down to the low end of the mid values 
//  Look at the properties entry, and check the empty ones 
//  add zip entry header ~ 128 bytes 
//  the logical x/y-coordinate of the upper-left corner of the destination rectangle. 
//  Pink with yellow 
// TODO finish usermodel API for XSSFPicture 
// set up style to be able to create hyperlinks 
//  make sure junit4 executes this test class 
//  Apply the other, changes 
/*  Read the origin POIFS using the eventing API. The real work is done         * in the class CopyFile which is registered here as a POIFSReader.  */
//  Double check things are as expected 
//  A 32-bit signed integer that specifies the average width, in logical units, of   characters in the font. If the Width field value is zero, an appropriate value SHOULD be   calculated from other LogFont values to find a font that has the typographer's intended 
//  reserved   Neither defined nor reserved 
//  Oh dear, style claims that it is its own parent 
// verify we can access the xls data 
//  It needs to be unsigned, so that bit stuff works 
//  Treat as an atom, grab and hold everything 
//  98 version 
//  the name gets encoded as the first operand on the stack 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#getErrorBoxText()      */
//  dark grey 
//  right aligned   line spacing 80 
//   so these should be & forms, not the &amp; ones! 
//  see http://msdn.microsoft.com/en-us/library/dd949807(v=office.12).aspx 
//  Pre-condition assumptions. This test is broken if either of these fail. 
//  width div 32 
//  NOSONAR   ensure that we close the package again if there is an error opening it, however   we need to revert the package to not re-write the file via close(), which is very likely not wanted for a TextExtractor! 
//  310: FTEST 
//  Then PDF 
/*  char 15  */
//  some pre-checks to hunt for a problem in the Maven build   these checks ensure that the correct locale is set, so a failure here   usually indicates an invalid locale during test-execution 
//  test SSN format 
//  no PAPX reconstruction   assertEquals( page_break + "\r", r.getParagraph( 3 ).text() );   assertEquals( p2_parts[0] + "\r", r.getParagraph( 4 ).text() );   assertEquals( p2_parts[1] + "\r", r.getParagraph( 5 ).text() );   assertEquals( p2_parts[2] + "\r", r.getParagraph( 6 ).text() ); 
// should exist now! 
//  French style accounting, euro sign comes after not before 
//  BitMaskTextProperties will sanitize the output 
//  assure that the formula refers to the cell above.   the check below is 'deep' and involves conversion of the shared formula:   in the sample file a shared formula in GN1 is spanned in the range GN2:IY2, 
//  Maximum Value Formula 
//  special logger for formula evaluation output (because of possibly very large output) 
//  output (possibly incomplete) last line 
// //// Evaluate "Table1[#This Row]" when rowIndex is outside Table //////// 
//  then scan the presentation relations 
//  contentType 
//  Excel often prefers "# #/#" 
//  Should have non-standard properties with IDs 0xE28 and 0xE29 
//  A 32-bit unsigned integer that specifies the palette EMF Object Table index. 
//   who knows what that starting bit is all about 
//  pattern matching is never used for < > <= => 
// if we haven't already read the bytes for the module keyed off this name... 
//  setting formula should unset text, but since there is a formula, returns an empty string 
// position of the text box in the slide 
// set POIFS properties after constructing HSSFWorkbook 
//  A 32-bit floating-point value that specifies the amount by which to scale the custom line cap with 
//  Plain Text - File 
// URI compatible with MS Office and OpenOffice: leading slash is removed 
//  Don't write out the old Workbook, we'll be doing our new one   If the file had an "incorrect" name for the workbook stream, 
//  If it's a document, free the blocks 
//  instance, a data file. 
//  Colours Blue->White->Red - Column G 
//  testBug54786 gets here with a date, so retain previous behaviour 
//  tAttrSkip 
//  get from master 
//  IntPtg(1) 
//  test all variants 
//  AccessControlException can occur in a restricted context   (client applet/jws application or restricted security server) 
// cast to avoid overflow 
//   process BOFRecords in byte offset order 
//  and may contain white spaces and raw unicode characters 
//  we expect that drawing block consists of either   DrawingRecord or ContinueRecord or ObjRecord or TextObjectRecord 
// defines worksheet in wb part 
//  print overlapping rule results 
//  functions from the Excel Analysis Toolpack 
//  unsupported file-types, no supported OLE2 parts 
//  Check the mini stream location was set 
//  Print not PrintLn as already has \n added to it 
/*      * Bug 56345: Reject single-cell merged regions      */
//  setting the line cap is not implemented, as the border lines aren't connected 
//  Must make this sheet active (otherwise, for XLSX, Excel might protest that active sheet no longer exists)   I think POI should automatically handle this case when deleting sheets... 
// assertTrue(sheet.getDisplayGuts()); 
// 0x138b RT_BinaryTagDataBlob 
// see page 181 
//                                     // make it transparent                                      line[x] &= 0xFFFFFF;                                  }                              }                              wr.setPixels(0, row, w, 1, line);                          } 
//  Wrong number of arguments 
//  0x39, 0x49, 0x79   0x3a, 0x5a, 0x7a   0x3b, 0x5b, 0x7b   0x3c, 0x5c, 0x7c   0x3d, 0x5d, 0x7d 
// header key 
//  We will use the first core properties, and ignore the others 
// TIKA-2154's file shows that even in a unicode string  there can be a remaining byte (without proper final '00') 
//  Just use the normal toString on the value 
//  A string of 32 Unicode characters that defines the font's style. If the length of   this string is less than 32 characters, a terminating NULL MUST be present, 
//  initialize any existing paragraphs - this will be the default body   paragraph in a new shape,   or existing paragraphs that have been loaded from the file 
//  Add a core document 
/* 			The array form of LOOKUP is very similar to the HLOOKUP and VLOOKUP functions. The difference is that HLOOKUP searches for the value of lookup_value in the first row, VLOOKUP searches in the first column, and LOOKUP searches according to the dimensions of array.			If array covers an area that is wider than it is tall (more columns than rows), LOOKUP searches for the value of lookup_value in the first row.			If an array is square or is taller than it is wide (more rows than columns), LOOKUP searches in the first column.			With the HLOOKUP and VLOOKUP functions, you can index down or across, but LOOKUP always selects the last value in the row or column.			  */
//  The name should still refer to the same sheet after the sheets are re-ordered 
//  creation of a new LinkTable insert two new records: SupBookRecord followed by ExternSheetRecord   assure they are in place:      [BOFRecord]      [CountryRecord]      [SUPBOOK Internal References  nSheets= 3]      [EXTERNSHEET]      [EOFRecord] 
//  The max possible size is when each BAT block entry is used 
// First 3 parameters are mandatory 
// <cols>    <col min="1" max="5" width="15.77734375" customWidth="1"/>  </cols> 
//  application/msexcel 
//  Four constants that determine how - and indeed whether - the rows   and columns an image may overlie should be expanded to accommodate that   image.   Passing EXPAND_ROW will result in the height of a row being increased   to accommodate the image if it is not already larger. The image will   be layed across one or more columns.   Passing EXPAND_COLUMN will result in the width of the column being   increased to accommodate the image if it is not already larger. The image   will be layed across one or many rows.   Passing EXPAND_ROW_AND_COLUMN will result in the height of the row   bing increased along with the width of the column to accomdate the   image if either is not already larger.   Passing OVERLAY_ROW_AND_COLUMN will result in the image being layed   over one or more rows and columns. No row or column will be resized,   instead, code will determine how many rows and columns the image should 
//  For now, we're only handling PositionDependentRecord's that   happen at the top level.   In future, we'll need the handle them everywhere, but that's 
//  once again with removing the same cell, this throws an exception 
// OK. the sst table is filled, check the contents 
//  extract first parameter 
//  special cases 
// case 3. cell.setCellValue((RichTextString)null); 
//  fib.setCcpHdd(fib.getCcpHdd() + adjustment);   } 
//  Check raw details on one without 
//  msonfcArabic   rncCont 
//  The stream at 0 has 23 blocks in it 
//  A 32-bit signed integer that specifies the byte offset between the beginning of one scan-line   and the next. This value is the number of bytes per pixel, which is specified in the PixelFormat   field, multiplied by the width in pixels, which is specified in the Width field.   The value of this field MUST be a multiple of four. If the image is compressed, according to the 
//  u16 number of sheets 
//  Get the theme colour 
//  if the absolute value is smaller than 1 over the exact or maxDenom   you can stop here and return "0"   reciprocal is result of an int devision ... and so it's nearly always 0   double reciprocal = 1/Math.max(exactDenom,  maxDenom); 
//  MSOBI constants for various formats. 
//  set cell formula validation to false 
//  The referenced sheet could not be found 
//  Internal Date Formats as described on page 427 in   Microsoft Excel Dev's Kit... 
//  Build up a tree of Escher records contained within 
//  First char style is boring, and 21 long 
//  perform calculation 
//  un-collapse contained groups 
//  values data type   num categories 
//  Via a POIFSFileSystem 
//  We actually want after this though 
//  ROUND() - takes 2 args 
//  1. single-cell array formula 
//  Grab the first text run on the first sheet 
// calculate 
//  Create the run.  
//  fib.setCcpAtn(fib.getCcpAtn() + adjustment);   } 
//  reading 8 byte values from a 9 byte buffer 
//  show input box 
//  should still work, for some reason DrawingManager2.allocateShapeId() skips the first 1024... 
//  Check right contents 
// Test a basic string 
/*      * Test apply(Object value) with a Date as parameter      */
// Fills must be "No Line" 
//  Create SST if it is missing 
//  Check hyperlinks 
// DeletedRef 
//  from file 
/*  Print the properties:  */
//  Return the specific exception so the user knows    that the name is already taken 
//  placeholders will be implicitly initialized when requested 
//  discard any custom tags associated with the picture being copied 
//  see http://officeopenxml.com/prSlide-color.php - "Color Placeholders within Themes" 
// set default properties for a line 
// step 1. Map sheet's relationship Id and the corresponding PackagePart 
//  If the POSITION bit is clear and the COMPRESSED bit is clear in the Flags field, the points   specify absolute locations with floating-point values. 
/*         final Object expected;        final Object actual;        POITestCase.assertReflectEquals(expected, actual);         */
//  Calculate the size of this IndexRecord 
//  x basis   y basis 
//  correct saltHash for supplied password (and docId/saltHash) 
//  extract second parameter 
//  A 16-bit signed integer that defines the x-coordinate, in logical units, of the 
//  The x-coordinate of the ending vertex of a quadratic Bezier curve 
//         OutputStream os = new FileOutputStream("/tmp/protected.xls"); 
//  text (first) arg type is number, other args are strings with fractional digits 
//  Not properly referenced 
//     fail("Total time exceeded 10 seconds: " + totalTime_s + " s");  } 
//  pic size dummy 
//  Options flags is set. In this case, GlyphPos specifies the position of the first glyph only. 
//  Square Root Formula: "sqrt x" = sqrt(x) = value of this guide 
//  Should have three hyperlinks, and one comment 
//  Applies to a series, unless we've seen a legend already 
//  Design Vector 
// simple string argument 
/*  Gets "<sheetData>" document fragment */
//  Font 0 
//  Reference to an empty workbook name   will this just be empty string?   encoded file name 
//  add XAdES ds:Reference 
//  SYSTEM_FIXED_FONT   A fixed-width font that is guaranteed to be available in the operating system. 
// The relationship Id references the part containing the drawing definitions. 
//  With a header on the notes 
//  And check they still have the contents they should do 
//  1. Create drawing patriarch 
//  see https://msdn.microsoft.com/en-ca/goglobal/bb964664.aspx and https://bz.apache.org/ooo/show_bug.cgi?id=70003   we ignore these for now though 
//  Get with recursing into chunks and pointers 
// 	private void writeToFile(MAPIMessage mapi, File file)  			throws FileNotFoundException, IOException {  		OutputStream stream = new FileOutputStream(file); 
//  Slide records were fine 
//  Get the first rich text run 
//  max cell in Excel 97-2003 
//  Formula Value 
//  The DirectoryEntry is a DocumentNode. Examine its entries to find out what it is 
//  A4:B7 will elongate vertically 
//  create empty document summary 
//  paragraph reserved field   mask is 0x1000 
//  only cache non-blank values in the plain cell cache   (dependencies on blank cells are managed by   FormulaCellCacheEntry._usedBlankCellGroup) 
//  assure they are in place:      [BOFRecord]      [CountryRecord]      [SUPBOOK Internal References  nSheets= 3]      [SUPBOOK Add-In Functions nSheets= 1]      [EXTERNALNAME .name    = ISODD]      [EXTERNALNAME .name    = ISEVEN]      [EXTERNSHEET] 
//  Initialize the variables 
//  testRRaC has multiple (3) built-in name records 
//  Implementation Notes List:   --> In this third stage, the reversed byte order legacy hash from the second stage shall       be converted to Unicode hex string representation 
//  Data rows 
//  Even though this is a mere boolean, KOffice's code says it's an int. 
//  re-add the CF 
/*          * Checksum (2 bytes):  A checksum for the previous 10 16-bit values in the header.         * This value can be used to determine whether the metafile has become corrupted.          */
//  title and content 
//  Evaluate it, no change as the formula evaluator 
//  If there was something in rawCode before, then that was 
//  see [MS-OFFCRYPTO] - 2.3.4.9 
//  Default content types 
//  values between 0.0 and 1.0 result in #NUM! 
// Continue Record additional byte overhead 
//  OOo seems to like the "# ?/?" form 
//  that is exact multiple of block size 
//  <-- works 
//  setting no precalculated value works just fine. 
//  msotxflHorzN   msotxflHorzA 
//  MergedCellsTable 
//  That should be it! 
//  First 12 bytes are a SSlideLayoutAtom, checked elsewhere 
//  only if isFormatted 
//  TODO Parse this, see #58150 
//  Set the comment on a sheet 
//  Default to searching from 1, unless they asked for 0+ 
//  constructor throws exception on null 
//  Shouldn't occur in write-mode 
//  Create a cell at A4 and insert a numbered list into that cell.   Note that a couple of items have been added to the listItems 
//  all fields empty 
// private TextPieceTable tpt; 
// write book to temp file; read and verify that position is serialized 
//  Now turn off sheet names 
//  Bug 55380 
// BOFRecord  IndexRecord 
//  cell not in range of this rule 
//  then assume, that we've been called by import content and only need to update the children 
//  add a pixel to compensate rounding errors 
//  Some tests commented out because close() modifies the file   See bug 58779 
//  run 3 has same text properties as run 2 and will be merged when saving 
//  single quote gets doubled 
//  populate _row.cArray correctly 
//  add two bytes so we can prepend the stylesheet w/ its size 
// Create relationship between pivotTable and the worksheet 
//  Have an empty one created for now 
//  Reference to a sheet scoped named range from another sheet 
//  Set the text 
//  special handling for HSLF 
//  then becomes the new current position. 
//  Now, onto just the doc bit 
//  01 18 30 00 03 20 00 00   E8 03 06 08 07 08 08 08 09 10 01 00 0C 20 04 00   00 00 00 88 1E 00 00 00 
//   to be stored in the Root Property 
//  don't add UncalcedRecord to the list   this flag is enough 
//  make sure none of the padding looks important 
//  convert tail arguments into an array of doubles 
//  for some reason the number of clusters is actually the real number + 1   private int field_2_numIdClusters; 
//  A 32-bit signed integer that specifies the weight of the font in the range zero through 1000. 
//  determine transparency 
//  Note - not all the formats in the file    actually quite match what they claim to    be, as some are auto-local builtins... 
//  visible text   link address 
//  no need to attemptMergeColInfoRecords because we   know both on each side are different 
// stFile  unused (1 byte as we're using single byes) 
//  8 bytes, always seems to be   E8 AC 2C 00 E8 03 05 01   E8 AC 2C 00 E8 03 05 01 
//  write the property values 
//  And something that doesn't 
//  Otherwise these differences look capricious. 
//  But with an invalid font, we get an exception 
//  fall through 
//  247: DB 
//  Sheet 2 is deleted 
//  don't EVER use the 1904 date system 
//  Finish with this one 
//  doesn't work without mocking ... see above 
//  One cell at the beginning 
//  Do endnotes and footnotes 
//  fe1 and fe2 can be used concurrently on separate threads 
//  need to cache data (i.e. read all data) before changing the key size 
//  Ask for it to be written out, and check the header 
//  Verify that hyperlink was removed from workbook after writing out 
// add a new row 
// default line properties 
//  points 
//  end of area is preserved (will remain exact same column)   the top area column is moved simply 
//  clean up the filesystem when we cannot read it here to avoid   leaking file handles 
//  keep UNKNOWN always as last enum! 
//  change C1. Note - last time A1 evaluated C1 was not used 
//  Slide - added later and then changed 
//  make sure ID used once 
//  swap not appropriated records - noop if unchanged 
//   decode them (via a call to setParentTextSize(int) 
//  If the image is compressed, according to the Type field, this value is undefined and MUST be ignored. 
// no fields to initialize 
//  headerIdx = i; 
//  stay   go   stay 
//  TODO - assert something interesting 
//  check that the autoSized column width has ignored the 2nd row 
//  String 
//  Use a test file with the external linked table in place 
//  244: INFO 
//  rethrow exception - be aware that the exception source can be in   multiple locations above ... 
//  flushedWidth or activeWidth may be negative if column contains only blank cells 
//  We might as well evaluate the formula 
// turn off gridlines 
// Add the palette record after the bof which is always the first record 
//  And check they have notes as expected 
// permutation vector for fast saves, who cares! 
//  Decide on the size    8 = atom header    20 = up to name    4 = revision 
//  Having avoided a DOM-based parse of the sheet, we can stream it instead. 
//  It seems like the best thing to do might be to combine these into one 
//  Check the IDs 
//  What excel does if sheet has been deleted   note - '!' added just once below 
//  cause the geometries to be not found 
// Sum up the second column with column title and data format 
//  Page 52 of public specification begins 
//  anchor.setDy1(0); 
// fill w fg fill color 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidation#setErrorStyle(int)	  */
//  whose items are neither bulleted or numbered - into that cell. 
/*          * Loop over the section descriptor array. Each descriptor         * consists of a ClassID and a DWord, and we have to increment         * "offset" accordingly.          */
//  Check that the values supplied are valid 
//  row0 will be shifted on top of row1, so this URL should be removed from the workbook 
//  "You may not use unions, intersections or array constants in Data Validation criteria" 
//  Holds the contents between write-outs 
//  Serialize again 
// comments 
//  borders are not set 
//  -6 bytes of record function and length header 
//  assure that the range [startIndex, endIndex] consists if a single run   there can be two or three runs depending whether startIndex or endIndex 
//  Remove the 1st 
//  grow 50% 
//  Need to evaluate the reference in the context of the other book 
// C  D  E  F  G 
//  create cell color element 
//  For the quote characters in the range U+2018 - U+201E, use the East Asian font   if the text has one of the following language identifiers: 
// new clean instance of paragraph 
//  older biff formats aren't 
//  Write out the 2nd SLWT in the active document 
//  Check again 
// record size must == 4 
//  see https://stackoverflow.com/questions/925147   we use a 115% value instead of the 120% proposed one, as this seems to be closer to LO/OO 
//  SSTRecords store a array of unique strings used in Excel. 
//  the orientation is not set 
//  fail early 
//  Write out and back in again, no change 
//  handler(GenericRecord.class, GenericRecordXmlWriter::printGenericRecord); 
//  unmapped column 
//  Microsoft TNEF 
//  shapes without parents 
//  Asking to re-create will make no difference now 
//  figure out which one to use and load it 
//  don't create hash buffer everytime new 
//         System.arraycopy( remainingData, 0, data, offset + 26, remainingData.length );          int pos = offset + 8 + 18 + remainingData.length; 
//  Finish allocating 
// <cols>    <col min="2" max="4" width="12" customWidth="1"/>    <col min="7" max="7" width="10.85546875" customWidth="1"/>  </cols> 
//  Turn this into a Java date 
// //// Case 1: Evaluate Table1[col] with apostrophe-escaped #-signs //////// 
//  32 length title and 255 length text work for both 
//  Query the CurrentUserAtom 
//  Should never happen in production as all data are fixed but in   case of return null: 
//  Do nothing if no change 
//  fake SID   first rec len 6 
// assertEquals(slide6.getTheme().getColor("accent1").getColor(), s0.getFillColor()); 
//  convert to area ref for simpler code in getValueFromArea() 
/* 		 * Check rule M1.25: The Relationships part shall not have relationships		 * to any other part. Package implementers shall enforce this		 * requirement upon the attempt to create such a relationship and shall		 * treat any such relationship as invalid.		  */
//  The color scheme is responsible for defining a list of twelve colors. 
//  sid=0x0209   size=0x0006 
//  Check some bits in it 
//  Check the FAT was properly processed: 
//             logDebug("push " + opResult); 
//  copy the previous contents of part.data in newArray 
//  and may not follow changes to the underlying CTTable 
//  move the sheets around in all possible combinations to check that the active sheet   is set correctly in all cases 
//  rId1 is url 
//  */ 
//  Columns being moved completely enclose the area ref.   - move the area ref along with the columns regardless of destination 
//  0xB acts like carriage return in page titles and like blank in the others 
//   ignores all categories 
//  a multi-cell array formula defined in this sheet 
//  Open it up again backed by the file 
// test data for the second taable 
//  image/png ISO/IEC 15948:2003 http://www.libpng.org/pub/png/spec/ 
// 2x2  2x2 
// cell B1 has a link to cell A1 on the same sheet 
// JMH TBD 
//  also try the cetab functions 
//  Change a few things 
//  Create new MSG and copy properties. 
//  01 18 32 00 03 20 00 00   E8 03 06 08 07 08 08 08 09 10 01 00 0C 20 04 00   00 00 00 88 1E 00 00 00 
//                     record.getClass().equals(MMSRecord.class) ||                      record.getClass().equals(InterfaceEndRecord.class) ||                      record.getClass().equals(WriteAccessRecord.class) ||                      record.getClass().equals(CodepageRecord.class) ||                      record.getClass().equals(DSFRecord.class)) {                  continue;              } 
//  Simple SUM over numbers 
/*           In powerpoint anchor of a shape is its top left corner.          Java graphics sets string coordinates by the baseline of the first character          so we need to shift down by the height of the textbox         */
//  (currentRecord instanceof HemfPlusMisc.EmfEof) 
//  should not be equal to "555.555" 
//  they both seem unused, but clone them nevertheless to have an exact copy 
//  chart 
//  could be one region "A1:D3"   could be one region "A1:D3" 
//  different sweeps depending on where the control point is 
// text.offset 
//  Check the contents 
//  EXCEL uses this and no VALUE_ERROR 
//  Cell should appear as "<poundsymbol>5" 
//  NB would be 5 if POI added tAttrVolatile properly 
//  read the size of the image and calculate the overall file size 
// FunctionEval.getBasicFunction can throw NotImplementedException   if the fucntion is not yet supported. 
//  Get the cp of the start of text in the main stream 
//  1904 date windowing uses 1/2/1904 as the first day 
//  some cases we get missing external references, resulting in empty sheet names 
//  page number run 
//  Create a second paragraph: 
//  Next, from the columns width, calculate how many co-ordinate 
//  BLACK_BRUSH - A black, solid color brush   BrushStyle: BS_SOLID   Color: 0x00000000 
//  Check for >2gb, which we only support via a File 
//  Try changing the cached value on one of the string 
//  bug 38396 : Formula with exponential numbers not parsed correctly. 
//  UserSViewBegin   SelectionRecord  HeaderRecord  FooterRecord   HeaderFooterRecord 
//  Skip 02:00 CET as that is the Daylight change time   and Java converts it automatically to 03:00 CEST 
//  Add content types 
//  3) once a negative shift has been made any attempt to shift another group of rows    (note: outside of previously negative shifted rows) by a POSITIVE amount causes POI exception:    org.apache.xmlbeans.impl.values.XmlValueDisconnectedException.   NOTE: another negative shift on another group of rows is successful, provided no new rows in     place of previously shifted rows were attempted to be created as explained above. 
//  Try to get it formatted to look the same as excel 
/*              * From: http://social.msdn.microsoft.com/Forums/en-US/3dadbed3-0e68-4f11-8b43-3a2328d9ebd5             *             * The initial value for XorArrayIndex is as follows:             * XorArrayIndex = (FileOffset + Data.Length) % 16             *             * The FileOffset variable in this context is the stream offset into the Workbook stream at             * the time we are about to write each of the bytes of the record data.             * This (the value) is then incremented after each byte is written.              */
//  sprmCFtcBi 
//  give each property its index 
//  @Ignore2("This fails on some systems because fonts are rendered slightly different") 
// swap first row and last row numbers and relativity  Note: cannot just swap the fields because row relativity is stored in fields 3 and 4 
//  to it ... then serialize it and verify the content 
//  Don't need to touch the paragraph styles 
//  Invalid property, ended short 
//  Re-load 
//  strange arguments 
//  indent details 
//  Fetch the next record, and see if it indicates whether    the document is encrypted or not 
// contains custom VBA function 'Commission' 
//             boolean a1; 
//  1x1 corner intersection 
//  Now load the file 
//  reset 
//  line dash 
//  A 32-bit signed integer that specifies the width of the vertical brush stroke, in logical units. 
//  Check read ok, and re-evaluate fine 
//  this cat axis is deleted 
//  TODO: Rich text formatting 
// serialize, read back and compare with the original 
/*          * SignatureTime          */
//  and three hyperlinks 
// default date 
//  Shift Merged Regions 
//  ranges have a vertical border in common   make sure rows are identical: 
// then this unit test should be updated 
//  negative value means the absolute spacing in points 
//  We'll match up the chunk later 
//  The resulting Verifier value MUST be an array of 16 bytes. 
//  arbitrarily selected; may need to increase 
//  note this is asymmetric with the errors when the index is too large (#REF!) 
//  Make sure we don't encounter a loop whilst overwriting   the existing blocks 
//  If the user has chosen to overlay both rows and columns or just   to expand ONLY the size of the rows, then calculate how to lay 
//  WMF   PNG   PNG   PNG   PNG   PNG   WMF   WMF   PNG   PNG   PNG   WMF   WMF   WMF   EMF 
//                 ctDocument.getBody().addNewSectPr();              } 
//  application/vnd.visio 
//  Test removing a sheet maintains the named ranges correctly 
//  oh yeah, and missing arguments 
//  First, try a one BAT block file 
//  A 32-bit unsigned integer that specifies either the foreground color of the text or a graphics brush, 
//  Several styles 
//  no table 
//  Is it a properties chunk? (They have special names) 
//  We can only check the round-tripping, as for now 
//  extract values as ValueEval 
// is MissingCellPolicy=Row.RETURN_NULL_AND_BLANK needed? 
// General number format 
//  Start with an empty one 
//  find first occurrence of lookup value 
//  check that same verifier/salt lead to same hashes 
//  Create a new SupBookRecord 
//  Dk2 
//  A 32-bit unsigned integer that specifies the raster operation code. This code defines how the   color data of the source rectangle is to be combined with the color data of the destination 
//  289: HYPGEOMDIST   290: LOGNORMDIST   291: LOGINV   292: NEGBINOMDIST   293: NORMDIST   294: NORMSDIST   295: NORMINV   296: NORMSINV 
//  Add another sheet, and give it a drawing 
//  Not supported 
//  Complete scientific notation by adding the missing +. 
//  Create the parent style 
/*  only add to relations, if according relationship is being created.  */
//  point number   series index 
//  double; 
//  absolute coordinates 
//  Copy the properties of the one before to afterwards   Will go:      Original, until insert at point      New one      Clone of original, on to the old end 
//  get past the null delimiter for the name. 
/* step */
//  is this a valid address? 
// don't merge continue record with the drawing record, it must be serialized separately 
/*          * plcfBkmkf (table recording beginning CPs of bookmarks) Written         * immediately after the sttbfBkmk, if the document contains bookmarks.         *          * Microsoft Office Word 97-2007 Binary File Format (.doc)         * Specification; Page 24 of 210          */
//  the source part. 
//  External reference - reference is 1 based, link table is 0 based 
//  no password by default! 
//  Border could be defined for the entire row, or for each cell, with the same visual appearance. 
//  calculate the new rownum 
//  Format 0   Cell opts ... 
//  that is small 
//  YK: this is incorrect and the exception below is never thrown. 
//  assertContents("message.rtf", contentsBytes); 
//  Now read the rest of the stream 
//  When it matches:     Sets the font colour to dark red     Sets the background colour to lighter red 
//  First child should be the InteractiveInfoAtom 
//  Compare 
//  Ptgs 
//  Check if we have a rectangle 
//  start with width - offset, then keep adding column widths until the next one puts us over w 
/* double ky1Value = */
//  Don't include the first SpContainer, it is always NotPrimitive 
// expected exception 
//  held on the first bit 
//  As of 2016-06-10, POI does not contain a LatentStyle class, nor was one included in the patch for bug 48574.  LatentStyle shall know styles 
//  Note to POI developers:   Make sure you delete the corresponding entry from   this method any time a new Record subclass is created. 
// this doesn't appear to work, and we still need to limit  entity expansions to 1 in trySetXercesSecurityManager 
//  Row 8 is blank / string / number formula / string formula / blank 
//  and fields so it is different to the paragraph R array. 
//  no placeholder means plain text box 
//  Split it into its parts 
//  first without a formula evaluator 
//  writing is not yet supported... handlePOIDocument(mapi); 
//  But only the first one by relationship 
//  calculate new area 
//  display mode   rgb color 
//  extra complexity required to emulate the way LOOKUP can handles these abnormal cases. 
//  but now the dimensions/relations are kept as-is 
//   (text) 
//  Start again, then wind on to the required block 
//  If there's now no drawing manager, then there's    no drawing escher records on the workbook 
//  Is this right? Number formats (XSSFDataFormat) and cell styles (XSSFCellStyle) are different. What's up with the plus 1? 
/*  TOOD: map content-type  */
//  Check negative (illegal) limits 
//  Excel supports fractions in format strings, which Java doesn't 
//  With Slides and Master Text 
//  we use a XmlCursor here to handle oleObject with-/out AlternateContent wrappers 
//  the ibm jdk has a rendering/JIT bug, which throws an AIOOBE in   TexturePaintContext$Int.setRaster(TexturePaintContext.java:476)   this usually doesn't happen while debugging, because JIT doesn't jump in then. 
// this workbook does not have drawings 
//  previously we used Mockito here, but since JDK 11 mocking the Graphics2D does   not work any longer 
//  TODO set encoding from a command argument 
//  Overlaps with 20 - 30 (before, overlap and after replacements required) 
/*  Insert some custom properties into the container.  */
// link to a place in worksheet: Sheet1!A1 
//  CENTER: X=balance, Y=balance 
//  (Assuming we actually have some) 
//  init. indent string to needed spaces (create as substring vom very long space-only string;   limit indendation for deep recursions) 
//  Need to give a byte array to read 
// should probably defensively return a copy. 
//  Make sure hyperlinks were moved and not copied 
//  Use the second stroke to create an outline of that outline. 
//  rotate about the origin 
// 			// for observing arithmetic near numeric range boundaries  			row.createCell(7).setCellFormula(cel0ref + " * 1.0001");  			row.createCell(8).setCellFormula(cel0ref + " / 1.0001");  		} 
//  Initialise some PackageBase properties 
//  Create a sheet with data validity (similar to bugzilla attachment id=23131). 
/*  Exit if there is no file to display (none specified or only         * files with problems).  */
//  delete end point in current 
//  redirect stdout as the examples often write lots of text 
//  Write out and re-read 
//  these can be null... 
//  Test row creation with consecutive indexes 
// Now if the forground changes to a non-AUTOMATIC color the background resets itself!!! 
//  max row & max col limit as per BIFF8 
//  check the parameters after the directories have been created 
//  Integers 
//  Now look at the table 
//  width 
//  parenthesis Ptg should have only one child 
//  for generated sheets. 
//  initialize with default value; msonfcArabic 
//             } 
//  0-4 
//  Check now it can be opened 
//  accent2 in theme1.xml is <a:srgbClr val="C0504D"/> 
/*  * Tests formulas and operators as loaded from a test data spreadsheet.<p> * This class does not test implementors of <tt>Function</tt> and <tt>OperationEval</tt> in * isolation.  Much of the evaluation engine (i.e. <tt>HSSFFormulaEvaluator</tt>, ...) gets * exercised as well.  Tests for bug fixes and specific/tricky behaviour can be found in the * corresponding test class (<tt>TestXxxx</tt>) of the target (<tt>Xxxx</tt>) implementor, * where execution can be observed more easily.  */
//  now try (re-)parsing the formula 
//  find root by Newton secant method 
//  decrypt the rest of the record 
//  as returned by excel 
//  org.apache.poi.xslf.usermodel.XSLFMetroShape 
//  Check that we're not asked to move too many 
//  Check the block allocation is unchanged, other than    the properties stream going in at the end 
// get default style 
//  should fail if we try to add more now 
// Test the footer 
//  Check the first three have no run styles, just default paragraph style 
//  Good 
// custom copy of ris.readUnicodeLEString to allow for extra bytes at the end 
//  size += readPoint.apply(leis, upperLeft);   size += readPoint.apply(leis, upperRight);   size += readPoint.apply(leis, lowerLeft); 
//  This one shouldn't be allowed 
//  Special case for where the two are the same 
//  comment is column in column 1 
/*          * Copy the original OOXML content to the signed OOXML package. During         * copying some files need to changed.          */
// read ppt from byte array 
//  unset the existing reference to the drawing,   so that subsequent call of clonedSheet.createDrawingPatriarch() will create a new one 
//  working with ints (left shifted 20) instead of doubles   x = 14.5 - binaryExponent * log10(2); 
//  should not be equal to "555.47431" 
// noinspection fallthrough 
//  Complex Accesser methods follow 
//  handle empty cells 
//   B: Theme Based, Foreground 
//  Scary internal getters 
//  Create a new one from that 
//  Check it 
//  Data needs to initially hold just the header block,    a single bat block, and an empty properties section 
//  This avoids an IndexOutOfBounds if multiple nested groups are collapsed/expanded 
/*  Change the category to "POI example". Any former category value will             * be lost. If there has been no category yet, it will be created.  */
//  make sure the formula encodes OK 
//  table2 size was increased, check that new table cells have been cleared 
//  other bookmarks with same boundaries 
//  PT_MOVETO 
//  The booleans as bytes 
//  LittleEndian.putInt( buf, fcOffset, papx.getStartBytes() ); 
//  Non-unicode 
// store the name in byte form if it's a built-in name 
//  Turn on tinting, and check it behaves 
//  Various Stats formulas on numbers 
//  =sum(C:D) -> 66 
//  ---- end optimization to aviod painting background ---- 
//  if it's set to -1, it must be omitted - see 2.9.36 TextMasterStyleLevel 
//  If requested, copy over any other streams we spot, eg Macros 
// if DPI is zero then assume standard 96 DPI  since cannot divide by zero 
/*          * sometimes plex looks like [100, 2000), where 100 is the position of         * field-end character, and 2000 - some other char position, far away         * from field (not inside). So taking into account only start --sergey          */
/*  XLS FO 1.1 doesn't support opacity -- sergey  */
//  propagate parents to parent-aware records 
//  Grab the ministore 
//  Find either Slides or Notes 
//   overwritten 
//  after May 2008 there was one more style applied to the footnotes 
//  Reference to a global named range in a different workbook 
//  if this path is connected to the current position (= has no start point)   the first entry is a dummy entry and will be skipped later 
//  ROW 
//  bool1 bitfields 
//  for numeric cells try user supplied default 
//  Should have one more than the default of each 
//  Add one place after the supplied record 
//  Normal case - read until EOF and close 
/*  Initialize "osVersion" field as if the property has been created on         * a Win32 platform, whether this is the case or not.  */
//  The slide size type 
//  2003 xml file isn't 
//  converted to DeletedAreaRef   truncation at top   truncation at bottom 
//  underlying POIFSDocument instance 
// lifted directly from org.apache.commons.io.IOUtils 2.4 
/*  char 5   */
//  special cached value type 'error' 
//  4 bytes on either side of boundary 
//  we get the same instance on further calls 
//  HTTP input validation 
//  AlternateRecipientAllowed = 01 00 
//  index to first column and relative flags   index to last column and relative flags 
//  cs2 -> 22 
//  Row 19 has a single string in E19 
//  Ensure we have enough data to create a chunk from 
//  field 'rt' should have value 0x01C1, but Excel doesn't care during reading 
//  The value MUST be less than or equal to 0x00000400 and greater than 0x00000000. 
//  THERE IS NO FOUR!! 
//  Try to format 
//  Cell addresses/references are not allowed 
//  if row was not given when constructing the range... 
//  Use a test file with "other workbook" style references 
//  Now zap it from the properties list 
//  Write file. 
//  #2 pass - init properties 
// e-mail link 
//  undocumented till 0x30 
//  3 circles div 8: 3 x 360 / 8 = 135 
//  encrypted 
// simple case  apostrophes are treated as word breaks  capitalization is ignored, special punctuation is treated as a word break 
//  inspection of the code above reveals that every stack.pop() is followed by a   stack.push(). So this is either an internal error or impossible. 
//  Write and check 
// obsolete, used in word 1.x 
//   its relationship exists, and then it won't tie up) 
//  Lt1   Dk1   Lt2   DK2   Accent1   Accent2   Accent3   Accent4   Accent5   Accent6   Hlink   FolHlink 
//  So eclipse doesn't moan 
//  Call should not modify the contents 
//  Look for other interesting values that follow the EOFRecord 
//  If the destination of the rows overlaps either the top 
//  not an omnivorous listener (if it was, this method is a   no-op) 
// 204: USDOLLAR (YEN in BIFF3)  205: FINDB  206: SEARCHB  207: REPLACEB  208: LEFTB  209: RIGHTB  210: MIDB 
//  blank slide 
// hyperlink 
//  result can be null if value is optional (xsd:minOccurs=0), see bugzilla 55864 
//  record to the DIB header, if the record contains a DIB. 
// c >= lastCol, end of row reached  CR  LF 
//  Mac   Ubuntu Xenial, 15", 1680x1050 
//  If the source URI is empty 
//  https://msdn.microsoft.com/en-us/library/ms367611(v=office.12).aspx 
//  skip current '\' and continue to the next char 
//  recursively update each shape 
//  SlideListWithText container. 
//  Check the current ones 
//  hyperlink 
//  Our list of entries, kept sorted to preserve order 
//  check the arguments : as per excel function def 
/*  (non-Javadoc)     * @see org.apache.poi.ss.usermodel.DataValidation#setShowPromptBox(boolean)      */
//  table1 size was reduced, check that former table cells have been cleared 
//  ignore INDEX record because it is only needed by Excel,   and POI always re-calculates its contents 
// We cannot introduce a new type CellType.RICH_TEXT because the types are public so we have to make rich text as a type of string   using the POI style which seems to avoid "instanceof". 
//  test that the conditional validation evaluations changed 
//  not quite an error literal, should be treated as plain text 
//  Gump reports a strange error because of an unavailable XML Parser, let's try to find out where    this comes from    
//  defaults to xor password 
// private static final POILogger _logger = POILogFactory.getLogger(XSSFRow.class); 
//  Directly on a Stream, will go via POIFS and spot it's    actually a .xlsx file encrypted with the default password, and open 
//  Check rule M4.1 : The format designer shall specify and the format   producer   shall create at most one core properties relationship for a package.   A format consumer shall consider more than one core properties   relationship for a package to be an error. If present, the   relationship shall target the Core Properties part. 
//  Check stylings still as expected 
//  Exactly 3 points MUST be specified. 
//  Make sure hyperlinks were deep-copied, and modifying one does not modify the other.  
//  Initialize array to allow to summarize afterwards 
//  3. Use patriarch 
// Create some data to build the pivot table on 
//  A 32-bit unsigned integer that contains the index of the 
//  Check comments are there 
// return new XWPFTableRow(ctTbl.getTrArray(pos)); 
// Check for a good clone 
//  sanity check 
//  empty 
//  embed the time-stamp 
//  true parameter 
//  Check the header created with the paragraph got them, and the one 
//  previously this failed because the border-element was not copied over  
//  remove sheets 
//  This value MUST be 8- or 16-bit aligned, according to the character format. 
//  list may be seen. 
//  TODO 
//  dark blue 
//  Package -> xssf 
// colored axis line 
//  Grab the bytes back 
// one row down 
//  Find or add the external sheet record definition for this 
//  If they're the wrong way around, give up 
//  Clone the sheet, and make sure the password hash is preserved 
//  ambiguous numeric identifiers 
//         background = backcolor; 
// create a standalone CTRow bean 
/*  (non-Javadoc)	 * @see org.apache.poi.hssf.usermodel.DataValidationConstraint#setFormula2(java.lang.String)	  */
//  Total is 20, as the 4 escher 8s all reference 
//  Is 2006-01-24 (2nd day of week) 21:25:03.725 
//  sprmCRsidText 
//  Write out, and check   Load up again, check all still there 
//  0x10 -> complex 
//  Check the 15 individual ones added 
//  row (in original file each row was unique) 
//  duplicate chart with embedded workbook 
//  https://bz.apache.org/bugzilla/show_bug.cgi?id=58648 
//  filename characters 
//  Transform of text in flipped shapes is special.   At this point the flip and rotation transform is already applied   (see DrawShape#applyTransform ), but we need to restore it to avoid painting "upside down".   See Bugzilla 54210. 
//  set the text "Rich Text" to be green and the default font 
/* XSLFSlide blankSlide = */
//  Window size 1 so only last row will be in memory 
//  See bug 56557, we should not inject data into the special ChartSheets 
//  verify a rather complex format found e.g. in http://wahl.land-oberoesterreich.gv.at/Downloads/bp10.xls 
//  check getFirstCell... 
//  Load the external links tables. Their order is defined by the order 
//  Write a 3 block stream 
//  fixed type header   page 24, point 2.4.2.1.1 
//  Reload the range every time 
//  minimal test to include generated classes in poi-ooxml-schemas 
//  FormulaParser strips spaces anyway 
//  falls on a word boundary 
//             assertEquals("MOD(ROW($T1),2)=1", cr.getFormula1()); 
// Bug53150 formatting a whole number with fractions should just give the number 
// TestPaletteRecord.class, //converted to junit4 
//  Save to a new temp file 
//  Use them 
//  line spacing 80   paragraph is 97 long 
// integer 
//  Add default content types for .xml and .rels 
//  it's final because the xslf inheritance hierarchy is not necessary the same as   the (not existing) xmlbeans hierarchy and subclasses shouldn't narrow it's return value 
//  visio is in flipped coordinates, so translate the text to be in the   right place 
//  No formatting applied, just do raw value in all cases 
//  The subrange [19, 388] is expected to be replaced with a EscherAggregate object 
// 				FileOutputStream fileOut = new FileOutputStream("27405output.xls");  				wb.write(fileOut);  				fileOut.close(); 
//  no header is set (yet) 
//  Turn the type ID into a strongly typed thing 
//  The second to the last knot of the NURBS. 
//  bug 59687:  XSSFSheet.RemoveRow doesn't handle row gaps properly when removing row comments 
//  Allocate all the spare ones 
//  lazy listen for ALL records with the listener shown above 
//  Slide - added at start 
//  we'll need multiple editions 
// start of interface implementation 
//  bug 60197: setSheetOrder should update sheet-scoped named ranges to maintain references to the sheets before the re-order 
//  (Because Excel typically doesn't write NaN 
//  And the chinese 
// check that id of the drawing group was updated 
//  do not break here since drawing has not been found yet (see bug 52425) 
//  NOSONAR   this is not the physical row number! 
//  enforces singleton 
//  note - does not match boolean TRUE 
//  out of bounds 
//  return 0;     EscherSimpleProperty simpleProperty = (EscherSimpleProperty)   property;   return simpleProperty.getPropertyValue(); 
//  2 defined rows 
//  If the CMAP_LOOKUP flag in the optionsFlags field is set, each value in this array specifies a   Unicode character. Otherwise, each value specifies an index to a character glyph in the EmfPlusFont 
//  Default + TNR 
//  nRegions 
//  only for xml signing 
//  ignore any exception here 
//  It's the same on 512 byte and 4096 byte block files! 
//  CustomViewSettingsRecordAggregate blocks having UserSViewBegin with the same GUID 
//  Note: the XSSFTextParagraph constructor will create its required   XSSFTextRuns from the provided CTTextParagraph 
// this is the codepoint index, not char index, which may be larger if there are multi-byte chars 
//  line decorations 
//  now the whole block G4L:15 
//  negative values are mapped to the correct values for compatibility between HSSF and XSSF 
//  ignore trailing newline 
// "document/bug53475-password-is-solrcell.docx", 
//  Verify that myFunc and yourFunc were successfully added to Workbook names 
// increase row height to accommodate two lines of text 
//  You should only every have 1, 2 or 3 SLWTs    (normally it's 2, or 3 if you have notes) 
//  end public class ByteField 
//  The Source File/Folder, Destination Folder and Separator   were passed to the main method. 
//  the bullet is set 40 pt before the text 
//  These are the bit fields in cell options 
//  paragraph is 97 long   paragraph reserved field 
//  Sanity check the block count 
//  Start off with rich one 
// Ffn corresponds to a Pascal style String in STTBF. 
//  using the PieceDescriptors, build our list of TextPieces. 
// idx is 0-based index in the #pictures array 
//  2x2 corner intersection   2-row/2-column intersection 
//  "E" 
//  Table lookup should be case-insensitive 
//  Add two more 
//  (eg font.dialog.plain.* vs font.Californian FB Bold.*) 
//  bug 58084: set borders correctly 
//  Wind on by the 4 byte info header 
//  If 4k blocks, rest is blank 
//  worksheet stream is seriously broken 
//  subtracting positive zero gives minus zero 
//  verify that null-values can be set, this was possible up to 3.11, but broken in 3.12 
//  Keeps final check below from adding 1 and keeps Den from being 0 
// stored strings items  stored strings begin sst  stored strings end sst 
//  Save a workbook with a hyperlink 
//  try to read it in HSSFWorkbook to quickly fail if we cannot read the file there at all and thus probably should use EXCLUDED instead 
//   2 x x 
//  Slightly pointless step counter 
//  character run is 1 long 
//  "PK\005\006"   number of this disk   central directory start disk   number of directory entries on disk   total number of directory entries   length of central directory   offset of central directory   comment length 
//  writing is not yet implemented... handlePOIDocument(pub); 
//  invalid characters are replaced with question marks 
//  always use real numbers in calculations! 
//                 return null;              } 
//  May need better parsing in future 
//  the height of the shape. 
//  if the target had a fragment then append it to the result 
//   2   x 
//  We have rows 0, 1, 2, 20 and 21 
//  collapse both inner and outer groups 
/*  Open the POI filesystem.  */
//  also try to see if some of the Records behave incorrectly   TODO: still fails on some records... RecordsStresser.handleWorkbook(wb); 
// move the 3rd row two rows down 
//  Otherwise, try it as a named range 
//  some files store the whole file size in sizeLast, other just the last record size 
/* FileOutputStream fileOut = new FileOutputStream(filename);        wb.write(fileOut);        fileOut.close(); */
/*          *    A      B         * 1 LONGMERGED         * 2 SHORT SHORT          */
//  do not delete the file if there's an error--might be helpful for debugging 
//  although the spec says "use unsigned ints", there are examples out there using signed ints 
// 				row.createCell(0); // this causes ValueRecordsAggregate.records to auto-extend  			} 
//  Should have the usual 6 separaters   Then all 6 of the different header/footer kinds   Finally a terminater 
//  produces #DIV/0! 
//  need to read the header to calculate start of bitmap data correct 
//  Second cell should be detected as having two paragraphs 
//  The maximum column width for an individual cell is 255 characters 
//  sheet cloning errors 
//  add the created SupBookRecord before ExternSheetRecord 
//  maximum column width is 255 characters   Bug 50681 reports exception at this point 
//  An x-coordinate of a point on the infinite line; paired with y-coordinate 
//  SBAT   Mini Stream 
//  these line patterns are just approximations 
//  endingFc += fcMin; 
//  category data type 
// setting XSSFColor 
//  from the start of the record in which this object is contained. This value MUST be 32-bit aligned. 
//  Set it up 
//  This row shift should only affect the formulas 
//  No overlap 
//  see https://stackoverflow.com/questions/11787571/how-to-read-pem-file-to-get-private-and-public-key 
//  Will show as the center, as that is what excel does    with an invalid footer lacking left/right/center details 
//  4st is left aligned + normal line spacing (despite differing font) 
//  Priority = 00 00 00 00 
// If the JTables default cell renderer has been setup correctly the  value will be the HSSFCell that we are trying to render 
//  Copy formula result as value   FIXME: Cached value may be stale 
//  Used to blow up with an IllegalArgumentException    when creating a DVRecord   Now won't, but no idea if this means we have    rubbish in the DVRecord or not... 
//  x basis 
//  currently immutable 
//  last shape ID cached in EscherDgRecord 
//  Now add a new sheet, and check things work 
//  Test that comments were shifted as expected 
//  Check on the workbook, but shouldn't be there! 
//  (XXX 1904-windowing not respected)   => sunday = 1, monday = 2, ..., saturday = 7 
//  Now sort, and re-check 
//  Check our filesystem has Properties then BAT 
//  Ensure we have enough tab IDs   Can be a few short if new sheets were added 
//  Palette 0   ADTL Palette 0 
//  add in the middle 
// we cannot remove cells included in a multi-cell array formula 
// retrieve the range and check it is the same 
/*  (non-Javadoc)	 * @see org.apache.poi.ss.usermodel.DataValidationConstraint#getExplicitListValues()	  */
//  XSSFPictureData.class 
//  Open the two filesystems 
//  u201c and u201d are "smart-quotes" 
//  bug 46973: fails here with IllegalArgumentException   ptgs must not be null 
//  which is in the choice element 
//  https://stackoverflow.com/questions/30532612 
//  RectStruct 
//  Function "Text" uses custom-formats which are locale specific   can't set the locale on a per-testrun execution, as some settings have been 
//  For offline testing 
//  immutable - so OK to return this 
//  private static final int MASTER_SLIDE_ID      =  0x00000000; 
// Need to update the name -> named ranges map 
//  space in cell ref 
// 61287 -- if the footer_len == 0, there may not be a multibyte flag 
//  Check we got the 33 rows 
// The vertical line spacing 
//  expected   but still should close 
//  create a defined name called 'B0' and try again 
// Used for clone method. 
//  and encrypt it again 
//  ten column ColumnInfoRecord starting at index 0 
// //// Case 5: Evaluate "Table1[#Data]" (excludes Header and Data rows) //////// 
//  For handling formulas with string results 
//  Parent ChunkStream is at 0x7194   This is one of the last children of the trailer 
//  Column 'A'   Column 'B'   Column 'C'   Column 'D' 
//  ignore the 16 padding bytes 
//  identified bug 44421 
//  Not sure if this can ever happen (See bug 45798)   Seems to be what excel would do in this case 
//  sheet1 A3 formulae 
//  just used for printing out contents of spreadsheets 
//  A 32-bit unsigned integer that specifies the number of elements in the 
//  do something to make font1 and font2 different   so they are not same or equal. 
//  A value of type FixedPoint, as specified in [MS-OSHARED] section 2.2.1.6,   that specifies the angle of the gradient fill. Zero degrees represents a vertical vector from   bottom to top. The default value for this property is 0x00000000. 
//  bottom 
//  Mark the previous block as carrying on to us if needed 
// number of items  selected item  flags  objId  LbsDropData  flags  the number of lines to be displayed in the dropdown  the smallest width in pixels allowed for the dropdown window  num chars 
//  And some MID ones just to check 
//  return null if Blip data is missing 
// modify position through HSSFCell 
//  minimal test to cause ooxml-lite to include all the classes in poi-ooxml-schemas 
//  Check that a mini-stream was assigned, with one block used 
//  Check the authors came through too 
//  a failed invocation of Cell.setCellType leaves the cell   in the state that it was in prior to the invocation 
//  0x80000009 is not a valid stock object 
//  paragraphs of text. 
// this is at a critical juncture  this too 
// Last column of the hyperlink 
//  Could be replaced with org.apache.commons.lang3.StringUtils#join 
/*  **********  END  implementation of Entry **********  */
//  These are CFRule12Rule only 
/* assertNull(((XSSFWorkbook)wb).getCalculationChain());        assertNotNull(((XSSFWorkbook)wb).getCalculationChain().getCTCalcChain());        assertNotNull(((XSSFWorkbook)wb).getCalculationChain().getCTCalcChain().getCArray());        assertEquals(0, ((XSSFWorkbook)wb).getCalculationChain().getCTCalcChain().getCArray().length); */
//  Split the URI into several part and analyze each 
// 				throw new RuntimeException(e);  			} 
/*  According to the definition of the processPOIFSReaderEvent method             * we cannot pass checked exceptions to the caller. The following             * lines check whether a checked exception occurred and throws an             * unchecked exception. The message of that exception is that of             * the underlying checked exception.  */
//  the use of 2 big blocks 
//  unregistered functions are parseable and renderable, but may not be evaluateable 
// safety checks 
//  space   colon 
//  Sheet 1 A7 is to another sheet, range 
//  build a range of the rows that are overwritten, i.e. the target-area, but without   rows that are moved along 
//  FtCf (pictFormat)  
//  Finally, write the newly modified Word document out to file. 
//  HSLFSlideShow primed on the test data 
//  If we're not preserving nodes, don't track the 
//  TODO make this class into a record aggregate 
//  paragprah is 28 long 
//  maximum number of colors in the DIB. 
//  the record will start with two integers, then this string   ... that will eat up 16 of the 8224 bytes that the record 
//  Grab the right block 
// An ExVideoContainer record that specifies information about the MCI movie 
//  Allocate our BAT in the existing XBAT with space 
//  instantiate the following classes so they'll get picked up by   the XmlBean process and added to the jar file. they are required   for the following XWPFTable methods. 
//  check the rest 
//  Check we can get at the Escher layer still 
//  Now for some non-internal ones 
//  Quick check on 4096 byte blocks too 
//  Data Format 
//  XmlAnyTypeImpl is returned for AlternateContent   parts, which might contain a CTDrawing 
//  object created above. 
// now ref is CellRangeAddress(10, 2, 3, 4) 
//  Check a few bits of the table directly 
//  expected no change 
//  Create a map from the STBorder.Enum values to the XWPF-level enums 
//  sprmPDxcRight 
//  can just zap the lot 
//  index to last row   index to first column and relative flags 
//  Save and re-load them, to check for stability across that 
//  Evaluation order:   lookup_value , table_array, range_lookup, find lookup value, col_index, fetch result 
//  In case user provided testName with a file extension, don't repeat the file extension a second time 
//  Types taken from http://msdn.microsoft.com/en-us/library/microsoft.exchange.data.contenttypes.tnef.tnefpropertytype%28v=EXCHG.140%29.aspx 
//  "-dump", new File("build/tmp/", pptFile+".dump").getCanonicalPath(), 
//  remove the rest all at once and test 
//  else y = value of this guide 
//  Oh joy, we need a new XBAT too... 
//  Lots, with gaps 
//  Encrypted OOXML files go inside OLE2 containers, is this one? 
//  compare each cell range to all other cell-ranges 
//  none of the columns should be hidden 
//  copy original formula but adjust 3D refs to the new external sheet index 
//  If we found it and are now at 18 bytes, 
/*  e.g. 2500 for 50%  */
//  Move to end 
//  Add a row to the existing empty sheet 
//  And grab the 2 byte values 
//  Look for any other streams 
//  we can merge non-intersecting cells 
//  MEMORYMETAFILE = 0x0001, DISKMETAFILE = 0x0002  
//  jumpTable 
//  length of address link field 
//  If there's a format that starts later in the string, make it start now 
/* 		* How to recognise end of stream?		* In the best case, the underlying input stream (in) ends just after the last EOF record		* Usually however, the stream is padded with an arbitrary byte count.  Excel and most apps		* reliably use zeros for padding and if this were always the case, this code could just		* skip all the (zero sized) records with sid==0.  However, bug 46987 shows a file with		* non-zero padding that is read OK by Excel (Excel also fixes the padding).		*		* So to properly detect the workbook end of stream, this code has to identify the last		* EOF record.  This is not so easy because the worbook bof+eof pair do not bracket the		* whole stream.  The worksheets follow the workbook, but it is not easy to tell how many		* sheet sub-streams should be present.  Hence we are looking for an EOF record that is not		* immediately followed by a BOF record.  One extra complication is that bof+eof sub-		* streams can be nested within worksheet streams and it's not clear in these cases what		* record might follow any EOF record.  So we also need to keep track of the bof/eof		* nesting level.		 */
//  Reference to a sheet-scoped named range in a different workbook 
/*  Check whether we have exactly one command-line argument.  */
//  Excel example for built-in title:     'second sheet'!$E:$F,'second sheet'!$2:$3 
//  sprmPItap 
//  frameWidth accounts for leading spaces which is excluded from bounds.getWidth() 
// TODO: add in tests for phonetic runs 
//  Last is a chain location 
//  Note - no adjustments for end of Feb 
//  BarDirection.BAR then X axis is target axis and Y axis is from 0 to 1 
//  Since the Workbook interface doesn't derive from POIDocument   We'll likely need one of these for each document container interface 
//  decrypted 
//  Check that we have the new entries 
//  Output the comment, if requested and exists 
//  (non-null) > (null) 
//  If the '.' is any later, ExcelGeneralNumberFormat will render an integer, as Excel does. 
//  Pink with yellow - full 
//  Note - the tAttrSum token (node.getToken()) is a base   token so does not need to have its operand class set 
//  intentionally shadowing variables here 
//  Do not close the workbook if there was a problem writing the workbook 
//  [MS-DOC], v20140721, 2.6.4, sprmSRncFtn         
// try to add 5 empty rows to a new sheet 
//  Now do non rich one 
//  The x-coordinate of the curve's ending control point relative to the   shape's width; a point on the arc. The control point is best located 
//  value 2 is handled above (as value 11) 
//  MB 
//  Negative months are fairly easy 
//  will become "Normal". 
//  Overlaps with 8 - 9 (overlap and after replacements required) 
